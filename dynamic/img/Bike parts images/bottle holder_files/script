/**
 * body-scroll-lock
 *
 * Copyright (c) 2018 Will Po
 * @license   Licensed under MIT license
 *
 * You can obtain a copy of the License at
 * gis.goinstore.com/static-common/licenses/MIT-License.txt
 */
var gisAppLib= gisAppLib || {};
!function(e,o){var t={};o(t),e.bodyScrollLock=t}(gisAppLib,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=!1;if("undefined"!=typeof window){var e={get passive(){t=!0}};window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}function d(o){return s.some(function(e){return!(!e.options.allowTouchMove||!e.options.allowTouchMove(o))})}function l(e){var o=e||window.event;return!!d(o.target)||(1<o.touches.length||(o.preventDefault&&o.preventDefault(),!1))}function n(){void 0!==m&&(document.body.style.paddingRight=m,m=void 0),void 0!==v&&(document.body.style.overflow=v,v=void 0)}function i(){if(void 0!==f){var e=-parseInt(document.body.style.top,10),o=-parseInt(document.body.style.left,10);document.body.style.position=f.position,document.body.style.top=f.top,document.body.style.left=f.left,window.scrollTo(o,e),f=void 0}}var c="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints),s=[],u=!1,a=-1,v=void 0,f=void 0,m=void 0;exports.disableBodyScroll=function(r,e){if(r){if(!s.some(function(e){return e.targetElement===r})){var o={targetElement:r,options:e||{}};s=[].concat(function(e){if(Array.isArray(e)){for(var o=0,t=Array(e.length);o<e.length;o++)t[o]=e[o];return t}return Array.from(e)}(s),[o]),c?window.requestAnimationFrame(function(){if(void 0===f){f={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var e=window,o=e.scrollY,t=e.scrollX,n=e.innerHeight;document.body.style.position="fixed",document.body.style.top=-o+"px",document.body.style.left=-t+"px",setTimeout(function(){return window.requestAnimationFrame(function(){var e=n-window.innerHeight;e&&n<=o&&(document.body.style.top=-(o+e))})},300)}}):function(e){if(void 0===m){var o=!!e&&!0===e.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;if(o&&0<t){var n=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);m=document.body.style.paddingRight,document.body.style.paddingRight=n+t+"px"}}void 0===v&&(v=document.body.style.overflow,document.body.style.overflow="hidden")}(e),c&&(r.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},r.ontouchmove=function(e){var o,t,n,i;1===e.targetTouches.length&&(t=r,i=(o=e).targetTouches[0].clientY-a,d(o.target)||(t&&0===t.scrollTop&&0<i||(n=t)&&n.scrollHeight-n.scrollTop<=n.clientHeight&&i<0?l(o):o.stopPropagation()))},u||(document.addEventListener("touchmove",l,t?{passive:!1}:void 0),u=!0))}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},exports.clearAllBodyScrollLocks=function(){c&&(s.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),u&&(document.removeEventListener("touchmove",l,t?{passive:!1}:void 0),u=!1),a=-1),(c?i:n)(),s=[]},exports.enableBodyScroll=function(o){o?(s=s.filter(function(e){return e.targetElement!==o}),c&&(o.ontouchstart=null,o.ontouchmove=null,u&&0===s.length&&(document.removeEventListener("touchmove",l,t?{passive:!1}:void 0),u=!1)),(c?i:n)()):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")}});

//# sourceMappingURL=loggly.tracker-2.1.min.map
!function(a,b){function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function d(){this.key=!1,this.sendConsoleErrors=!1,this.tag="jslogger",this.useDomainProxy=!1}function e(a,b){a.key=b,a.setSession(),i(a)}function f(a,b){a.tag=b}function g(a,b){a.useDomainProxy=b,i(a)}function h(b,c){if(b.sendConsoleErrors=c,b.sendConsoleErrors===!0){var d=a.onerror;a.onerror=function(c,e,f,g){b.push({category:"BrowserJsException",exception:{message:c,url:e,lineno:f,colno:g}}),d&&"function"==typeof d&&d.apply(a,arguments)}}}function i(b){1==b.useDomainProxy?b.inputUrl=j+a.location.host+"/"+n+"/inputs/"+b.key+"/tag/"+b.tag:b.inputUrl=j+(b.logglyCollectorDomain||k)+"/inputs/"+b.key+"/tag/"+b.tag}var j="http"+("https:"===b.location.protocol?"s":"")+"://",k="logs-01.loggly.com",l="logglytrackingsession",m=l.length+1,n="loggly";d.prototype={setSession:function(a){a?(this.session_id=a,this.setCookie(this.session_id)):this.session_id||(this.session_id=this.readCookie(),this.session_id||(this.session_id=c(),this.setCookie(this.session_id)))},push:function(a){var b=typeof a;if(a&&("object"===b||"string"===b)){var c=this;if("string"===b)a={text:a};else{if(a.logglyCollectorDomain)return void(c.logglyCollectorDomain=a.logglyCollectorDomain);if(void 0!==a.sendConsoleErrors&&h(c,a.sendConsoleErrors),a.tag&&f(c,a.tag),a.useDomainProxy&&g(c,a.useDomainProxy),a.logglyKey)return void e(c,a.logglyKey);if(a.session_id)return void c.setSession(a.session_id)}c.key&&c.track(a)}},track:function(b){b.sessionId=this.session_id;try{var c=new XMLHttpRequest;c.open("POST",this.inputUrl,!0),c.setRequestHeader("Content-Type","text/plain"),c.send(JSON.stringify(b))}catch(d){a&&a.console&&"function"==typeof a.console.log&&(console.log("Failed to log to loggly because of this exception:\n"+d),console.log("Failed log data:",b))}},readCookie:function(){var a=b.cookie,c=a.indexOf(l);if(0>c)return!1;var d=a.indexOf(";",c+1);return d=0>d?a.length:d,a.slice(c+m,d)},setCookie:function(a){b.cookie=l+"="+a}};var o=a._LTracker,p=new d;if(o&&o.length){var q=0,r=o.length;for(q=0;r>q;q++)p.push(o[q])}a._LTracker=p,a.LogglyTracker=d}(window,document);

/**
* post-robot
*
* Copyright 2016 PayPal
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
*     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
*     See the License for the specific language governing permissions and
* limitations under the License.
* */
var gisAppLib= gisAppLib || {};
!function(n,e){n.postRobot=e()}(gisAppLib,(function(){return function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return{}.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";function r(n){return"[object RegExp]"==={}.toString.call(n)}t.r(e),t.d(e,"Promise",(function(){return A})),t.d(e,"TYPES",(function(){return Zn})),t.d(e,"ProxyWindow",(function(){return En})),t.d(e,"setup",(function(){return Kn})),t.d(e,"destroy",(function(){return Yn})),t.d(e,"serializeMessage",(function(){return Bn})),t.d(e,"deserializeMessage",(function(){return Jn})),t.d(e,"createProxyWindow",(function(){return Hn})),t.d(e,"toProxyWindow",(function(){return Un})),t.d(e,"on",(function(){return Ln})),t.d(e,"once",(function(){return qn})),t.d(e,"send",(function(){return Fn})),t.d(e,"markWindowKnown",(function(){return ln})),t.d(e,"cleanUpWindow",(function(){return $n})),t.d(e,"bridge",(function(){}));var o="Call was rejected by callee.\r\n";function i(n){return void 0===n&&(n=window),"about:"===n.location.protocol}function a(n){if(void 0===n&&(n=window),n)try{if(n.parent&&n.parent!==n)return n.parent}catch(n){}}function u(n){if(void 0===n&&(n=window),n&&!a(n))try{return n.opener}catch(n){}}function c(n){try{return!0}catch(n){}return!1}function s(n){void 0===n&&(n=window);var e=n.location;if(!e)throw new Error("Can not read window location");var t=e.protocol;if(!t)throw new Error("Can not read window protocol");if("file:"===t)return"file://";if("about:"===t){var r=a(n);return r&&c()?s(r):"about://"}var o=e.host;if(!o)throw new Error("Can not read window host");return t+"//"+o}function f(n){void 0===n&&(n=window);var e=s(n);return e&&n.mockDomain&&0===n.mockDomain.indexOf("mock:")?n.mockDomain:e}function d(n){if(!function(n){try{if(n===window)return!0}catch(n){}try{var e=Object.getOwnPropertyDescriptor(n,"location");if(e&&!1===e.enumerable)return!1}catch(n){}try{if(i(n)&&c())return!0}catch(n){}try{if(s(n)===s(window))return!0}catch(n){}return!1}(n))return!1;try{if(n===window)return!0;if(i(n)&&c())return!0;if(f(window)===f(n))return!0}catch(n){}return!1}function l(n){if(!d(n))throw new Error("Expected window to be same domain");return n}function h(n,e){if(!n||!e)return!1;var t=a(e);return t?t===n:-1!==function(n){var e=[];try{for(;n.parent!==n;)e.push(n.parent),n=n.parent}catch(n){}return e}(e).indexOf(n)}function w(n){var e,t,r=[];try{e=n.frames}catch(t){e=n}try{t=e.length}catch(n){}if(0===t)return r;if(t){for(var o=0;o<t;o++){var i=void 0;try{i=e[o]}catch(n){continue}r.push(i)}return r}for(var a=0;a<100;a++){var u=void 0;try{u=e[a]}catch(n){return r}if(!u)return r;r.push(u)}return r}var p=[],m=[];function v(n,e){void 0===e&&(e=!0);try{if(n===window)return!1}catch(n){return!0}try{if(!n)return!0}catch(n){return!0}try{if(n.closed)return!0}catch(n){return!n||n.message!==o}if(e&&d(n))try{if(n.mockclosed)return!0}catch(n){}try{if(!n.parent||!n.top)return!0}catch(n){}var t=function(n,e){for(var t=0;t<n.length;t++)try{if(n[t]===e)return t}catch(n){}return-1}(p,n);if(-1!==t){var r=m[t];if(r&&function(n){if(!n.contentWindow)return!0;if(!n.parentNode)return!0;var e=n.ownerDocument;if(e&&e.documentElement&&!e.documentElement.contains(n)){for(var t=n;t.parentNode&&t.parentNode!==t;)t=t.parentNode;if(!t.host||!e.documentElement.contains(t.host))return!0}return!1}(r))return!0}return!1}function y(n){return void 0===n&&(n=window),u(n=n||window)||a(n)||void 0}function g(n,e){if("string"==typeof n){if("string"==typeof e)return"*"===n||e===n;if(r(e))return!1;if(Array.isArray(e))return!1}return r(n)?r(e)?n.toString()===e.toString():!Array.isArray(e)&&Boolean(e.match(n)):!!Array.isArray(n)&&(Array.isArray(e)?JSON.stringify(n)===JSON.stringify(e):!r(e)&&n.some((function(n){return g(n,e)})))}function _(n){try{if(n===window)return!0}catch(n){if(n&&n.message===o)return!0}try{if("[object Window]"==={}.toString.call(n))return!0}catch(n){if(n&&n.message===o)return!0}try{if(window.Window&&n instanceof window.Window)return!0}catch(n){if(n&&n.message===o)return!0}try{if(n&&n.self===n)return!0}catch(n){if(n&&n.message===o)return!0}try{if(n&&n.parent===n)return!0}catch(n){if(n&&n.message===o)return!0}try{if(n&&n.top===n)return!0}catch(n){if(n&&n.message===o)return!0}try{if(n&&"__unlikely_value__"===n.__cross_domain_utils_window_check__)return!1}catch(n){return!0}try{if("postMessage"in n&&"self"in n&&"location"in n)return!0}catch(n){}return!1}function b(n){try{n.close()}catch(n){}}function W(n){try{if(!n)return!1;if("undefined"!=typeof Promise&&n instanceof Promise)return!0;if("undefined"!=typeof window&&"function"==typeof window.Window&&n instanceof window.Window)return!1;if("undefined"!=typeof window&&"function"==typeof window.constructor&&n instanceof window.constructor)return!1;var e={}.toString;if(e){var t=e.call(n);if("[object Window]"===t||"[object global]"===t||"[object DOMWindow]"===t)return!1}if("function"==typeof n.then)return!0}catch(n){return!1}return!1}var E,x=[],S=[],j=0;function k(){if(!j&&E){var n=E;E=null,n.resolve()}}function O(){j+=1}function P(){j-=1,k()}var A=function(){function n(n){var e=this;if(this.resolved=void 0,this.rejected=void 0,this.errorHandled=void 0,this.value=void 0,this.error=void 0,this.handlers=void 0,this.dispatching=void 0,this.stack=void 0,this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],n){var t,r,o=!1,i=!1,a=!1;O();try{n((function(n){a?e.resolve(n):(o=!0,t=n)}),(function(n){a?e.reject(n):(i=!0,r=n)}))}catch(n){return P(),void this.reject(n)}P(),a=!0,o?this.resolve(t):i&&this.reject(r)}}var e=n.prototype;return e.resolve=function(n){if(this.resolved||this.rejected)return this;if(W(n))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=n,this.dispatch(),this},e.reject=function(n){var e=this;if(this.resolved||this.rejected)return this;if(W(n))throw new Error("Can not reject promise with another promise");if(!n){var t=n&&"function"==typeof n.toString?n.toString():{}.toString.call(n);n=new Error("Expected reject to be called with Error, got "+t)}return this.rejected=!0,this.error=n,this.errorHandled||setTimeout((function(){e.errorHandled||function(n,e){if(-1===x.indexOf(n)){x.push(n),setTimeout((function(){throw n}),1);for(var t=0;t<S.length;t++)S[t](n,e)}}(n,e)}),1),this.dispatch(),this},e.asyncReject=function(n){return this.errorHandled=!0,this.reject(n),this},e.dispatch=function(){var e=this.resolved,t=this.rejected,r=this.handlers;if(!this.dispatching&&(e||t)){this.dispatching=!0,O();for(var o=function(n,e){return n.then((function(n){e.resolve(n)}),(function(n){e.reject(n)}))},i=0;i<r.length;i++){var a=r[i],u=a.onSuccess,c=a.onError,s=a.promise,f=void 0;if(e)try{f=u?u(this.value):this.value}catch(n){s.reject(n);continue}else if(t){if(!c){s.reject(this.error);continue}try{f=c(this.error)}catch(n){s.reject(n);continue}}if(f instanceof n&&(f.resolved||f.rejected)){var d=f;d.resolved?s.resolve(d.value):s.reject(d.error),d.errorHandled=!0}else W(f)?f instanceof n&&(f.resolved||f.rejected)?f.resolved?s.resolve(f.value):s.reject(f.error):o(f,s):s.resolve(f)}r.length=0,this.dispatching=!1,P()}},e.then=function(e,t){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.then expected a function for success handler");if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for error handler");var r=new n;return this.handlers.push({promise:r,onSuccess:e,onError:t}),this.errorHandled=!0,this.dispatch(),r},e.catch=function(n){return this.then(void 0,n)},e.finally=function(e){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.finally expected a function");return this.then((function(t){return n.try(e).then((function(){return t}))}),(function(t){return n.try(e).then((function(){throw t}))}))},e.timeout=function(n,e){var t=this;if(this.resolved||this.rejected)return this;var r=setTimeout((function(){t.resolved||t.rejected||t.reject(e||new Error("Promise timed out after "+n+"ms"))}),n);return this.then((function(n){return clearTimeout(r),n}))},e.toPromise=function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)},n.resolve=function(e){return e instanceof n?e:W(e)?new n((function(n,t){return e.then(n,t)})):(new n).resolve(e)},n.reject=function(e){return(new n).reject(e)},n.asyncReject=function(e){return(new n).asyncReject(e)},n.all=function(e){var t=new n,r=e.length,o=[].slice();if(!r)return t.resolve(o),t;for(var i=function(n,e,i){return e.then((function(e){o[n]=e,0==(r-=1)&&t.resolve(o)}),(function(n){i.reject(n)}))},a=0;a<e.length;a++){var u=e[a];if(u instanceof n){if(u.resolved){o[a]=u.value,r-=1;continue}}else if(!W(u)){o[a]=u,r-=1;continue}i(a,n.resolve(u),t)}return 0===r&&t.resolve(o),t},n.hash=function(e){var t={},r=[],o=function(n){if(e.hasOwnProperty(n)){var o=e[n];W(o)?r.push(o.then((function(e){t[n]=e}))):t[n]=o}};for(var i in e)o(i);return n.all(r).then((function(){return t}))},n.map=function(e,t){return n.all(e.map(t))},n.onPossiblyUnhandledException=function(n){return function(n){return S.push(n),{cancel:function(){S.splice(S.indexOf(n),1)}}}(n)},n.try=function(e,t,r){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.try expected a function");var o;O();try{o=e.apply(t,r||[])}catch(e){return P(),n.reject(e)}return P(),n.resolve(o)},n.delay=function(e){return new n((function(n){setTimeout(n,e)}))},n.isPromise=function(e){return!!(e&&e instanceof n)||W(e)},n.flush=function(){return e=E=E||new n,k(),e;var e},n}();function I(n,e){for(var t=0;t<n.length;t++)try{if(n[t]===e)return t}catch(n){}return-1}var z,C=function(){function n(){if(this.name=void 0,this.weakmap=void 0,this.keys=void 0,this.values=void 0,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__",function(){if("undefined"==typeof WeakMap)return!1;if(void 0===Object.freeze)return!1;try{var n=new WeakMap,e={};return Object.freeze(e),n.set(e,"__testvalue__"),"__testvalue__"===n.get(e)}catch(n){return!1}}())try{this.weakmap=new WeakMap}catch(n){}this.keys=[],this.values=[]}var e=n.prototype;return e._cleanupClosedWindows=function(){for(var n=this.weakmap,e=this.keys,t=0;t<e.length;t++){var r=e[t];if(_(r)&&v(r)){if(n)try{n.delete(r)}catch(n){}e.splice(t,1),this.values.splice(t,1),t-=1}}},e.isSafeToReadWrite=function(n){return!_(n)},e.set=function(n,e){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.set(n,e)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=this.name,o=n[r];return void(o&&o[0]===n?o[1]=e:Object.defineProperty(n,r,{value:[n,e],writable:!0}))}catch(n){}this._cleanupClosedWindows();var i=this.keys,a=this.values,u=I(i,n);-1===u?(i.push(n),a.push(e)):a[u]=e},e.get=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{if(e.has(n))return e.get(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var t=n[this.name];return t&&t[0]===n?t[1]:void 0}catch(n){}this._cleanupClosedWindows();var r=I(this.keys,n);if(-1!==r)return this.values[r]},e.delete=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{e.delete(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var t=n[this.name];t&&t[0]===n&&(t[0]=t[1]=void 0)}catch(n){}this._cleanupClosedWindows();var r=this.keys,o=I(r,n);-1!==o&&(r.splice(o,1),this.values.splice(o,1))},e.has=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{if(e.has(n))return!0}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var t=n[this.name];return!(!t||t[0]!==n)}catch(n){}return this._cleanupClosedWindows(),-1!==I(this.keys,n)},e.getOrSet=function(n,e){if(this.has(n))return this.get(n);var t=e();return this.set(n,t),t},n}();function D(n){return n.name||n.__name__||n.displayName||"anonymous"}function N(n,e){try{delete n.name,n.name=e}catch(n){}return n.__name__=n.displayName=e,n}function M(){var n="0123456789abcdef";return"uid_"+"xxxxxxxxxx".replace(/./g,(function(){return n.charAt(Math.floor(Math.random()*n.length))}))+"_"+function(n){if("function"==typeof btoa)return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(n,e){return String.fromCharCode(parseInt(e,16))}))).replace(/[=]/g,"");if("undefined"!=typeof Buffer)return Buffer.from(n,"utf8").toString("base64").replace(/[=]/g,"");throw new Error("Can not find window.btoa or Buffer")}((new Date).toISOString().slice(11,19).replace("T",".")).replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function R(n){try{return JSON.stringify([].slice.call(n),(function(n,e){return"function"==typeof e?"memoize["+function(n){if(z=z||new C,null==n||"object"!=typeof n&&"function"!=typeof n)throw new Error("Invalid object");var e=z.get(n);return e||(e=typeof n+":"+M(),z.set(n,e)),e}(e)+"]":e}))}catch(n){throw new Error("Arguments not serializable -- can not be used to memoize")}}function T(){return{}}var L=0,q=0;function F(n,e){void 0===e&&(e={});var t,r,o=e.thisNamespace,i=void 0!==o&&o,a=e.time,u=L;L+=1;var c=function(){for(var e=arguments.length,o=new Array(e),c=0;c<e;c++)o[c]=arguments[c];var s;u<q&&(t=null,r=null,u=L,L+=1),s=i?(r=r||new C).getOrSet(this,T):t=t||{};var f=R(o),d=s[f];if(d&&a&&Date.now()-d.time<a&&(delete s[f],d=null),d)return d.value;var l=Date.now(),h=n.apply(this,arguments);return s[f]={time:l,value:h},h};return c.reset=function(){t=null,r=null},N(c,(e.name||D(n))+"::memoized")}function B(n){var e={};function t(){for(var t=arguments,r=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var u=R(i);return e.hasOwnProperty(u)||(e[u]=A.try((function(){return n.apply(r,t)})).finally((function(){delete e[u]}))),e[u]}return t.reset=function(){e={}},N(t,D(n)+"::promiseMemoized")}function J(){}function H(n,e){if(void 0===e&&(e=1),e>=3)return"stringifyError stack overflow";try{if(!n)return"<unknown error: "+{}.toString.call(n)+">";if("string"==typeof n)return n;if(n instanceof Error){var t=n&&n.stack,r=n&&n.message;if(t&&r)return-1!==t.indexOf(r)?t:r+"\n"+t;if(t)return t;if(r)return r}return n&&n.toString&&"function"==typeof n.toString?n.toString():{}.toString.call(n)}catch(n){return"Error while stringifying error: "+H(n,e+1)}}function U(n){return"string"==typeof n?n:n&&n.toString&&"function"==typeof n.toString?n.toString():{}.toString.call(n)}function K(n){return"[object RegExp]"==={}.toString.call(n)}function Y(n,e,t){if(n.hasOwnProperty(e))return n[e];var r=t();return n[e]=r,r}function Z(){var n=document.body;if(!n)throw new Error("Body element not found");return n}function $(){return Boolean(document.body)&&"complete"===document.readyState}function G(){return Boolean(document.body)&&"interactive"===document.readyState}F.clear=function(){q=L},F((function(n){if(Object.values)return Object.values(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(n[t]);return e})),Error,F((function(){return new A((function(n){if($()||G())return n();var e=setInterval((function(){if($()||G())return clearInterval(e),n()}),10)}))}));var Q="undefined"!=typeof document?document.currentScript:null,V=F((function(){if(Q)return Q;if(Q=function(){try{var n=function(){try{throw new Error("_")}catch(n){return n.stack||""}}(),e=/.*at [^(]*\((.*):(.+):(.+)\)$/gi.exec(n),t=e&&e[1];if(!t)return;for(var r=0,o=[].slice.call(document.getElementsByTagName("script")).reverse();r<o.length;r++){var i=o[r];if(i.src&&i.src===t)return i}}catch(n){}}())return Q;throw new Error("Can not determine current script")})),X=M();function nn(n){void 0===n&&(n=window);var e="__post_robot_10_0_44__";return n!==window?n[e]:n[e]=n[e]||{}}F((function(){var n;try{n=V()}catch(n){return X}var e=n.getAttribute("data-uid");if(e&&"string"==typeof e)return e;if((e=n.getAttribute("data-uid-auto"))&&"string"==typeof e)return e;if(n.src){var t=function(n){for(var e="",t=0;t<n.length;t++){var r=n[t].charCodeAt(0)*t;n[t+1]&&(r+=n[t+1].charCodeAt(0)*(t-1)),e+=String.fromCharCode(97+Math.abs(r)%26)}return e}(JSON.stringify({src:n.src,dataset:n.dataset}));e="uid_"+t.slice(t.length-30)}else e=M();return n.setAttribute("data-uid-auto",e),e}));var en=function(){return{}};function tn(n,e){return void 0===n&&(n="store"),void 0===e&&(e=en),Y(nn(),n,(function(){var n=e();return{has:function(e){return n.hasOwnProperty(e)},get:function(e,t){return n.hasOwnProperty(e)?n[e]:t},set:function(e,t){return n[e]=t,t},del:function(e){delete n[e]},getOrSet:function(e,t){return Y(n,e,t)},reset:function(){n=e()},keys:function(){return Object.keys(n)}}}))}var rn,on=function(){};function an(){var n=nn();return n.WINDOW_WILDCARD=n.WINDOW_WILDCARD||new on,n.WINDOW_WILDCARD}function un(n,e){return void 0===n&&(n="store"),void 0===e&&(e=en),tn("windowStore").getOrSet(n,(function(){var t=new C,r=function(n){return t.getOrSet(n,e)};return{has:function(e){return r(e).hasOwnProperty(n)},get:function(e,t){var o=r(e);return o.hasOwnProperty(n)?o[n]:t},set:function(e,t){return r(e)[n]=t,t},del:function(e){delete r(e)[n]},getOrSet:function(e,t){return Y(r(e),n,t)}}}))}function cn(){return tn("instance").getOrSet("instanceID",M)}function sn(n,e){var t=e.domain,r=un("helloPromises"),o=r.get(n);o&&o.resolve({domain:t});var i=A.resolve({domain:t});return r.set(n,i),i}function fn(n,e){return(0,e.send)(n,"postrobot_hello",{instanceID:cn()},{domain:"*",timeout:-1}).then((function(e){var t=e.origin,r=e.data.instanceID;return sn(n,{domain:t}),{win:n,domain:t,instanceID:r}}))}function dn(n,e){var t=e.send;return un("windowInstanceIDPromises").getOrSet(n,(function(){return fn(n,{send:t}).then((function(n){return n.instanceID}))}))}function ln(n){un("knownWindows").set(n,!0)}function hn(n){return"object"==typeof n&&null!==n&&"string"==typeof n.__type__}function wn(n){return void 0===n?"undefined":null===n?"null":Array.isArray(n)?"array":"function"==typeof n?"function":"object"==typeof n?n instanceof Error?"error":"function"==typeof n.then?"promise":"[object RegExp]"==={}.toString.call(n)?"regex":"[object Date]"==={}.toString.call(n)?"date":"object":"string"==typeof n?"string":"number"==typeof n?"number":"boolean"==typeof n?"boolean":void 0}function pn(n,e){return{__type__:n,__val__:e}}var mn,vn=((rn={}).function=function(){},rn.error=function(n){return pn("error",{message:n.message,stack:n.stack,code:n.code,data:n.data})},rn.promise=function(){},rn.regex=function(n){return pn("regex",n.source)},rn.date=function(n){return pn("date",n.toJSON())},rn.array=function(n){return n},rn.object=function(n){return n},rn.string=function(n){return n},rn.number=function(n){return n},rn.boolean=function(n){return n},rn.null=function(n){return n},rn),yn={},gn=((mn={}).function=function(){throw new Error("Function serialization is not implemented; nothing to deserialize")},mn.error=function(n){var e=n.stack,t=n.code,r=n.data,o=new Error(n.message);return o.code=t,r&&(o.data=r),o.stack=e+"\n\n"+o.stack,o},mn.promise=function(){throw new Error("Promise serialization is not implemented; nothing to deserialize")},mn.regex=function(n){return new RegExp(n)},mn.date=function(n){return new Date(n)},mn.array=function(n){return n},mn.object=function(n){return n},mn.string=function(n){return n},mn.number=function(n){return n},mn.boolean=function(n){return n},mn.null=function(n){return n},mn),_n={};function bn(){for(var n=tn("idToProxyWindow"),e=0,t=n.keys();e<t.length;e++){var r=t[e];n.get(r).shouldClean()&&n.del(r)}}function Wn(n,e){var t=e.send,r=e.id,o=void 0===r?M():r,i=n.then((function(n){if(d(n))return l(n).name})),a=n.then((function(n){if(v(n))throw new Error("Window is closed, can not determine type");return u(n)?"popup":"iframe"}));i.catch(J),a.catch(J);var c=function(){return n.then((function(n){if(!v(n))return d(n)?l(n).name:i}))};return{id:o,getType:function(){return a},getInstanceID:B((function(){return n.then((function(n){return dn(n,{send:t})}))})),close:function(){return n.then(b)},getName:c,focus:function(){return n.then((function(n){n.focus()}))},isClosed:function(){return n.then((function(n){return v(n)}))},setLocation:function(e,t){return void 0===t&&(t={}),n.then((function(n){var r=window.location.protocol+"//"+window.location.host,o=t.method,i=void 0===o?"get":o,a=t.body;if(0===e.indexOf("/"))e=""+r+e;else if(!e.match(/^https?:\/\//)&&0!==e.indexOf(r))throw new Error("Expected url to be http or https url, or absolute path, got "+JSON.stringify(e));if("post"===i)return c().then((function(n){if(!n)throw new Error("Can not post to window without target name");!function(n){var e=n.url,t=n.target,r=n.body,o=n.method,i=void 0===o?"post":o,a=document.createElement("form");if(a.setAttribute("target",t),a.setAttribute("method",i),a.setAttribute("action",e),a.style.display="none",r)for(var u=0,c=Object.keys(r);u<c.length;u++){var s,f=c[u],d=document.createElement("input");d.setAttribute("name",f),d.setAttribute("value",null==(s=r[f])?void 0:s.toString()),a.appendChild(d)}Z().appendChild(a),a.submit(),Z().removeChild(a)}({url:e,target:n,method:i,body:a})}));if("get"!==i)throw new Error("Unsupported method: "+i);if(d(n))try{if(n.location&&"function"==typeof n.location.replace)return void n.location.replace(e)}catch(n){}n.location=e}))},setName:function(e){return n.then((function(n){var t=d(n),r=function(n){if(d(n))return l(n).frameElement;for(var e=0,t=document.querySelectorAll("iframe");e<t.length;e++){var r=t[e];if(r&&r.contentWindow&&r.contentWindow===n)return r}}(n);if(!t)throw new Error("Can not set name for cross-domain window: "+e);l(n).name=e,r&&r.setAttribute("name",e),i=A.resolve(e)}))}}}new A((function(n){if(window.document&&window.document.body)return n(window.document.body);var e=setInterval((function(){if(window.document&&window.document.body)return clearInterval(e),n(window.document.body)}),10)}));var En=function(){function n(n){var e=n.send,t=n.win,r=n.serializedWindow;this.id=void 0,this.isProxyWindow=!0,this.serializedWindow=void 0,this.actualWindow=void 0,this.actualWindowPromise=void 0,this.send=void 0,this.name=void 0,this.actualWindowPromise=new A,this.serializedWindow=r||Wn(this.actualWindowPromise,{send:e}),tn("idToProxyWindow").set(this.getID(),this),t&&this.setWindow(t,{send:e})}var e=n.prototype;return e.getID=function(){return this.serializedWindow.id},e.getType=function(){return this.serializedWindow.getType()},e.isPopup=function(){return this.getType().then((function(n){return"popup"===n}))},e.setLocation=function(n,e){var t=this;return this.serializedWindow.setLocation(n,e).then((function(){return t}))},e.getName=function(){return this.serializedWindow.getName()},e.setName=function(n){var e=this;return this.serializedWindow.setName(n).then((function(){return e}))},e.close=function(){var n=this;return this.serializedWindow.close().then((function(){return n}))},e.focus=function(){var n=this,e=this.isPopup(),t=this.getName(),r=A.hash({isPopup:e,name:t}).then((function(n){var e=n.name;n.isPopup&&e&&window.open("",e)})),o=this.serializedWindow.focus();return A.all([r,o]).then((function(){return n}))},e.isClosed=function(){return this.serializedWindow.isClosed()},e.getWindow=function(){return this.actualWindow},e.setWindow=function(n,e){var t=e.send;this.actualWindow=n,this.actualWindowPromise.resolve(this.actualWindow),this.serializedWindow=Wn(this.actualWindowPromise,{send:t,id:this.getID()}),un("winToProxyWindow").set(n,this)},e.awaitWindow=function(){return this.actualWindowPromise},e.matchWindow=function(n,e){var t=this,r=e.send;return A.try((function(){return t.actualWindow?n===t.actualWindow:A.hash({proxyInstanceID:t.getInstanceID(),knownWindowInstanceID:dn(n,{send:r})}).then((function(e){var o=e.proxyInstanceID===e.knownWindowInstanceID;return o&&t.setWindow(n,{send:r}),o}))}))},e.unwrap=function(){return this.actualWindow||this},e.getInstanceID=function(){return this.serializedWindow.getInstanceID()},e.shouldClean=function(){return Boolean(this.actualWindow&&v(this.actualWindow))},e.serialize=function(){return this.serializedWindow},n.unwrap=function(e){return n.isProxyWindow(e)?e.unwrap():e},n.serialize=function(e,t){var r=t.send;return bn(),n.toProxyWindow(e,{send:r}).serialize()},n.deserialize=function(e,t){var r=t.send;return bn(),tn("idToProxyWindow").get(e.id)||new n({serializedWindow:e,send:r})},n.isProxyWindow=function(n){return Boolean(n&&!_(n)&&n.isProxyWindow)},n.toProxyWindow=function(e,t){var r=t.send;if(bn(),n.isProxyWindow(e))return e;var o=e;return un("winToProxyWindow").get(o)||new n({win:o,send:r})},n}();function xn(n,e,t,r,o){var i=un("methodStore"),a=tn("proxyWindowMethods");En.isProxyWindow(r)?a.set(n,{val:e,name:t,domain:o,source:r}):(a.del(n),i.getOrSet(r,(function(){return{}}))[n]={domain:o,name:t,val:e,source:r})}function Sn(n,e){var t=un("methodStore"),r=tn("proxyWindowMethods");return t.getOrSet(n,(function(){return{}}))[e]||r.get(e)}function jn(n,e,t,r,o){var i,a,u;a=(i={on:o.on,send:o.send}).on,u=i.send,tn("builtinListeners").getOrSet("functionCalls",(function(){return a("postrobot_method",{domain:"*"},(function(n){var e=n.source,t=n.origin,r=n.data,o=r.id,i=r.name,a=Sn(e,o);if(!a)throw new Error("Could not find method '"+i+"' with id: "+r.id+" in "+f(window));var c=a.source,s=a.domain,d=a.val;return A.try((function(){if(!g(s,t))throw new Error("Method '"+r.name+"' domain "+JSON.stringify(K(a.domain)?a.domain.source:a.domain)+" does not match origin "+t+" in "+f(window));if(En.isProxyWindow(c))return c.matchWindow(e,{send:u}).then((function(n){if(!n)throw new Error("Method call '"+r.name+"' failed - proxy window does not match source in "+f(window))}))})).then((function(){return d.apply({source:e,origin:t},r.args)}),(function(n){return A.try((function(){if(d.onError)return d.onError(n)})).then((function(){var e,t;throw n.stack&&(n.stack="Remote call to "+i+"("+(void 0===(e=r.args)&&(e=[]),(t=e,[].slice.call(t)).map((function(n){return"string"==typeof n?"'"+n+"'":void 0===n?"undefined":null===n?"null":"boolean"==typeof n?n.toString():Array.isArray(n)?"[ ... ]":"object"==typeof n?"{ ... }":"function"==typeof n?"() => { ... }":"<"+typeof n+">"})).join(", ")+") failed\n\n")+n.stack),n}))})).then((function(n){return{result:n,id:o,name:i}}))}))}));var c=t.__id__||M();n=En.unwrap(n);var s=t.__name__||t.name||r;return"string"==typeof s&&"function"==typeof s.indexOf&&0===s.indexOf("anonymous::")&&(s=s.replace("anonymous::",r+"::")),En.isProxyWindow(n)?(xn(c,t,s,n,e),n.awaitWindow().then((function(n){xn(c,t,s,n,e)}))):xn(c,t,s,n,e),pn("cross_domain_function",{id:c,name:s})}function kn(n,e,t,r){var o,i=r.on,a=r.send;return function(n,e){void 0===e&&(e=yn);var t=JSON.stringify(n,(function(n){var t=this[n];if(hn(this))return t;var r=wn(t);if(!r)return t;var o=e[r]||vn[r];return o?o(t,n):t}));return void 0===t?"undefined":t}(t,((o={}).promise=function(t,r){return function(n,e,t,r,o){return pn("cross_domain_zalgo_promise",{then:jn(n,e,(function(n,e){return t.then(n,e)}),r,{on:o.on,send:o.send})})}(n,e,t,r,{on:i,send:a})},o.function=function(t,r){return jn(n,e,t,r,{on:i,send:a})},o.object=function(n){return _(n)||En.isProxyWindow(n)?pn("cross_domain_window",En.serialize(n,{send:a})):n},o))}function On(n,e,t,r){var o,i=r.send;return function(n,e){if(void 0===e&&(e=_n),"undefined"!==n)return JSON.parse(n,(function(n,t){if(hn(this))return t;var r,o;if(hn(t)?(r=t.__type__,o=t.__val__):(r=wn(t),o=t),!r)return o;var i=e[r]||gn[r];return i?i(o,n):o}))}(t,((o={}).cross_domain_zalgo_promise=function(n){return function(n,e,t){return new A(t.then)}(0,0,n)},o.cross_domain_function=function(t){return function(n,e,t,r){var o=t.id,i=t.name,a=r.send,u=function(t){function r(){var u=arguments;return En.toProxyWindow(n,{send:a}).awaitWindow().then((function(n){var c=Sn(n,o);if(c&&c.val!==r)return c.val.apply({source:window,origin:f()},u);var s=[].slice.call(u);return t.fireAndForget?a(n,"postrobot_method",{id:o,name:i,args:s},{domain:e,fireAndForget:!0}):a(n,"postrobot_method",{id:o,name:i,args:s},{domain:e,fireAndForget:!1}).then((function(n){return n.data.result}))})).catch((function(n){throw n}))}return void 0===t&&(t={}),r.__name__=i,r.__origin__=e,r.__source__=n,r.__id__=o,r.origin=e,r},c=u();return c.fireAndForget=u({fireAndForget:!0}),c}(n,e,t,{send:i})},o.cross_domain_window=function(n){return En.deserialize(n,{send:i})},o))}var Pn={};function An(n,e,t,r){var o=r.on,i=r.send;return A.try((function(){var r=un().getOrSet(n,(function(){return{}}));return r.buffer=r.buffer||[],r.buffer.push(t),r.flush=r.flush||A.flush().then((function(){if(v(n))throw new Error("Window is closed");var t,a=kn(n,e,((t={}).__post_robot_10_0_44__=r.buffer||[],t),{on:o,send:i});delete r.buffer;for(var u=Object.keys(Pn),c=[],s=0;s<u.length;s++){var f=u[s];try{Pn[f](n,a,e)}catch(n){c.push(n)}}if(c.length===u.length)throw new Error("All post-robot messaging strategies failed:\n\n"+c.map((function(n,e){return e+". "+H(n)})).join("\n\n"))})),r.flush.then((function(){delete r.flush}))})).then(J)}function In(n){return tn("responseListeners").get(n)}function zn(n){tn("responseListeners").del(n)}function Cn(n){return tn("erroredResponseListeners").has(n)}function Dn(n){var e=n.name,t=n.win,r=n.domain,o=un("requestListeners");if("*"===t&&(t=null),"*"===r&&(r=null),!e)throw new Error("Name required to get request listener");for(var i=0,a=[t,an()];i<a.length;i++){var u=a[i];if(u){var c=o.get(u);if(c){var s=c[e];if(s){if(r&&"string"==typeof r){if(s[r])return s[r];if(s.__domain_regex__)for(var f=0,d=s.__domain_regex__;f<d.length;f++){var l=d[f],h=l.listener;if(g(l.regex,r))return h}}if(s["*"])return s["*"]}}}}}function Nn(n,e,t,r){var o=r.on,i=r.send,a=Dn({name:t.name,win:n,domain:e}),u="postrobot_method"===t.name&&t.data&&"string"==typeof t.data.name?t.data.name+"()":t.name;function c(r,a,c){return A.flush().then((function(){if(!t.fireAndForget&&!v(n))try{return An(n,e,{id:M(),origin:f(window),type:"postrobot_message_response",hash:t.hash,name:t.name,ack:r,data:a,error:c},{on:o,send:i})}catch(n){throw new Error("Send response message failed for "+u+" in "+f()+"\n\n"+H(n))}}))}return A.all([A.flush().then((function(){if(!t.fireAndForget&&!v(n))try{return An(n,e,{id:M(),origin:f(window),type:"postrobot_message_ack",hash:t.hash,name:t.name},{on:o,send:i})}catch(n){throw new Error("Send ack message failed for "+u+" in "+f()+"\n\n"+H(n))}})),A.try((function(){if(!a)throw new Error("No handler found for post message: "+t.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!g(a.domain,e))throw new Error("Request origin "+e+" does not match domain "+a.domain.toString());return a.handler({source:n,origin:e,data:t.data})})).then((function(n){return c("success",n)}),(function(n){return c("error",null,n)}))]).then(J).catch((function(n){if(a&&a.handleError)return a.handleError(n);throw n}))}function Mn(n,e,t){if(!Cn(t.hash)){var r=In(t.hash);if(!r)throw new Error("No handler found for post message ack for message: "+t.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);try{if(!g(r.domain,e))throw new Error("Ack origin "+e+" does not match domain "+r.domain.toString());if(n!==r.win)throw new Error("Ack source does not match registered window")}catch(n){r.promise.reject(n)}r.ack=!0}}function Rn(n,e,t){if(!Cn(t.hash)){var o,i=In(t.hash);if(!i)throw new Error("No handler found for post message response for message: "+t.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!g(i.domain,e))throw new Error("Response origin "+e+" does not match domain "+(o=i.domain,Array.isArray(o)?"("+o.join(" | ")+")":r(o)?"RegExp("+o.toString()+")":o.toString()));if(n!==i.win)throw new Error("Response source does not match registered window");zn(t.hash),"error"===t.ack?i.promise.reject(t.error):"success"===t.ack&&i.promise.resolve({source:n,origin:e,data:t.data})}}function Tn(n,e){var t=e.on,r=e.send,o=tn("receivedMessages");try{if(!window||window.closed||!n.source)return}catch(n){return}var i=n.source,a=n.origin,u=function(n,e,t,r){var o,i=r.on,a=r.send;try{o=On(e,t,n,{on:i,send:a})}catch(n){return}if(o&&"object"==typeof o&&null!==o){var u=o.__post_robot_10_0_44__;if(Array.isArray(u))return u}}(n.data,i,a,{on:t,send:r});if(u){ln(i);for(var c=0;c<u.length;c++){var s=u[c];if(o.has(s.id))return;if(o.set(s.id,!0),v(i)&&!s.fireAndForget)return;0===s.origin.indexOf("file:")&&(a="file://");try{"postrobot_message_request"===s.type?Nn(i,a,s,{on:t,send:r}):"postrobot_message_response"===s.type?Rn(i,a,s):"postrobot_message_ack"===s.type&&Mn(i,a,s)}catch(n){setTimeout((function(){throw n}),0)}}}}function Ln(n,e,t){if(!n)throw new Error("Expected name");if("function"==typeof(e=e||{})&&(t=e,e={}),!t)throw new Error("Expected handler");(e=e||{}).name=n,e.handler=t||e.handler;var r=e.window,o=e.domain,i=function n(e,t){var r=e.name,o=e.win,i=e.domain,a=un("requestListeners");if(!r||"string"!=typeof r)throw new Error("Name required to add request listener");if(Array.isArray(o)){for(var u=[],c=0,s=o;c<s.length;c++)u.push(n({name:r,domain:i,win:s[c]},t));return{cancel:function(){for(var n=0;n<u.length;n++)u[n].cancel()}}}if(Array.isArray(i)){for(var f=[],d=0,l=i;d<l.length;d++)f.push(n({name:r,win:o,domain:l[d]},t));return{cancel:function(){for(var n=0;n<f.length;n++)f[n].cancel()}}}var h=Dn({name:r,win:o,domain:i});if(o&&"*"!==o||(o=an()),i=i||"*",h)throw o&&i?new Error("Request listener already exists for "+r+" on domain "+i.toString()+" for "+(o===an()?"wildcard":"specified")+" window"):o?new Error("Request listener already exists for "+r+" for "+(o===an()?"wildcard":"specified")+" window"):i?new Error("Request listener already exists for "+r+" on domain "+i.toString()):new Error("Request listener already exists for "+r);var w,p,m=a.getOrSet(o,(function(){return{}})),v=Y(m,r,(function(){return{}})),y=i.toString();return K(i)?(w=Y(v,"__domain_regex__",(function(){return[]}))).push(p={regex:i,listener:t}):v[y]=t,{cancel:function(){delete v[y],p&&(w.splice(w.indexOf(p,1)),w.length||delete v.__domain_regex__),Object.keys(v).length||delete m[r],o&&!Object.keys(m).length&&a.del(o)}}}({name:n,win:r,domain:o},{handler:e.handler,handleError:e.errorHandler||function(n){throw n},window:r,domain:o||"*",name:n});return{cancel:function(){i.cancel()}}}function qn(n,e,t){"function"==typeof(e=e||{})&&(t=e,e={});var r,o=new A;return e.errorHandler=function(n){r.cancel(),o.reject(n)},r=Ln(n,e,(function(n){if(r.cancel(),o.resolve(n),t)return t(n)})),o.cancel=r.cancel,o}Pn.postrobot_post_message=function(n,e,t){0===t.indexOf("file:")&&(t="*"),n.postMessage(e,t)};var Fn=function n(e,t,r,o){var i=(o=o||{}).domain||"*",u=o.timeout||-1,c=o.timeout||5e3,s=o.fireAndForget||!1;return A.try((function(){if(function(n,e,t){if(!n)throw new Error("Expected name");if(t&&"string"!=typeof t&&!Array.isArray(t)&&!K(t))throw new TypeError("Can not send "+n+". Expected domain "+JSON.stringify(t)+" to be a string, array, or regex");if(v(e))throw new Error("Can not send "+n+". Target window is closed")}(t,e,i),function(n,e){var t=y(e);if(t)return t===n;if(e===n)return!1;if(function(n){void 0===n&&(n=window);try{if(n.top)return n.top}catch(n){}if(a(n)===n)return n;try{if(h(window,n)&&window.top)return window.top}catch(n){}try{if(h(n,window)&&window.top)return window.top}catch(n){}for(var e=0,t=function n(e){for(var t=[],r=0,o=w(e);r<o.length;r++){var i=o[r];t.push(i);for(var a=0,u=n(i);a<u.length;a++)t.push(u[a])}return t}(n);e<t.length;e++){var r=t[e];try{if(r.top)return r.top}catch(n){}if(a(r)===r)return r}}(e)===e)return!1;for(var r=0,o=w(n);r<o.length;r++)if(o[r]===e)return!0;return!1}(window,e))return function(n,e,t){void 0===e&&(e=5e3),void 0===t&&(t="Window");var r=function(n){return un("helloPromises").getOrSet(n,(function(){return new A}))}(n);return-1!==e&&(r=r.timeout(e,new Error(t+" did not load after "+e+"ms"))),r}(e,c)})).then((function(t){return function(n,e,t,r){var o=r.send;return A.try((function(){return"string"==typeof e?e:A.try((function(){return t||fn(n,{send:o}).then((function(n){return n.domain}))})).then((function(n){if(!g(e,e))throw new Error("Domain "+U(e)+" does not match "+U(e));return n}))}))}(e,i,(void 0===t?{}:t).domain,{send:n})})).then((function(o){var i,a,c=o,d="postrobot_method"===t&&r&&"string"==typeof r.name?r.name+"()":t,l=new A,h=t+"_"+M();if(!s){var w={name:t,win:e,domain:c,promise:l};!function(n,e){tn("responseListeners").set(n,e)}(h,w);var p=un("requestPromises").getOrSet(e,(function(){return[]}));p.push(l),l.catch((function(){!function(n){tn("erroredResponseListeners").set(n,!0)}(h),zn(h)}));var m=function(n){return un("knownWindows").get(n,!1)}(e)?1e4:2e3,y=u,g=m,_=y,b=(i=function(){return v(e)?l.reject(new Error("Window closed for "+t+" before "+(w.ack?"response":"ack"))):w.cancelled?l.reject(new Error("Response listener was cancelled for "+t)):(g=Math.max(g-500,0),-1!==_&&(_=Math.max(_-500,0)),w.ack||0!==g?0===_?l.reject(new Error("No response for postMessage "+d+" in "+f()+" in "+y+"ms")):void 0:l.reject(new Error("No ack for postMessage "+d+" in "+f()+" in "+m+"ms")))},500,function n(){a=setTimeout((function(){i(),n()}),500)}(),{cancel:function(){clearTimeout(a)}});l.finally((function(){b.cancel(),p.splice(p.indexOf(l,1))})).catch(J)}return An(e,c,{id:M(),origin:f(window),type:"postrobot_message_request",hash:h,name:t,data:r,fireAndForget:s},{on:Ln,send:n}).then((function(){return s?l.resolve():l}),(function(n){throw new Error("Send request message failed for "+d+" in "+f()+"\n\n"+H(n))}))}))};function Bn(n,e,t){return kn(n,e,t,{on:Ln,send:Fn})}function Jn(n,e,t){return On(n,e,t,{on:Ln,send:Fn})}function Hn(n){return new En({send:Fn,win:n})}function Un(n){return En.toProxyWindow(n,{send:Fn})}function Kn(){var n,e,t,r;nn().initialized||(nn().initialized=!0,e=(n={on:Ln,send:Fn}).on,t=n.send,(r=nn()).receiveMessage=r.receiveMessage||function(n){return Tn(n,{on:e,send:t})},function(n){var e=n.on,t=n.send;tn().getOrSet("postMessageListener",(function(){return(n=window).addEventListener("message",r=function(n){!function(n,e){var t=e.on,r=e.send;A.try((function(){var e=n.source||n.sourceElement,o=n.origin||n.originalEvent&&n.originalEvent.origin,i=n.data;if("null"===o&&(o="file://"),e){if(!o)throw new Error("Post message did not have origin domain");Tn({source:e,origin:o,data:i},{on:t,send:r})}}))}(n,{on:e,send:t})}),{cancel:function(){n.removeEventListener("message",r)}};var n,r}))}({on:Ln,send:Fn}),function(n){var e=n.on,t=n.send;tn("builtinListeners").getOrSet("helloListener",(function(){var n=e("postrobot_hello",{domain:"*"},(function(n){return sn(n.source,{domain:n.origin}),{instanceID:cn()}})),r=y();return r&&fn(r,{send:t}).catch((function(n){})),n}))}({on:Ln,send:Fn}))}function Yn(){var n;!function(){for(var n=tn("responseListeners"),e=0,t=n.keys();e<t.length;e++){var r=t[e],o=n.get(r);o&&(o.cancelled=!0),n.del(r)}}(),(n=tn().get("postMessageListener"))&&n.cancel(),delete window.__post_robot_10_0_44__}var Zn=!0;function $n(n){for(var e=0,t=un("requestPromises").get(n,[]);e<t.length;e++)t[e].reject(new Error("Window "+(v(n)?"closed":"cleaned up")+" before response")).catch(J)}Kn()}])}));

window.gisProfilingStartTime=performance.now();var GISAPP={},gisCallbacks={};GISAPP.Sym_Sys=function(logService,serverInjectionService,clientStorageService,systemInfoService,gaService,gisService,otService,utilitiesService,uiUtilitiesService,stateService,eventLoggerService,directCallCtrl,broadcastCtrl,replayCtrl,callCtrl,availabilityCtrl,broadcastDOMProc,GIS_CONSTANTS,embedCtrl){'use strict';var r,n,o,c="Sym_Sys";function e(e){try{if(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_RECEIVED,{isClerkAvailable:!0}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_RECEIVED,{isClerkAvailable:!0}),!utilitiesService.isHttpsPageRedirected()){if(stateService.setOneToOneChecked(),"function"==typeof r&&r(),serverInjectionService.getApiEnabled()&&!stateService.getAPIStandardJourney())return;stateService.getClerkAvailability()||(stateService.setClerkAvailability(!0),l())}}catch(e){logService.error(c,"Exception on server callback, clerkIsAvailable.",e)}}function t(e){try{if(e&&"BLOCKED_CALL_USER"===e.message&&eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_USER_BLOCKED,{referrer:document.referrer||""}),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_RECEIVED,{isClerkAvailable:!1}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_RECEIVED,{isClerkAvailable:!1}),stateService.setOneToOneChecked(),"function"==typeof n&&n(),serverInjectionService.getApiEnabled()&&!stateService.getAPIStandardJourney())return;stateService.setClerkAvailability(!1),l()}catch(e){logService.error(c,"Exception on server callback, clerkIsNotAvailable.",e)}}function a(e){var a=[],t={},s=[],i={};try{e.broadcasts.forEach(function(e){var t={id:e.id,name:e.name,description:e.desc,channelId:e.channelId,isDefaultChannel:e.isDefaultChannel};e.isLive||0===e.status||Array.isArray(e.urls)&&'string'==typeof e.urls[0]&&e.urls[0].includes(".m3u8")?(t.type="broadcast",t.autoPlayType="broadcast",t.status=e.status):(t.type="replay",t.autoPlayType="replay"),a.push(t),t.callUUID=e.callUUID,t.sessionId=e.sessionId,t.urls=e.urls,t.ctaMessage=e.ctaMessage,t.ctaImage=e.ctaImage,t.config=e.config,t.secondsSinceStarted=e.secondsSinceStarted,t.isAutoPlayable=e.isAutoPlayable,t.broadcastEventHoldTimeStamp=e.broadcastEventHoldTimestamp,t.isChatProcessed=e.isChatProcessed,s.push(t)}),i.gisBroadcasts=s,i.status=e.status,i.requestType=e.requestType,i.message=e.message}catch(e){return void logService.error(c,"The server did not provide the expected response to broadcastAvailabilityCallback",e)}t.broadcasts=a,stateService.setBroadcastResponse(i),stateService.setBroadcastChecked();try{if("alias"===i.requestType){var l=i.gisBroadcasts[0];return void(l&&'replay'===l.type?replayCtrl.playReplay(l):l&&'broadcast'===l.type&&l.status===GIS_CONSTANTS.BROADCAST_STATUS.BROADCAST_LIVE?broadcastCtrl.playBroadcast(l):broadcastCtrl.showNoBroadcastView(l))}if("function"==typeof o&&o(t),serverInjectionService.getApiEnabled()&&!stateService.getAPIStandardJourney())return;embedCtrl.isEmbed()?embedCtrl.startBroadcast(t):availabilityCtrl.updateCTA()}catch(e){logService.error(c,"Exception on server callback, broadcastCallback",e)}}function s(){return otService.getOT()&&systemInfoService.checkSystemSupported()}function i(){this.name="_pluginError",this.message="Plugin Installation Required."}function l(){utilitiesService.isAutoStartConnectScreen()?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.AUTO_CALL_USER),stateService.getRoutingKey()||(stateService.setRoutingKey(""),stateService.addRoutingKey()),callCtrl.startCallJourney({routingKey:stateService.getRoutingKey(),type:GIS_CONSTANTS.CALL_TYPES.STANDARD})):serverInjectionService.getApiEnabled()&&!stateService.getAPIStandardJourney()||availabilityCtrl.updateCTA()}return i.prototype=Error.prototype,{clerkIsAvailable:window.clerkIsAvailable=e,clerkIsNotAvailable:window.clerkIsNotAvailable=t,broadcastCallback:window.broadcastCallback=a,availabilityAction:l,checkClerkAvailable:function(e,t){if('function'==typeof e&&(r=e),systemInfoService.checkSystemSupported()){t||(t=stateService.getRoutingKey()),gisService.isClerkAvailable("clerkIsAvailable","",t);var a=serverInjectionService.getSystemConfig(),s=a&&a.clerkAvailabilityReqDelay&&!isNaN(a.clerkAvailabilityReqDelay)?a.clerkAvailabilityReqDelay:0;eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_SENT,{delay:s})}},checkClerkAvailability:function(e,t,a,s){if(systemInfoService.checkGisServiceEnabled())if(!serverInjectionService.getApiEnabled()||systemInfoService.checkSystemSupported()){'function'==typeof e&&(r=e),'function'==typeof t&&(n=t),a||(a=stateService.getRoutingKey()),s?gisService.isClerkAvailable(e,t,a):gisService.isClerkAvailable("clerkIsAvailable","clerkIsNotAvailable",a);var i=serverInjectionService.getSystemConfig(),l=i&&i.clerkAvailabilityReqDelay&&!isNaN(i.clerkAvailabilityReqDelay)?i.clerkAvailabilityReqDelay:0;eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.IS_CLERK_AVAILABLE_REQUEST_SENT,{delay:l})}else console.info("GIS: System not supported")},checkBroadcastAvailability:function(e){return systemInfoService.checkGisServiceEnabled()?serverInjectionService.getSystemConfig()?serverInjectionService.getSystemConfig().broadcast.enabled?(o=e,gisService.getBroadcasts(null,"broadcastCallback"),{status:0,message:"ok"}):{status:-1,message:"Broadcast not enabled in systemConfig"}:{status:-1,message:"Missing systemConfig"}:{status:-1,message:"Service disabled"}},playBroadcast:function(e){var t;if(e)t=stateService.getBroadcastById(e);else{var a=stateService.getBroadcasts();if(!(0<a.length))return{status:-1,message:"no broadcasts available"};t=a[0]}return t?"broadcast"===t.type&&0===broadcastCtrl.playBroadcast(t)?{status:0,message:"ok"}:"replay"===t.type&&0===replayCtrl.playReplay(t)?{status:0,message:"ok"}:{status:-1,message:"internal error: couldn't play broadcast"}:{status:-1,message:"id not found: there's no broadcast matching that id"}},startCall:function(e,t){callCtrl.setCallEndedCallback(e),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.CONNECT_BUTTON+eventLoggerService.GIS_ACTIONS.CLICKED,{source:"api"}),callCtrl.startCallJourney({routingKey:t,type:GIS_CONSTANTS.CALL_TYPES.STANDARD})},submitContactDetails:function(e,t,a){gisService.submitContactDetails(e,t,a)},registerAnalyticsEventCallback:function(e){gaService.registerCustomAnalyticsReference(e)},detectDevices:function(e,t){if('function'!=typeof e)throw new TypeError("onCompleteHandler is not a function, while detecting devices");s()?otService.detectDevices(e):!1===t?e(new i,!1):otService.initializePluginInstallationProcess()},isPluginInstalled:s,installPlugin:function(){otService.initializePluginInstallationProcess()}}};GISAPP.addAPersonCtrl=function(gisService,utilitiesService,callCtrl,GIS_CONSTANTS,stateService){'use strict';return gisCallbacks.onAddAFriendCallInitiated=function(n){n.token&&stateService.setToken(n.token),n.sessionId&&stateService.setSessionId(n.sessionId),n.apiKey&&stateService.setTokBoxApiKey(n.apiKey),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isAddAPersonCall:!0,data:n})},gisCallbacks.onAddAFriendCallFailed=function(){callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isInvalidUrl:!0})},{init:function(){var n=utilitiesService.getUrlParams().giscallconnect;gisService.initiateAddAFriendCall("gisCallbacks.onAddAFriendCallInitiated","gisCallbacks.onAddAFriendCallFailed",n)}}};GISAPP.availabilityCtrl=function(serverInjectionService,stateService,gaService,utilitiesService,eventLoggerService,mediaService,deviceInfoService,clientStorageService,logService,pollingService,callCtrl,broadcastCtrl,replayCtrl,ctaTabDOMProc,ctaRoundelDOMProc,autoPlayService,GIS_CONSTANTS,bookingService,callService,gisService){'use strict';var t,l="availabilityCtrl",a=0,i=1,o=2,r=3,s=4,c=serverInjectionService.getUiConfig(),A=serverInjectionService.getSystemConfig(),e=c.ctaType||"roundel",u=!1,y=a,E=!1,d=null,C=null,f=c.ctaPosition?c.ctaPosition:"right";function n(){if(!(A&&A.noOneAvailableBlock&&A.noOneAvailableBlock.enable&&GISAPP.noClerkAvailableScreenShown)&&!stateService.isUIActive()&&stateService.isOneToOneChecked()&&stateService.isBroadcastChecked()){var e,n=function(){for(var e=stateService.getBroadcasts(),n=0;n<e.length;n++){var t=e[n],a=t.config;if(!a)return void logService.error(l,"Invalid broadcast channel (channelId: "+t.channelId+") config");if(C&&'replay'===C.type){if(C.channelId==t.channelId)return t;if('broadcast'===t.type)return t}else{if('broadcast'===t.type)return t;if(!a.announcementChannel.enabled)return t;var i=clientStorageService.getItem(clientStorageService.storageKeys.VIDEO_VIEWED);if(!i)return t;if(!v(t))return t;if(L(t))return t}}return null}();if(C=n,A.persistentCta||stateService.getClerkAvailability()||n)if(n&&'broadcast'===n.type&&n.status===GIS_CONSTANTS.BROADCAST_STATUS.BROADCAST_LIVE)e=n.callUUID,y!==o&&(y=o,p(n),E=!0,d=n.callUUID),e!==d&&(d=e,p(n));else if(stateService.getClerkAvailability()&&"clerk"===A.singleCtaDefaultService&&!(n&&n.config&&n.config.overrideOneToOne)||!n&&"replay"===A.singleCtaDefaultService||A.persistentCta&&"clerk"===A.singleCtaDefaultService){var t=stateService.getClerkAvailability()?i:s;y!==t&&(y=t,I(n),E=!0)}else n&&'replay'===n.type&&(e=n.callUUID,y!==r&&(y=r,_(n),E=!0,d=n.callUUID),e!==d&&(d=e,_(n)));else y=a;if(y===a){if(!A.persistentCta)return void T();I(n)}S()}}function S(e){if((!u||u&&E)&&(E=!1,function(){var e={timeElapsed:(performance.now()-window.gisProfilingStartTime).toFixed(3),ctaSize:deviceInfoService.isMobileDevice()?c.ctaSize:'Large'};switch(y){case r:eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.BROADCAST_REPLAY_CTA_SHOWN,e),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_CTA_SHOWN,e);break;case o:eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.BROADCAST_CTA_SHOWN,e),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_CTA_SHOWN,e);break;case i:e.cta={isAnimationEnabled:deviceInfoService.isMobileDevice()?c.cta.animation.enabled&&c.cta.animation.mobile:c.cta.animation.enabled&&c.cta.animation.desktop},eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN,e),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN,e);break;case s:e.cta={isBooking:bookingService.isEnabledForUnavailableCta()},eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN_UNAVAILABLE,e),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN_UNAVAILABLE,e);break;case a:A.persistentCta&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN,e),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN,e))}}()),!u){var n=!e||e.isNaN()?e:0;t.show(n),u=!0}}function T(){u&&(u=!1,t.hide())}function g(n){n&&'function'==typeof n&&t.setOnClickEvent(function(e){n(e),callService.isRedirectJourney()||T()})}function p(e){autoPlayService.destroyAutoPlay(),t.setMode('broadcast',e,!1,!1),t.show(),g(function(){broadcastCtrl.playBroadcast(e)})}function I(e){autoPlayService.destroyAutoPlay(),t.setMode('clerk',null,A.persistentCta,stateService.getClerkAvailability()),g(function(e){callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.STANDARD},e)});var n=clientStorageService.getItem(clientStorageService.storageKeys.ONE_TO_ONE_ENGAGEMENT);(!n||utilitiesService.dateDifferenceInDays(Date.parse(n),new Date)>=A.oneToOneEngagement.reshowDuration)&&A.oneToOneEngagement&&A.oneToOneEngagement.enabled&&function(e){if(autoPlayService.isAutoPlaySetup()||!e)return;autoPlayService.setupAutoplay(e,f,{playerInitialize:function(){t.hide()},playerClicked:function(){"replay_engagement"==e.autoPlayType?replayCtrl.playReplay(e):"call"==e.autoPlayType&&(autoPlayService.storeAutoPlayReshowTimestamp(e),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.STANDARD}))},playerDismissed:function(){window.dispatchEvent(new GisCustomEvent("gisUIClosed")),t.show()},playerPlay:function(){("call"==e.autoPlayType||"replay_engagement"==e.autoPlayType&&e.config.announcementChannel.enabled)&&autoPlayService.storeAutoPlayReshowTimestamp(e)}})}(function(e){var n=A.oneToOneEngagement,t=stateService.getOneToOneAutoPlay();{if(n.src.serviceIntro&&t&&t.config.ctaAutoPlay.enabled&&(!v(t)||L(t)))return t;if(n.src.replay&&e)return e.autoPlayType="replay_engagement",e}return null}(e))}function _(e){t.setMode('replay',e,A.persistentCta,!1),g(function(){e.config.announcementChannel.enabled&&autoPlayService.storeAutoPlayReshowTimestamp(e),replayCtrl.playReplay(e)}),e.config.ctaAutoPlay.enabled&&(autoPlayService.isAutoPlaySetup()||autoPlayService.setupAutoplay(e,f,{playerInitialize:function(){t.hide()},playerClicked:function(){replayCtrl.playReplay(e)},playerDismissed:function(){window.dispatchEvent(new GisCustomEvent("gisUIClosed")),t.show()},playerPlay:function(){e.config.announcementChannel.enabled&&autoPlayService.storeAutoPlayReshowTimestamp(e)}}))}function v(e){var n=clientStorageService.getItem(clientStorageService.storageKeys.VIDEO_VIEWED);return n&&n[e.id]}function L(e){var n=e.config,t=clientStorageService.getItem(clientStorageService.storageKeys.VIDEO_VIEWED);return t&&t[e.id]&&n.announcementChannel.reshow.enabled&&utilitiesService.dateDifferenceInDays(Date.parse(t[e.id]),new Date)>=n.announcementChannel.reshow.reshowDuration}return t="tab"===e?ctaTabDOMProc:ctaRoundelDOMProc,{init:function(){window.addEventListener("gisUIClosed",function(e){stateService.setUIActive(!1),!pollingService.isPollingTimeExpiredForEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)&&A.persistentCta&&(pollingService.subscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,GISAPP.Sym_Sys.clerkIsAvailable,GISAPP.Sym_Sys.clerkIsNotAvailable),pollingService.startPollingEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)),e.detail&&e.detail.action===GIS_CONSTANTS.ACTIONS.BROADCAST_SCREEN_CLOSED?gisService.getBroadcasts(null,"broadcastCallback"):n()}),window.addEventListener("gisUIOpen",function(e){stateService.setUIActive(!0),T(),autoPlayService.destroyAutoPlay()})},updateCTA:n,showCTA:S,hideCTA:T,setOnClick:g}};GISAPP.broadcastCtrl=function(callCtrl,serverInjectionService,activityLoggerService,gaService,browserInfoService,deviceInfoService,stateService,eventLoggerService,retailerFunctionalityCtrl,hlsCtrl,chatInputDOMProc,broadcastDOMProc,callUserService,pageUnloadService,utilitiesService,gisService,emailSubmitComponent,preCallScreen,uiUtilitiesService,modalComponent,modalContentComponent,clientStorageService,buttonComponent,contactCaptureCtrl,GIS_CONSTANTS,pollingService,gisPlayerScreen,shopStreamService,urlUtilitiesService,callService,eventService,playerUtilService){'use strict';var t,a,n,i,s,l,r,A,E,o={},S={},T={NAVIGATE:"navigate"},u=!1,c=!1,e="AVAILABLE",C="UNAVAILABLE",_="NONE",I=_,d=!1,O=!1,L=!1,N=!1;function g(t,e,n){pollingService.registerPollingEvent(pollingService.BASE_EVENTS.SCHEDULED_BROADCAST_POLLING,{poll:gisService.getBroadcastsEvent,pollArguments:[utilitiesService.utf8ToBase64(e),null,"broadcastCallback"],pollWithOnSuccessAndFailure:!1,interval:n||null}),pollingService.subscribe(pollingService.BASE_EVENTS.SCHEDULED_BROADCAST_POLLING,function(){},function(){}),pollingService.startPollingEvent(pollingService.BASE_EVENTS.SCHEDULED_BROADCAST_POLLING),d=!0}function D(){pollingService.stopPollingEvent(pollingService.BASE_EVENTS.SCHEDULED_BROADCAST_POLLING),pollingService.events.scheduledBroadcastPolling=null,d=!1}function B(){o.broadcastContactCaptureData={broadcastId:S.id,viewDuration:b()||0},gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_DURATION,{duration:b()})}function R(){serverInjectionService.getSystemConfig().oneToOneCta.broadcast&&i.config.oneToOneInBroadcast&&(I=_,pollingService.subscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,f,V),pollingService.startPollingEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING))}function f(){if(I!==e){I=e;var t=serverInjectionService.getSystemConfig();stateService.setClerkAvailability(!0),p(t.persistentCta,!0)}}function V(){if(I!==C){I=C;var t=serverInjectionService.getSystemConfig();stateService.setClerkAvailability(!1),p(t.persistentCta,!1)}}function p(t,e){broadcastDOMProc.setOneToOneCtaOnBroadcast(t,e);var n=(performance.now()-window.gisProfilingStartTime).toFixed(3);e?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN_ON_BROADCAST,{timeElapsed:n}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN_ON_BROADCAST)):!e&&t&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN_ON_BROADCAST_UNAVAILABLE,{timeElapsed:n}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN_ON_BROADCAST_UNAVAILABLE)),function(e){if(!e||'function'!=typeof e)return;broadcastDOMProc.setOnCtaClickEvent(function(t){e(t)})}(function(t){callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.STANDARD},t),e?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK_FROM_BROADCAST,{channelId:i.channelId}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK_FROM_BROADCAST)):(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE_ON_BROADCAST,{channelId:i.channelId}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE_ON_BROADCAST)),c||callService.isRedirectJourney()?stateService.setCallUUID(null):broadcastDOMProc.hide()})}function v(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_USER_DURATION,{viewDuration:b(),callUUID:m(),broadcastId:i.id,shopStreamType:"broadcast",channelId:i.channelId})}function P(){t?broadcastDOMProc.stopVideo():(hlsCtrl.destroy(),S=null)}function m(){return S&&S.callUUID?S.callUUID:""}function U(){utilitiesService.supportsHLS()&&!utilitiesService.supportsMediaSource()?(broadcastDOMProc.getVideoElement().src=S.urls[0],y()):(hlsCtrl.registerOnManifestParsed(y),hlsCtrl.registerOnErrorFunction(W),hlsCtrl.loadHls(H))}function b(){return playerUtilService.getWatchedTime()}function G(t){var e=serverInjectionService.getSystemConfig();if(stateService.setCurrentPhase(stateService.phase.BROADCAST_END),B(),pageUnloadService.unregisterFunction(G),P(),chatInputDOMProc.dispose(),stateService.setCallStartTime(0),a&&a(),stateService.setCurrentPhase(stateService.phase.READY),e&&e.captureInfo&&e.captureInfo.views&&!0===e.captureInfo.views.broadcast&&"object"==typeof t&&"click"===t.type&&1<=o.broadcastContactCaptureData.viewDuration){var n=clientStorageService.getItem(clientStorageService.storageKeys.BROADCAST_CONTACT_CAPTURE)||{};n&&!n[o.broadcastContactCaptureData.broadcastId]&&contactCaptureCtrl.init("broadcast",o.broadcastContactCaptureData)}stateService.setCallUUID(null),I=_,e.oneToOneCta.broadcast&&i.config.oneToOneInBroadcast&&pollingService.unSubscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,f,V),pollingService.startPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING),v(),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_ACTIONS.CLOSED,{url:urlUtilitiesService.getUrlWithoutParamsWithLimit(500),broadcastId:i.id,callUUID:stateService.getCallUUID()}),0,null,u=!1,deviceInfoService.isIos()&&broadcastDOMProc.clearIntervalOnVideoElement(),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.PRODUCTS_FOR_CAROUSEL_POLLING)}function y(){deviceInfoService.isMobileDevice()?broadcastDOMProc.setOnClickPlay(h):h()}function h(){stateService.setCallStartTime((new Date).getTime()),broadcastDOMProc.playVideo(),stateService.setCurrentPhase(stateService.phase.BROADCAST_PLAYING)}function w(){(new Date).getTime(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PAUSE_BUTTON_CLICKED,{callUUID:m(),shopStreamType:"broadcast",videoPauseTime:broadcastDOMProc.getVideoElement().currentTime}),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING),deviceInfoService.isIos()&&broadcastDOMProc.clearIntervalOnVideoElement(),u=!1}function W(t){t.type===Hls.ErrorTypes.NETWORK_ERROR?K():t.fatal&&pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING)}function K(){S?gisService.isBroadcastActiveByBroadcastId(S.id,"GISAPP.broadcastCtrl.broadcastHasEnded",function(){broadcastDOMProc.hide()}):broadcastDOMProc.hide()}function H(t){t&&hlsCtrl.playUrl(broadcastDOMProc.getVideoElement(),S.urls[0])}function k(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PLAY_BUTTON_CLICKED,{callUUID:m(),shopStreamType:"broadcast",videoPlayTime:broadcastDOMProc.getVideoElement().currentTime,channelId:i.channelId}),u||(u=!0,pollingService.startPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING),deviceInfoService.isIos()&&broadcastDOMProc.setIntervalOnVideoElement(K))}function M(){pollingService.registerPollingEvent(pollingService.BASE_EVENTS.PRODUCTS_FOR_CAROUSEL_POLLING,{poll:Y,pollWithOnSuccessAndFailure:!1,pollArguments:[]}),pollingService.subscribe(pollingService.BASE_EVENTS.PRODUCTS_FOR_CAROUSEL_POLLING,function(){},function(){}),pollingService.startPollingEvent(pollingService.BASE_EVENTS.PRODUCTS_FOR_CAROUSEL_POLLING)}function Y(){var t=broadcastDOMProc.getCarouselVersion();gisService.isProductCarouselVersionUpdated(i.id,"gisCallbacks.checkCarouselUpdatedCallback",t)}return shopStreamService.isShopStreamEnabled()&&(broadcastDOMProc=new gisPlayerScreen({onPlay:k,onPause:w})),broadcastDOMProc.onVideoPlay(k),broadcastDOMProc.onVideoPause(w),{playBroadcast:function(t,e){return stateService.setCurrentPhase(stateService.phase.BROADCAST_START),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING),d&&D(),O&&(O=!1),S&&P(),t?(i=S=t,e&&(a=e),stateService.setCallUUID(m()),!shopStreamService.isChatTypeQuestion(S)&&shopStreamService.isShopStreamEnabled()||callUserService.add(S.type),function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_ACTIONS.SHOWN,{url:urlUtilitiesService.getUrlWithoutParamsWithLimit(500),broadcastId:i.id,callUUID:stateService.getCallUUID()});var t=serverInjectionService.getSystemConfig().oneToOneCta.broadcast&&i.config.oneToOneInBroadcast;shopStreamService.isShopStreamEnabled()?broadcastDOMProc.show(t,i):broadcastDOMProc.show(),broadcastDOMProc.extendPlayer(playerUtilService.setup),broadcastDOMProc.setOnClickClose(G),function(){var t=serverInjectionService.getSystemConfig(),e=t.goToShopBtn;e&&e.url&&broadcastDOMProc.setOnClickShop(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_VIEWS.LINK+eventLoggerService.GIS_ACTIONS.CLICKED,{url:e.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_LINK_CLICK,{url:e.url}),window.open(e.url,e.redirect===T.NAVIGATE?'_self':'_blank')});var n=t.specificPageBtn;n&&n.url&&broadcastDOMProc.setOnClickSpecificShop(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_VIEWS.LINK2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:n.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_LINK2_CLICK,{url:n.url}),window.open(n.url,n.redirect===T.NAVIGATE?'_self':'_blank')}),broadcastDOMProc.setOnClickRetailerCustomButton(function(){activityLoggerService.logBroadcastLink2Click("RetailerCustomButton"),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_VIEWS.LINK2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:"RetailerCustomButton"}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_LINK2_CLICK,{url:"RetailerCustomButton"})});var a=S.config?S.config:null;a&&a.button1&&broadcastDOMProc.setupExtraButton(1,a.button1.label,function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_VIEWS.EXTRABTN1+eventLoggerService.GIS_ACTIONS.CLICKED,{url:a.button1.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_EXTRABTN1_CLICK,{url:a.button1.url}),window.open(a.button1.url,a.button1.redirect===T.NAVIGATE?'_self':'_blank')}),a&&a.button2&&broadcastDOMProc.setupExtraButton(2,a.button2.label,function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST+eventLoggerService.GIS_VIEWS.EXTRABTN2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:a.button2.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_EXTRABTN2_CLICK,{url:a.button2.url}),window.open(a.button2.url,a.button2.redirect===T.NAVIGATE?'_self':'_blank')})}(),R(),i&&1==i.status&&U()}(),pageUnloadService.registerFunction(G),pollingService.registerPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING,{poll:v,pollArguments:[]},!0),pollingService.subscribe(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING,function(){},function(){}),eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.CHECK_FOR_CAROUSEL_UPDATE,M),0):-1},startDirectLinkBroadcast:function(){var t=utilitiesService.getUrlParamsLowerCase()[GIS_CONSTANTS.QUERY_PARAM.GIS_CHANNEL_PARAM],e=utilitiesService.getUrlParamsLowerCase()[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM],n=t||e;if(utilitiesService.isEncodedUri(n)&&(n=decodeURIComponent(n)),null!=n||""!=n)if(t)gisService.getBroadcasts(utilitiesService.utf8ToBase64(n),"broadcastCallback");else if(e){var a=utilitiesService.getUrlParamsLowerCase().giskey;utilitiesService.isEncodedUri(a)&&(a=decodeURIComponent(a)),gisService.getBroadcastsEvent(utilitiesService.utf8ToBase64(n),a?utilitiesService.utf8ToBase64(a):null,"broadcastCallback")}},broadcastHasEnded:function(t){t||(hlsCtrl.destroy(),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING),deviceInfoService.isIos()&&broadcastDOMProc.clearIntervalOnVideoElement(),broadcastDOMProc.broadcastEnded(),'function'==typeof n&&n())},setupEmbedBroadcast:function(t,e){if(pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING),c=!0,S&&P(),!t)return-1;i=S=t,e&&(n=e),stateService.setCallUUID(m()),callUserService.add(t.type),R(),U(),pageUnloadService.registerFunction(B)},getBroadcastView:function(){var t=broadcastDOMProc.getView();return uiUtilitiesService.removeClass(t,'gis-modal-wrap'),t},pauseVideo:function(){broadcastDOMProc.pauseVideo()},playVideo:function(){broadcastDOMProc.playVideo()},toggleMute:function(){broadcastDOMProc.toggleMute()},showNoBroadcastView:function(t){var e,n,a=utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM];if(shopStreamService.isShopStreamEnabled()&&a&&t&&t.broadcastEventHoldTimeStamp&&(n=a,(e=t).status===GIS_CONSTANTS.BROADCAST_STATUS.BROADCAST_CREATED?(s&&s.getTime()!==new Date(e.broadcastEventHoldTimeStamp).getTime()&&(broadcastDOMProc.updateTimeOnHoldingScreen(new Date(e.broadcastEventHoldTimeStamp)),clearTimeout(l),D()),s=new Date(e.broadcastEventHoldTimeStamp),function t(e,n){if(i=new Date,(r=new Date(s)).setMinutes(s.getMinutes()-10),i.getTime()<r.getTime()&&!l)l=setTimeout(function(){t(e,n)},1e3*utilitiesService.getTimeDifference(r,new Date));else if(o=new Date,(A=new Date(s)).setMinutes(s.getMinutes()+10),o.getTime()>=r.getTime()&&o.getTime()<=A.getTime()){if(d&&L)return;g(0,n),N=!(L=!0)}else if(a=new Date,(E=new Date(s)).setMinutes(s.getMinutes()+25),a.getTime()>=A.getTime()&&a.getTime()<=E.getTime()){if(d&&N)return;d&&L&&D(),g(0,n,3e4),N=!(L=!1)}else(new Date).getTime()>E.getTime()&&d&&(D(),clearTimeout(l),N=L=!1);var a,o,i}(e,n)):e.status===GIS_CONSTANTS.BROADCAST_STATUS.BROADCAST_ENDED&&d&&D()),!O){stateService.setCurrentPhase(stateService.phase.NO_BROADCAST_AVAILABLE),O=!0,i=t;var o=serverInjectionService.getSystemConfig().oneToOneCta.broadcast&&i&&i.config&&i.config.oneToOneInBroadcast;!i||void 0===i.status||0!==i.status&&10!==i.status?broadcastDOMProc.show(!1,i):broadcastDOMProc.show(o,i),i&&(0===i.status||10===i.status)&&o&&R()}}}};GISAPP.callCtrl=function(logService,serverInjectionService,stateService,mediaService,browserInfoService,activityLoggerService,systemInfoService,uiUtilitiesService,gisService,otService,callUserService,gaService,pageUnloadService,utilitiesService,callDOMProc,preCallScreen,surveyScreen,modalComponent,eventLoggerService,overrideService,callService,GIS_CONSTANTS,bookingService,callScreen,streamService,chatLogoutService,addToCartService,addAPersonService,clientStorageService){'use strict';var o,e,a,t={},r="callCtrl",A=!1,E=serverInjectionService.getSystemConfig().skipMicShare,n=serverInjectionService.getSystemConfig().isNewCallScreen||serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall.enabled,i=0,l=0,s=!0,C=function(e,t,i){};t.addProductToBasket=C;var c,d,T,S,I,_,otSession,otPublisher,g=null,L=!1,u=browserInfoService.isChrome()?'https://support.google.com/chrome/answer/2693767?hl=en':'https://support.mozilla.org/en-US/questions/1168156',N=GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED,h=[],D=!1,O=!1,y=!1,v=!1,f=!1,M=!1,p=!1,V=!1,R=0,m=0,P=!0,Y={},b=!1,w=!1,U=[],G={mic:{isMute:E,onClick:ve},speaker:{isMute:A,onClick:fe},cameraToggle:{isMute:P,onClick:Ye,isEnabled:serverInjectionService.getSystemConfig().oneToOne.twoWayVideo.enabled},cameraSwitch:{isMute:!1,onClick:be},onLeaveButtonClick:K};function k(e,t,i){if(window.dispatchEvent(new GisCustomEvent("gisCallInitiated")),stateService.getCurrentPhase()===stateService.phase.READY||stateService.getCurrentPhase()===stateService.phase.EMBED_CALL_INITIATED){stateService.getCanceledOnConnectingScreen()&&stateService.setCallInitiatedWhileCanceling(!0),stateService.setCurrentPhase(stateService.phase.CALL_INITIATING),oe();var n=e&&"string"==typeof e?e:stateService.getRoutingKey();stateService.setActiveCallRoutingKey(n),d=utilitiesService.isDirectCall()||utilitiesService.isDepartmentCall()?GIS_CONSTANTS.CALL_TYPES.DIRECT:GIS_CONSTANTS.CALL_TYPES.STANDARD,gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_MADE,{CallType:d}),systemInfoService.requiresSSLCall()?gisService.getSecurityToken("gisCallbacks.onSecurityTokenReceived"):(utilitiesService.isMeeting()?gisService.initiateMeetingCall("gisCallbacks.onCallInitiation",d,a):addAPersonService.isAddAPersonCall()?W(t.data):(V=i,gisService.initiateCall("gisCallbacks.onCallInitiation",d)),c&&clearTimeout(c),c=setTimeout(Me,4e4))}else logService.warn(r,"Tried to initiate call procedure when phase is "+stateService.getCurrentPhase())}function H(){c&&clearTimeout(c),uiUtilitiesService.redirectToHttp(),stateService.setCallUUID(""),stateService.setActiveCallRoutingKey(""),N=GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED,w=V=!1,me(),"function"==typeof S&&S()}function W(t){logService.debug(r,"Call initiation received",stateService.getCallUUID());try{if(stateService.getCallUUID()||stateService.getCurrentPhase()!==stateService.phase.CALL_INITIATING)return void logService.warn(r,"Received call initiation but call has already been initiated or has been canceled");stateService.setCurrentPhase(stateService.phase.CALL_INITIATED),t.callUUID&&stateService.setCallUUID(t.callUUID),t.sessionId&&stateService.setSessionId(t.sessionId),t.token&&stateService.setToken(t.token),t.sessionId&&t.sessionId,t.apiKey&&(e=t.apiKey),t.surveyId&&t.surveyId,t.apiKey&&stateService.setTokBoxApiKey(e),clearTimeout(c),c=null,callUserService.add("call"),V?Ce():ae()}catch(e){logService.error(r,"Exception on server callback, onCallInitiation.",e,{callId:t.callUUID})}}function B(e,t,i,n,o,a,l,s,C,c){C&&'string'==typeof C&&(C=JSON.parse(C));try{if(Re(t))return;callDOMProc.setupClerkProfile(n,o),logService.log(r,"Session Connected"),N=GIS_CONSTANTS.CALL_STATUS.CONNECTED,stateService.setCurrentPhase(stateService.phase.IN_CALL),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ACCEPTED),utilitiesService.isDirectCall()?gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.DIRECT_CALL):gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.STANDARD_CALL),g=new Date,c||(I.hide(!0),callDOMProc.show({isMicSetupRequired:serverInjectionService.getSystemConfig().skipMicShare,isBookingCall:utilitiesService.isMeeting(),isArchivingEnabled:b,chatOnlyCall:{enabled:V,startCallOnClick:we}}),GISAPP.chatUserNameService.setCallDOMProc(callDOMProc)),callDOMProc.changeMicIcon(E),callDOMProc.changeSpeakerIcon(A),(utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall()&&Y.video&&Y.video.isAllowed)&&(callDOMProc.setOnCameraSwitch(be),callDOMProc.setOnCamClick(Ye),callDOMProc.changeCamIcon(P)),callDOMProc.hideMicShareOverlay(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_UI_LOADED);var d={routingKey:stateService.getRoutingKey()};C&&(d.routing=C),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.CALL+eventLoggerService.GIS_ACTIONS.SHOWN,d),callDOMProc.displayControls(),serverInjectionService.getSystemConfig().skipMicShare&&setTimeout(function(){otPublisher.getPublisher()||de()},3e3),callDOMProc.setOnMicClick(ve),callDOMProc.setOnSpeakerClick(fe),callDOMProc.setOnEndCallClick(K),callDOMProc.setOnHelpUnblockClick(function(){window.open(u,'_blank')}),V||Ne()}catch(e){logService.error(r,"Exception on server callback, postConnect.",e)}}function K(){M=!0,utilitiesService.isMeeting()&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.BOOKING_CUSTOMER_LEFT),stateService.setCurrentPhase(stateService.phase.CALL_END),N===GIS_CONSTANTS.CALL_STATUS.CONNECTED&&(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_DISCONNECTED_BY_CONSUMER),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.CONSUMER})),N===GIS_CONSTANTS.CALL_STATUS.CONNECTING&&(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECTING_CANCELLED),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CONNECTING_CANCELLED)),Pe(),callDOMProc.destroyEventListeners(),V=!1}callDOMProc=n?new callScreen(G):callDOMProc,pageUnloadService.registerFunction(function(){switch(N){case GIS_CONSTANTS.CALL_STATUS.CONNECTING:setTimeout(function(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_ABORT_BY_CONSUMER),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ABORTED)},0);break;case GIS_CONSTANTS.CALL_STATUS.CONNECTED:setTimeout(function(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_ENDPOINTS.CALL_FINISHED_PAGE_UNLOAD),stateService.getChatInitialized()&&chatLogoutService.logout()},0)}}),window.addEventListener("orientationchange",function(){otPublisher&&otPublisher.getPublisher()&&setTimeout(function(){callDOMProc.changeVideoDimension(callDOMProc.getMainVideoStreamId())},2e3)},!1),overrideService.override(r,t),t.addProductToBasket!==C&&addToCartService.overrideATC(t.addProductToBasket);var F=function(e){N!==GIS_CONSTANTS.CALL_STATUS.CONNECTING||f||(f=!0,utilitiesService.isMeeting()||addAPersonService.isAddAPersonCall()?B(0,stateService.getCallUUID(),0,null,null,0,0,0,null,!0):utilitiesService.isDepartmentCall()?gisService.connectAutoLaunchCall(stateService.getAutoLaunchId(),stateService.getCallUUID(),stateService.getPageMetadata()):gisService.connectCall(stateService.getCallUUID(),stateService.getRoutingKey(),o,stateService.getPageMetadata(),ne()),window.dispatchEvent(new GisCustomEvent("gisCallConnecting")),I.getChild().setConnecting(L,ne()))},J=function(e){"CONSUMER"===JSON.parse(e.stream.connection.data).userType&&stateService.addStreamToConsumerMap(e.stream.connection.id),'camera'===e.stream.videoType&&l++,i++,e&&e.stream&&(e.stream.connection&&(otService.log('streamCreated - connectionId: '+e.stream.connection.connectionId),otService.log('streamCreated - connectionData: '+e.stream.connection.data)),function(e){if(e.connection.connectionId===otSession.getConnection().connectionId)return;var t=callDOMProc.addStream(e),otSubscriber=otSession.subscribe(e,t.id,{showControls:!1,width:"100%",height:"100%"});otSubscriber.setVideoDisableWarningHandler(function(){callDOMProc.showPoorConnectionMessage()}),otSubscriber.setVideoDisableWarningLiftedHandler(function(){callDOMProc.hidePoorConnectionMessage()}),otSubscriber.setVideoDisabledHandler(function(e){'quality'===e.reason&&callDOMProc.showVideoDisabledMessage()}),otSubscriber.setVideoEnabledHandler(function(){callDOMProc.hideVideoDisabledMessage()}),A?otSubscriber.setAudioVolume(0):otSubscriber.setAudioVolume(100);callDOMProc.changeVideoDimension(e.streamId)}(e.stream)),O||(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CLERK_STREAM_RECEIVED),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CLERK_STREAM_RECEIVED),O=!0,D&&(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_ENDPOINTS.CALL_STARTED),pe())),callDOMProc.hideCallStatusDialog(),(utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall())&&callDOMProc.setupTapToFocus(),callDOMProc.hideCallController(),callDOMProc.setCallControllerAnimation(),callDOMProc.updateConnectionCount(l),Ve(e.stream)},x=function(e){"CONSUMER"===JSON.parse(e.stream.connection.data).userType&&stateService.removeStreamFromConsumerMap(e.stream.connection.id),1<=i&&(callDOMProc.removeVideoWhenClerkLeave(e.stream.id),callDOMProc.changeVideoDimension(callDOMProc.getMainVideoStreamId())),'camera'===e.stream.videoType&&l--,i--,callDOMProc.updateConnectionCount(l)},z=function(e){"hasVideo"===e.changedProperty&&(1<i||n?e.stream.hasVideo?callDOMProc.showVideoOfClerk(e.stream.id):callDOMProc.hideVideoOfClerk(e.stream.id):1===i&&(callDOMProc.setSubscriberVideoState(e.stream.hasVideo),callDOMProc.changeVideoDimension(e.stream.id))),"videoDimensions"===e.changedProperty&&callDOMProc.changeVideoDimension(e.stream.id),Ve(e.stream)},j=function(){b=!0,callDOMProc.showRecordingTooltip()},q=function(){b=!1,callDOMProc.hideRecordingTooltip()},Q=function(e){!M&&p?callDOMProc.showDisconnectedMessage(Z):Z()};function Z(){f=!1;var e=N;N=GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED,stateService.getChatInitialized()&&N&&chatLogoutService.logout(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_ENDPOINTS.CALL_FINISHED);var t=new Date,i=utilitiesService.getTimeDifference(g,t);0<i&&gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_DURATION,{CallDurationSec:i}),e===GIS_CONSTANTS.CALL_STATUS.CONNECTED?(callDOMProc.hide(),"true"===serverInjectionService.getSurveyEnabled()?(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_SURVEY_SHOWN),I=new modalComponent({child:surveyScreen,hideDisclaimerOnSurveyScreen:!0,ctrlFunctions:{initiateCallProcedure:k,initPublisher:de,destroyPublisher:De,endCall:K,handlePostCallEvents:H,destroyUiContainer:function(){I=null},startCall:Ce,onMicToggle:Oe,onCameraToggle:ye}}),uiUtilitiesService.bodyRender(I.render())):H()):H()}var X=function(e){if(utilitiesService.isJsonString(e.connection.data)){var t=JSON.parse(e.connection.data).userType;'CONSUMER'==t&&R--,'CLERK'==t&&m--}utilitiesService.removeFromArray(h,e.connection.connectionId),h.length<2&&N===GIS_CONSTANTS.CALL_STATUS.CONNECTED&&!utilitiesService.isMeeting()&&(stateService.setCurrentPhase(stateService.phase.CALL_END),"clientDisconnected"===e.reason?'CLERK'===t&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_ENDED_BY_CLERK),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.CLERK})):"networkDisconnected"===e.reason?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_ENDED_NETWORK_DISCONNECT),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.FAILED})):"forceDisconnected"===e.reason&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_ENDED_FORCE),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.OTHER})),Pe(),callDOMProc.hide())},$=function(e){if(U.push({id:e.connection.connectionId,type:JSON.parse(e.connection.data).userType}),utilitiesService.isJsonString(e.connection.data)){var t=JSON.parse(e.connection.data);t||logService.error(r,"Connection data not found on connectionCreatedHanlder.",t);var i=t&&t.userType;if('CONSUMER'==i&&R++,'CLERK'==i){m++;var n=t.clerk&&t.clerk.id;n?gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CLERK_JOINED,{clerkId:n}):logService.error(r,"Clerk-id not found in the connection data on connectionCreatedHanlder. NOT sending clerk-joined analytics.",t)}}utilitiesService.isMeeting()&&(0<R&&0==m?callDOMProc.showWaitingForAssistant():'CLERK'==i&&callDOMProc.showAssistantIsJoining()),(utilitiesService.isMeeting()||addAPersonService.isAddAPersonCall())&&'CONSUMER'===i&&eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CONSUMER_JOINED_THE_CALL,{consumerCount:R}),utilitiesService.addToArray(h,e.connection.connectionId)},ee=function(e){var t,i=stateService.getChatInitiated();if(e&&"signal:ADD-TO-BASKET"===e.type&&e.data&&(t=JSON.parse(e.data),callDOMProc.showSignalMessage(e,addToCartService.onAddToBasketTriggered.bind(null,t,e,null,null,otSession),addToCartService.onAddToBasketDenied.bind(null,t,e,otSession)),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_SHOWN,{basketInfo:addToCartService.getBasketInfo(t)})),e&&"signal:ADD-TO-RECOMMENDED"===e.type&&e.data&&((t=JSON.parse(e.data)).isRecommendedByClerk=!0,t.url=t.productUrl,t.id=t.productCode,t.onAccept=addToCartService.onAddToBasketTriggered.bind(null,t),callDOMProc.addRecommendedProduct(t)),e&&"signal:ADD-ADDON-TO-BASKET"===e.type&&e.data&&((t=JSON.parse(e.data)).title=t.addOnTitle,t.price=t.addOnPrice,callDOMProc.showSignalMessage(e,addToCartService.onAddToBasketTriggered.bind(null,t,e,null,null,otSession),addToCartService.onAddToBasketDenied.bind(null,t,e,otSession)),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_SHOWN,{basketInfo:addToCartService.getBasketInfo(t)})),callService.isInCallChatEnabled()&&e&&"signal:CHAT_INITIATED"===e.type&&(!i&&n&&callDOMProc.checkChatInitiationType(e.type),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.IN_CALL_CHAT_SHOWN,{chatInfo:{callUUID:'callUUID',groupID:'groupID'}})),callService.isInCallChatEnabled()&&e&&"signal:IS_CHAT_INITIATED"===e.type&&i&&otSession.sendSignal(null,GIS_CONSTANTS.SIGNAL_TYPE.CHAT_INITIATED,null),e&&"signal:TRANSITION_CHAT_TO_CALL_REQUEST"===e.type){if(w||e.from.id===otSession.getConnection().connectionId)return;w=!0,I.hide(),otPublisher&&De(),callDOMProc.showIncomingCallPopUp(function(){ae(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.TRANSITION_CHAT_TO_CALL_ACCEPTED_BY_CONSUMER)},function(){var e=Ue();e?otSession.sendSignal(otSession.getSession().connections.get(e.id),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_RESPONSE,{isAccepted:!1}):logService.error(r,"Clerk Connection not found when sending chat-to-call transition response to clerk."),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CHAT_TO_CALL_REQUEST_CANCEL_BY_CONSUMER),w=!1})}if(e&&"signal:TRANSITION_CHAT_TO_CALL_RESPONSE"===e.type){if(stateService.getCanceledOnConnectingScreen())return void stateService.setCanceledOnConnectingScreen(!1);(t=JSON.parse(e.data))&&t.isAccepted?se():t&&!t.isAccepted&&(I.hide(),callDOMProc.showCallDeclinedNotification())}};var te=function(e){p=!0,callDOMProc.showReconnectingMessage(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_RECONNECTING),stateService.setSessionReconnected(!1)},ie=function(e){p=!1,callDOMProc.setCallStatus("CALL_RECONNECTED"),callDOMProc.updateCallScreenOverlayStatus(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_RECONNECTED),'sessionReconnected'===e.type&&(otSession.sendSignal(null,GIS_CONSTANTS.SIGNAL_TYPE.IS_CHAT_INITIATED,null),stateService.setSessionReconnected(!0),GISAPP.chatInitService.triggerEvent(e.type))},ne=function(){return V};function oe(){N=GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED,i=0,w=V=p=M=L=O=D=!(h=[]),otPublisher=S=g=d=c=null}function ae(){'ie'!==stateService.getBrowser()||systemInfoService.checkSystemSupported()?systemInfoService.checkSystemSupported()?otService.detectDevices(function(e,t){if(e)return activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ACCESS_ERROR),void logService.debug(r,"Failed to start call at OT device support.",e);(Y=t).audio.isDetected?(serverInjectionService.getSystemConfig().skipMicShare?Ce():(utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall())&&t&&t.audio.isAllowed&&t.video&&t.video.isAllowed?de(!(s=!1)):V?(mediaService.isMicAllowed()?de(callService.isTwoWayVideoCall()):(I.isVisible()||re(),I.getChild().setCallInitiated(!0)),w&&"function"==typeof I.getChild().addOnCloseCallback&&I.getChild().addOnCloseCallback(le)):I.getChild().setCallInitiated(),t.video.isDetected?activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_DETECTED,systemInfoService.getSystemInfo()):activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_UNDETECTED,systemInfoService.getSystemInfo())):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_BLOCKED_NO_MIC,systemInfoService.getSystemInfo()),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_BLOCKED_NO_MIC,{systemInfo:systemInfoService.getSystemInfo()}),I.getChild().noMic())}):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_BLOCKED_UNSUPPORTED_BROWSER),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_BLOCKED_UNSUPPORTED_BROWSER),I.getChild().browserUnsupported(),otSession.sendSignal(otSession.getSession().connections.get(Ue().id),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_RESPONSE,{isAccepted:!1})):(I&&I.hide(!0),uiUtilitiesService.hideModal(!0),otService.initializePluginInstallationProcess())}function le(){w&&(otSession.sendSignal(otSession.getSession().connections.get(Ue().id),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_RESPONSE,{isAccepted:!1}),w=!1),otPublisher&&De()}function se(e){I.hide(),Ne(),callDOMProc.showAVCallView(),w&&e&&otSession.sendSignal(otSession.getSession().connections.get(e),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_RESPONSE,{isAccepted:!0}),V=w=!1}function Ce(){N=GIS_CONSTANTS.CALL_STATUS.CONNECTING,activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECTING),utilitiesService.isMeeting()||addAPersonService.isAddAPersonCall()?(I.hide(!0),callDOMProc.show({isMicSetupRequired:serverInjectionService.getSystemConfig().skipMicShare,isBookingCall:utilitiesService.isMeeting(),isArchivingEnabled:b}),callDOMProc.showConnectingToLobby(),GISAPP.chatUserNameService.setCallDOMProc(callDOMProc),setTimeout(ce,2e3),utilitiesService.isMeeting()&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.BOOKING_CUSTOMER_JOINED),addAPersonService.isAddAPersonCall()&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.FRIEND_ADDED_IN_CALL),P?Y.video.isAllowed&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_JOINED_CAMERA_MUTE):activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_JOINED_CAMERA_UNMUTE),E?Y.audio.isAllowed&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_JOINED_MIC_MUTE):activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_JOINED_MIC_UNMUTE)):ce()}function ce(){(otSession=otService.initSession(stateService.getTokBoxApiKey(),stateService.getSessionId(),function(e){e&&(logService.error(r,"Error on initiating OT session",e),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECT_FAILED,utilitiesService.getErrorObject(e.code,e.message)),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.FAILED}))})).setSessionConnectedHandler(F),otSession.setSessionDisconnectedHandler(Q),otSession.setSessionReconnectingHandler(te),otSession.setSessionReconnectedHandler(ie),otSession.setConnectionCreatedHandler($),otSession.setConnectionDestroyedHandler(X),otSession.setStreamCreatedHandler(J),otSession.setStreamDestroyedHandler(x),otSession.setSignalHandler(ee),otSession.setStreamPropertyChangedHandler(z),otSession.setArchivingStartedHandler(j),otSession.setArchivingStoppedHandler(q),otSession.connect(stateService.getToken(),function(e){e&&(logService.error(r,"Failed to connect to session.",e),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECT_FAILED,utilitiesService.getErrorObject(e.code,e.message)),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.FAILED}),H())})}var de=function(e){otPublisher&&De();var t={publishAudio:!0,publishVideo:!!e,insertDefaultUI:!1,width:'100%',height:'100%',insertMode:'append'};if(serverInjectionService.getSystemConfig().isMusicCall&&serverInjectionService.getSystemConfig().isMusicCall.enabled&&serverInjectionService.getSystemConfig().isMusicCall.config){var i=serverInjectionService.getSystemConfig().isMusicCall.config;for(var n in i)t[n]=i[n]}e||(t.videoSource=null),otPublisher=otService.initPublisher(t,function(e){e&&(logService.error(r,"Failed to initialize OT publisher.",e),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECT_FAILED,utilitiesService.getErrorObject(e.code,e.message)),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.FAILED}))}),(utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall())&&(otPublisher.setVideoElementCreatedHandler(function(e){e.element&&(_=e.element)}),otPublisher.setStreamCreatedHandler(function(e){var t=uiUtilitiesService.createElementWithAttributes("div",e.stream.streamId);_.style.width='100%',_.style.height='100%',t.appendChild(_),callDOMProc.setPublishedVideo(t),streamService.addStreamToMap(e.stream.streamId,e.stream,t)})),serverInjectionService.getSystemConfig().skipMicShare?(otPublisher.setAccessAllowedHandler(ue),otPublisher.setAccessDeniedHandler(Ae),otPublisher.setAccessDialogOpenedHandler(Se)):(V?(otPublisher.setAccessAllowedHandler(_e),otPublisher.setAccessDeniedHandler(ge)):(otPublisher.setAccessAllowedHandler(Ie),otPublisher.setAccessDeniedHandler(Ee)),otPublisher.setAccessDialogOpenedHandler(Te))};function re(e){I=new modalComponent({child:preCallScreen,event:e,steps:mediaService.isMicAllowed()?0:2,ctrlFunctions:{initiateCallProcedure:k,initPublisher:de,destroyPublisher:De,endCall:K,handlePostCallEvents:H,startCall:Ce,onMicToggle:Oe,onCameraToggle:ye,transitionToAVCallFromChat:Le,isChatFirstCall:ne}}),uiUtilitiesService.bodyRender(I.render())}function Ae(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_BLOCKED_IN_CALL),v=!(y=!1),callDOMProc.updateOverlayTo("MIC_DENIED"),De()}function Ee(e){utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall()?otService.detectDevices(function(e,t){I.getChild().updateMediaShareStatus(t),t.audio.isAllowed?activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ALLOWED):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_BLOCKED_MIC_DENIED),De()),t.video.isAllowed?activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_ALLOWED):activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_DENIED)}):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_BLOCKED_MIC_DENIED),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_MIC_DENIED),I.getChild().micBlocked(),De()),Y=otService.getMediaDevicesStatus()}function Te(){systemInfoService.shouldBypass(systemInfoService.CONTROLLER_KEYS.MEDIA_SHARE)||activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_REQUESTED)}function Se(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_REQUESTED_IN_CALL),y=!0,T=setTimeout(function(){callDOMProc.updateOverlayTo("SHARE_MIC")},500)}function Ie(e){utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall()?otService.detectDevices(function(e,t){t&&t.audio.isAllowed&&t.video&&t.video.isAllowed&&!s?I.getChild().setCallInitiated():I.getChild().updateMediaShareStatus(t),t.video.isAllowed&&(I.getChild().displayPreviewMediaShareScreen(_),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_ALLOWED)),t.audio.isAllowed&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ALLOWED)}):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ALLOWED),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_MIC_ALLOWED),Ce()),Y=otService.getMediaDevicesStatus()}function _e(e){callService.isTwoWayVideoCall()?otService.detectDevices(function(e,t){I.isVisible()||re(),t&&t.audio.isAllowed&&t.video&&t.video.isAllowed&&!s?I.getChild().setCallInitiated(!0):I.getChild().updateMediaShareStatus(t),t.video.isAllowed&&(I.getChild().displayPreviewMediaShareScreen(_),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CAMERA_ALLOWED)),t.audio.isAllowed&&activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ALLOWED)}):Le(),Y=otService.getMediaDevicesStatus()}function ge(e){Ee(),otSession.sendSignal(otSession.getSession().connections.get(Ue().id),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_RESPONSE,{isAccepted:!1}),w=!1}function Le(){I.hide(!0),function(){var e=Ue();if(e){var t=e.id;w?se(t):(re(),I.getChild().setConnecting(L,!0,!0),otSession.sendSignal(otSession.getSession().connections.get(t),GIS_CONSTANTS.SIGNAL_TYPE.TRANSITION_CHAT_TO_CALL_REQUEST,null),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.TRANSITION_CHAT_TO_CALL_SENT_BY_CONSUMER))}else logService.error(r,"Clerk Connection not found when sending chat-to-call transition request to clerk.")}()}function ue(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_ALLOWED_IN_CALL),E=v=y=!1,clearTimeout(T),N===GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED?De():(Ne(),callDOMProc.updateOverlayTo('MIC_SHARED'),setTimeout(callDOMProc.hideMicShareOverlay,1500),callDOMProc.changeMicIcon(E),callDOMProc.enableControlSlide())}var Ne=function(){f?void 0!==otPublisher.getPublisher()&&null!==otPublisher.getPublisher()&&((utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall()&&Y.video.isAllowed)&&(otPublisher.publishAudio(!E),otPublisher.publishVideo(!P)),otSession.publish(otPublisher.getPublisher(),he)):setTimeout(Ne,500)};function he(e){if(null==e)return activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_PUBLISHED),D=!0,void(O&&(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_ENDPOINTS.CALL_STARTED),pe()));if(logService.debug(r,"Failed to publish audio.",e),D=!1,'1500'===e.code){var t=browserInfoService.getBrowserDisplayName(stateService.getBrowser());uiUtilitiesService.showAlert(t+" has failed to allow access to the microphone. Please restart "+t+" and try again");var i={browser:t,browserVersion:stateService.getBrowserVersion()};activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_MIC_SHARE_TIMED_OUT,i)}activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONNECT_FAILED,utilitiesService.getErrorObject(e.code,e.message)),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_ENDED,{CallEndReason:GIS_CONSTANTS.CALL_END_REASONS.FAILED})}function De(){!y&&otPublisher&&otPublisher.getPublisher()&&(otPublisher.destroy(),otPublisher=null)}function Oe(e){otPublisher.getPublisher()&&otPublisher.publishAudio(e),E=!e,G.mic.isMute=E}function ye(e){otPublisher.getPublisher()&&otPublisher.publishVideo(e),P=!e,G.cameraToggle.isMute=P}function ve(){if(E){if(y||v)return;otPublisher.publishAudio(!0),E=!1,callDOMProc.changeMicIcon(E),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_MIC_UNMUTE_IN_CALL)}else otPublisher.publishAudio(!1),E=!0,callDOMProc.changeMicIcon(E),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_MIC_MUTE_IN_CALL)}function fe(){var t=0;A&&(t=100),otSession.getSubscribers().forEach(function(e){e.setAudioVolume(t)}),A=!A,callDOMProc.changeSpeakerIcon(A)}function Me(){stateService.getCurrentPhase()===stateService.phase.CALL_INITIATING&&(I.hide(),uiUtilitiesService.showAlert("Failed to connect you to the store. Try again later.",function(){H()}))}function pe(){var e=document.getElementById("gis-call-footer");uiUtilitiesService.removeClass(e,'gis-hide')}function Ve(e){var t=!1;serverInjectionService.getSystemConfig().noVideoImage&&0!=m&&serverInjectionService.getSystemConfig().noVideoImage&&(n?e.hasVideo?callDOMProc.hideNoVideoImage(e.id):callDOMProc.showNoVideoImage(e.id):(otSession.getSubscribers().find(function(e){if(e&&e.stream&&e.stream.hasVideo)return t=!0}),t?callDOMProc.hideNoVideoImage():callDOMProc.showNoVideoImage()))}function Re(e){return!(!stateService.getCanceledOnConnectingScreen()||!(!stateService.getCallInitiatedWhileCanceling()||e&&stateService.getCallInitiatedWhileCanceling()&&stateService.getCallUUID()!=e))&&(stateService.setCallInitiatedWhileCanceling(!1),stateService.setCanceledOnConnectingScreen(!1),!0)}function me(){stateService.setCurrentPhase(stateService.phase.READY)}function Pe(){try{A=E=!1,l=i=0,otPublisher&&De(),callService.isInCallChatEnabled()&&(chatLogoutService.logout(),stateService.setChatInitiated(!1),stateService.setChatInitialized(!1)),otSession.disconnect(),f=!1}catch(e){me(),logService.warn(r,'Exception on disconnecting session.')}}function Ye(){if(P){if(v)return;otPublisher.publishVideo(!0),P=!1,callDOMProc.changeCamIcon(P),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_CAMERA_UNMUTE_IN_CALL)}else otPublisher.publishVideo(!1),P=!0,callDOMProc.changeCamIcon(P),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CONSUMER_CAMERA_MUTE_IN_CALL)}function be(){otPublisher.cycleVideo()}function we(){ae()}function Ue(){for(var e in U)if('CLERK'===U[e].type)return U[e]}return window.noClerkAvailable=function(e,t,i){Re(i)||('CALL_MISSED'===e&&gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_MISSED),'CALL_USER_BLOCKED'===e?eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_USER_BLOCKED,{referrer:document.referrer||""}):(activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_NO_CLERK_AVAIL),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_NO_CLERK_AVAILABLE)),L=!0,N=GIS_CONSTANTS.CALL_STATUS.NOT_CONNECTED,I&&I.getChild().setNoClerkAvailable&&I.getChild().setNoClerkAvailable())},window.postConnect=B,window.gisCallbacks.onCallInitiation=W,window.gisCallbacks.onSSLCallInitiation=function(e,t,i,n){try{stateService.setCurrentPhase(stateService.phase.CALL_INITIATED),stateService.setCallUUID(n.callUUID),stateService.setTokBoxApiKey(n.apiKey),n.sessionId,logService.info(r,"Initiating call for secure page with id:"+n.callUUID),oe(),e=e&&"string"==typeof e?atob(e):stateService.getRoutingKey(),stateService.setActiveCallRoutingKey(e),o=encodeURIComponent(t);try{stateService.setPageMetadata(JSON.parse(atob(i)))}catch(e){}callUserService.add("call",o),re(),ae()}catch(e){logService.error(r,"Exception when starting SSL call",e)}},window.gisCallbacks.onSecurityTokenReceived=function(e){I.hide(),gisService.connectSSLCall(e,stateService.getRoutingKey(),stateService.getPageMetadata(),"gisCallbacks.onSSLCallInitiation",d)},{initiateCallProcedure:k,handlePostCallEvents:H,setCallEndedCallback:function(e){S=e},endCall:K,destroyPublisher:De,startCallJourney:function(e,t){if(e.type===GIS_CONSTANTS.CALL_TYPES.STANDARD&&callService.isRedirectJourney())bookingService.openBookingPage();else{clientStorageService.restoreOpenTokPropsToLocalStorage(),re(t),e.routingKey&&stateService.setActiveCallRoutingKey(e.routingKey),e.data&&e.data.id&&(a=e.data.id);var i=callService.getCallJourneyInitiationScreen(e);i?function(e,t){switch(e){case GIS_CONSTANTS.VIEWS.INVALID_URL:I.getChild().invalidDirectCallScreen();break;case GIS_CONSTANTS.VIEWS.DIRECT:I.getChild().directCallScreen(t);break;case GIS_CONSTANTS.VIEWS.HUMANIZED_CONNECT:I.getChild().setHumanizedConnectScreen(t);break;case GIS_CONSTANTS.VIEWS.CLERK_UNAVAILABLE_CONNECT:I.getChild().setClerkUnavailableConnectScreen();break;case GIS_CONSTANTS.VIEWS.CONNECT:I.getChild().setConnectScreen();break;case GIS_CONSTANTS.VIEWS.MEETING_MISSED:I.getChild().setMeetingMissed();break;case GIS_CONSTANTS.VIEWS.MEETING_CANCELED:I.getChild().setMeetingCancelled();break;case GIS_CONSTANTS.VIEWS.MEETING_CONNECT:I.getChild().meetingConnectScreenWaiting(t);break;case GIS_CONSTANTS.VIEWS.MEETING_ENDED:I.getChild().setMeetingEnded();break;case GIS_CONSTANTS.VIEWS.MEETING_ERROR:I.getChild().setMeetingSomethingWrong();break;case GIS_CONSTANTS.VIEWS.BOOKING:I.getChild().setBookingWidget();break;case GIS_CONSTANTS.VIEWS.ADD_A_PERSON_SCREEN:I.getChild().setAddAPersonScreen(t)}}(i,e):k(e.routingKey)}},sendSignal:function(e){otSession.sendSignal(null,GIS_CONSTANTS.SIGNAL_TYPE.CHAT_INITIATED,null)},initPublisher:de,isChatFirstCall:ne,getCallDomProcObject:function(){return callDOMProc}}};GISAPP.contactCaptureCtrl=function(logService,gisService,uiUtilitiesService,eventLoggerService,modalComponent,modalContentComponent,emailSubmitComponent,buttonComponent,utilitiesService,clientStorageService){'use strict';var a={};return a._submitContact=function(){if(!a.isSubmissionInProgress){a.isSubmissionInProgress=!0,a.emailTextBox.disableButton();var t={source:a.source,contact:{email:a.emailTextBox.getText().toLowerCase().trim(),broadcastId:a.broadcastContactCaptureData.broadcastId,viewDuration:parseInt(a.broadcastContactCaptureData.viewDuration)}},e=utilitiesService.utf8ToBase64(JSON.stringify(t));gisService.submitBroadcastContactDetails(e,function(){a.isSubmissionInProgress=!1,a.emailTextBox.enableButton();var t=clientStorageService.getItem(clientStorageService.storageKeys.BROADCAST_CONTACT_CAPTURE)||{};t[a.broadcastContactCaptureData.broadcastId]=!0,clientStorageService.setItem(clientStorageService.storageKeys.BROADCAST_CONTACT_CAPTURE,t),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.BROADCAST_CONTACT_CAPTURE_SUBMITTED,{source:a.source}),a.contactCapture.hide()},function(){a.isSubmissionInProgress=!1,logService.error(a.LOGTAG,"Error on submitting contact info from Broadcast."),a.emailTextBox.enableButton(),a.emailTextBox.showError("Failed to submit email address.")})}},{init:function(t,e){a.broadcastContactCaptureData=e,a.source=t,a.contactCapture=new modalComponent({child:modalContentComponent,eventName:eventLoggerService.GIS_VIEWS.BROADCAST_CONTACT_CAPTURE,eventAction:eventLoggerService.GIS_ACTIONS.CLOSED,eventData:{source:a.source,component:"closeButton"}}),a.emailTextBox=new emailSubmitComponent({textBoxPlaceHolder:"Email",textBoxLabel:"Please enter a valid email address",buttonClick:a._submitContact}),uiUtilitiesService.bodyRender(a.contactCapture.render()),a.contactCapture.getChild().setup({exitAnimation:!0,enterAnimation:"fullscreen",mainText:{text:"Thanks for watching"},mainSubText:"Would you like a live one-to-one product demo with one of our experts?",secondaryText:"Enter your email address below and we will get back to you to arrange a call at your convenience.",padding:'0px 20px'}),uiUtilitiesService.appendView(a.contactCapture.getChild().subviews.contentContainer,a.emailTextBox.render()),a.buttonComponent=new buttonComponent({buttonLabel:"No thanks",onClick:a.contactCapture.hide,buttonClass:"gis-transparent-btn gis-link-blue",eventName:eventLoggerService.GIS_VIEWS.BROADCAST_CONTACT_CAPTURE,eventAction:eventLoggerService.GIS_ACTIONS.CLOSED,eventData:{source:a.source,component:"skipButton"}}),uiUtilitiesService.appendView(a.contactCapture.getChild().subviews.contentContainer,a.buttonComponent.render()),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_CONTACT_CAPTURE+eventLoggerService.GIS_ACTIONS.SHOWN,{source:a.source})}}};GISAPP.directCallCtrl=function(logService,stateService,serverInjectionService,gisService,utilitiesService,eventLoggerService,callCtrl,GIS_CONSTANTS,pollingService){'use strict';var e,l,i="directCallCtrl",n=logService,t="giscall",a=-2,r=-3,o=!1;function c(){o||d(GIS_CONSTANTS.DIRECT_CALL_TYPE.DEPARTMENT_CALL),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.AUTO_LAUNCH_CALL_POLLING),C()}function s(){o||d(GIS_CONSTANTS.DIRECT_CALL_TYPE.DEPARTMENT_CALL),L()}function u(){e=utilitiesService.getUrlParams()[t],utilitiesService.isEncodedUri(e)&&(e=decodeURIComponent(e)),gisService.isClerkAvailableByAlias(utilitiesService.utf8ToBase64(e),"GISAPP.directCallCtrl.clerkIsAvailable","GISAPP.directCallCtrl.clerkIsNotAvailable",stateService.getRoutingKey())}function d(e){(o=!0,e===GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL)?(callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isInvalidUrl:!1}),document.getElementById('gis-v3-button').addEventListener('click',function(){clearTimeout(l)})):callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isDepartmentCall:!0})}function L(){if(null===document.getElementById("loading-gis-v3-button")){var e=document.getElementById('gis-connectv2-center-image'),t=document.createElement('div');t.id='loading-gis-v3-wait-text',t.innerHTML="<div style='text-align: center; margin-bottom: 8px; color: #7e7e7e;'>Waiting for the host to start call.</div>";var l=document.createElement('div');l.innerHTML="<div id='gis-v3-button-icon' class='gis-v3-button-icon gis-v3-button-icon-loading-gif'></div> <span id='gis-v3-button-label' style='cursor: pointer;'>Please Wait...</span>",l.id='loading-gis-v3-button',l.className='loading-gis-v3-button',l.style.display='flex';var i=document.getElementById('gis-v3-button');i.classList.add('gis-hideAll'),i.classList.add('gis-v3-dc-btn'),e.parentNode.insertBefore(l,e.nextSibling),e.parentNode.insertBefore(t,e.nextSibling)}}function C(){null!==document.getElementById("loading-gis-v3-button")&&document.getElementById('loading-gis-v3-button').remove();null!==document.getElementById("loading-gis-v3-wait-text")&&document.getElementById('loading-gis-v3-wait-text').remove();if(null==document.getElementById("gis-v3-button'")){var e=document.getElementById('gis-v3-button');e.classList.add('gis-v3-dc-btn'),e.classList.remove('gis-hideAll')}}return{init:function(e){var t;e===GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL?u():e===GIS_CONSTANTS.DIRECT_CALL_TYPE.DEPARTMENT_CALL&&(t=utilitiesService.getUrlParams().giscallcategory,stateService.setAutoLaunchId(t),pollingService.registerPollingEvent(pollingService.BASE_EVENTS.AUTO_LAUNCH_CALL_POLLING,{poll:gisService.checkAutoLaunchClerkIsAvailable,pollArguments:[t]}),pollingService.subscribe(pollingService.BASE_EVENTS.AUTO_LAUNCH_CALL_POLLING,c,s),pollingService.startPollingEvent(pollingService.BASE_EVENTS.AUTO_LAUNCH_CALL_POLLING))},clerkIsNotAvailable:function(e){try{var t="";if(e&&(t=e.code),t==a)return clearTimeout(l),void callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isInvalidUrl:!0});if(t==r)return eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_USER_BLOCKED,{referrer:document.referrer||""}),void clearTimeout(l);'true'===serverInjectionService.isAutoStartDirectCallEnabled()?(o||d(GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL),L()):(o||d(GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL),L(),l=setTimeout(u,3e3))}catch(e){n.error(i,"Exception while processing directCall clerkIsNotAvailable Response.",e)}},clerkIsAvailable:function(){o||d(GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL);try{'true'!==serverInjectionService.isAutoStartDirectCallEnabled()||utilitiesService.isHttpsPageRedirected()?(C(),l=setTimeout(u,3e3)):callCtrl.initiateCallProcedure()}catch(e){n.error(i,"Exception on directCall server callback, clerkIsAvailable.",e)}},autoLaunchClerkIsAvailable:gisCallbacks.autoLaunchClerkIsAvailable=c,autoLaunchClerkIsNotAvailable:gisCallbacks.autoLaunchClerkIsNotAvailable=s}};GISAPP.embedCtrl=function(broadcastCtrl,chatInputDOMProc,stateService,overrideService,uiUtilitiesService,globalObjectService,pollingService){var a,s,n,e={},i=!1;e.LOGTAG='embedCtrl';var t="";function d(){globalObjectService.getWindow().dispatchEvent(new GisCustomEvent('GisBroadcastEnded',{detail:{broadcastView:s,chatView:n}}))}return e.init=function(){pollingService.subscribe(pollingService.BASE_EVENTS.BROADCAST_POLLING,function(){},function(){}),pollingService.startPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING),s=broadcastCtrl.getBroadcastView(),n=chatInputDOMProc.render(),uiUtilitiesService.addClass(s.querySelector('#gis-broadcast-video'),'gis-embed'),uiUtilitiesService.addClass(s.querySelector('.gis-modal-content.broadcast-video'),'gis-embed'),uiUtilitiesService.addClass(s,'gis-embed'),uiUtilitiesService.addClass(n,'gis-embed'),globalObjectService.getWindow().addEventListener("gisUIClosed",function(e){stateService.setUIActive(!1),stateService.getCurrentPhase()!==stateService.phase.IN_CALL&&stateService.getCurrentPhase()!==stateService.phase.CALL_END&&(stateService.setCallUUID(a.callUUID),stateService.setCurrentPhase(t)),broadcastCtrl.playVideo()}),globalObjectService.getWindow().addEventListener("gisUIOpen",function(e){stateService.setUIActive(!0),broadcastCtrl.pauseVideo(),stateService.getCurrentPhase()!==stateService.phase.IN_CALL&&stateService.getCurrentPhase()!==stateService.phase.CALL_END&&(stateService.setCallUUID(null),t=stateService.getCurrentPhase(),stateService.setCurrentPhase(stateService.phase.EMBED_CALL_INITIATED))})},e._isEmbed=function(){return!1},overrideService.override(e.LOGTAG,e),{init:e.init,isEmbed:e._isEmbed,startBroadcast:function(e){var t=e.broadcasts;0!==t.length&&(a=function(e){for(var t=0;t<e.length;t++){var a=e[t];if('broadcast'==a.type)return a}return null}(t))&&(i||(globalObjectService.getWindow().dispatchEvent(new GisCustomEvent('GisBroadcastStarted',{detail:{broadcastView:s,chatView:n,player:{toggleMute:broadcastCtrl.toggleMute,play:broadcastCtrl.playVideo,pause:broadcastCtrl.pauseVideo},onViewsAppended:function(){broadcastCtrl.setupEmbedBroadcast(a,d)}}})),i=!0))}}};GISAPP.hlsCtrl=function(logService,gisService,overrideService){var o,s,e={},r="hlsCtrl",i=logService,t=function(){},l=function(){};function n(n,t){var o=t.type,s=t.details;i.error(r,"Hls Error.",{message:o,stack:s}),l(t)}function c(){t()}function u(){o.loadSource(s)}return e.loadHls=function(t){gisService.loadHlsJs(function(){var n=e._isHlsObjectInit();n&&e._setEventsHandler(),t(n)},function(){i.error(r,"Failed to load Hls.js"),t(!1)})},e._isHlsObjectInit=function(){return!!Hls.isSupported()&&(o=new Hls,!0)},e._setEventsHandler=function(){o.on(Hls.Events.ERROR,n),o.on(Hls.Events.MEDIA_ATTACHED,u),o.on(Hls.Events.MANIFEST_PARSED,c)},overrideService.override(r,e),{loadHls:e.loadHls,playUrl:function(n,t){s=t,o.attachMedia(n)},destroy:function(){o&&o.destroy()},registerOnManifestParsed:function(n){'function'==typeof n&&(t=n)},registerOnErrorFunction:function(n){'function'==typeof n&&(l=n)}}};GISAPP.initCtrl=function(logService,clientStorageService,serverInjectionService,utilitiesService,systemInfoService,gisService,deviceInfoService,browserInfoService,stateService,uiUtilitiesService,gaService,overrideService,eventLoggerService,callUserService,API,availabilityCtrl,directCallCtrl,Sym_Sys,broadcastCtrl,pageUnloadService,metadataService,otService,meetingCtrl,globalObjectService,i18nService,embedCtrl,pollingService,cookieService,GIS_CONSTANTS,addAPersonCtrl,callService,addAPersonService,mvtService,userService){'use strict';var r={LOGTAG:"initCtrl",OPENTOK_SCRIPT_SRC:"https://static.opentok.com/v2.23.5/js/opentok.min.js"};return r.stateService=stateService,r.onGisLoadFunctions={},r.dependencyInitializationRetries=0,r.serviceOffered=!0,r.initInfoReceived=!1,r.cssReceived=!1,r.otReceived=!1,r.otSuccessCalled=!1,r.userMediaChecked=!1,r.isFeatureSupportChecked=!1,r.isTestingPhase=!1,r.init=function(){try{stateService.setCurrentPhase(stateService.phase.SCRIPT_INIT),logService.init(),cookieService.getCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID)&&r.getUserConsent()===GIS_CONSTANTS.COOKIES_PERMISSIONS.REJECTED&&cookieService.deleteCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID),r._setUserUUID();var e=utilitiesService.getUrlParams().pageUUID;e?stateService.setPageUUID(e):stateService.setPageUUID(utilitiesService.getRandomAlphaNumKey()),eventLoggerService.setupEventListeners(),gisCallbacks.initInfo=r.initInfoCallback,gisService.getInitInfo("gisCallbacks.initInfo",function(){logService.error(r.LOGTAG,"Failed to retrieve init info")}),r._loadOT(),gisService.loadCss(function(){r.cssReceived=!0,logService.debug(r.LOGTAG,"CSS loaded"),r.initGIS()},function(e){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_INIT_FAILED),logService.error(r.LOGTAG,"Failed to load Css",e)})}catch(e){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_INIT_FAILED),logService.error(r.LOGTAG,"Exception at script init",e)}},r.initInfoCallback=function(e){try{var t={text:navigator.userAgent,deviceType:null,deviceName:null,osName:deviceInfoService.getDeviceOS(),osVersion:null,browserName:browserInfoService.getBrowser(),browserVersion:null},i=serverInjectionService.getSystemConfig();if(e&&0===e.statusCode?t=e.userAgent:logService.warn(r.LOGTAG,"Request failed to get user-agent from server, using JS user-agent processor",{'server-resp':e}),t.osName&&!/unknown/i.test(t.osName)&&"??"!=t.osName||(t.osName=deviceInfoService.getDeviceOS()),t.browserName&&!/unknown/i.test(t.browserName)&&"??"!=t.browserName||(t.osName=browserInfoService.getBrowser()),stateService.setProcessedUserAgent(t),!e)return void logService.error(r.LOGTAG,"Stopping script execution. Invalid response from server on initInfoCallBack, response: "+e);if("BLOCKED_CALL_USER"===e.message){var n=document.referrer||"";return void eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_USER_BLOCKED,{referrer:n})}i.privacySettings&&i.privacySettings.optInAnalytics?(stateService.setIsDataCollectionDisabled(!0),r.isOptInAnalyticsAccepted()&&stateService.setIsDataCollectionDisabled(!1)):e.isDataCollectionDisabled&&stateService.setIsDataCollectionDisabled(e.isDataCollectionDisabled),r.broadcastEnabled=i.broadcast.enabled,e.hasOwnProperty("isOffered")&&(r.serviceOffered=e.isOffered);var o=r.isServiceOffered();if(!(systemInfoService.checkGisServiceEnabled()&&o||(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_BROWSER_NOT_SUPPORTED,{url:globalObjectService.getWindow().location.href}),r.broadcastEnabled)))return;if(utilitiesService.setupPolyfills(),e.isConfirmationPage&&eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ORDER_CONFIRMATION_PAGE),e&&e.locale&&stateService.setLocale(e.locale),e&&e.inputAlignment&&stateService.setInputAlignment(e.inputAlignment),e.oneToOneAutoPlay){var s={};s.urls=[e.oneToOneAutoPlay.url],s.name=e.oneToOneAutoPlay.broadcastName,s.channelId=e.oneToOneAutoPlay.channelId,s.id=e.oneToOneAutoPlay.broadcastId,s.config=JSON.parse(e.oneToOneAutoPlay.channelConfig),s.autoPlayType="call",e.oneToOneAutoPlay.isLive?(s.type="broadcast",s.status=broadcast.status):s.type="replay",stateService.setOneToOneAutoPlay(s)}logService.debug(r.LOGTAG,"initInfo processed"),stateService.setTokBoxApiKey(e.apiKey),e.labels&&serverInjectionService.updateLabels(e.labels),e.ctaMessage&&(stateService.setIsCtaCustomMessage(!0),i18nService.updateCTAMessage(e.ctaMessage)),e.activeTests&&(stateService.setActiveABTests(e.activeTests),mvtService.updateActiveMvtInLocalStorageIfChanged(e.activeTests)),r.isTestingPhase=e.isTestingPhase,stateService.setStrictLogging(!1),r.initInfoReceived=!0,r.onOtLoaded(),r.initGIS()}catch(e){logService.error(r.LOGTAG,"Exception at script init after server data received",e)}},r._setUserUUID=function(){if(utilitiesService.isRedirectedFromSocialWebview()){var e=utilitiesService.getSocialWebviewInfo();userService.setUserUUID(r.getUserConsent(),e[0]),stateService.setCallUserUUID(e[0]),stateService.setSocialRedirectionInfo(e[1])}else userService.setUserUUID(r.getUserConsent())},r.isServiceOffered=function(){var e=globalObjectService.getWindow().location.href;return r.serviceOffered?eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SERVICE_OFFERED,{referrer:e}):(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SERVICE_NOT_OFFERED,{referrer:e}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.SERVICE_NOT_OFFERED,{referrer:e})),r.serviceOffered},r._loadOT=function(){var e=function(){r.otSuccessCalled=!0,browserInfoService.isWebpSupported(r.checkBrowserFeatureSupport),r.onOtLoaded(),r.initGIS()};r._otError=function(e){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_INIT_FAILED),logService.error(r.LOGTAG,"Failed to load OT",e)},"function"==typeof window.require&&'MARRIOTT'!==serverInjectionService.getRetailerKey()&&'SOFOLOGY'!==serverInjectionService.getRetailerKey()?require([r.OPENTOK_SCRIPT_SRC],e,r._otError):gisService.loadScript(r.OPENTOK_SCRIPT_SRC,e,r._otError)},r.onOtLoaded=function(){if(r.otSuccessCalled&&r.initInfoReceived&&!r.otReceived)if(globalObjectService.getWindow().OT)1===OT.checkSystemRequirements()||stateService.isAndroidSocialBrowser()?(r.otReceived=!0,globalObjectService.getWindow().OT.on('exception',function(e){logService.error(r.LOGTAG,"OT Exception occurred.",e)}),logService.debug(r.LOGTAG,"OT loaded"),clientStorageService.clearLocalStorageFromOpenTokProps(),r.checkUserMediaSupport()):eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_BROWSER_NOT_SUPPORTED,{url:globalObjectService.getWindow().location.href});else{r._otError({message:"OT is not present in the window object"})}},r.checkUserMediaSupport=function(){otService.detectDevices(function(e){e?(logService.debug(r.LOGTAG,"Error on  OT device support.",e),systemInfoService.setUserMediaSupport(!1)):systemInfoService.setUserMediaSupport(!0),r.userMediaChecked=!0,r.initGIS()})},r.checkBrowserFeatureSupport=function(){r.isFeatureSupportChecked=!0,r.initGIS()},r.initGIS=function(){try{if(!r.isGisInitialized())return;uiUtilitiesService.setupGISPanels(),logService.log(r.LOGTAG,"GIS loaded."),r.executeOnGisLoadFunctions(),r.gisReady()}catch(e){logService.error(r.LOGTAG,"Failed to initialize due to exception.",e)}},r.isGisInitialized=function(){return(!r.isTestingPhase||2==utilitiesService.getUrlParams().gis)&&!!(r.cssReceived&&r.otReceived&&r.initInfoReceived&&r.userMediaChecked&&r.isFeatureSupportChecked)},r.gisReady=function(){try{stateService.setCurrentPhase(stateService.phase.READY),window.dispatchEvent(new GisCustomEvent("gisReady")),serverInjectionService.getApiEnabled()&&(window.gisApi=API.GisApi1_0,'function'==typeof window.onGisApiReady&&window.onGisApiReady(),stateService.getAPIStandardJourney()||Sym_Sys.availabilityAction()),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SCRIPT_INIT_SUCCESS,{timeElapsed:(performance.now()-window.gisProfilingStartTime).toFixed(3)}),pageUnloadService.registerFunction(function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PAGE_NAVIGATE)}),metadataService.parseMetadata(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PAGE_METADATA,{metadata:stateService.getPageMetadata()}),pollingService.registerPollingEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,{poll:Sym_Sys.checkClerkAvailability,pollArguments:[null,!0]}),pollingService.registerPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING,{poll:Sym_Sys.checkBroadcastAvailability,pollArguments:[]});var e=serverInjectionService.getSystemConfig();if(e.embedBroadcast&&e.embedBroadcast.enabled&&embedCtrl.isEmbed())stateService.setIsEmbed(!0),embedCtrl.init();else{var t=utilitiesService.isDirectCall(),i=utilitiesService.isDirectLinkBroadcast(),n=utilitiesService.isMeeting(),o=addAPersonService.isAddAPersonCall();utilitiesService.isDepartmentCall()&&directCallCtrl.init(GIS_CONSTANTS.DIRECT_CALL_TYPE.DEPARTMENT_CALL),t&&directCallCtrl.init(GIS_CONSTANTS.DIRECT_CALL_TYPE.CLERK_CALL),n&&meetingCtrl.init(),o&&callService.isAddAPersonEnabled()&&addAPersonCtrl.init(),i&&broadcastCtrl.startDirectLinkBroadcast(),serverInjectionService.getApiEnabled()&&!stateService.getAPIStandardJourney()||(availabilityCtrl.init(),t||i||!r.serviceOffered?stateService.setOneToOneChecked():Sym_Sys.checkClerkAvailability("clerkIsAvailable","clerkIsNotAvailable"),r.broadcastEnabled?e.broadcast.polling&&e.broadcast.polling.enabled?(pollingService.subscribe(pollingService.BASE_EVENTS.BROADCAST_POLLING,function(){},function(){}),pollingService.startPollingEvent(pollingService.BASE_EVENTS.BROADCAST_POLLING)):Sym_Sys.checkBroadcastAvailability():stateService.setBroadcastChecked(),serverInjectionService.getSystemConfig().persistentCta&&!pollingService.isPollingTimeExpiredForEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)&&(pollingService.subscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,Sym_Sys.clerkIsAvailable,Sym_Sys.clerkIsNotAvailable),pollingService.startPollingEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)))}'function'==typeof window.onGisInitialized&&window.onGisInitialized()}catch(e){logService.error(r.LOGTAG,"Exception when script ready.",e)}},r.executeOnGisLoadFunctions=function(){for(var e in r.onGisLoadFunctions)r.onGisLoadFunctions[e]()},r.isOptInAnalyticsAccepted=function(){return!1},r.getUserConsent=function(){return userService.isConsentProcessed()?userService.getUserConsent():GIS_CONSTANTS.COOKIES_PERMISSIONS.REJECTED},overrideService.override(r.LOGTAG,r),{init:r.init}};GISAPP.meetingCtrl=function(logService,stateService,serverInjectionService,gisService,utilitiesService,eventLoggerService,callCtrl,GIS_CONSTANTS,preCallScreen,modalComponent,uiUtilitiesService){'use strict';var e,t="gismeeting",s="CREATED",i="STARTED",r="CANCELLED",u="ENDED",o="MISSED",a="ERROR",l=!1;return{init:function(){e=utilitiesService.getUrlParams()[t],utilitiesService.isEncodedUri(e)&&(e=decodeURIComponent(e)),gisService.getMeetingStatus(e,"GISAPP.meetingCtrl.updateMeetingStatus")},updateMeetingStatus:function(e){if(e||e.status){var t=e.status;t===s||t===i?(e.sessionId&&stateService.setSessionId(e.sessionId),e.consumerToken&&stateService.setToken(e.consumerToken),l||(n=e,l||(l=!0),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isMeeting:!0,data:n}))):t===r?l||(l||(l=!0),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isCanceled:!0})):t===o?l||(l||(l=!0),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isMissed:!0})):t===a?l||(l||(l=!0),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isMeetingError:!0})):t===u&&(l||(l||(l=!0),callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.DIRECT,isMeetingEnded:!0})))}var n}}};GISAPP.replayCtrl=function(serverInjectionService,gaService,stateService,eventLoggerService,pageUnloadService,utilitiesService,videoJsCtrl,callCtrl,replayDOMProc,replayConnectDOMProc,contactCaptureCtrl,clientStorageService,gisService,videoSegmentComponent,availabilityService,GIS_CONSTANTS,pollingService,gisPlayerScreen,shopStreamService,urlUtilitiesService,callService,playerUtilService){'use strict';var o,i,E,n,A,a={},l=0,r={NAVIGATE:"navigate"},I=!1,S=null,t="AVAILABLE",_="UNAVAILABLE",C="NONE",T=C;function s(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PAUSE_BUTTON_CLICKED,{callUUID:stateService.getCallUUID(),shopStreamType:"replay",videoPauseTime:replayDOMProc.getVideoElement().currentTime}),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING)}function c(){if(T!==t){T=t;var e=serverInjectionService.getSystemConfig();stateService.setClerkAvailability(!0),d(e.persistentCta,!0)}}function u(){if(T!==_){T=_;var e=serverInjectionService.getSystemConfig();stateService.setClerkAvailability(!1),d(e.persistentCta,!1)}}function d(e,t){replayDOMProc.setOneToOneCtaOnReplay(e,t);var n=(performance.now()-window.gisProfilingStartTime).toFixed(3);t?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN_ON_REPLAY,{timeElapsed:n}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN_ON_REPLAY)):!t&&e&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_SHOWN_ON_REPLAY_UNAVAILABLE,{timeElapsed:n}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_SHOWN_ON_REPLAY_UNAVAILABLE)),function(t){if(!t||'function'!=typeof t)return;replayDOMProc.setOnCtaClickEvent(function(e){t(e)})}(function(e){callCtrl.startCallJourney({routingKey:null,type:GIS_CONSTANTS.CALL_TYPES.STANDARD},e),t?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK_FROM_REPLAY,{channelId:A.channelId}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK_FROM_REPLAY)):(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE_ON_REPLAY,{channelId:A.channelId}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE_ON_REPLAY)),callService.isRedirectJourney()||replayDOMProc.hide()})}function L(e,t){O(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SEGMENT_CLICKED,{playTime:o.currentTime(),segmentTime:e,segmentName:t,videoType:'replay',channelId:E.channelId,broadcastId:E.id,url:utilitiesService.getPageUrl(!0)}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.SEGMENT_CLICKED,{playTime:o.currentTime(),segmentTime:e,segmentName:t,videoType:'replay',channelId:E.channelId,broadcastId:E.id}),o.paused()?(o.one('timeupdate',function(){o.currentTime(e)}),o.play()):o.currentTime(e),S=t,n=new Date}function N(e){var t=serverInjectionService.getSystemConfig();if(stateService.setCurrentPhase(stateService.phase.REPLAY_END),o&&(o.pause(),o.currentTime(0),o.dispose()),o=null,a.broadcastContactCaptureData={broadcastId:E.id,viewDuration:R()},gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_DURATION,{duration:R()}),pageUnloadService.unregisterFunction(N),I=!1,l&&l(),stateService.setViewerRecId(null),stateService.setCurrentPhase(stateService.phase.READY),t&&t.captureInfo&&t.captureInfo.views&&!0===t.captureInfo.views.replay&&1<=a.broadcastContactCaptureData.viewDuration){var n=clientStorageService.getItem(clientStorageService.storageKeys.BROADCAST_CONTACT_CAPTURE)||{};n&&!n[a.broadcastContactCaptureData.broadcastId]&&contactCaptureCtrl.init("replay",a.broadcastContactCaptureData)}stateService.setCallUUID(null),T=C,t.oneToOneCta.broadcast&&A.config.oneToOneInBroadcast&&pollingService.unSubscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,c,u),pollingService.stopPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING),p(),eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_ACTIONS.CLOSED,{url:urlUtilitiesService.getUrlWithoutParamsWithLimit(500),broadcastId:E.id,callUUID:stateService.getCallUUID()}),playerUtilService.resetWatchedDuration()}function g(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PLAY_BUTTON_CLICKED,{callUUID:stateService.getCallUUID(),shopStreamType:"replay",videoPlayTime:replayDOMProc.getVideoElement().currentTime,channelId:A.channelId}),stateService.setCurrentPhase(stateService.phase.REPLAY_PLAYING),pollingService.startPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING);try{o.muted(!1)}catch(e){}I||(I=!0)}function O(){if(S){var e=((new Date).getTime()-n)/1e3;eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SEGMENT_VIEW_DURATION,{viewTime:e,segmentName:S,videoType:'replay',channelId:E.channelId,broadcastId:E.id,url:utilitiesService.getPageUrl(!0)}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.SEGMENT_VIEW_DURATION,{viewTime:e,segmentName:S,videoType:'replay',channelId:E.channelId,broadcastId:E.id}),S=null}}function p(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_USER_DURATION,{viewDuration:R(),callUUID:stateService.getCallUUID(),broadcastId:A.id,shopStreamType:"replay",channelId:A.channelId})}function R(){return playerUtilService.getWatchedTime()}return shopStreamService.isShopStreamEnabled()&&(replayDOMProc=new gisPlayerScreen({onPlay:g,onPause:s})),{playReplay:function(e,t){return stateService.setCurrentPhase(stateService.phase.REPLAY_START),e&&(E=e),E?(A=E,t&&(l=t),stateService.setCallUUID(e.callUUID),i=e.urls[0],pageUnloadService.registerFunction(N),pollingService.registerPollingEvent(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING,{poll:p,pollArguments:[]},!0),pollingService.subscribe(pollingService.BASE_EVENTS.BROADCAST_VIEW_DURATION_POLLING,function(){},function(){}),function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_ACTIONS.SHOWN,{url:urlUtilitiesService.getUrlWithoutParamsWithLimit(500),broadcastId:E.id,callUUID:stateService.getCallUUID()});var e=serverInjectionService.getSystemConfig(),t=!!e.replayConnectEnabled;if(t)replayConnectDOMProc.show(n),replayConnectDOMProc.setVideoSrc(i),replayConnectDOMProc.extendPlayer(playerUtilService.setup),replayConnectDOMProc.setOnClickClose(N),replayConnectDOMProc.setOnClickConnect(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.CONNECT_BUTTON+eventLoggerService.GIS_ACTIONS.CLICKED,{source:"replay"}),callCtrl.initiateCallProcedure()});else{var n=E.config.button1||E.config.button2,a=!!E.config.videoSegment,l=e.oneToOneCta.broadcast&&A.config.oneToOneInBroadcast;e.shopStream&&e.shopStream.enabled?replayDOMProc.show(l,A):replayDOMProc.show(n,a),replayDOMProc.setVideoSrc(i),replayDOMProc.extendPlayer(playerUtilService.setup),replayDOMProc.setOnClickClose(N),function(){var e=serverInjectionService.getSystemConfig(),t=e.goToShopBtn;t&&t.url&&replayDOMProc.setOnClickShop(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_VIEWS.LINK+eventLoggerService.GIS_ACTIONS.CLICKED,{url:t.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_LINK_CLICK,{url:t.url}),window.open(t.url,t.redirect===r.NAVIGATE?'_self':'_blank')});var n=e.specificPageBtn;n&&n.url&&replayDOMProc.setOnClickSpecificShop(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_VIEWS.LINK2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:n.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_LINK2_CLICK,{url:n.url}),window.open(n.url,n.redirect===r.NAVIGATE?'_self':'_blank')}),replayDOMProc.setOnClickRetailerCustomButton(function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_VIEWS.LINK2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:"RetailerCustomButton"}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_LINK2_CLICK,{url:"RetailerCustomButton"})});var a=E.config?E.config:null;a&&a.button1&&replayDOMProc.setupExtraButton(1,a.button1.label,function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_VIEWS.EXTRABTN1+eventLoggerService.GIS_ACTIONS.CLICKED,{url:a.button1.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_EXTRABTN1_CLICK,{url:a.button1.url}),window.open(a.button1.url,a.button1.redirect===r.NAVIGATE?'_self':'_blank')}),a&&a.button2&&replayDOMProc.setupExtraButton(2,a.button2.label,function(){eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.BROADCAST_REPLAY+eventLoggerService.GIS_VIEWS.EXTRABTN2+eventLoggerService.GIS_ACTIONS.CLICKED,{url:a.button2.url}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_EXTRABTN2_CLICK,{url:a.button2.url}),window.open(a.button2.url,a.button2.redirect===r.NAVIGATE?'_self':'_blank')})}()}o?o.play():shopStreamService.isShopStreamEnabled()||videoJsCtrl.initializePlayer('gis-playback-video',!t,!1,function(e){o=e,replayDOMProc.setPlayer(o),o.on("play",g),o.on("pause",function(){O(),s()}),o.on("ended",function(){O()}),o.play()}),a&&gisService.getVideoSegmentsByBroadcastId(E.id),serverInjectionService.getSystemConfig().oneToOneCta.broadcast&&A.config.oneToOneInBroadcast&&(pollingService.subscribe(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING,c,u),pollingService.startPollingEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING))}(),replayDOMProc.playVideo&&replayDOMProc.playVideo(),0):-1},displayVideoSegments:function(e){var t=document.getElementById('gis-segment-container'),n=new videoSegmentComponent({videoSegmentContainer:t,videoSegmentList:e,playTo:L});t.appendChild(n.render())}}};GISAPP.retailerFunctionalityCtrl=function(logService,uiUtilitiesService,overrideService){var i={};return i.uiUtilities=uiUtilitiesService,i.LOGTAG="retailerFunctionalityCtrl",i.LOGGER=logService,i.init=function(){},overrideService.override(i.LOGTAG,i),{init:i.init}};GISAPP.videoJsCtrl=function(logService,stateService,utilitiesService,deviceInfoService,gisService){'use strict';var r,u,c,d,e,n,s="videoJsCtrl",f=logService,a="https://vjs.zencdn.net/7.4.1/video.js",l="https://vjs.zencdn.net/7.4.1/video-js.css",t=0,o=0;function v(){r.on('error',i),r.on('dispose',m),r.on("pause",p),r.on("play",y),r.on("ended",j)}function i(n){var e=r.error();f.error(s,"VideoJS error",e),u()}function p(){n=(new Date).getTime(),t+=((o=n)-e)/1e3}function m(){if(0==o){var n=(new Date).getTime();t+=(n-e)/1e3}}function y(){c(),e=(new Date).getTime(),o=0}function j(){d()}return{initializePlayer:function(e,t,o,i){var n;(function(){}),u=function(){},c=function(){},d=function(){},n=function(){var n={controls:t,preload:'metadata',html5:{nativeTextTracks:!1},textTrackSettings:o,muted:!0};window.videojs&&(void 0!==window.videojs.VERSION&&"5"<window.videojs.VERSION.split('.')[0]?r=videojs(e,n,v):(r=videojs(e,n),v())),'function'==typeof i&&i(r)},null==window.videojs?gisService.loadVideoJs(a,function(){gisService.loadExternalCss(l,function(){"function"==typeof n&&n()},function(){f.error(s,"Failed to load VideoJs css")})},function(){f.error(s,"Failed to load VideoJs js")}):"function"==typeof n&&n()},registerOnCompleteAction:function(n){'function'==typeof n&&n},onError:function(n){'function'==typeof n&&(u=n)},getCurrentPlayTime:function(n){if(r){var e=r.currentTime();if(!n)return e;var t=utilitiesService.getTimeFromSeconds(e),o=new Date;return o.setHours(t.hour,t.minute,t.second),utilitiesService.getFormattedTime(o)}return-1},onVideoPlay:function(n){'function'==typeof n&&(c=n)},onVideoEnded:function(n){'function'==typeof n&&(d=n)},getWatchedDuration:function(){return t},resetWatchedDuration:function(){t=0},playVideo:function(){r&&r.play()},isVideoMute:function(){return!r||r.muted()},mute:function(n){r&&r.muted(n)},dispose:function(n){n?videojs.getPlayers()[n].dispose():r.dispose()},setCurrentPlayTime:function(n){r&&r.currentTime(n)},getPlayer:function(){return r}}};GISAPP.callScreen=function(callService,uiUtilitiesService,serverInjectionService,standardCallComponent,addToBasketRequestComponent,globalObjectService,GIS_CONSTANTS,stateService,logService,chatLoadService,dialPadComponent,eventLoggerService,baseShopStreamLayoutComponent,baseCallLayoutComponent,chatUserFormComponent,controlButtonComponent,productPopupComponent,utilitiesService,carouselService,deviceInfoService,bookingService,eventService,popup,ctaComponent,activityLoggerService,toastComponent){return function(t){'use strict';var v,i,n,s,r,a,o,L,c,l,C,d,N,u,g,p,h,S,_,m,E,I='chat-icon-container',A='badge',e='callScreen',T=!1,w=!1,f=!1,b=0,y='9+',O={NONE:'NONE',INCOMING_CALL:'INCOMING_CALL',START_CALL:'START_CALL',CHAT_INACTIVITY:'CHAT_INACTIVITY',END_CALL:"END_CALL",CALL_DECLINED:'CALL_DECLINED'},M=O.NONE,P=GIS_CONSTANTS.CHAT.INACTIVITY.CONVERSATION.ENDCALL_TIMEOUT,D={CLOSE_DESKTOP:"<svg width=\"28\" height=\"28\" viewBox=\"0 0 28 28\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M28 2.82L25.18 0L14 11.18L2.82 0L0 2.82L11.18 14L0 25.18L2.82 28L14 16.82L25.18 28L28 25.18L16.82 14L28 2.82Z\" fill=\"#1A1F26\"/></svg>"};function V(e){w=e.chatOnlyCall&&e.chatOnlyCall.enabled||!1,v=function(){{if(callService.isShopStreamCallEnabled()){l=new baseCallLayoutComponent,L=new baseShopStreamLayoutComponent({player:l.render()}),c=L.render();var e=new productPopupComponent({type:null,payload:null,popUpContainer:c.querySelector('#gis-ss-player-popup')});return eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.SHOW_PRODUCT_DETAILS_POPUP,e.triggerDetailsPopup),w&&uiUtilitiesService.addClass(c.querySelector('#gis-ss-left-pane'),'gis-hide'),c}return uiUtilitiesService.processView(serverInjectionService.getViews().callScreenView)}}(),i=callService.getElementReference(v,'#gis-std-call-view'),r=callService.getElementReference(v,'#gis-cs-signal-container'),function(){t.switchToFullScreen=de,t.switchToNormalScreen=ue,callService.isShopStreamCallEnabled()&&(t.controlLess=!0);n=new standardCallComponent(t),i.appendChild(n.render()),callService.isShopStreamCallEnabled()&&l.setBottomControls(n.getControlsView())}(),function(){if(!function(){if(w)return!0;if(deviceInfoService.isMobileDevice()&&callService.isShopStreamCallProductCarouselEnabled())return!0;return!1}())return;var e=v.querySelector('#gis-ss-right-pane'),t=uiUtilitiesService.processView(serverInjectionService.getViews().shopStreamChatCarouselToggle);Y(t),e.insertBefore(t,e.firstChild),W()?function(){if(!deviceInfoService.isMobileDevice()&&!w||deviceInfoService.isIPad()&&!w||!callService.isShopStreamCallEnabled()||!callService.isShopStreamCallProductCarouselEnabled()||!callService.isInCallChatEnabled())return;T=!0;var e=v.querySelector('#gis-ss-right-pane');uiUtilitiesService.addClass(e,'gis-toggle-enabled');var t=v.querySelector('#gis-ss-rightpane-header');!deviceInfoService.isMobileDevice()&&w||Y(t);var i=t.querySelector('#gis-ss-chat-tab');i.querySelector('#gis-ss-tab-text-chat').innerHTML=serverInjectionService.getLabels().oto_chat_toggle_label;var n=t.querySelector('#gis-ss-carousel-tab'),s=n.querySelector('#gis-ss-tab-text-carousel');s.innerHTML=serverInjectionService.getLabels().oto_carousel_toggle_label+' ',s.innerHTML=s.innerHTML+'<span id="gis-ss-carousel-count">('+(carouselService.getTiles().length-1)+')</span>',carouselService.addTileToCarouselCallback(function(){s.querySelector('#gis-ss-carousel-count').innerHTML='('+(carouselService.getTiles().length-1)+')'}),e.insertBefore(t,e.firstChild),n.onclick=J,i.onclick=z}():uiUtilitiesService.addClass(t.querySelector('#gis-ss-wrapper-tab'),'gis-ss-hide')}(),callService.isShopStreamCallEnabled()&&(!function(){callService.isShopStreamCallProductCarouselEnabled()&&(g=new controlButtonComponent({config:{states:{on:{image:'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="#0E0E10" /> </svg>',onclick:function(){deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()?se('carousel','carousel'):L.showLeftBottomContainer(),l.updateControlType("normal"),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_OPENED)},stateTransition:"off",style:"background: rgba(255, 255, 255, 0.63); border-radius: 25px; width: 40px; height: 40px; padding: 10px; order:2"},off:{image:'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="white" /> </svg>',onclick:function(){deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()||L.hideLeftBottomContainer(),l.updateControlType("compact"),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_HIDDEN)},stateTransition:"on",style:"order: 2"}},order:2,defaultState:"off"}}),(u=g.render()).setAttribute('id','gis-shop-stream-carousel-control'),l.addSideControls(u));var e;(utilitiesService.isMeeting()&&(bookingService.isMultiParticipantEnabled()||bookingService.isAddAPersonEnabled())||!utilitiesService.isMeeting()&&callService.isAddAPersonEnabled())&&((e=new controlButtonComponent({config:{states:{on:{image:'<svg width="24" height="13" viewBox="0 0 24 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5H5V2H3V5H0V7H3V10H5V7H8V5ZM18 6C18.4325 5.99939 18.8598 5.90525 19.2526 5.72405C19.6453 5.54284 19.9942 5.27885 20.2754 4.95018C20.5566 4.6215 20.7634 4.23591 20.8816 3.81984C20.9998 3.40377 21.0266 2.96706 20.9602 2.53965C20.8938 2.11224 20.7358 1.70424 20.497 1.34361C20.2582 0.98298 19.9442 0.678257 19.5766 0.45033C19.209 0.222403 18.7965 0.0766616 18.3673 0.0230972C17.9381 -0.0304672 17.5023 0.00941184 17.09 0.140001C17.6794 0.976896 17.9939 1.97639 17.99 3C17.9876 4.02265 17.6737 5.0203 17.09 5.86C17.3843 5.95337 17.6913 6.0006 18 6V6ZM13 6C13.5933 6 14.1734 5.82405 14.6667 5.49441C15.1601 5.16477 15.5446 4.69623 15.7716 4.14805C15.9987 3.59987 16.0581 2.99667 15.9424 2.41473C15.8266 1.83279 15.5409 1.29824 15.1213 0.878681C14.7018 0.459123 14.1672 0.173401 13.5853 0.0576455C13.0033 -0.0581102 12.4001 0.00129986 11.8519 0.228363C11.3038 0.455426 10.8352 0.839943 10.5056 1.33329C10.1759 1.82664 10 2.40666 10 3C9.99828 3.39445 10.0747 3.78533 10.2249 4.15008C10.375 4.51484 10.5959 4.84624 10.8748 5.12516C11.1538 5.40408 11.4852 5.62499 11.8499 5.77514C12.2147 5.9253 12.6056 6.00172 13 6V6ZM19.62 8.16C20.0453 8.50226 20.3896 8.93439 20.6282 9.4254C20.8667 9.91641 20.9937 10.4541 21 11V13H24V11C24 9.46 21.63 8.51 19.62 8.16ZM13 8C11 8 7 9 7 11V13H19V11C19 9 15 8 13 8Z" fill="white"/></svg>',onclick:function(){var e=new productPopupComponent({type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA,payload:{type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.ADD_A_PERSON},popUpContainer:c.querySelector('#gis-ss-player-popup'),isMultiParty:utilitiesService.isMeeting()&&bookingService.isMultiParticipantEnabled(),isOneToOneCall:!utilitiesService.isMeeting()});e.render(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_A_PERSON_BUTTON_CLICKED,{isMultiParty:bookingService.isMultiParticipantEnabled(),isAddAPerson:bookingService.isAddAPersonEnabled(),isOneToOneCall:!utilitiesService.isMeeting()})},stateTransition:"on",style:"order: 3"}},order:3,defaultState:"on"}}).render()).setAttribute('id','gis-shop-stream-add-a-person-control'),l.addSideControls(e))}(),callService.isShopStreamCallProductCarouselEnabled()&&(uiUtilitiesService.removeClass(v.querySelector('#gis-ss-carousel-content'),'gis-ss-hide'),S=carouselService.getCarouselComponentView({scrollEvent:eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_SCROLLED}),carouselService.updateOrientation("horizontal","horizontal"),uiUtilitiesService.addClass(S.querySelector('#gis-slider-content-container'),"gis-slider-x-scroll"),carouselService.addTileToCarousel({customTile:!0,image:'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="#2BBAE7"/></svg>',title:serverInjectionService.getLabels().product_tile_recommended_label}),L.setupLeftBottomContainer(S),carouselService.addTileToCarouselCallback(function(e,t){if(carouselService.getSliderInstance().slideToEnd(),c.querySelector("#gis-ss-left-bottom-pane").classList.contains('gis-ss-hide')){if(deviceInfoService.isMobileDevice()&&t.isRecommendedByClerk)return;u.click()}}))),uiUtilitiesService.showModal(v),w&&function(e){uiUtilitiesService.addClass(v.querySelector('#gis-ss-container'),"gis-chatfirst-call"),deviceInfoService.isMobileDevice()?uiUtilitiesService.addClass(v.querySelector('#gis-ss-container'),"gis-mobile"):(!function(){uiUtilitiesService.addClass(v.querySelector('#gis-ss-chat-close-btn'),'gis-hide');var e=uiUtilitiesService.createElementWithAttributes("div","gis-chatfirst-logo-header","gis-chatfirst-logo-header","background-image: "+uiUtilitiesService.getImageUrl("retailer-logo-dark.png"));v.querySelector('#gis-ss-header-content').append(e)}(),function(){var e=uiUtilitiesService.createElementWithAttributes("div","gis-chatfirst-callendcta","gis-chatfirst-callendcta");e.innerHTML=D.CLOSE_DESKTOP,e.onclick=k;var t=serverInjectionService.getUiConfig();t.theme&&(e.style.background=t.theme.mainColor);v.querySelector('#gis-ss-container').append(e)}(),uiUtilitiesService.addClass(v.querySelector('#gis-ss-right-pane'),'gis-chatFirstCall-compact-view'),uiUtilitiesService.addClass(v.querySelector('.gis-shop-stream-mobile-view'),'gis-row-full-width'),uiUtilitiesService.removeClass(v.querySelector('.gis-shop-stream-mobile-view'),'gis-shop-stream-row-compact'));callService.isShopStreamCallProductCarouselEnabled()&&j();(function(e){var t=uiUtilitiesService.createElementWithAttributes("div","gis-start-call-cta-label","gis-start-call-cta-label");t.innerHTML=serverInjectionService.getLabels().chat_to_call_transition_cta_label,v.querySelector('#gis-ss-start-call-btn').append(t);var i=Z(),n=serverInjectionService.getUiConfig();n.theme&&(v.querySelector('#gis-ss-start-call-btn').style.background=n.theme.mainColor);v.querySelector('#gis-ss-start-call-btn').append(i),te(),se('chat','chat'),'function'==typeof e.chatOnlyCall.startCallOnClick&&(v.querySelector("#gis-ss-start-call-btn").onclick=function(){f||function(e){if(M===O.START_CALL)return;M!==O.NONE&&x();clearTimeout(m);var t=eventLoggerService.GIS_VIEWS.CHAT_CALL_START_POPUP,i=new popup({type:GIS_CONSTANTS.POPUP_TYPE.START_CALL_PROMPT,position:'center',backgroundClass:'gis-chat-inactivity-notification-bg',popupContent:{image:Z(),mainText:serverInjectionService.getLabels().chat_to_call_transition_popup_title,subMainText:serverInjectionService.getLabels().chat_to_call_transition_popup_subtitle,primaryBtn:{label:serverInjectionService.getLabels().chat_to_call_transition_popup_primary_btn_label,onclick:function(){eventService.unsubscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_REACHED,H),eventService.unsubscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_CLEARED,R),clearTimeout(m),e.chatOnlyCall.startCallOnClick(),uiUtilitiesService.removeNode(v.querySelector('#gis-popup-wrapper')),M=O.NONE},eventName:t+"_START_CALL_BUTTON"},secondaryBtn:{label:serverInjectionService.getLabels().chat_to_call_transition_popup_secondary_btn_label,onclick:x,eventName:t+"_CANCEL_BUTTON"}}});eventLoggerService.logEvent(t+eventLoggerService.GIS_ACTIONS.SHOWN),v.querySelector('#gis-ss-container').append(i.render()),M=O.START_CALL}(e)})})(e),v.querySelector('#gis-ss-wrapper-content').style.removeProperty('height'),v.querySelector('#gis-ss-container').append(v.querySelector('#gis-ss-player-popup')),eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.COMETCHAT_LOGGED_IN,q)}(e),deviceInfoService.isMobileDevice()&&uiUtilitiesService.addClass(v.querySelector('#gis-ss-container'),"gis-mobile"),e.isArchivingEnabled?n.showRecordingTooltip():n.hideRecordingTooltip(),n.setUserProfileInfo({userDisplayName:o,userImageName:a}),B(),eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_REACHED,H),eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_CLEARED,R)}function q(e){var t=v.querySelector("iframe");null===(E=t.contentWindow.document.querySelector(".main__chat .chat__header"))?(!e||e<60)&&setTimeout(q.bind(null,e?e+1:1),250):E.style.display="none"}function U(){w=!1,uiUtilitiesService.removeClass(v.querySelector('#gis-ss-container'),"gis-chatfirst-call"),uiUtilitiesService.removeClass(v.querySelector('#gis-ss-right-pane'),'gis-chatFirstCall-compact-view'),uiUtilitiesService.removeClass(v.querySelector('.gis-shop-stream-mobile-view'),'gis-row-full-width'),uiUtilitiesService.addClass(v.querySelector('.gis-shop-stream-mobile-view'),'gis-shop-stream-row-compact'),v.querySelector('#gis-ss-player-view').append(v.querySelector('#gis-ss-player-popup')),deviceInfoService.isMobileDevice()||(E.style.display="flex",v.querySelector('#gis-ss-header-content').style.display="none",uiUtilitiesService.removeClass(v.querySelector('#gis-ss-right-pane'),'gis-toggle-enabled'),callService.isShopStreamCallProductCarouselEnabled()&&X())}function H(){if(M!==O.CHAT_INACTIVITY){M!==O.NONE&&x();var e=eventLoggerService.GIS_VIEWS.CHAT_CALL_INACTIVITY_POPUP,t=new popup({type:GIS_CONSTANTS.POPUP_TYPE.CHAT_INACTIVITY_PROMPT,position:'center',backgroundClass:'gis-chat-inactivity-notification-bg',popupContent:{mainText:serverInjectionService.getLabels().chat_inactivity_popup_title,subMainText:serverInjectionService.getLabels().chat_inactivity_popup_subtitle,primaryBtn:{label:serverInjectionService.getLabels().chat_inactivity_popup_primary_button_label,onclick:G.bind(null,!1),eventName:e+"_CALL_LEAVE_BUTTON"},secondaryBtn:{label:serverInjectionService.getLabels().chat_inactivity_popup_secondary_button_label,onclick:R,eventName:e+"_CANCEL_BUTTON"}}});eventLoggerService.logEvent(e+eventLoggerService.GIS_ACTIONS.SHOWN),v.querySelector('#gis-ss-container').append(t.render()),M=O.CHAT_INACTIVITY,m=setTimeout(G.bind(null,!0),1e3*P)}}function R(){clearTimeout(m),x()}function k(){if(M!==O.END_CALL){M!==O.NONE&&x();var e=eventLoggerService.GIS_VIEWS.CHAT_END_CALL_POPUP,t=new popup({type:GIS_CONSTANTS.POPUP_TYPE.END_CALL_PROMPT,position:'center',backgroundClass:'gis-chat-inactivity-notification-bg',popupContent:{image:Z(),mainText:serverInjectionService.getLabels().end_call_popup_title,subMainText:serverInjectionService.getLabels().end_call_popup_subtitle,primaryBtn:{label:serverInjectionService.getLabels().end_call_popup_primary_btn_label,onclick:function(){G(!1),uiUtilitiesService.removeNode(v.querySelector('#gis-popup-wrapper')),M=O.NONE},eventName:e+"_LEAVE_CALL_BUTTON"},secondaryBtn:{label:serverInjectionService.getLabels().end_call_popup_secondary_btn_label,onclick:function(){x()},eventName:e+"_CANCEL_BUTTON"}}});eventLoggerService.logEvent(e+eventLoggerService.GIS_ACTIONS.SHOWN),v.querySelector('#gis-ss-container').append(t.render()),M=O.END_CALL}}function x(){uiUtilitiesService.removeNode(v.querySelector('#gis-popup-wrapper')),M===O.START_CALL?eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.CHAT_CALL_START_POPUP+eventLoggerService.GIS_ACTIONS.CLOSED):M===O.INCOMING_CALL?eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.INCOMING_CALL_PROMPT+eventLoggerService.GIS_ACTIONS.CLOSED):M===O.CHAT_INACTIVITY&&eventLoggerService.logEvent(eventLoggerService.GIS_VIEWS.CHAT_CALL_INACTIVITY_POPUP+eventLoggerService.GIS_ACTIONS.CLOSED),M=O.NONE}function Z(){var e=serverInjectionService.getUiConfig(),t=new ctaComponent({ctaMode:"humanized",position:"right",roundelColor:e.theme&&e.theme.mainColor,roundelImage:"cta-logo.png",isCtaOnBroadcast:!0,isFloater:!0,shopStream:!0}).render();return uiUtilitiesService.addClass(t.querySelector("#gis-cta"),"gis-circle-animate-show"),t}function G(e){R(),$(),t.onLeaveButtonClick(),e&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY))}function B(){stateService.getInputAlignment()===GIS_CONSTANTS.INPUT_ALIGNMENT.RTL&&uiUtilitiesService.addClass(v.querySelector('#gis-cs-user-form-input'),'gis-rtl')}function W(){return(deviceInfoService.isMobileDevice()||w)&&callService.isShopStreamCallProductCarouselEnabled()&&callService.isInCallChatEnabled()}function Y(e){e.querySelector('#gis-ss-chat-close-btn').onclick=function(){w?k():T?W()?se(!1,!1):se(!1,'chat'):'off'===g.getCurrentState().stateTransition?se(!1,'carousel'):(g.updateState(null,"off"),se(!1,'chat'))}}function F(){uiUtilitiesService.removeClassOnList(v.querySelectorAll('.gis-ss-rightpane-tab'),'gis-ss-active-tab'),uiUtilitiesService.removeClass(v.querySelector('#gis-ss-right-pane'),'gis-ss-chat-active'),uiUtilitiesService.removeClass(v.querySelector('#gis-ss-right-pane'),'gis-ss-carousel-active'),''}function z(){F(),uiUtilitiesService.addClass(v.querySelector('.gis-ss-chat-tab'),'gis-ss-active-tab'),uiUtilitiesService.addClass(v.querySelector('#gis-ss-right-pane'),'gis-ss-chat-active'),'chat',C&&C()}function J(){F(),uiUtilitiesService.addClass(v.querySelector('.gis-ss-carousel-tab'),'gis-ss-active-tab'),uiUtilitiesService.addClass(v.querySelector('#gis-ss-right-pane'),'gis-ss-carousel-active'),'carousel'}function K(e){e.match(/landscape/)?uiUtilitiesService.addClass(c.querySelector("#gis-ss-left-bottom-pane"),'gis-ss-hide'):uiUtilitiesService.removeClass(c.querySelector("#gis-ss-left-bottom-pane"),'gis-ss-hide'),carouselService.refresh()}function j(){v.querySelector('.gis-ss-carousel-content').appendChild(S),carouselService.updateOrientation('mobile','horizontal mobile'),uiUtilitiesService.removeClass(S.querySelector('#gis-slider-content-container'),"gis-slider-x-scroll"),carouselService.refresh()}function X(){L.setupLeftBottomContainer(S),carouselService.updateOrientation('horizontal','horizontal'),uiUtilitiesService.addClass(S.querySelector('#gis-slider-content-container'),"gis-slider-x-scroll"),carouselService.refresh()}function Q(){}function $(){globalObjectService.getWindow().removeEventListener('messageReceived',ie),T=!1,n.destroy(),uiUtilitiesService.removeNode(v),uiUtilitiesService.hideModal()}function ee(e){return'none'===globalObjectService.getWindow().getComputedStyle(e).display}var te=utilitiesService.callOncePerSession(function(){callService.isInCallChatEnabled()&&(callService.isShopStreamCallEnabled()?(uiUtilitiesService.removeClass(v.querySelector('#gis-ss-chat-content'),"gis-ss-hide"),(d=(N=new controlButtonComponent({config:{states:{on:{image:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 0H2C0.9 0 0.00999999 0.9 0.00999999 2L0 20L4 16H18C19.1 16 20 15.1 20 14V2C20 0.9 19.1 0 18 0ZM4 7H16V9H4V7ZM12 12H4V10H12V12ZM16 6H4V4H16V6Z" fill="#0E0E10" /> </svg>',onclick:function(){b=0,d.setAttribute('data-counter',b),uiUtilitiesService.removeClass(d,'gis-counter'),se('chat','chat')},stateTransition:"off",style:"background: rgba(255, 255, 255, 0.63); border-radius: 25px; width: 40px; height: 40px; padding: 10px; order:1"},off:{image:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 0H2C0.9 0 0.00999999 0.9 0.00999999 2L0 20L4 16H18C19.1 16 20 15.1 20 14V2C20 0.9 19.1 0 18 0ZM4 7H16V9H4V7ZM12 12H4V10H12V12ZM16 6H4V4H16V6Z" fill="white" /> </svg>',onclick:function(){uiUtilitiesService.removeClass(d,'gis-counter'),se(!1,'chat')},stateTransition:"on",style:"order: 1"}},order:1,defaultState:"off"}})).render()).setAttribute('id',"gis-shop-stream-chat-control"),globalObjectService.getWindow().addEventListener("messageReceived",ie),l.addSideControls(d),le()):function(){var e=v.querySelector('#gis-cs-container');e.style.display='flex',e.style['flex-direction']='row';var t=uiUtilitiesService.createElementWithAttributes('img','','init-chat-icon');t.src=uiUtilitiesService.getImageUrl('init_chat_icon.png',!0);var i=uiUtilitiesService.createElementWithAttributes('div',I,I);i.append(t),callService.getElementReference(v,'#gis-cs-right-pane').style.display='none';var n=uiUtilitiesService.createElementWithAttributes('span',A,A,'display: none');i.append(n),v.querySelector('#gis-cs-left-pane').append(i),le()}(),B())},stateService.getCallUUID);function ie(e){"off"!==N.getCurrentState().stateTransition&&(++b<=9?d.setAttribute('data-counter',b):d.setAttribute('data-counter',y),uiUtilitiesService.addClass(d,'gis-counter'))}var ne=utilitiesService.once(function(){deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()&&(L.showLeftBottomContainer(),function(e,t){var i=globalObjectService.getWindow().matchMedia(e);try{i.addEventListener('change',t)}catch(e){try{i.addListener(t)}catch(e){console.error(e)}}return i}("(orientation: portrait)",function(e){e.matches?K('portrait'):K('landscape')}).matches?K('portrait'):K('landscape'))});function se(e,t){e?(uiUtilitiesService.removeClass(c.querySelector(".gis-shop-stream-right-chat-compact"),"gis-rightpane-disabled"),L.showRightContainer(),callService.isShopStreamCallProductCarouselEnabled()&&deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()&&j(),'string'==typeof e&&T&&('carousel'===e?v.querySelector('#gis-ss-carousel-tab').click():v.querySelector('#gis-ss-chat-tab').click()),t&&'carousel'===t?g.updateState(null,"on",!0):(C(),N.updateState(null,"on",!0))):('',uiUtilitiesService.addClass(c.querySelector(".gis-shop-stream-right-chat-compact"),"gis-rightpane-disabled"),L.hideRightContainer(),callService.isShopStreamCallProductCarouselEnabled()&&deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()&&X(),t&&'carousel'===t?g.updateState(null,"off",!0):t&&'chat'===t?N.updateState(null,"off",!0):(g&&g.updateState(null,"off",!0),N&&N.updateState(null,"off",!0)))}function ae(e){var t=document.querySelector(callService.getElementReference(null,'#gis-cs-right-pane',!0));stateService.getChatInitialized()||(callService.isShopStreamCallEnabled()&&(t=t.querySelector('#gis-ss-chat-content')),chatLoadService.loadChatInIframe(t,ce,e,w||(deviceInfoService.isMobileDevice()||deviceInfoService.isIPad())&&!callService.isShopStreamCallProductCarouselEnabled()&&callService.isInCallChatEnabled()||!deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()&&callService.isInCallChatEnabled()),stateService.setChatInitialized(!0)),uiUtilitiesService.show(callService.getElementReference(null,'#gis-cs-right-pane',!0).replace("#",""))}function oe(e,t,i,n,s,a){var o=v.querySelector('.'+I);GIS_CONSTANTS.CHAT.CURRENT_NUM_OF_USERS<=GIS_CONSTANTS.CHAT.MAX_NUM_OF_USERS?(C=function(e,t,i,n,s,a){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ONE_TO_ONE_CHAT_BUTTON_CLICKED),GISAPP.chatUserNameService.isNameConfigured()?ae(!1):GISAPP.chatUserNameService.openEnterUserForm(e,t,i,n,s,null,a,ce,!1,w),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_SHOWN_ON_ONE_TO_ONE)}.bind(null,e,t,i,n,s,a),o&&(o.onclick=C)):o.addEventListener('click',re)}function le(e){var o=callService.getElementReference(v,'#gis-cs-right-pane');v.querySelector('#gis-user-title')||(o.querySelector('.gis-ss-chat-content')?o.querySelector('.gis-ss-chat-content'):o).appendChild((new chatUserFormComponent).render());var t,i,n,s,a,l=o.getAttribute('id'),r=v.querySelector('#gis-user-title'),c=v.querySelector('#gis-user-secondary-title'),C=v.querySelector('#gis-cs-user-error-msg'),d=v.querySelector('#gis-cs-user-form-input'),u=v.querySelector('#gis-cs-submit-user-form-btn'),g=v.querySelector('.'+I),p=v.querySelector('#gis-cs-user-form-container').getAttribute('id'),h=u.getAttribute('id'),S=d.getAttribute('id'),_=C.getAttribute('id'),m=g?g.getAttribute('id'):null,E=serverInjectionService.getLabels().chat_userName_title,T=serverInjectionService.getLabels().chat_userName_instructions,f=serverInjectionService.getLabels().chat_userName_firstInput,b=serverInjectionService.getLabels().chat_joinChat_button,y=serverInjectionService.getLabels().chat_userName_secondary_title;r.innerHTML=E,c.innerHTML=y,C.innerHTML=T,u.innerHTML=b,d.innerHTML='',d.setAttribute("data-placeholder",f),callService.isShopStreamCallEnabled()||globalObjectService.getWindow().addEventListener('messageReceived',function(e){var t,i,n,s,a;e.detail[0].sender.uid!==stateService.getCallUserUUID()&&(t=e,i=A,n=o,s=v.querySelector('#'+A),a=0,ee(n)&&ee(s)&&uiUtilitiesService.show(i,'flex'),t.detail.forEach(function(e){'text'===e.type&&a++}),s.innerHTML=a)}),e?(t=l,i=p,n=h,s=S,a=_,callService.isShopStreamCallEnabled()&&(L.showRightContainer(),N.updateState(N.states,"on",!0)),GISAPP.chatUserNameService.isNameConfigured()?ae(!0):GISAPP.chatUserNameService.openEnterUserForm(t,i,n,s,null,"signal:CHAT_INITIATED",a,ce,!1,w)):oe(l,p,h,S,m,_)}function re(){logService.debug(e,'Amount of users reached its limitations')}function ce(){stateService.getChatInitialized()&&(callService.isShopStreamCallEnabled()?d?d.onclick():document.getElementById("gis-shop-stream-chat-control").onclick():uiUtilitiesService.hide(callService.getElementReference(null,'#gis-cs-right-pane',!0).replace("#",""))),callService.isShopStreamCallEnabled()||(uiUtilitiesService.show(I,'flex'),uiUtilitiesService.hide(A),stateService.setUpdateMessageId(!0))}function Ce(e,t){a=e,o=t}function de(){callService.isShopStreamCallEnabled()?L.showFullScreen():(v.querySelector('#gis-cs-left-pane').style.width='100%',v.querySelector('#gis-cs-left-pane').style.height='100%',v.querySelector('#gis-cs-container').classList.add('fullScreen-pane')),globalObjectService.getWindow().dispatchEvent(new GisCustomEvent(GIS_CONSTANTS.CALLSCREEN_MODE.GIS_CHAT_FULL_SCREEN))}function ue(){callService.isShopStreamCallEnabled()?L.hideFullScreen():(v.querySelector('#gis-cs-left-pane').style.removeProperty('width'),v.querySelector('#gis-cs-left-pane').style.removeProperty('height'),v.querySelector('#gis-cs-container').classList.contains('fullScreen-pane')&&v.querySelector('#gis-cs-container').classList.remove('fullScreen-pane')),globalObjectService.getWindow().dispatchEvent(new GisCustomEvent(GIS_CONSTANTS.CALLSCREEN_MODE.GIS_CHAT_NORMAL_SCREEN))}function ge(){p.updateState(null,"off",!0)}return{render:V,show:function(e){V(e)},hide:$,enableChat:ae,setOnMicClick:Q,setOnSpeakerClick:Q,setOnEndCallClick:Q,setOnHelpUnblockClick:Q,changeMicIcon:Q,changeSpeakerIcon:Q,setupClerkProfile:Ce,updateMessage:Q,hideMicShareOverlay:Q,displayControls:Q,disableChat:ce,enableControlSlide:Q,updateOverlayTo:Q,overlayStages:Q,showNoVideoImage:function(e){n.showNoVideoImage(e)},hideNoVideoImage:function(e){n.hideNoVideoImage(e)},showReconnectingMessage:function(){n.showReconnectingMessage()},showDisconnectedMessage:function(e){n.showDisconnectedMessage(e)},updateCallScreenOverlayStatus:function(){n.updateCallScreenOverlayStatus()},hideCallStatusDialog:function(){n.hideCallStatusDialog()},setPublishedVideo:function(e){return n.addVideo(e)},disableCamMuteMuteBtn:Q,setOnCamClick:function(){n.setCameraToggle()},setOnCameraSwitch:function(){n.setOnCameraSwitch()},changeCamIcon:Q,setupTapToFocus:Q,hideCallController:Q,setCallControllerAnimation:Q,destroyEventListeners:Q,showRecordingTooltip:function(){n&&n.showRecordingTooltip()},hideRecordingTooltip:function(){n&&n.hideRecordingTooltip()},updateConnectionCount:function(e){n.updateConnectionCount(e)},hideVideoOfClerk:Q,showVideoOfClerk:Q,addStream:function(e){w||te(),globalObjectService.getWindow().dispatchEvent(new GisCustomEvent(GIS_CONSTANTS.CALLSCREEN_MODE.NORMAL_SCREEN));var t=JSON.parse(e.connection.data);return t.isIVREnabled&&function(e){if(_=v.querySelector('#gis-dial-pad-main-container'),uiUtilitiesService.hasChildNodes(_))s.showDialPad();else if(s=new dialPadComponent({resetDialPadZIndex:function(){_.style.zIndex='1'},sessionId:stateService.getSessionId(),connectionId:e,onCloseCallback:callService.isShopStreamCallEnabled()?ge:Q}),_.style.display='block',_.style.zIndex='11',_.appendChild(s.render()),callService.isShopStreamCallEnabled())p=new controlButtonComponent({config:{states:{on:{image:'<svg width="16" height="22" viewBox="0 0 16 22" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M8 18C6.9 18 6 18.9 6 20C6 21.1 6.9 22 8 22C9.1 22 10 21.1 10 20C10 18.9 9.1 18 8 18ZM2 0C0.9 0 0 0.9 0 2C0 3.1 0.9 4 2 4C3.1 4 4 3.1 4 2C4 0.9 3.1 0 2 0ZM2 6C0.9 6 0 6.9 0 8C0 9.1 0.9 10 2 10C3.1 10 4 9.1 4 8C4 6.9 3.1 6 2 6ZM2 12C0.9 12 0 12.9 0 14C0 15.1 0.9 16 2 16C3.1 16 4 15.1 4 14C4 12.9 3.1 12 2 12ZM14 4C15.1 4 16 3.1 16 2C16 0.9 15.1 0 14 0C12.9 0 12 0.9 12 2C12 3.1 12.9 4 14 4ZM8 12C6.9 12 6 12.9 6 14C6 15.1 6.9 16 8 16C9.1 16 10 15.1 10 14C10 12.9 9.1 12 8 12ZM14 12C12.9 12 12 12.9 12 14C12 15.1 12.9 16 14 16C15.1 16 16 15.1 16 14C16 12.9 15.1 12 14 12ZM14 6C12.9 6 12 6.9 12 8C12 9.1 12.9 10 14 10C15.1 10 16 9.1 16 8C16 6.9 15.1 6 14 6ZM8 6C6.9 6 6 6.9 6 8C6 9.1 6.9 10 8 10C9.1 10 10 9.1 10 8C10 6.9 9.1 6 8 6ZM8 0C6.9 0 6 0.9 6 2C6 3.1 6.9 4 8 4C9.1 4 10 3.1 10 2C10 0.9 9.1 0 8 0Z" fill="#0E0E10" /></svg>',onclick:function(){s.showDialPad(),_.style.display='block',_.style.zIndex='11',uiUtilitiesService.addClass(i,'gis-ivrActive')},stateTransition:"off",style:"background: rgba(255, 255, 255, 0.63); border-radius: 25px; width: 40px; height: 40px; padding: 10px;"},off:{image:'<svg width="16" height="22" viewBox="0 0 16 22" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M8 18C6.9 18 6 18.9 6 20C6 21.1 6.9 22 8 22C9.1 22 10 21.1 10 20C10 18.9 9.1 18 8 18ZM2 0C0.9 0 0 0.9 0 2C0 3.1 0.9 4 2 4C3.1 4 4 3.1 4 2C4 0.9 3.1 0 2 0ZM2 6C0.9 6 0 6.9 0 8C0 9.1 0.9 10 2 10C3.1 10 4 9.1 4 8C4 6.9 3.1 6 2 6ZM2 12C0.9 12 0 12.9 0 14C0 15.1 0.9 16 2 16C3.1 16 4 15.1 4 14C4 12.9 3.1 12 2 12ZM14 4C15.1 4 16 3.1 16 2C16 0.9 15.1 0 14 0C12.9 0 12 0.9 12 2C12 3.1 12.9 4 14 4ZM8 12C6.9 12 6 12.9 6 14C6 15.1 6.9 16 8 16C9.1 16 10 15.1 10 14C10 12.9 9.1 12 8 12ZM14 12C12.9 12 12 12.9 12 14C12 15.1 12.9 16 14 16C15.1 16 16 15.1 16 14C16 12.9 15.1 12 14 12ZM14 6C12.9 6 12 6.9 12 8C12 9.1 12.9 10 14 10C15.1 10 16 9.1 16 8C16 6.9 15.1 6 14 6ZM8 6C6.9 6 6 6.9 6 8C6 9.1 6.9 10 8 10C9.1 10 10 9.1 10 8C10 6.9 9.1 6 8 6ZM8 0C6.9 0 6 0.9 6 2C6 3.1 6.9 4 8 4C9.1 4 10 3.1 10 2C10 0.9 9.1 0 8 0Z" fill="white" /></svg>',onclick:function(){s.hideDialPad(),_.style.display='none',_.style.zIndex='1',uiUtilitiesService.removeClass(i,'gis-ivrActive')},stateTransition:"on"}},order:20,defaultState:"on"}}),(h=p.render()).setAttribute('id','gis-shop-stream-ivr-control'),l.addSideControls(h);else{var t=v.querySelector('#gis-dial-pad-icon');t.style.display='flex',t.onclick=function(){s.showDialPad(),_.style.zIndex='11',uiUtilitiesService.addClass(i,'gis-ivrActive')}}}(e.connection.connectionId),"CLERK"===t.userType&&t.publisher?(Ce(t.publisher.imgName,t.publisher.displayName),n.setUserProfileInfo({userDisplayName:o,userImageName:a})):"CONSUMER"===t.userType&&(Ce(null,n.getDisplayNameFromStream(e)),n.setUserProfileInfo({userDisplayName:n.getDisplayNameFromStream(e),userImageName:null})),n.addStream(e)},getMainVideoStreamId:function(){return n.getMainVideoStreamId()},removeVideoWhenClerkLeave:function(e){n.removeVideoWhenClerkLeave(e)},changeVideoDimension:function(e){n.changeVideoDimension(e)},setSubscriberVideoState:Q,showSignalMessage:function(e,t,i){var n=JSON.parse(e.data),s=JSON.parse(e.from.data).publisher,a={data:n,onAccept:t,onReject:i,exit:function(){r.style.display='none',r.innerHTML=''},clerkImageURL:uiUtilitiesService.getClerkImageUrl(s.imgName||'clerk-default'),clerkName:s.displayName};if(callService.isShopStreamCallEnabled()&&callService.isShopStreamCallProductCarouselEnabled())a.type=GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.SHARED,a.data.id=a.data.productCode,a.data.onAccept=a.onAccept,new productPopupComponent({type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA,payload:a,popUpContainer:c.querySelector('#gis-ss-player-popup')}).render(),ne();else{var o=new addToBasketRequestComponent(a);if(r.innerHTML='',r.appendChild(o.render()),callService.isShopStreamCallEnabled()&&!callService.isShopStreamCallProductCarouselEnabled()){var l=r.children[0];uiUtilitiesService.addClass(l,"gis-ss-carousel-prompt"),l.style.background="white",l.style.height="auto",l.style.padding="15px 0",l.style.top="0",l.style.display="flex",l.style.flexDirection="column",l.style.bottom="auto",uiUtilitiesService.removeClass(r,"gis-ss-hide")}else r.style.animation='1s gis-call-signal-container-show forwards';r.style.display='block'}},showAssistantIsJoining:function(){n.showAssistantIsJoining()},showConnectingToLobby:function(){n.showConnectingToLobby()},showWaitingForAssistant:function(){n.showWaitingForAssistant()},setCallStatus:function(e){n.setCallStatus(e)},showPoorConnectionMessage:function(){n.showPoorConnectionMessage()},showVideoDisabledMessage:function(){n.showVideoDisabledMessage()},hideVideoDisabledMessage:function(){n.hideVideoDisabledMessage()},hidePoorConnectionMessage:function(){n.hidePoorConnectionMessage()},checkChatInitiationType:le,addRecommendedProduct:function(e){if(callService.isShopStreamCallEnabled()&&callService.isShopStreamCallProductCarouselEnabled()&&(carouselService.addTileToCarousel(e),deviceInfoService.isMobileDevice())){var t=carouselService.getTileFromCarousel(e.productCode).render();t&&(new productPopupComponent({type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO,payload:{type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO_TYPES.CAROUSEL_PROMPT},popUpContainer:c.querySelector('#gis-ss-player-popup'),productTile:t}).render(),ne())}},showAVCallView:function(){M!==O.NONE&&x(),uiUtilitiesService.removeClass(c.querySelector('#gis-ss-left-pane'),'gis-hide'),v.querySelector("#gis-ss-start-call-btn").style.display='none',ce(),U()},showIncomingCallPopUp:function(e,t){if(M!==O.INCOMING_CALL){M!==O.NONE&&x(),f=!0,clearTimeout(m);var i=eventLoggerService.GIS_VIEWS.CHAT_INCOMING_CALL_POPUP,n=new popup({type:GIS_CONSTANTS.POPUP_TYPE.INCOMING_CALL_PROMPT,position:'center',backgroundClass:'gis-chat-inactivity-notification-bg',popupContent:{image:Z(),mainText:serverInjectionService.getLabels().incoming_call_popup_title,primaryBtn:{label:serverInjectionService.getLabels().incoming_call_popup_primary_btn_label,onclick:function(){f=!1,eventService.unsubscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_REACHED,H),eventService.unsubscribe(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_CLEARED,R),e(),uiUtilitiesService.removeNode(v.querySelector('#gis-popup-wrapper')),M=O.NONE},eventName:i+"_ACCEPT_CALL_BUTTON"},secondaryBtn:{label:serverInjectionService.getLabels().incoming_call_popup_secondary_btn_label,onclick:function(){f=!1,t(),x()},eventName:i+"_DECLINE_BUTTON"}}});eventLoggerService.logEvent(i+eventLoggerService.GIS_ACTIONS.SHOWN),v.querySelector('#gis-ss-container').append(n.render()),M=O.INCOMING_CALL}},showCallDeclinedNotification:function(){var e=eventLoggerService.GIS_VIEWS.CHAT_OUTGOING_CALL_DECLINED;deviceInfoService.isMobileDevice()?function(e){M!==O.NONE&&x(),clearTimeout(m);var t=new toastComponent({description:serverInjectionService.getLabels().call_declined_toast_message});v.querySelector('#gis-ss-container').append(t.render()),t.show()}():function(e){if(M!==O.CALL_DECLINED){M!==O.NONE&&x(),clearTimeout(m);var t=new popup({type:GIS_CONSTANTS.POPUP_TYPE.OUTGOING_CALL_DECLINED,position:'center',backgroundClass:'gis-chat-inactivity-notification-bg',popupContent:{mainText:serverInjectionService.getLabels().call_declined_popup_title,subMainText:serverInjectionService.getLabels().call_declined_popup_text,primaryBtn:{label:serverInjectionService.getLabels().call_declined_popup_primary_btn_label,onclick:function(){uiUtilitiesService.removeNode(v.querySelector('#gis-popup-wrapper')),M=O.NONE},eventName:e+"_CALL_DECLINED_POPUP_BUTTON"}}});v.querySelector('#gis-ss-container').append(t.render()),M=O.CALL_DECLINED}}(e),eventLoggerService.logEvent(e+eventLoggerService.GIS_ACTIONS.SHOWN)},revertChatFirstCallLayout:U}}};GISAPP.connectingScreen=function(systemInfoService,logService,gisService,uiUtilitiesService,serverInjectionService,deviceInfoService,validationUtilitiesService,eventLoggerService,emailSubmitComponent,buttonComponent,stateService,overrideService,modalVideoComponent,modalContentComponent,bookingService){return function(t){'use strict';var o={};function n(e,n,t){o.components.contentContainer.subviews.connectingFooter.style.display='none',uiUtilitiesService.appendView(o.components.contentContainer.subviews.contentContainer,t),o.components.contentContainer.subviews.mainText.innerHTML=e,o.components.contentContainer.subviews.secondaryText.innerHTML=n}return o.components={},o.LOGTAG="connectingScreen",o.props=t,o.serverInjectionService=serverInjectionService,o.labels=o.serverInjectionService.getLabels(),o.awaitingPhase=!1,o.isNoClerkAvailableShown=!1,o.isSubmissionInProgress=!1,o.connectingVideo="/connecting.mp4",o.EVENT_LOGTAG=eventLoggerService.GIS_VIEWS.CONNECTING,o.render=function(){return o.isNoClerkAvailableShown=!1,o.view=uiUtilitiesService.processView(" ",{},!0),o.videoContainer=new modalVideoComponent({video:o.connectingVideo}),o.components.videoContainer=o.videoContainer.render(),uiUtilitiesService.appendView(o.view,o.components.videoContainer),o.components.contentContainer=new modalContentComponent({enterAnimation:"fullscreen",mainText:{text:o.labels.connecting_v2_mainText1},connectingScreenDisclaimerText:o.labels.connectingScreen_v2_disclaimer}),uiUtilitiesService.appendView(o.view,o.components.contentContainer.render()),uiUtilitiesService.addClass(o.components.contentContainer.subviews.connectingFooter,'gis-connectingv3-footer'),uiUtilitiesService.removeClass(o.components.contentContainer.subviews.connectingFooter,'gis-hide'),t.hideFooter&&t.hideFooter(),t.extendOnClose(o._hide),o.components.contentContainer.subviews.mainText.style.fontWeight="400",o.components.contentContainer.subviews.mainText.style.fontSize="16px",o.components.contentContainer.subviews.mainText.style.fontStyle="normal",o.components.contentContainer.subviews.mainText.style.lineHeight="19px",o.components.contentContainer.subviews.mainText.style.letterSpacing="0px",o.components.contentContainer.subviews.mainText.style.textAlign="center",deviceInfoService.isMobileDevice()&&(o.components.videoContainer.style.width="100vw",o.components.contentContainer.subviews.content.style.bottom="0"),setTimeout(function(){o.components.videoContainer.style.display="block"},2e3),setTimeout(function(){o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-out forwards",setTimeout(function(){t.extraProps&&t.extraProps.noClerkAvailable?o._setNoClerkAvailableUI():(o.awaitingPhase=!0,o._setConnectingUI(),o.components.contentContainer.setup({mainText:t.extraProps.isChatFirstCall?{text:o.labels.connecting_v2_chatText}:{text:o.labels.connecting_v2_mainText2},topImage:"connecting.svg",connectingScreenDisclaimerText:o.labels.connectingScreen_v2_disclaimer}),o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-in forwards",uiUtilitiesService.addClass(o.components.contentContainer.subviews.topImage,"gis-rotate"))},1500)},6e3),o.view},o.setNoClerkAvailable=function(){o.isNoClerkAvailableShown=!0,o.awaitingPhase?(clearTimeout(o.animationTimeout),o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-out forwards",o.animationTimeout=setTimeout(function(){o._setNoClerkAvailableUI()},1500)):(t.extraProps||(t.extraProps={}),t.extraProps.noClerkAvailable=!0);var e=o.serverInjectionService.getSystemConfig();e&&e.noOneAvailableBlock&&e.noOneAvailableBlock.enable&&(GISAPP.noClerkAvailableScreenShown=!0)},o._setConnectingUI=function(){o.animationTimeout=setTimeout(function(){o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-out forwards",o.animationTimeout=setTimeout(function(){o.components.contentContainer.subviews.mainText.innerHTML=o.labels.connecting_v2_mainText3,o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-in forwards",eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.RESPECT_MESSAGE_DISPLAYED_ON_CONNECTING_SCREEN),o.animationTimeout=setTimeout(function(){o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-out forwards",o.animationTimeout=setTimeout(function(){o.components.contentContainer.subviews.mainText.innerHTML=o.labels.connecting_v2_mainText4,o.components.contentContainer.subviews.mainText.style.animation="1s gis-fade-in forwards"},1500)},7e3)},1500)},7e3)},o._setNoClerkAvailableUI=function(){o.EVENT_LOGTAG=eventLoggerService.GIS_VIEWS.NO_CLERK_AVAILABLE;var e=o.serverInjectionService.getSystemConfig();bookingService.isBookingEnabled()?(o.button=new buttonComponent({buttonLabel:serverInjectionService.getLabels().schedule_booking_button_label,onClick:function(){t.extraProps.setBookingWidget()},eventName:o.EVENT_LOGTAG+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,buttonClass:"gis-secondary-button"}),n(o.labels.connecting_v2_noClerk_booking_mainText,o.labels.connecting_v2_noClerk_booking_secondaryText,o.button.render())):e&&e.captureInfo&&e.captureInfo.views&&!0===e.captureInfo.views.clerkUnavailable?(o.emailTextBox=new emailSubmitComponent({textBoxPlaceHolder:o.labels.noClerkAvailableScreen_emailFieldLabel,textBoxLabel:o.labels.noClerkAvailableScreen_emailErrorLabel,buttonClick:o._submitContact}),n(o.labels.connecting_v2_noClerkCaptureInfo_mainText,o.labels.connecting_v2_noClerkCaptureInfo_secondaryText,o.emailTextBox.render())):(o.button=new buttonComponent({buttonLabel:o.labels.connecting_v2_noClerk_buttonLabel,onClick:t.closeButton.onclick}),n(o.labels.connecting_v2_noClerk_mainText,o.labels.connecting_v2_noClerk_secondaryText,o.button.render())),o.components.contentContainer.subviews.secondaryText.style.visibility="hidden",o.components.contentContainer.subviews.secondaryText.style.display="block",o.components.contentContainer.subviews.topImage.style.display="none",o.components.contentContainer.subviews.mainText.style.animation="2s gis-fade-in forwards",o.components.contentContainer.subviews.secondaryText.style.animation="2s gis-fade-in forwards",o.components.contentContainer.subviews.secondaryText.style.visibility="visible",o.components.contentContainer.subviews.mainText.style.fontWeight="700",o.components.contentContainer.subviews.mainText.style.fontSize="20px",o.components.contentContainer.subviews.mainText.style.fontStyle="normal",o.components.contentContainer.subviews.mainText.style.lineHeight="23px",o.components.contentContainer.subviews.mainText.style.letterSpacing="0px",o.components.contentContainer.subviews.mainText.style.textAlign="center",eventLoggerService.logEvent(o.EVENT_LOGTAG+eventLoggerService.GIS_ACTIONS.SHOWN,{routingKey:stateService.getRoutingKey()})},o._submitContact=function(){if(!o.isSubmissionInProgress){o.isSubmissionInProgress=!0,o.emailTextBox.disableButton();var e={source:"connecting-v2",contact:{email:o.emailTextBox.getText().toLowerCase().trim()}},n=btoa(JSON.stringify(e));gisService.submitContactDetails(n,function(){o.isSubmissionInProgress=!1,o.emailTextBox.enableButton(),t.closeButton.onclick()},function(){o.isSubmissionInProgress=!1,logService.error(o.LOGTAG,"Error on submitting contact info from ConnectingV2."),o.emailTextBox.enableButton(),o.emailTextBox.showError("Failed to submit email address.")})}},o._hide=function(){eventLoggerService.logEvent(o.EVENT_LOGTAG+eventLoggerService.GIS_ACTIONS.CLOSED,{routingKey:stateService.getRoutingKey()}),o.isSubmissionInProgress=!1,o.emailTextBox&&o.emailTextBox.enableButton(),stateService.setCanceledOnConnectingScreen(!0),t.extraProps.isChatFirstCall||t.ctrlFunctions.endCall()},overrideService.override(o.LOGTAG,o),{render:o.render,setNoClerkAvailable:o.setNoClerkAvailable}}};GISAPP.gisPlayerScreen=function(serverInjectionService,globalObjectService,logService,GIS_CONSTANTS,stateService,uiUtilitiesService,videoPlayerComponent,deviceInfoService,shopStreamVideoHeaderComponent,eventService,ctaComponent,chatInputDOMProc,clientStorageService,iframeService,sliderComponent,productCarouselTileComponent,gisService,shopStreamService,utilitiesService,eventLoggerService,layoutService,productPopupComponent,carouselService,addToCartService,systemInfoService,chatGroupService,chatUserNameService,chatComponent){return function(s){var l,y,b,T,i,r,O,t,a,o,n,d,c,g,u,f,C,h,p,S,m,E,v,e,_,A,D,P,L,N,I,R,M,U,H,k,V,q,w=!1,x=!1,F='gisPlayerScreen',B=globalObjectService.getWindow().screen,G=[],W=[],z={BROADCAST_FOUND:0,BROADCAST_NOT_FOUND:1,INVALID_ALIAS:2},Q=serverInjectionService.getLabels().mobile_product_toggle_label,Y=serverInjectionService.getUiConfig(),K=serverInjectionService.getSystemConfig(),j=K.shopStream,J=!1,X=!1,Z={},$=!1,ee=!1,se=!1,ie=!1,te=!1,ae=!1;function oe(){if(X=!1,y=uiUtilitiesService.processView(serverInjectionService.getViews().gisPlayerView,{}),o=y.querySelector('#gis-player-close-button-container'),n=y.querySelector('#gis-player-close-button'),A=y.querySelector('#gis-mobile-portrait-player-header'),a=y.querySelector('#gis-player-video-header'),r=y.querySelector('#gis-player-video-container'),T=y.querySelector('#gis-player-right-pane'),t=y.querySelector('#gis-player-left-pane'),I=carouselService.getCarouselComponentView({hiddenArrowsLogic:function(){return deviceInfoService.isMobileDevice()||deviceInfoService.isIPad()&&layoutService.getOrientation().match(/portrait/)}}),(i=y.querySelector('#gis-product-carousel-container')).appendChild(I),O=y.querySelector('#gis-player-container'),g=y.querySelector('#gis-player-secondary-cta-container'),f=y.querySelector('#gis-player-chat-container'),p=y.querySelector('#gis-player-overlay-message'),stateService.getInputAlignment()===GIS_CONSTANTS.INPUT_ALIGNMENT.RTL&&uiUtilitiesService.addClass(p,'gis-rtl'),gisCallbacks.productsForBroadcastCallback=ue,gisCallbacks.checkCarouselUpdatedCallback=We,gisCallbacks.updateCarousel=ze,E=new videoPlayerComponent({width:'100%',height:'100%',onFullScreen:Ee,initialScreen:De,onChatClick:me,onProductClick:ve,onPlay:s.onPlay,onPause:s.onPause}),l=E.render(),se=deviceInfoService.isMobileDevice()?(E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),ee=!1):(ee=!!shopStreamService.isChatEnabledForShopStream(b)||(E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),!1),!!shopStreamService.isProductCarouselEnabledForShopStream()||(E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),!1)),ke(),C=l.querySelector('#gis-vc-chat'),h=l.querySelector('#gis-vc-product'),u=y.querySelector('#gis-player-cta-container'),d=y.querySelector('#gis-player-cta'),(deviceInfoService.isMobileDevice()||X)&&(Me(),uiUtilitiesService.addClass(a,'gis-mobile'),uiUtilitiesService.addClass(i,'gis-hide'),de()),deviceInfoService.isMobileDevice()&&layoutService.applyIf(Se.bind(null,'landscape'),Se.bind(null,'portrait'),[function(){return layoutService.getOrientation().match(/landscape/)}]),n.onclick=Ge,layoutService.resizeCallback(be),layoutService.resizeCallback(Te),deviceInfoService.isIPad()?layoutService.orientationChangeCallback(le.bind(null,!1),!0):deviceInfoService.isMobileDevice()||layoutService.resizeCallback(le.bind(null,!1),!0),r.appendChild(l),m=y.querySelector('#gis-video'),uiUtilitiesService.showModal(y),b&&0===b.status?(uiUtilitiesService.addClass(i,'gis-hide'),uiUtilitiesService.addClass(f,'gis-hide'),l.querySelector('#gis-video-controls-container').style.display='none'):(function(){if(!shopStreamService.isChatEnabledForShopStream(b)||!b||10===b.status&&'replay'!==b.type)return uiUtilitiesService.addClass(f,'gis-hide');var e=b.config&&b.config.chat&&b.config.chat.type||j.chat.type;if('replay'===b.type&&b.isChatProcessed&&'group'===e){var s=new chatComponent({type:e,videoPlayer:E,broadcast:b,onChatClick:E.internalToggleChat}),i=s.render();return t=i,uiUtilitiesService.removeClass(T,'gis-hide'),uiUtilitiesService.removeClass(f,'gis-hide'),uiUtilitiesService.removeClass(O,'gis-video'),uiUtilitiesService.addClass(O,'gis-video-chat'),f.appendChild(t),X||deviceInfoService.isMobileDevice()||E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),E.internalToggleChat(!0),le(!(ee=!0))}var t;var a=y.querySelector('#gis-user-title'),o=y.querySelector('#gis-user-secondary-title'),l=y.querySelector('#gis-user-error-msg'),r=y.querySelector('#gis-user-form-input'),n=y.querySelector('#gis-submit-user-form-btn'),d=y.querySelector('#gis-player-right-pane').getAttribute('id'),c=y.querySelector('#gis-user-form-container').getAttribute('id'),g=n.getAttribute('id'),u=r.getAttribute('id'),C=l.getAttribute('id'),h=serverInjectionService.getLabels().chat_userName_title,p=serverInjectionService.getLabels().chat_userName_secondary_title,S=chatUserNameService.isNameConfigured()?chatUserNameService.getUserName():serverInjectionService.getLabels().chat_userName_firstInput,m=serverInjectionService.getLabels().chat_joinChat_button;a.innerHTML=h,o.innerHTML=p,n.innerHTML=m,r.innerHTML='',r.setAttribute("data-placeholder",S),E.internalToggleChat(!1),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),deviceInfoService.isMobileDevice()&&!deviceInfoService.isIos()&&(r.addEventListener('focus',function(){J=!0}),r.addEventListener('blur',function(){J=!1,Oe()}));if('question'===e)X||deviceInfoService.isMobileDevice()||E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),f.appendChild(((v=chatInputDOMProc.render()).querySelector('#gis-convo').style.height='auto',v.querySelector('#gis-broadcast-close').style.display='none',v.style.width='100%',v)),E.internalToggleChat(!0);else{if('group'!==e)return uiUtilitiesService.addClass(f,'gis-hide');chatGroupService.getGroupCount(b.callUUID,function(e,s){if(e||s)return te=!(ee=!1),(deviceInfoService.isMobileDevice()||X)&&0!==G.length&&(uiUtilitiesService.removeClass(R,"gis-enabled"),uiUtilitiesService.removeClass(T,"gis-toggle-exists"),ge()),X=!X,void le(!1);X||deviceInfoService.isMobileDevice()||E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),E.internalToggleChat(!0),chatUserNameService.openEnterUserForm(d,c,g,u,null,null,C,E.callChatButtonOnClick,!0),globalObjectService.getWindow().addEventListener('messageReceived',function(e){var s,i;e.detail[0].sender.uid!==stateService.getCallUserUUID()&&(s=e,i=0,f.className.match(/gis-hide/)&&E.showMessageIndicator(),s.detail.forEach(function(e){'text'===e.type&&i++}),E.updateMessageIndicatorCounter(i))})})}var v;deviceInfoService.isMobileDevice()||eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_SHOWN_ON_SHOP_STREAM)}(),shopStreamService.isProductCarouselEnabledForShopStream()?b&&gisService.getProductsForBroadcast(b.id,'gisCallbacks.productsForBroadcastCallback'):uiUtilitiesService.addClass(i,'gis-hide')),ye(),ke(),u=y.querySelector('#gis-player-cta-container'),d=y.querySelector('#gis-player-cta'),Le(),xe(),uiUtilitiesService.enableBodyScroll(),gisAppLib.bodyScrollLock.disableBodyScroll(y),uiUtilitiesService.hasClass(i,"gis-hide")||eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_SHOWN_ON_SHOP_STREAM),H=new productPopupComponent({type:null,payload:null,popUpContainer:y.querySelector('#gis-ss-player-popup'),labels:{product_details_popup_label:serverInjectionService.getLabels().product_popup_details_label,product_popup_view_details_label:serverInjectionService.getLabels().product_popup_more_info_label},repeatableATC:!0}),eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.SHOW_PRODUCT_DETAILS_POPUP,H.triggerDetailsPopup),deviceInfoService.isIPad()?(layoutService.applyIf(function(){layoutService.applyFullScreenHeight(y)},function(){layoutService.removeFullScreenHeight(y)},[ne]),uiUtilitiesService.addClass(O,'gis-ipad-landscape')):layoutService.applyIf(function(){layoutService.applyFullScreenHeight(y)},function(){layoutService.removeFullScreenHeight(y)},[{selector:"<",breakpoint:{type:null,maxWidth:1025}},ne]),b&&1===b.status&&(E.hideProgressBar(),deviceInfoService.isMobileDevice())){var e=l.querySelectorAll('.gis-desktop');uiUtilitiesService.removeClassOnList(e,'gis-desktop'),uiUtilitiesService.addClassOnList(e,'gis-mobile')}le(!0)}function le(e){var s=layoutService.getWindowSize();deviceInfoService.isIPad()?layoutService.getOrientation().match(/portrait/)&&s.WIDTH<1025&&!X?re(!0,e):layoutService.getOrientation().match(/landscape/)&&1024<s.WIDTH&&X?re(!1,e):globalObjectService.getWindow().outerWidth>s.WIDTH&&X&&s.WIDTH<1025&&layoutService.getOrientation().match(/landscape/)&&!$&&(re(!($=!0),e),setTimeout(function(){$=!1},2e3)):deviceInfoService.isMobileDevice()||deviceInfoService.isIPad()||(s.WIDTH<1025&&!X?re(!0,e):1025<=s.WIDTH&&X&&re(!1,e))}function re(e,s){(!s||s&&e||s&&!e&&deviceInfoService.isIPad())&&((X=e)?(uiUtilitiesService.removeClass(O,'gis-ipad-landscape'),uiUtilitiesService.addClass(O,'gis-ipad-portrait'),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),uiUtilitiesService.addClass(a,'gis-mobile'),uiUtilitiesService.addClass(i,'gis-hide'),Ve(),Me(),E.setupUiForMobile(),b&&0!==b.status&&(de(),uiUtilitiesService.removeClass(T,'gis-hide'),be(),ye())):(uiUtilitiesService.removeClass(O,'gis-ipad-portrait'),deviceInfoService.isIPad()&&uiUtilitiesService.addClass(O,'gis-ipad-landscape'),de(),shopStreamService.isChatEnabledForShopStream(b)&&ee&&b&&b.status!==GIS_CONSTANTS.BROADCAST_STATUS.BROADCAST_CREATED?(E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),C.classList.contains('gis-disabled')?E.internalToggleChat(!1):uiUtilitiesService.removeClass(T,'gis-hide')):E.internalToggleChat(!1),shopStreamService.isProductCarouselEnabledForShopStream()&&se&&b&&0!==b.status?(E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),h.classList.contains('gis-disabled')?E.internalToggleProduct(!1):uiUtilitiesService.removeClass(i,'gis-hide'),be()):E.internalToggleProduct(!1),uiUtilitiesService.removeClass(a,'gis-mobile'),Ue(),qe(),Z&&Z.showAvailabilityIndicator&&Z.isAvailable&&(Le(),Ne(Z.showAvailabilityIndicator,Z.isAvailable)),Z&&Z.onclick&&Be(Z.onclick),fe(),E.setupUiForDesktop(),ye(),carouselService.refresh()),w&&Ee())}function ne(){return w}function de(){R=y.querySelector("#gis-chat-carousel-toggle-container"),M=y.querySelector("#gis-chat-toggle"),U=y.querySelector("#gis-product-toggle"),deviceInfoService.isMobileDevice()||X?(shopStreamService.isProductCarouselEnabledForShopStream()&&(uiUtilitiesService.removeNode(i),T.appendChild(i)),!shopStreamService.isProductCarouselEnabledForShopStream()||0===G.length||!shopStreamService.isChatEnabledForShopStream(b)||te||!ae&&10===b.status?(uiUtilitiesService.removeClass(R,"gis-enabled"),uiUtilitiesService.removeClass(T,"gis-toggle-exists"),shopStreamService.isChatEnabledForShopStream(b)&&!te&&ee&&(10!==b.status||ae&&10===b.status)?ce():shopStreamService.isProductCarouselEnabledForShopStream()&&ie&&(10!==b.status||!ae&&10===b.status)&&ge()):(uiUtilitiesService.removeClass(R,'gis-hide'),uiUtilitiesService.addClass(T,"gis-toggle-exists"),Q||(Q=serverInjectionService.getLabels().mobile_product_toggle_label),M.innerHTML=serverInjectionService.getLabels().mobile_chat_toggle_label,U.innerHTML||(U.innerHTML=Q),uiUtilitiesService.addClass(R,"gis-enabled"),M.addEventListener("click",function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_CHAT_BUTTON_CLICKED),ce()}),U.addEventListener("click",function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PRODUCT_CAROUSEL_BUTTON_CLICKED),ge()})),shopStreamService.isChatEnabledForShopStream(b)&&!te&&(10!==b.status||ae&&10===b.status)?ce():shopStreamService.isProductCarouselEnabledForShopStream()&&ie&&(10!==b.status||!ae&&10===b.status)&&ge()):(shopStreamService.isProductCarouselEnabledForShopStream()&&be(),uiUtilitiesService.removeClass(R,"gis-enabled"),uiUtilitiesService.removeClass(T,"gis-toggle-exists"),E.internalToggleProduct(!0),E.internalToggleChat(!0))}function ce(){uiUtilitiesService.removeClass(U,"gis-active"),uiUtilitiesService.addClass(i,"gis-hide"),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_HIDDEN_ON_SHOP_STREAM),uiUtilitiesService.removeClass(f,"gis-hide"),uiUtilitiesService.addClass(M,"gis-active"),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_SHOWN_ON_SHOP_STREAM)}function ge(){uiUtilitiesService.removeClass(M,"gis-active"),uiUtilitiesService.addClass(f,"gis-hide"),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_HIDDEN_ON_SHOP_STREAM),uiUtilitiesService.removeClass(i,"gis-hide"),uiUtilitiesService.addClass(U,"gis-active"),S&&(deviceInfoService.isMobileDevice()||X)&&gisAppLib.bodyScrollLock.disableBodyScroll(S),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_SHOWN_ON_SHOP_STREAM)}function ue(e){if(e.version&&(q=e.version,eventService.publish(GIS_CONSTANTS.EVENT_NAMES.CHECK_FOR_CAROUSEL_UPDATE)),0===e.productCarousel.length)return uiUtilitiesService.addClass(i,'gis-hide'),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),ie=se=!1,void ye();ie=!0,"none"===h.style.display||deviceInfoService.isMobileDevice()||X||(E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),se=!0),uiUtilitiesService.removeClass(i,'gis-hide'),ye(),Ce(he(e)),be()}function Ce(e){S=I.querySelector('#gis-slider-content'),e.forEach(function(e){if(e.id&&addToCartService.isAddToCartConfigured())carouselService.addTileToCarousel(e);else{var s=new productCarouselTileComponent({title:e.title,imageUrl:e.imageUrl,price:e.price,currency:e.currency,productUrl:e.productUrl,alignment:'horizontal',id:e.id,sku:e.sku});W.push(s),I.querySelector('#gis-slider-content').appendChild(s.render()),carouselService.refresh()}}),S&&(deviceInfoService.isMobileDevice()||X)&&gisAppLib.bodyScrollLock.disableBodyScroll(S)}function he(e){var s=e.productCarousel;return s.forEach(function(e){e.id=e.productSku,e.onAccept=addToCartService.onAddToBasketTriggered.bind(null,e)}),G=s,(deviceInfoService.isMobileDevice()||X)&&de(),G&&0<G.length&&(deviceInfoService.isMobileDevice()||X)&&(U.innerHTML=Q+' ('+G.length+')'),s}function pe(e){Se(e.target.type),deviceInfoService.isMobileDevice()&&!deviceInfoService.isIos()&&J&&e.target.type.match(/landscape/)&&(J=!1,Oe())}function Se(e){e.match(/landscape/)?(uiUtilitiesService.addClass(O,'gis-landscape'),uiUtilitiesService.addClass(T,'gis-hide'),uiUtilitiesService.removeClass(r,'gis-mobile'),uiUtilitiesService.removeClass(r,'gis-no-Bottom-Panel'),uiUtilitiesService.removeClass(t,'gis-no-Bottom-Panel'),uiUtilitiesService.addClass(r,'gis-landscape-mobile'),uiUtilitiesService.removeClass(t,'gis-mobile'),uiUtilitiesService.addClass(t,'gis-landscape-mobile'),deviceInfoService.isIos()&&(uiUtilitiesService.enableBodyScroll(),uiUtilitiesService.enableScrollLock(document.body))):(uiUtilitiesService.removeClass(O,'gis-landscape'),uiUtilitiesService.removeClass(T,'gis-hide'),uiUtilitiesService.removeClass(r,'gis-landscape-mobile'),uiUtilitiesService.addClass(r,'gis-mobile'),shopStreamService.isProductCarouselEnabledForShopStream()||shopStreamService.isChatEnabledForShopStream(b)||(uiUtilitiesService.addClass(r,'gis-no-Bottom-Panel'),uiUtilitiesService.addClass(t,'gis-no-Bottom-Panel')),uiUtilitiesService.removeClass(t,'gis-landscape-mobile'),uiUtilitiesService.addClass(t,'gis-mobile'),deviceInfoService.isIos()&&(uiUtilitiesService.disableScrollLock(document.body),uiUtilitiesService.enableBodyScroll(),uiUtilitiesService.disableBodyScrollExcludingContainer(y)))}function me(e){e?uiUtilitiesService.removeClass(f,'gis-hide'):uiUtilitiesService.addClass(f,'gis-hide'),stateService.getUpdateMessageId()||stateService.setUpdateMessageId(!0),ye()}function ve(e){e?uiUtilitiesService.removeClass(i,'gis-hide'):uiUtilitiesService.addClass(i,'gis-hide'),ye()}function ye(){O.className=O.className.replace(/gis-video-chat|gis-video-carousel|gis-video-chat-carousel|gis-video/g,''),uiUtilitiesService.removeClass(T,'gis-hide'),uiUtilitiesService.removeClass(O,'-carousel'),i.className.match(/gis-hide/)&&f.className.match(/gis-hide/)?(uiUtilitiesService.addClass(T,'gis-hide'),uiUtilitiesService.addClass(O,'gis-video')):i.className.match(/gis-hide/)&&!f.className.match(/gis-hide/)?uiUtilitiesService.addClass(O,'gis-video-chat'):!i.className.match(/gis-hide/)&&f.className.match(/gis-hide/)?(uiUtilitiesService.addClass(O,'gis-video-carousel'),"horizontal"===carouselService.getOrientation()&&uiUtilitiesService.addClass(T,'gis-hide')):i.className.match(/gis-hide/)||f.className.match(/gis-hide/)?(uiUtilitiesService.removeClass(i,'gis-hide'),uiUtilitiesService.removeClass(f,'gis-hide')):uiUtilitiesService.addClass(O,'gis-video-chat-carousel'),x?uiUtilitiesService.removeClass(O,'gis-no-secondary-cta'):uiUtilitiesService.addClass(O,'gis-no-secondary-cta')}function be(){deviceInfoService.isMobileDevice()||X?(uiUtilitiesService.removeNode(i),T.appendChild(i),W.forEach(function(e){e.updateOrientation("horizontal mobile")}),carouselService.updateOrientation('mobile','horizontal mobile'),i.className.match(/gis-hide/)||f.className.match(/gis-hide/)||(uiUtilitiesService.addClass(i,'gis-hide'),se&&E.internalToggleProduct(!1))):(uiUtilitiesService.removeNode(i),t.appendChild(i),W.forEach(function(e){e.updateOrientation("horizontal")}),carouselService.updateOrientation('horizontal','horizontal'))}function Te(){deviceInfoService.isMobileDevice()&&!uiUtilitiesService.isLandscape()&&J&&(N=globalObjectService.getWindow(),r.style.display='none',A.style.display='none',T.style.height=x?'calc('+N.innerHeight.toString()+'px - 48px)':N.innerHeight.toString()+'px',t.style.height='auto')}function Oe(){t.style.height=x?T.style.height='':(T.style.height='calc(100% - (56.2525vw + 47px))',uiUtilitiesService.isLandscape()?'100%':'calc((100vw / 1.7777) + 47px)'),r.style.display='',A.style.display='block'}function fe(){systemInfoService.checkGisServiceEnabled()&&(K.persistentCta?(He(),Ie()):stateService.getClerkAvailability()&&(He(),Ie()))}function Ee(){if(w=!0,uiUtilitiesService.addClass(y,'gis-fs'),layoutService.publishResizeEvents(),deviceInfoService.isMobileDevice()||X)return Ve(),Ue(),fe(),void(!document.getElementById('gis-bg-cover').requestFullscreen||X?_e():document.getElementById('gis-bg-cover').requestFullscreen().then(function(){_e(),Ue(),B.orientation.lock("landscape").then(function(){}).catch(function(e){logService.error(F,'Error on orientation lock: ',e)})}).catch(function(e){logService.error(F,'Error on FullScreen: ',e)}));l.style.width='100vw',deviceInfoService.isIPad()?l.style.height='100%':l.style.height='100vh',_e()}function _e(){uiUtilitiesService.addClass(y,'gis-fs'),uiUtilitiesService.addClass(r,'gis-fs'),uiUtilitiesService.addClass(T,'gis-fs'),uiUtilitiesService.addClass(t,'gis-fs'),uiUtilitiesService.addClass(i,'gis-fs'),o.style.display='none',C&&E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),h&&(h.style.display='none'),Ue(),fe(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_FULL_SCREEN)}function Ae(){uiUtilitiesService.removeClass(O,'gis-fs'),uiUtilitiesService.removeClass(T,'gis-fs'),uiUtilitiesService.removeClass(t,'gis-fs'),uiUtilitiesService.removeClass(r,'gis-fs'),uiUtilitiesService.removeClass(i,'gis-fs'),o.style.display='flex',C&&ee&&!X&&E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),h&&se&&!X&&(h.style.display='flex'),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_INITIAL_SCREEN)}function De(){uiUtilitiesService.addClass(O,'gis-disable-transition'),w=!1,uiUtilitiesService.removeClass(y,'gis-fs'),layoutService.publishResizeEvents(),(deviceInfoService.isMobileDevice()||X)&&(Ve(),Me(),document.getElementById('gis-bg-cover').requestFullscreen&&document.fullscreenElement&&!X&&(B.orientation.unlock(),document.exitFullscreen().then(function(){}).catch(function(e){logService.error(F,'Error on Exit FullScreen: ',e)}))),l.style.width='100%',l.style.height='100%',Ae(),setTimeout(function(){uiUtilitiesService.removeClass(O,'gis-disable-transition')},100)}function Pe(){}function Le(){d&&""!==d.innerHTML||(v=new ctaComponent({ctaMode:"humanized",position:"right",roundelColor:Y.theme&&Y.theme.mainColor,roundelImage:"cta-logo.png",isCtaOnBroadcast:!0,isFloater:!0,shopStream:!0}),c=v.render(),d.appendChild(c))}function Ne(e,s){Z.showAvailabilityIndicator=e,Z.isAvailable=s,v.setup({showAvailabilityIndicator:e,isAvailable:s,isOneToOneInBroadcast:!0,position:'right'}),K=serverInjectionService.getSystemConfig(),!deviceInfoService.isMobileDevice()&&!X||w?s||K.persistentCta?(He(),Ie()):(setTimeout(function(){uiUtilitiesService.removeClass(c.querySelector("#gis-cta"),"gis-circle-animate-show"),uiUtilitiesService.addClass(c.querySelector("#gis-cta"),"gis-circle-animate-hide")},400),Re()):Me()}function Ie(){x&&(u.style.display='flex')}function Re(){u.style.display='none'}function Me(){x&&systemInfoService.checkGisServiceEnabled()?(Re(),uiUtilitiesService.removeClass(g,'gis-hide'),y.querySelector('#gis-player-secondary-cta-message').innerText=serverInjectionService.getLabels().shopStream_secondary_cta_message,uiUtilitiesService.removeClass(r,'gis-no-secondary-cta')):Ue()}function Ue(){uiUtilitiesService.addClass(g,'gis-hide'),uiUtilitiesService.addClass(r,'gis-no-secondary-cta')}function He(){setTimeout(function(){uiUtilitiesService.removeClass(c.querySelector("#gis-cta"),"gis-circle-animate-hide"),uiUtilitiesService.addClass(c.querySelector("#gis-cta"),"gis-circle-animate-show")},400)}function ke(){e=new shopStreamVideoHeaderComponent,V=e.render(),uiUtilitiesService.clearView(a),a.appendChild(V),deviceInfoService.isMobileDevice()||X?Ve():qe()}function Ve(){V.querySelector('#gis-player-video-header-right-pane').appendChild(o),uiUtilitiesService.addClass(o,'gis-mobile'),w?(A.style.display='none',r.appendChild(a)):(A.style.display='block',A.appendChild(a))}function qe(){O.prepend(o),A.style.display='none',r.appendChild(a)}function we(e){var s="";k=y.querySelector('#gis-player-overlay-unmute');var i=l.querySelector('#gis-vc-vol');uiUtilitiesService.removeClass(p,'gis-hide'),uiUtilitiesService.removeClass(k,'gis-hide');var t=uiUtilitiesService.createElementWithAttributes("div","gis-player-overlay-unmute-btn",""),a=uiUtilitiesService.createElementWithAttributes("div","gis-player-overlay-unmute-btn-text","");function o(e){uiUtilitiesService.hasClass(k,'gis-hide')||(p.style.pointerEvents="all",uiUtilitiesService.addClass(p,'gis-hide'),uiUtilitiesService.addClass(k,'gis-hide'),m.style.background="",r.querySelector('#gis-video-controls-container').style.pointerEvents="",e())}deviceInfoService.isMobileDevice()?(k.style.marginTop="-"+A.clientHeight+"px",a.innerHTML=serverInjectionService.getLabels().broadcastViewer_tapToUnmute,uiUtilitiesService.addClass(t,'gis-mobile'),uiUtilitiesService.addClass(a,'gis-mobile')):(uiUtilitiesService.removeClass(t,'gis-mobile'),uiUtilitiesService.removeClass(a,'gis-mobile'),a.innerHTML=serverInjectionService.getLabels().broadcastViewer_clickToUnmute,s="transform: scale(1.2);margin-top: 2px;"),t.innerHTML="<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"none\" style=\""+s+"\"><path d=\"M13.5 9A4.5 4.5 0 0 0 11 4.97v2.21l2.45 2.45A4.23 4.23 0 0 0 13.5 9zM16 9c0 .94-.2 1.82-.54 2.64l1.51 1.51C17.63 11.91 18 10.5 18 9c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM1.27 0L0 1.27 4.73 6H0v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L16.73 18 18 16.73l-9-9L1.27 0zM9 1L6.91 3.09 9 5.18V1z\" fill=\"#fff\"></path></svg>",t.style.lineHeight=t.height+"px",i.addEventListener('click',o.bind(null,Pe)),p.addEventListener('click',o.bind(null,e)),p.style.pointerEvents="none",t.appendChild(a),k.appendChild(t)}function xe(){if(!b||'replay'!==b.type){var e=stateService.getBroadcastResponse().status,s=void 0===e||e==z.BROADCAST_FOUND;if((utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_CHANNEL_PARAM]||utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM]||10==b.status)&&(!s||!(utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_CHANNEL_PARAM]&&10!=b.status||utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM]&&1==b.status))){var i=y.querySelector('#gis-player-overlay-message'),t=y.querySelector('#gis-player-msg-title'),a=y.querySelector('#gis-player-msg-subtitle');L=y.querySelector('#gis-player-msg-text'),P=r.querySelector('#gis-video-controls-container'),w&&De(),P.querySelector("#gis-vc-left")&&P.querySelectorAll("#gis-vc-left > *").forEach(function(e){e.style.display="none"}),P.querySelector("#gis-vc-fs")&&(P.querySelector("#gis-vc-fs").style.display="none"),P.querySelector('#gis-video-controls')&&(P.querySelector('#gis-video-controls').style.zIndex="2"),(deviceInfoService.isMobileDevice()||X)&&(uiUtilitiesService.addClass(t,'gis-mobile'),uiUtilitiesService.addClass(a,'gis-mobile'),uiUtilitiesService.addClass(L,'gis-mobile'),shopStreamService.isChatTypeQuestion(b)&&chatInputDOMProc.disableChat(),a.style.fontSize='11px'),b&&10!==b.status||(se&&E.internalToggleProduct(!1),ee&&E.internalToggleChat(!1),!utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_CHANNEL_PARAM]&&!utilitiesService.getUrlParams()[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM]||ae||(P.querySelector('#gis-video-seek-bar-wrapper')&&(P.querySelector('#gis-video-seek-bar-wrapper').style.display="none"),de(),b||(E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),E.internalToggleProduct(!1),se=!1),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.CHAT),E.internalToggleChat(!1),ee=!1,ye(),fe())),m.src&&(m.src='',l.querySelector('#gis-vc-play').onclick()),m.style.background='#37373E',uiUtilitiesService.removeClass(i,'gis-hide'),k&&uiUtilitiesService.addClass(k,'gis-hide');var o=function(e){var s={firstText:'',secondText:'',thirdText:''},i=serverInjectionService.getLabels();if(e==z.BROADCAST_NOT_FOUND)s.firstText=i.broadcastViewer_broadcastNotFoundText1,s.secondText=i.broadcastViewer_broadcastNotFoundText2;else if(e==z.INVALID_ALIAS)s.firstText=i.broadcastViewer_invalidBroadcastUrlText1,s.secondText=i.broadcastViewer_invalidBroadcastUrlText2;else if(e==z.BROADCAST_FOUND&&10==b.status)s.firstText=i.broadcastViewer_broadcastEventEnded1,s.secondText=i.broadcastViewer_broadcastEventEnded2;else if(e==z.BROADCAST_FOUND&&0==b.status){s.firstText=i.broadcastViewer_broadcastEventToBegin,s.secondText=b.name;var t=new Date(b.broadcastEventHoldTimeStamp);s.thirdText=Fe(t)}return s}(e);e==z.BROADCAST_NOT_FOUND||e==z.INVALID_ALIAS?(uiUtilitiesService.addClass(a,'gis-content-align'),a.innerHTML=o.firstText+'<br>'+o.secondText):(t.innerHTML=o.firstText,a.innerHTML=o.secondText,L.innerHTML=o.thirdText)}}}function Fe(e){var s='';return s+=e.toLocaleDateString('en-US',{weekday:'long'})+', ',s+=e.toLocaleDateString('en-US',{month:'short'})+' ',s+=e.toLocaleDateString('en-US',{day:'numeric'})+', ',s+=e.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'})}function Be(s){c&&'function'==typeof s&&(Z.onclick=s,u&&(u.onclick=function(e){s.call(this,e)}),g.onclick=function(e){s.call(this,e)})}function Ge(e){w&&De(),x=!1,_&&_(e),B.orientation&&B.orientation.removeEventListener('change',pe),E.dispose(),uiUtilitiesService.clearView(uiUtilitiesService.getInnerPanel()),uiUtilitiesService.hideModal(!1,GIS_CONSTANTS.ACTIONS.BROADCAST_SCREEN_CLOSED),uiUtilitiesService.enableBodyScroll(),G=[],delete gisCallbacks.productsForBroadcastCallback,delete gisCallbacks.checkCarouselUpdatedCallback,delete gisCallbacks.updateCarousel,eventService.unsubscribe(GIS_CONSTANTS.EVENT_NAMES.SHOW_PRODUCT_DETAILS_POPUP,H.triggerDetailsPopup)}function We(e){e&&e.isVersionChanged&&gisService.getProductsForBroadcast(b.id,'gisCallbacks.updateCarousel')}function ze(e){if(q=e.version,0<e.productCarousel.length){carouselService.setBasketProducts();var s=he(e);carouselService.clearOldProducts(),carouselService.removeAllTilesFromDOM(),Ce(s),i.className.match(/gis-hide/)&&(ie=se=!0,deviceInfoService.isMobileDevice()||X?shopStreamService.isChatEnabledForShopStream(b)?(uiUtilitiesService.addClass(R,"gis-enabled"),uiUtilitiesService.addClass(T,"gis-toggle-exists")):(uiUtilitiesService.removeClass(i,'gis-hide'),ye()):(uiUtilitiesService.removeClass(i,'gis-hide'),E.showControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),ye()))}else se=ie=!1,deviceInfoService.isMobileDevice()||X?shopStreamService.isChatEnabledForShopStream(b)?(ce(),uiUtilitiesService.removeClass(R,"gis-enabled"),uiUtilitiesService.removeClass(T,"gis-toggle-exists")):(uiUtilitiesService.addClass(i,'gis-hide'),ye()):(uiUtilitiesService.addClass(i,'gis-hide'),E.hideControl(GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT),ye()),carouselService.clearOldProducts(),carouselService.removeAllTilesFromDOM()}return{show:function(e,s){x=e,b=s,carouselService.resetState(),oe()},hide:Ge,setOnClickClose:function(e){y&&(Re(),e&&'function'==typeof e&&(_=e))},setOnClickPlay:function(e){e()},setOnClickShop:Pe,setOnClickSpecificShop:Pe,setOnClickRetailerCustomButton:Pe,getVideoElement:function(){return l.querySelector('video')},playVideo:function(){E.play(we)},pauseVideo:function(){E.pause()},toggleMute:Pe,stopVideo:Pe,onVideoPlay:Pe,onVideoPause:Pe,setupExtraButton:Pe,broadcastEnded:function(){ae=!0,b.status=10,xe()},setOneToOneCtaOnBroadcast:Ne,showOneToOneCtaOnBroadcast:Ie,hideOneToOneCtaOnBroadcast:Re,setOneToOneCtaOnReplay:Ne,showOneToOneCtaOnReplay:Ie,hideOneToOneCtaOnReplay:Re,setOnCtaClickEvent:Be,getView:function(){return l},setVideoSrc:function(e){l.querySelector('source').src=e},setPlayer:function(e){E.setPlayer(e)},updateTimeOnHoldingScreen:function(e){L.innerHTML=Fe(e)},setIntervalOnVideoElement:function(s){var i=l.querySelector('#gis-video'),t=i.currentTime,a=0;D&&clearInterval(D),D=setInterval(function(){var e=i.currentTime;Math.trunc(e)!=Math.trunc(t)?(t=e,a=0):a+=1,10<a&&(a=0,s())},2e3)},clearIntervalOnVideoElement:function(){D&&clearInterval(D)},getCarouselVersion:function(){return q},extendPlayer:function(e){E.getPlayer()&&e(E.getPlayer())}}}};GISAPP.preCallScreen=function(serverInjectionService,uiUtilitiesService,stateService,deviceInfoService,mediaService,eventLoggerService,overrideService,buttonComponent,clientStorageService,pollingService,modalImageComponent,modalContentComponent,connectingScreen,systemInfoService,availableClerkComponent,genericModalContentComponent,ctaComponent,bookingService,utilitiesService,mediaShareComponent,GIS_CONSTANTS,otService,logService,callService,iframeService,addAPersonService,browserInfoService,popup,externalChatIntegrationService,urlUtilitiesService,userService,globalObjectService){return function(a){'use strict';var c={};c.props=a,c.subviews={},c.components={},c.timeouts=[],c.serverInjectionService=serverInjectionService;var i=!1,l="";function r(){return uiUtilitiesService.createElementWithAttributes("div","gis-vertical-padding","gis-humanized","height: 60px;width: 100%;")}function u(e,n,t){c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),a.hideFooter(),c.components.contentContainer=new genericModalContentComponent({componentList:t}),c.subviews.contentContainer=c.components.contentContainer.render(),c.components.imageContainer=new modalImageComponent({mainImage:{filename:n,width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.subviews.split1.style.position="relative",uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(e+eventLoggerService.GIS_ACTIONS.SHOWN)}return c.render=function(){return c.components={},c.view=uiUtilitiesService.processView(serverInjectionService.getViews().splitLayoutView,{},!0),c.subviews.split1=c.view.querySelector("#gis-splitLayout-1"),c.subviews.split2=c.view.querySelector("#gis-splitLayout-2"),deviceInfoService.isMobileDevice()&&(uiUtilitiesService.addClass(c.subviews.split1,"gis-mobile"),uiUtilitiesService.addClass(c.subviews.split2,"gis-mobile")),c.components.imageContainer=new modalImageComponent({event:a.event}),c.components.imageContainer.render(),a.extendOnClose(c._hide),c.view},c.setCallInitiated=function(e){if(utilitiesService.isMeeting()&&bookingService.isTwoWayVideoCallEnabled()||!utilitiesService.isMeeting()&&callService.isTwoWayVideoCall())c._micAndCameraShareScreen(e);else if(mediaService.isMicAllowed())a.ctrlFunctions.initPublisher();else switch(window.dispatchEvent(new GisCustomEvent("gisMicShare")),serverInjectionService.getUiConfig().micSetupVersion){case 2:c._newMicSetup();break;case 3:c._humanizedMicSetup();break;default:c._micSetup()}},c._onMicToggle=function(e){if(e&&e.audio&&e.audio.isAllowed){var n=new popup({type:GIS_CONSTANTS.POPUP_TYPE.PRECALLSCREEN_MIC_NEEDED,position:'center',backgroundClass:'gis-mic-needed-popup-background',popupContent:{mainText:serverInjectionService.getLabels().mic_needed_popup_title,subMainText:serverInjectionService.getLabels().mic_needed_popup_subtitle,primaryBtn:{label:serverInjectionService.getLabels().mic_needed_popup_primary_button_label,onclick:function(){uiUtilitiesService.removeNode(c.subviews.split2.querySelector('#gis-popup-wrapper'))}}}});c.subviews.split2.append(n.render())}},c.setConnectScreen=function(){l=eventLoggerService.GIS_VIEWS.CONNECT,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",c.components.imageContainer=new modalImageComponent({event:a.event,mainImage:{filename:"iMac.png"},secondImage:"Screen.png"}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.usePerspective(),deviceInfoService.isMobileDevice()||(c.components.imageContainer.subviews.mainImage.style.left="-25px"),c.components.contentContainer=new modalContentComponent({mainText:{text:"Get advice and see our products live"},linkText:"What is this?",button:{label:"Speak with an Expert",image:mediaService.isMicAllowed()?"":"mic.svg",onclick:c.connectClick,eventName:eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.CONNECT_BUTTON,eventData:{source:"standard"}}}),c.subviews.contentContainer=c.components.contentContainer.render(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.setClerkUnavailableConnectScreen=function(){l=eventLoggerService.GIS_VIEWS.CLERK_UNAVAILABLE_CONNECT,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer=new modalImageComponent({mainImage:{filename:"humanized-connect-cover.jpg",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover();var e=function(){var e=uiUtilitiesService.createElementWithAttributes("div",null,null,"display:flex;margin:20px 0px;");deviceInfoService.isMobileDevice()&&(e.style.margin="10px 0px");var n=uiUtilitiesService.createElementWithAttributes("div","gis-cta-explainer-container",null,"display:flex;align-items:flex-end;margin:auto"),t=uiUtilitiesService.createElementWithAttributes("div","gis-cta-wrapper"),i=uiUtilitiesService.createElementWithAttributes("div","gis-cta-arrow","","width:30px;height:22px");i.style.background=uiUtilitiesService.getImageUrl("availability-indicator-arrow.svg")+" no-repeat";var o=uiUtilitiesService.createElementWithAttributes("div","gis-cta-indicator","gis-cta-indicator available","position:relative"),s=serverInjectionService.getUiConfig(),a=new ctaComponent({ctaMode:"humanized",position:"right",roundelColor:s.theme&&s.theme.mainColor,roundelImage:"cta-logo.png",showAvailabilityIndicator:!0,isFloater:!0}).render();return uiUtilitiesService.addClass(a.querySelector("#gis-cta"),"gis-circle-animate-show"),t.appendChild(a),n.appendChild(t),n.appendChild(i),n.appendChild(o),e.appendChild(n),e}(),n=serverInjectionService.getLabels(),t=[{text:n.clerkUnavailableConnectScreen_title,type:"title"},{text:n.clerkUnavailableConnectScreen_primaryText,type:"subTitle",style:"margin:15px 0px"},{text:n.clerkUnavailableConnectScreen_weekdayOpeningTime,type:"secondaryText"},{text:n.clerkUnavailableConnectScreen_weekendOpeningTime,type:"secondaryText"},{text:n.clerkUnavailableConnectScreen_closedTime,type:"secondaryText"},{text:n.connect_v2_Disclaimer,type:"footer"}];bookingService.isBookingEnabled()?(serverInjectionService.getUiConfig().supportInfoLink&&a.showInfoButton(),t.splice(5,0,{label:n.schedule_booking_button_label,onClick:c.setBookingWidget,eventName:l+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,class:"gis-secondary-button",type:"button"}),uiUtilitiesService.addClass(e.querySelector("#gis-cta-explainer-container"),"gis-center-transform"),e.querySelector("#gis-cta-explainer-container").style.width="150px",uiUtilitiesService.appendView(c.subviews.split1,e)):(t.splice(1,0,{value:e,type:"other"}),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer));externalChatIntegrationService.isEnabledOnUnavailableScreen()&&t.splice(6,0,{label:serverInjectionService.getLabels().external_chat_button_label,onClick:externalChatIntegrationService.onChatButtonClick.bind(null,a.hide),eventName:l+"_"+eventLoggerService.GIS_VIEWS.EXTERNAL_CHAT_BUTTON,class:"gis-secondary-button gis-suppressed-button",type:"button"}),c.components.contentContainer=new genericModalContentComponent({componentList:t}),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),c.subviews.split1.style.position="relative",uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN,{routingKey:stateService.getRoutingKey()}),pollingService.isPollingTimeExpiredForEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)&&pollingService.resetPollingTimeExpiryForEvent(pollingService.BASE_EVENTS.CLERK_AVAILABILITY_POLLING)},c.setHumanizedConnectScreen=function(e){l=eventLoggerService.GIS_VIEWS.CONNECT,c.subviews.split1.innerHTML="";var n=c.subviews.split2.innerHTML="";serverInjectionService.getUiConfig().showAvailableClerks&&systemInfoService.shouldShowAvailableClerkList()&&(n=(new availableClerkComponent).render(),eventLoggerService.logEvent(l+eventLoggerService.GIS_VIEWS.AVAILABLE_CLERKS+eventLoggerService.GIS_ACTIONS.SHOWN));var t={mainText:{text:serverInjectionService.getLabels().connect_v4_mainText,class:"gis-humanized"},mainSubText:serverInjectionService.getLabels().connect_v4_subMainText,footerText:serverInjectionService.getLabels().connect_v2_Disclaimer,button:{label:serverInjectionService.getLabels().connect_v4_button,image:mediaService.isMicAllowed()?"":"mic.svg",isResponsive:!stateService.isAndroidSocialBrowser(),responseLabel:serverInjectionService.getLabels().directCallScreen_v3_waiting,onclick:c.connectClick,eventName:eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.CONNECT_BUTTON,eventData:{source:"standard",isAndroidSocialBrowser:stateService.isAndroidSocialBrowser()},buttonClass:"gis-humanized"},centerImageView:{content:n,class:"gis-humanized"}};bookingService.isBookingEnabled()?(serverInjectionService.getUiConfig().supportInfoLink&&a.showInfoButton(),t.secondaryButton={label:serverInjectionService.getLabels().schedule_booking_button_label,onclick:c.setBookingWidget,eventName:eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,eventData:{source:"standard"},class:"gis-secondary-button"}):t.linkText=serverInjectionService.getLabels().support_info_text;callService.isChatFirstCallEnabled()?t.chatLiveButton={label:serverInjectionService.getLabels().start_chatonly_call_button_label,onclick:c.connectClick.bind(null,null,!0),eventName:eventLoggerService.GIS_VIEWS.CONNECT+"_"+eventLoggerService.GIS_VIEWS.LIVE_CHAT_BUTTON,eventData:{source:"standard"},class:"gis-secondary-button",isResponsive:!0,responseLabel:serverInjectionService.getLabels().directCallScreen_v3_waiting}:externalChatIntegrationService.isEnabledOnConnectScreen()&&(t.tertiaryButton={label:serverInjectionService.getLabels().external_chat_button_label,onclick:externalChatIntegrationService.onChatButtonClick.bind(null,a.hide),eventName:eventLoggerService.GIS_VIEWS.CONNECT+"_"+eventLoggerService.GIS_VIEWS.EXTERNAL_CHAT_BUTTON,eventData:{source:"standard"},class:"gis-secondary-button gis-suppressed-button"},deviceInfoService.isMobileDevice()&&(t.centerImageView=!1)),uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer=new modalImageComponent({mainImage:{filename:"humanized-connect-cover.jpg",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.components.contentContainer=new modalContentComponent(t),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),utilitiesService.isRedirectedFromSocialWebview()&&c.triggerAutoConnect()},c.setGenericModalComponentScreen=function(e,n,t){c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),a.hideFooter(),c.components.contentContainer=new genericModalContentComponent({componentList:t}),c.subviews.contentContainer=c.components.contentContainer.render(),c.components.imageContainer=new modalImageComponent({mainImage:{filename:n,width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.subviews.split1.style.position="relative",uiUtilitiesService.appendView(c.subviews.split1,ctaAvailabilityExplainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(e+eventLoggerService.GIS_ACTIONS.SHOWN)},c.directCallScreen=function(e){l=eventLoggerService.GIS_VIEWS.DIRECT_CALL,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized");var n={image:mediaService.isMicAllowed()?"":"mic.svg",isResponsive:!0,responseLabel:"Please Wait...",onclick:c.connectClick,eventName:eventLoggerService.GIS_VIEWS.DIRECT_CALL+eventLoggerService.GIS_VIEWS.DIRECT_CALL_BTN,eventData:{source:"directCall"},buttonClass:"gis-humanized"};e&&e.isDepartmentCall?n.label=serverInjectionService.getLabels().connect_v4_button:n.label=serverInjectionService.getLabels().directCallScreen_connectBtnLabel,c.components.imageContainer=new modalImageComponent({mainImage:{filename:"direct-call-connect-image.png",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.components.contentContainer=new modalContentComponent({mainText:{text:"Welcome to your live Ribble showroom visit",class:"gis-humanized"},centerImage:{class:"gis-humanized"},mainSubText:"Video is shared by us only, we won't see you.",linkText:"More Info",footerText:"",button:n}),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),utilitiesService.isRedirectedFromSocialWebview()&&c.triggerAutoConnect()},c.invalidDirectCallScreen=function(){l=eventLoggerService.GIS_VIEWS.INVALID_DIRECT_CALL,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer=new modalImageComponent({mainImage:{filename:"direct-call-broken-link.png",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.components.contentContainer=new modalContentComponent({mainText:{text:"Sorry, your Live Video Link is invalid.",class:"gis-humanized"},secondaryText:"<div style='text-align: left;'></div><div class='gis-invalid-url-text'>Check if you have correctly entered the complete invite URL.</div><div class='gis-invalid-url-text'>Contact your in-store associate to request a new link.</div></div>",linkText:"What is this?",footerText:"",button:{label:"OK",eventName:eventLoggerService.GIS_VIEWS.INVALID_DIRECT_CALL+eventLoggerService.GIS_VIEWS.INVALID_DIRECT_CALL_BTN,eventData:{source:"directCall"},onclick:a.closeButton.onclick,buttonClass:"gis-humanized"}}),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.browserUnsupported=function(){l=eventLoggerService.GIS_VIEWS.BROWSER_UNSUPPORTED,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",a.showFooter(),uiUtilitiesService.removeClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer.setup({mainImage:{filename:"unsupported-browser.png",backgroundSize:"80%"}}),uiUtilitiesService.appendView(c.subviews.split1,c.components.imageContainer.render()),c.components.contentContainer2=new modalContentComponent({mainText:{text:"Your browser doesn't support this experience"},secondaryText:"Open the page in an up to date supported browser and start again.",button:{label:"Got it",onclick:a.closeButton.onclick}}),a.hideInfoButton(),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.noMic=function(){l=eventLoggerService.GIS_VIEWS.NO_MIC,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",a.showFooter(),uiUtilitiesService.removeClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer.setup({mainImage:{filename:"No-Mic-Detected.png"}}),uiUtilitiesService.appendView(c.subviews.split1,c.components.imageContainer.render()),c.components.contentContainer2=new modalContentComponent({mainText:{text:"Your mic isn't <br> connected"},secondaryText:"Check your mic is connected [USB / Bluetooth], turned on, and unmuted, then start again.",button:{label:"Got it",onclick:a.closeButton.onclick}}),a.hideInfoButton(),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.setConnecting=function(e,n,t){l=eventLoggerService.GIS_VIEWS.CONNECTING,2===serverInjectionService.getUiConfig().micSetupVersion?(i=e,c.components.contentContainer2&&(c.components.contentContainer2.setup({centerImage:{filename:"mic_ok.png",height:deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()?"100px":"160px"},secondaryText:"Microphone enabled"}),c.components.contentContainer2.components.button2.hide()),c.timeouts.push(setTimeout(function(){a.steps&&a.steps.hide(),a.setTitle(""),a.updateChild(connectingScreen,{noClerkAvailable:i,setBookingWidget:c.setBookingWidget,isChatFirstCall:n})},2e3))):a.updateChild(connectingScreen,{noClerkAvailable:i,setBookingWidget:c.setBookingWidget,isChatFirstCall:n}),n&&t&&a.hideCloseButton(),a.hideInfoButton(),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN,{routingKey:stateService.getRoutingKey()})},c.setNoClerkAvailable=function(){i=!0},c.micBlocked=function(){l=eventLoggerService.GIS_VIEWS.MIC_BLOCKED,c.subviews.split1.style.width="",c.subviews.split1.style.height="",c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",a.setTitle(""),c.components.imageContainer.setup({mainImage:{filename:"mic-denied.png"}}),uiUtilitiesService.appendView(c.subviews.split1,c.components.imageContainer.render()),c.components.contentContainer2=new modalContentComponent({mainText:{text:"Oops, you blocked your microphone"},secondaryText:"To talk to us you need to unblock your mic via address bar or settings.",button:{label:"OK",onclick:a.closeButton.onclick}}),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),a.hideInfoButton(),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.meetingConnectScreenWaiting=function(e){l=eventLoggerService.GIS_VIEWS.MEETING_CONNECT;var n=new Date(e.data.startTime),t=serverInjectionService.getLabels(),i=[{text:t.meetingScreen_Title,type:"title"},{text:t.meetingScreen_subMainText,type:"subTitle"},{text:t.meetingScreen_infoText,type:"subTitle"},{value:r(),type:"other"},{label:t.meetingScreen_connectBtnLabel,image:mediaService.isMicAllowed()?"":"mic.svg",isResponsive:!0,responseLabel:t.meetingScreen_waiting,onClick:c.connectClick,eventName:eventLoggerService.GIS_VIEWS.MEETING_CONNECT+eventLoggerService.GIS_VIEWS.MEETING_CONNECT_BTN,eventData:{source:"meetingCall"},buttonClass:"gis-humanized",type:"button"},{text:t.meetingScreen_startTimeText+" "+utilitiesService.getFormattedTime(n),type:"subTitle"},{text:t.meetingScreen_startDateText+" "+utilitiesService.getFormattedDate(n),type:"subTitle"}];u(l,"meeting-connect-image.png",i);var o=new Date((new Date).setMinutes((new Date).getMinutes()+3));if(o<n){c.components.contentContainer.subcomponent.button.processing();var s=1e3*utilitiesService.getTimeDifference(n,o);setTimeout(function(){c.components.contentContainer.subcomponent.button.enable()},s)}serverInjectionService.getUiConfig().supportInfoLink&&a.showInfoButton(),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),utilitiesService.isRedirectedFromSocialWebview()&&c.triggerAutoConnect()},c.setAddAPersonScreen=function(e){l=eventLoggerService.GIS_VIEWS.ADD_A_PERSON_VIEW,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer=new modalImageComponent({mainImage:{filename:"direct-call-connect-image.png",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.components.contentContainer=new modalContentComponent({mainText:{text:"Welcome to your live Ribble showroom visit",class:"gis-humanized"},centerImage:{class:"gis-humanized"},mainSubText:"Video is shared by us only, we won't see you.",linkText:"More Info",footerText:"",button:{label:"Join Call",image:mediaService.isMicAllowed()?"":"mic.svg",isResponsive:!0,responseLabel:"Please Wait...",onclick:function(){c.connectClick(e)},eventName:eventLoggerService.GIS_VIEWS.ADD_A_PERSON_VIEW+eventLoggerService.GIS_VIEWS.ADD_A_PERSON_CALL_BUTTON,eventData:{source:"addAPersonCall"},buttonClass:"gis-humanized"}}),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),utilitiesService.isRedirectedFromSocialWebview()&&c.triggerAutoConnect(e)},c.setCallEndedScreenForAddAPerson=function(){addAPersonService.addAPersonEndCallScreenShown(),l=eventLoggerService.GIS_VIEWS.ADD_A_PERSON_CALL_ENDED_VIEW,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="";var e={mainText:{text:serverInjectionService.getLabels().add_a_person_call_has_ended_main_text,class:"gis-humanized"},mainSubText:serverInjectionService.getLabels().add_a_person_call_has_ended_sub_main_text,button:{label:serverInjectionService.getLabels().add_a_person_start_new_call_button_text,image:mediaService.isMicAllowed()?"":"mic.svg",isResponsive:!0,responseLabel:serverInjectionService.getLabels().directCallScreen_v3_waiting,onclick:c.connectClick,eventName:eventLoggerService.GIS_VIEWS.ADD_A_PERSON_CALL_ENDED_VIEW+eventLoggerService.GIS_VIEWS.ADD_A_PERSON_CALL_ENDED_BUTTON,eventData:{source:"standard"},buttonClass:"gis-humanized"}};bookingService.isBookingEnabled()?(serverInjectionService.getUiConfig().supportInfoLink&&a.showInfoButton(),e.secondaryButton={label:serverInjectionService.getLabels().schedule_booking_button_label,onclick:c.setBookingWidget,eventName:eventLoggerService.GIS_VIEWS.CONNECT+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,eventData:{source:"standard"},class:"gis-secondary-button"}):e.linkText=serverInjectionService.getLabels().support_info_text;uiUtilitiesService.addClass(c.subviews.split1,"gis-humanized"),c.components.imageContainer=new modalImageComponent({mainImage:{filename:"call-has-ended-connect-screen.jpg",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),c.components.contentContainer=new modalContentComponent(e),a.hideFooter(),c.subviews.contentContainer=c.components.contentContainer.render(),deviceInfoService.isMobileDevice()?(c.components.contentContainer.subviews.mainSubText.style.paddingTop="23px",c.components.contentContainer.subviews.mainSubText.style.paddingBottom="34px"):(c.components.contentContainer.subviews.mainSubText.style.paddingTop="37px",c.components.contentContainer.subviews.mainSubText.style.paddingBottom="147px"),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),uiUtilitiesService.appendView(c.subviews.split2,c.subviews.contentContainer),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.setMeetingMissed=function(){l=eventLoggerService.GIS_VIEWS.MEETING_MISSED;var e=serverInjectionService.getLabels(),n=[{text:e.meetingScreen_Title,type:"title"},{text:e.meetingScreen_missedText,type:"subTitle"},{value:r(),type:"other"},{label:e.schedule_booking_button_label,onClick:c.setBookingWidget,eventName:l+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,class:"gis-secondary-button",type:"button"}];u(l,"meeting-connect-image.png",n)},c.setMeetingEnded=function(){l=eventLoggerService.GIS_VIEWS.MEETING_ENDED;var e=serverInjectionService.getLabels(),n=[{text:e.meetingScreen_ended,type:"title"},{label:e.schedule_booking_button_label,onClick:c.setBookingWidget,eventName:l+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,class:"gis-secondary-button",type:"button"}];u(l,"meeting-connect-image.png",n)},c.setMeetingCancelled=function(){l=eventLoggerService.GIS_VIEWS.MEETING_CANCELED;var e=serverInjectionService.getLabels(),n=[{text:e.meetingScreen_Title,type:"title"},{text:e.meetingScreen_canceledText,type:"subTitle"},{value:r(),type:"other"},{label:e.schedule_booking_button_label,onClick:c.setBookingWidget,eventName:l+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,class:"gis-secondary-button",type:"button"}];u(l,"meeting-connect-image.png",n)},c.setBookingWidget=function(){var e=l;if(l=eventLoggerService.GIS_VIEWS.BOOKING,bookingService.isOpenBookingWidgetInNewTab())bookingService.openBookingPage();else{a.hideFooter(),a.hideInfoButton(),a.hideCloseButton();var n=a.modalContainer.querySelector("#gis-modal-content"),t=uiUtilitiesService.processView(serverInjectionService.getViews().bookingWidgetView,{},!1);uiUtilitiesService.clearView(n),n.appendChild(t);var i=t.querySelector("#gis-booking-widget-back-button-container");e?(t.querySelector('#gis-booking-widget-back-button-message').innerText=serverInjectionService.getLabels().bookingWidget_back_button_message,i.onclick=function(){switch(uiUtilitiesService.clearView(n),n.appendChild(c.render().querySelector('#gis-splitLayout')),a.showCloseButton(),e){case eventLoggerService.GIS_VIEWS.CONNECT:c.setHumanizedConnectScreen();break;case eventLoggerService.GIS_VIEWS.CLERK_UNAVAILABLE_CONNECT:c.setClerkUnavailableConnectScreen();break;case eventLoggerService.GIS_VIEWS.MEETING_CANCELED:c.setMeetingCancelled();break;case eventLoggerService.GIS_VIEWS.MEETING_ENDED:c.setMeetingEnded();break;case eventLoggerService.GIS_VIEWS.MEETING_MISSED:c.setMeetingMissed();break;case eventLoggerService.GIS_VIEWS.MEETING_ERROR:c.setMeetingSomethingWrong();break;case eventLoggerService.GIS_VIEWS.CONNECTING:c.setHumanizedConnectScreen()}}):i.style.visibility='hidden',t.querySelector("#gis-booking-widget-close-button-container").onclick=function(){a.hide()},iframeService.initializeSourceLessIframeWithScriptInjection('gis-booking-widget',t.querySelector('#gis-booking-widget-body'),bookingService.getScheduleCallButtonUrl(),{isSrc:!0,isCrossCommunication:!1}),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)}},c.setInformationScreen=function(e){l=eventLoggerService.GIS_VIEWS.ADD_A_PERSON_SESSION_IS_FULL_VIEW,a.hideFooter(),a.hideInfoButton(),a.hideCloseButton();var n=a.modalContainer.querySelector("#gis-modal-content"),t=uiUtilitiesService.processView(serverInjectionService.getViews().informationView,{},!1);uiUtilitiesService.clearView(n),n.appendChild(t),t.querySelector('#gis-connectv3-mainText').innerText=e,t.querySelector("#gis-information-close-button-container").onclick=function(){a.hide()},eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c.setMeetingSomethingWrong=function(){l=eventLoggerService.GIS_VIEWS.MEETING_ERROR;var e=serverInjectionService.getLabels(),n=[{text:e.meetingScreen_Title,type:"title"},{text:e.meetingScreen_somethingWentWrongText,type:"subTitle"},{value:r(),type:"other"},{label:e.schedule_booking_button_label,onClick:c.setBookingWidget,eventName:l+eventLoggerService.GIS_VIEWS.BOOKING_SCHEDULE_BUTTON,class:"gis-secondary-button",type:"button"}];u(l,"meeting-connect-image.png",n)},c.triggerAutoConnect=function(e,n){var t=c.subviews.split2?c.subviews.split2.querySelector('#gis-connectv3-content .gis-v3-button'):null;t&&"function(){}"!==t.onclick.toString()?t.onclick(e||null):t&&(!n||n<9)?setTimeout(c.triggerAutoConnect.bind(null,e||null,n?n+1:1),100):c.connectClick(e||null)},c._hide=function(){c.timeouts=uiUtilitiesService.clearTimeouts(c.timeouts),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.CLOSED),stateService.getCurrentPhase===stateService.phase.READY||"function"!=typeof c.props.ctrlFunctions.isChatFirstCall||c.props.ctrlFunctions.isChatFirstCall()||c.props.ctrlFunctions.handlePostCallEvents()},c.connectClick=function(e,n){if(stateService.isAndroidSocialBrowser()){var t=utilitiesService.getSocialTrackableURL(utilitiesService.getPageUrl(!0),userService.getUserUUID()+"__"+utilitiesService.getBrowserShortcode(stateService.getBrowser()));globalObjectService.getWindow().location.replace(urlUtilitiesService.getExternalDeepLinkForAndroidWebviews(t))}else!function(e,n){if(bookingService.isAddAPersonEnabled()&&utilitiesService.isMeeting()||addAPersonService.isAddAPersonCall()&&callService.isAddAPersonEnabled()){var t=otService.initSession(stateService.getTokBoxApiKey(),stateService.getSessionId(),function(e){e&&logService.error("PRE-CALL-SCREEN","Error on initiating OT session",e)}),i=0,o=0;t.setConnectionCreatedHandler(function(e){var n=JSON.parse(e.connection.data),t=n&&n.userType;o++,'CONSUMER'===t&&i++}),t.connect(stateService.getToken(),function(){}),setTimeout(function(){t.off(),t.disconnect(),3<i?c.setInformationScreen(serverInjectionService.getLabels().sessionFull_main_text):1===o&&addAPersonService.isAddAPersonCall()?c.setCallEndedScreenForAddAPerson():(c.props.ctrlFunctions.initiateCallProcedure(null,e),c.connectClick=function(){})},1e4)}else c.props.ctrlFunctions.initiateCallProcedure(null,null,n),c.connectClick=function(){}}(e,n)},c._micSetup=function(){l=eventLoggerService.GIS_VIEWS.MIC_SETUP;var e;c.components.imageContainer&&c.components.imageContainer.stopPerspective(),c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",a.showFooter(),uiUtilitiesService.removeClass(c.subviews.split1,"gis-humanized"),deviceInfoService.isMobileDevice()?(e=7500,c.subviews.split1.style.width="100%",c.subviews.split1.style.height="100%",c.subviews.split1.style.marginTop=0,c.components.contentContainer=new modalContentComponent({exitAnimation:!0,enterAnimation:"fullscreen",mainText:{text:"This experience requires a mic"},secondaryText:"We respect your privacy and will never access your camera",centerImage:{filename:"mic-status.gif"}}),uiUtilitiesService.appendView(c.subviews.split1,c.components.contentContainer.render()),c.components.contentContainer.subviews.centerImage.style.marginTop="30px",c.components.contentContainer.subviews.centerImage.style.marginBottom="30px",c.components.contentContainer.subviews.centerImageLabel.innerHTML="Checking mic status...",c.timeouts.push(setTimeout(function(){c.components.contentContainer.subviews.mainText.innerHTML="...so we can speak to you"},4e3))):(e=3500,c.components.contentContainer=new modalContentComponent({exitAnimation:!0,enterAnimation:"slide",mainText:{text:"This experience requires a mic"},secondaryText:"We respect your privacy and will never access your camera"}),uiUtilitiesService.appendView(c.subviews.split1,c.components.contentContainer.render()),c.components.imageContainer.setup({mainImage:{filename:"micShare.png"}}),uiUtilitiesService.appendView(c.subviews.split2,c.components.imageContainer.render())),c.timeouts.push(setTimeout(function(){c.components.imageContainer.subviews.mainImage.style.filter="brightness(40%)",a.ctrlFunctions.initPublisher()},e)),a.hideInfoButton(),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c._newMicSetup=function(){l=eventLoggerService.GIS_VIEWS.MIC_OPTIN,c.components.imageContainer&&c.components.imageContainer.stopPerspective(),c.subviews.split1.innerHTML="",a.setTitle("Mic Setup"),a.showFooter(),uiUtilitiesService.removeClass(c.subviews.split1,"gis-humanized"),c.components.contentContainer=new modalContentComponent({exitAnimation:!0,enterAnimation:"fadein",centerImage:{filename:"no_camera.png",height:deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()?"100px":"160px"},secondaryText:"Camera not used"}),c.subviews.contentContainer=c.components.contentContainer.render(),deviceInfoService.isMobileDevice()?c.components.contentContainer.subviews.centerImage.style.marginBottom="25px":c.components.contentContainer.subviews.centerImage.style.marginBottom="50px",c.components.contentContainer.subviews.secondaryText.style.paddingBottom="35px",uiUtilitiesService.appendView(c.subviews.split1,c.subviews.contentContainer),c.components.contentContainer2=new modalContentComponent({}),c.components.contentContainer2.setup({enterAnimation:"fadein",centerImage:{filename:"mic_requested.png",height:deviceInfoService.isMobileDevice()&&!deviceInfoService.isIPad()?"100px":"160px"},button:{image:"mic.svg",label:"Allow mic to continue",isResponsive:!0,responseLabel:"Allow mic to continue",onclick:function(){a.ctrlFunctions.initPublisher(),deviceInfoService.isMobileDevice()&&deviceInfoService.isIos()&&browserInfoService.isSafari()&&uiUtilitiesService.disableBodyScrollExcludingContainer(c.view)},eventName:l+eventLoggerService.GIS_VIEWS.MIC_ALLOW_BUTTON},extraSetupFunction:function(){var e=new buttonComponent({buttonLabel:"Don't allow mic",color:"#545555",onClick:function(){c._micDenied()},eventName:l+eventLoggerService.GIS_VIEWS.MIC_DONT_ALLOW_BUTTON});c.components.contentContainer2.components.button2=e,uiUtilitiesService.appendBefore(c.components.contentContainer2.subviews.contentContainer,e.render(),c.components.contentContainer2.subviews.supportInfoLink)}},2e3),c.subviews.split2.innerHTML="",uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),a.steps&&a.steps.setSelectedStep(1),a.hideInfoButton(),uiUtilitiesService.addClass(c.components.supportInfoLink,"gis-hide"),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c._humanizedMicSetup=function(){l=eventLoggerService.GIS_VIEWS.HUMANIZED_MIC_SHARE,c.components.imageContainer&&c.components.imageContainer.stopPerspective(),a.setTitle(""),c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="";var e=uiUtilitiesService.processView(serverInjectionService.getViews().humanizedMicShareImageView,{},!0),n=e.querySelector(".gis-humanized-micshare-no-camera"),t=e.querySelector(".gis-humanized-micshare-request-mic");c.components.imageContainer=new modalImageComponent({mainImage:{filename:"humanized-mic-share-cover.jpg",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),n.style.background=uiUtilitiesService.getImageUrl("no_camera.png")+" center center / contain no-repeat",t.style.background=uiUtilitiesService.getImageUrl("mic_requested.png")+" center center / contain no-repeat",c.components.contentContainer2=new modalContentComponent({mainText:{text:"To talk to us you need to allow your mic",class:"gis-humanized gis-connectv2-micshare"},centerImageView:{content:e,class:"gis-humanized gis-connectv2-micshare"},button:{image:"mic.svg",label:"Allow mic",isResponsive:!0,class:"gis-connectv2-micshare",responseLabel:"Allow mic",onclick:function(){a.ctrlFunctions.initPublisher(),deviceInfoService.isMobileDevice()&&deviceInfoService.isIos()&&browserInfoService.isSafari()&&uiUtilitiesService.disableBodyScrollExcludingContainer(c.view)},eventName:l+eventLoggerService.GIS_VIEWS.MIC_ALLOW_BUTTON},extraSetupFunction:function(){var e=new buttonComponent({buttonLabel:"Why is this needed",buttonClass:"gis-transparent-btn gis-link-blue gis-connectv2-micshare",onClick:function(){c._humanizedMicDenied()},eventName:l+eventLoggerService.GIS_VIEWS.MIC_DONT_ALLOW_BUTTON});c.components.contentContainer2.components.button2=e,uiUtilitiesService.appendBefore(c.components.contentContainer2.subviews.contentContainer,e.render(),c.components.contentContainer2.subviews.supportInfoLink)}}),a.hideInfoButton(),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),a.hideFooter()},c._micDenied=function(){l=eventLoggerService.GIS_VIEWS.MIC_DENIED,c.subviews.split1.innerHTML="",c.subviews.split2.innerHTML="",a.setTitle(""),c.components.imageContainer.setup({mainImage:{filename:"mic-denied.png"}}),uiUtilitiesService.appendView(c.subviews.split1,c.components.imageContainer.render()),c.components.contentContainer2=new modalContentComponent({secondaryText:"We need you to allow your microphone on this page so we can talk to you",button:{label:"Try again",onclick:c._newMicSetup,eventName:l+"_RETRY_BUTTON"}}),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c._humanizedMicDenied=function(){l=eventLoggerService.GIS_VIEWS.MIC_DENIED,a.setTitle(""),c.subviews.split2.innerHTML="",c.subviews.split1.innerHTML="",c.components.imageContainer=new modalImageComponent({mainImage:{filename:"humanized-mic-denied.png",backgroundSize:"contain"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer),c.components.contentContainer2=new modalContentComponent({secondaryText:"We need you to allow your microphone on this page so we can talk to you",button:{label:"Try again",onclick:c._humanizedMicSetup,eventName:l+"_RETRY_BUTTON"}}),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN)},c._micAndCameraShareScreen=function(e){l=eventLoggerService.GIS_VIEWS.MIC_AND_CAMERA_SETUP;var n=otService.getMediaDevicesStatus();a.setTitle(""),c.subviews.split2.innerHTML="",c.subviews.split1.innerHTML="",c.components.imageContainer=new modalImageComponent({mainImage:{filename:"humanized-mic-share-cover.jpg",width:"100%",backgroundSize:"cover"}}),c.subviews.imageContainer=c.components.imageContainer.render(),c.components.imageContainer.setImageToFullCover(),uiUtilitiesService.appendView(c.subviews.split1,c.subviews.imageContainer);c.components.contentContainer2=new mediaShareComponent({buttons:[{name:'allow',buttonLabel:serverInjectionService.getLabels().micAndCameraSetup_allow,onClick:function(){a.ctrlFunctions.initPublisher(!0),deviceInfoService.isMobileDevice()&&deviceInfoService.isIos()&&browserInfoService.isSafari()&&uiUtilitiesService.disableBodyScrollExcludingContainer(c.view)},isResponsive:!0,responseLabel:serverInjectionService.getLabels().micAndCameraSetup_awaitingPermission,eventName:l+eventLoggerService.GIS_VIEWS.MIC_AND_CAMERA_ALLOW_BUTTON},{name:'cancel',buttonLabel:serverInjectionService.getLabels().micAndCameraSetup_cancel,buttonClass:"gis-secondary-button",onClick:function(){a.closeButton.onclick()},eventName:l+eventLoggerService.GIS_VIEWS.MIC_AND_CAMERA_CANCEL_BUTTON}],switches:[{media:{type:GIS_CONSTANTS.MEDIA.TYPE.CAMERA,status:n.video.isDetected?GIS_CONSTANTS.MEDIA.STATUS.MUTE:GIS_CONSTANTS.MEDIA.STATUS.NOT_DETECTED,permission:n.video.isAllowed?GIS_CONSTANTS.MEDIA.PERMISSION.ALLOWED:GIS_CONSTANTS.MEDIA.PERMISSION.NOT_ALLOWED},label:serverInjectionService.getLabels().micAndCameraSetup_cameraSwitch,name:"camera",onToggle:function(e){a.ctrlFunctions.onCameraToggle(e);var n=c.subviews.split2.querySelector('#gis-ms-preview-video-disabled');e?uiUtilitiesService.addClass(n,'gis-hide'):uiUtilitiesService.removeClass(n,'gis-hide')}},{media:{type:GIS_CONSTANTS.MEDIA.TYPE.MIC,status:n.audio.isDetected?GIS_CONSTANTS.MEDIA.STATUS.MUTE:GIS_CONSTANTS.MEDIA.STATUS.NOT_DETECTED,permission:n.audio.isAllowed?GIS_CONSTANTS.MEDIA.PERMISSION.ALLOWED:GIS_CONSTANTS.MEDIA.PERMISSION.NOT_ALLOWED},label:serverInjectionService.getLabels().micAndCameraSetup_micSwitch,name:"mic",onToggle:function(){},toggleDisabled:!0}],onMediaAllow:function(){e?a.ctrlFunctions.transitionToAVCallFromChat():a.ctrlFunctions.startCall()},mediaDevices:n,screenProps:{updateModalImage:function(e){e?c.components.imageContainer.setup({mainImage:{filename:"humanized-mic-success-cover.jpg",width:"100%",backgroundSize:"cover"}}):c.components.imageContainer.setup({mainImage:{filename:"humanized-mic-share-cover.jpg",width:"100%",backgroundSize:"cover"}})},hideModalImage:function(){c.subviews.split1.style.display='none',c.subviews.split2.style.height='100%',c.subviews.split2.style.width='100%'}}}),uiUtilitiesService.appendView(c.subviews.split2,c.components.contentContainer2.render()),eventLoggerService.logEvent(l+eventLoggerService.GIS_ACTIONS.SHOWN),c.subviews.split2.querySelector('#gis-ms-switch-container .gis-switch-container:nth-child(2) #gis-switch-toggle').addEventListener('click',c._onMicToggle.bind(null,n)),uiUtilitiesService.removeNode(c.subviews.split2.querySelector('#gis-popup-wrapper')),a.hideFooter()},c.addOnCloseCallback=function(e){a.extendOnClose(e)},overrideService.override('preCallScreen',c),{render:c.render,browserUnsupported:c.browserUnsupported,noMic:c.noMic,setCallInitiated:c.setCallInitiated,micBlocked:c.micBlocked,setNoClerkAvailable:c.setNoClerkAvailable,setConnecting:c.setConnecting,setConnectScreen:c.setConnectScreen,setHumanizedConnectScreen:c.setHumanizedConnectScreen,directCallScreen:c.directCallScreen,invalidDirectCallScreen:c.invalidDirectCallScreen,setClerkUnavailableConnectScreen:c.setClerkUnavailableConnectScreen,setMeetingMissed:c.setMeetingMissed,setMeetingEnded:c.setMeetingEnded,setMeetingCancelled:c.setMeetingCancelled,setMeetingSomethingWrong:c.setMeetingSomethingWrong,meetingConnectScreenWaiting:c.meetingConnectScreenWaiting,setAddAPersonScreen:c.setAddAPersonScreen,updateMediaShareStatus:function(){if(!c.components.contentContainer2||c.components.contentContainer2&&"function"!=typeof c.components.contentContainer2.updateStatus)logService.error(l,"MediaShare component not present, it should be.");else{var e=otService.getMediaDevicesStatus();c.components.contentContainer2.updateStatus(e)}},displayPreviewMediaShareScreen:function(e){!c.components.contentContainer2||c.components.contentContainer2&&"function"!=typeof c.components.contentContainer2.displayPreview?logService.error(l,"MediaShare component not present, it should be."):c.components.contentContainer2.displayPreview(e)},setBookingWidget:c.setBookingWidget,setMicAndCameraShareScreen:c._micAndCameraShareScreen,triggerAutoConnect:c.triggerAutoConnect,connectClick:c.connectClick,addOnCloseCallback:c.addOnCloseCallback}}};GISAPP.surveyScreen=function(serverInjectionService,activityLoggerService,uiUtilitiesService,utilitiesService,gisService,stateService,gaService,modalComponent,labeledTextInputComponent,rateComponent,buttonComponent,deviceInfoService,eventLoggerService,overrideService,GIS_CONSTANTS,loaderComponent){return function(e){'use strict';var n='Submitted',t='Not Submitted',s={};return s._props=e,s.EVENT_LOGTAG=eventLoggerService.GIS_VIEWS.SURVEY,s.surveyRateComponents=[],s.isSubmitted=!1,s.systemConfig=serverInjectionService.getSystemConfig(),s.uiConfig=serverInjectionService.getUiConfig(),s.isDisclaimerSurvey=s.uiConfig.disclaimerSurvey,s.submitButtonText="Submit",s.skipButtonText="Skip",s.errorText="Please rate all questions before submitting.",s.disclaimerSurveyText="This survey is completely anonymous and no personal data is captured.",s.render=function(){return s.components={},s.view=uiUtilitiesService.processView(serverInjectionService.getViews().surveyScreenView,{},!0),s.components.upperDiv=s.view.querySelector("#gis-survey-upper-div"),s.components.upperDivWrap=s.view.querySelector("#gis-survey-upper-div-wrap"),s.components.lowerDiv=s.view.querySelector("#gis-survey-lower-div"),s.components.disclaimerSurvey=s.view.querySelector("#gis-connectv3-disclaimer"),s.components.surveyWrapping=s.view.querySelector("#gis-survey-wrap"),s.components.TextError=s.view.querySelector("#gis-text-error"),s.loader=new loaderComponent,s.view.prepend(s.loader.render()),gisService.getSurveyQuestionsFromCallUUID(stateService.getCallUUID()),s.view},s.onSubmitButton=function(){var e=function(){for(var e=[],t=0;t<s.surveyRateComponents.length;t++){if(0===s.surveyRateComponents[t].getStarsValue())return null;var n={callId:stateService.getCallUUID(),surveyId:s.surveyData.questions[t].surveyId,questionId:s.surveyData.questions[t].id,stars:s.surveyRateComponents[t].getStarsValue()};e.push(n)}s.textComp&&(n={callId:stateService.getCallUUID(),surveyId:s.surveyData.questions[t].surveyId,questionId:s.surveyData.questions[t].id,stars:s.textComp.getValue()},e.push(n));return e}();if(e){var t=utilitiesService.utf8ToBase64(JSON.stringify(e));!1===s.isSubmitted&&(s.isSubmitted=!0,gisService.submitSurveyResult(t),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_SURVEY_SUBMIT),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.SURVEY_RESULT,{SurveyResultType:n})),s._props.closeButton.onclick()}else s.components.TextError.style.visibility='visible'},s.onSkipButton=function(){activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_SURVEY_SKIP),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.SURVEY_RESULT,{SurveyResultType:t}),s._props.closeButton.onclick()},s.hide=function(){s.rateComp.resetValues(),s.isSubmitted=!1,s._props.ctrlFunctions.handlePostCallEvents()},overrideService.override('surveyScreen',s),window.setQuestions=function(e){for(var t=(s.surveyData=e).questions,n=0;n<t.length;n++)if("STAR"===t[n].questionType){var r=s.surveyData.questions[n].question;s.rateComp=new rateComponent({label:r,id:t[n].id}),uiUtilitiesService.appendView(s.components.upperDivWrap,s.rateComp.render()),s.surveyRateComponents.push(s.rateComp)}else"FREE_TEXT"===t[n].questionType&&(s.textComp=new labeledTextInputComponent({placeholder:s.surveyData.questions[n].question}),uiUtilitiesService.appendView(s.components.upperDivWrap,s.textComp.render()));s._props.steps&&s._props.steps.hide(),s._props.extendOnClose(s.hide),s.submitButton=new buttonComponent({buttonLabel:s.submitButtonText,buttonMargin:'0px',onClick:s.onSubmitButton,eventName:s.EVENT_LOGTAG+"_SUBMIT_BUTTON"}),s.components.submitButton=s.submitButton.render(),uiUtilitiesService.appendView(s.components.lowerDiv,s.components.submitButton),s.skipButton=new buttonComponent({buttonLabel:s.skipButtonText,buttonMargin:'0px',onClick:s.onSkipButton,buttonClass:"gis-transparent-btn",eventName:s.EVENT_LOGTAG+"_SKIP_BUTTON"}),s.components.skipButton=s.skipButton.render(),uiUtilitiesService.appendView(s.components.lowerDiv,s.components.skipButton),deviceInfoService.isMobileDevice()&&(uiUtilitiesService.addClass(s.components.upperDivWrap.querySelector('#gis-text-field'),"gis-mobile"),uiUtilitiesService.addClass(s.components.surveyWrapping,"gis-mobile"),uiUtilitiesService.addClass(s.components.lowerDiv,"gis-mobile"),uiUtilitiesService.addClass(s.components.TextError,"gis-mobile")),stateService.getInputAlignment()===GIS_CONSTANTS.INPUT_ALIGNMENT.RTL&&s.components.upperDivWrap.querySelector('#gis-text-field').setAttribute("dir",'rtl'),s.components.TextError.innerHTML=s.errorText,eventLoggerService.logEvent(s.EVENT_LOGTAG+eventLoggerService.GIS_ACTIONS.SHOWN,{routingKey:stateService.getRoutingKey()}),s.loader.hide()},{render:s.render}}};GISAPP.addToBasketRequestComponent=function(serverInjectionService,uiUtilitiesService,overrideService){return function(f){var S={},L=2;return S.LOGTAG='addToBasketRequestComponent',S.getAddOns=function(){return{}},overrideService.override(S.LOGTAG,S),{render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().addToBasketRequestView,{},!0),n=e.querySelector('#gis-call-signal-header-img'),a=e.querySelector('#gis-call-signal-header-text'),i=e.querySelector('#gis-call-signal-info-img'),l=e.querySelector('#gis-call-signal-info-title'),t=e.querySelector('#gis-call-signal-info-price'),r=e.querySelector('#gis-call-signal-info-size'),c=e.querySelector('#gis-call-signal-actions .confirmation-btn .gis-v3-button-icon'),s=e.querySelector('#gis-call-signal-actions .confirmation-btn'),o=e.querySelector('#gis-call-signal-actions .reject-btn'),g=e.querySelector('#gis-call-signal-actions .confirmation-btn span'),d=e.querySelector('#gis-call-signal-actions .reject-btn span'),u=e.querySelector('#gis-call-signal-info-addon-type'),y=e.querySelector('#gis-call-signal-info-care-plan-disclaimer'),T=e.querySelector('#gis-call-signal-info-care-plan-detail'),p=e.querySelector('#gis-signal-additional-details'),k=serverInjectionService.getLabels();p.style.display='none',g.innerHTML=k.addToBasket_acceptBtn,d.innerHTML=k.addToBasket_rejectBtn,n.style.backgroundImage="url(\""+f.clerkImageURL+"\")",a.style.margin="auto 0",f.clerkName&&(a.innerHTML="\""+f.clerkName+"\" shared");var m=f.data;return m.addOnType&&(u.innerHTML=S.getAddOns()[m.addOnType],m.addOnType===L&&(p.style.display='block',y.innerHTML=k.addToBasket_carePlan_disclaimer,T.innerHTML=k.addToBasket_carePlan_details,g.innerHTML=k.addToBasket_carePlan_confirmation_text)),m.title&&(l.innerHTML=(q=m.title,q&&174<q.length&&(q=q.slice(0,171),q+='...'),q||"")),m.price&&(t.innerHTML=m.price),m.imageUrl&&(i.style.backgroundImage="url("+m.imageUrl+")"),m.size&&(r.innerHTML=m.size),c.style.background=uiUtilitiesService.getImageUrl("basket.png")+" no-repeat center / 90% 90%",c.style.display="block",s.onclick=function(){f.exit(),f.onAccept()},o.onclick=function(){f.exit(),f.onReject()},e;var q}}}};GISAPP.alertComponent=function(serverInjectionService,uiUtilitiesService,buttonComponent){return function(t){var n,o,s,r;return{render:function(){if(n=uiUtilitiesService.processView(serverInjectionService.getViews().alertView,{},!1),o=n.querySelector("#gis-alert-message-container"),s=n.querySelector("#gis-alert-button-container"),t.message&&(t.message.messageContainerColor&&(o.style.backgroundColor=t.message.messageContainerColor),t.message.messageText&&0!==t.message.messageText.length&&(o.innerHTML=t.message.messageText)),t.button){var e=new buttonComponent({buttonLabel:t.button.buttonText,color:t.button.buttonColor,onClick:t.button.onClick});r=e.render(),s.appendChild(r)}return n},updateAlertMessage:function(e){e&&0!==e.length&&(o.innerHTML=e)},addButton:function(e){if(e){var t=new buttonComponent({buttonLabel:e.button.buttonText,color:e.button.buttonColor,onClick:e.button.onClick});r=t.render(),s.appendChild(r)}},hide:function(){n.style.display='none'},show:function(){n.style.display='flex'},isVisible:function(){return'flex'==n.style.display||''==n.style.display}}}};GISAPP.buttonComponent=function(serverInjectionService,uiUtilitiesService,eventLoggerService){return function(t){'use strict';var o={},e={};function s(n){o.props=n,o.props.buttonMargin&&(e.button.style.margin=o.props.buttonMargin),o.props.buttonLabel&&(e.buttonLabel.innerHTML=o.props.buttonLabel),o.props.color&&(e.button.style.background=o.props.color,e.button.style.boxShadow="initial"),e.button.style.display='flex',o.props.buttonImage?(e.buttonImg.style.background=uiUtilitiesService.getImageUrl(o.props.buttonImage)+" no-repeat center center / contain",e.buttonImg.style.display='inline-block'):e.buttonImg.style.display='none',null==o.props.onClick?e.button.onclick=function(){}:"function"==typeof o.props.onClick?e.button.onclick=o.onClick:console.warn("buttonComponent onClick prop is not valid"),o.props.buttonClass&&uiUtilitiesService.addClass(e.button,o.props.buttonClass)}function n(){e.buttonImg.style.background=uiUtilitiesService.getImageUrl("connecting-call.gif")+" no-repeat center center / contain",uiUtilitiesService.addClass(e.buttonImg,'gis-v3-button-icon-loading'),uiUtilitiesService.addClass(e.button,'gis-v3-button-loading'),e.buttonImg.style.display='inline-block',e.buttonLabel.innerHTML=o.props.responseLabel?o.props.responseLabel:"Please Wait...",e.button.onclick=function(){}}return o.onClick=function(){o.props.eventName&&eventLoggerService.logEvent(o.props.eventName+(o.props.eventAction?o.props.eventAction:eventLoggerService.GIS_ACTIONS.CLICKED),o.props.eventData?o.props.eventData:null),o.props.isResponsive&&n(),o.props.onClick()},{subviews:e,render:function(){var n=uiUtilitiesService.processView(serverInjectionService.getViews().buttonView,{},!0);return e.button=n.querySelector("#gis-v3-button"),e.buttonLabel=n.querySelector("#gis-v3-button-label"),e.buttonImg=n.querySelector("#gis-v3-button-icon"),s(t),n},setup:s,hide:function(){e.button?e.button.style.display='none':console.warn("buttonComponent can't be hidden before render")},show:function(){e.button?e.button.style.display='flex':console.warn("buttonComponent can't be shown before render")},enable:function(){uiUtilitiesService.removeClass(e.buttonImg,'gis-v3-button-icon-loading'),uiUtilitiesService.removeClass(e.button,'gis-v3-button-loading'),s(o.props)},disable:function(){uiUtilitiesService.addClass(e.button,'gis-v3-button-loading'),e.button.onclick=function(){}},processing:n}}};GISAPP.callControlComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,callControlSwitchButtonComponent){return function(E){var c,s={END_CALL:"<svg width='24' height='9' viewBox='0 0 24 9' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M12 2C10.4 2 8.85 2.25 7.4 2.72V5.82C7.4 6.21 7.17 6.56 6.84 6.72C5.86 7.21 4.97 7.84 4.18 8.57C4 8.75 3.75 8.85 3.48 8.85C3.2 8.85 2.95 8.74 2.77 8.56L0.29 6.08C0.11 5.91 0 5.66 0 5.38C0 5.1 0.11 4.85 0.29 4.67C3.34 1.78 7.46 0 12 0C16.54 0 20.66 1.78 23.71 4.67C23.89 4.85 24 5.1 24 5.38C24 5.66 23.89 5.91 23.71 6.09L21.23 8.57C21.05 8.75 20.8 8.86 20.52 8.86C20.25 8.86 20 8.75 19.82 8.58C19.03 7.84 18.13 7.22 17.15 6.73C16.82 6.57 16.59 6.23 16.59 5.83V2.73C15.15 2.25 13.6 2 12 2Z' fill='#FC4445'/></svg>",CAMERA_SWITCH:"<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M21 24C21 25.66 22.34 27 24 27C25.66 27 27 25.66 27 24C27 22.34 25.66 21 24 21C22.34 21 21 22.34 21 24Z' fill='#F3F3F3'/><path d='M20 22V20H17.09C18.47 17.61 21.05 16 24 16C27.72 16 30.85 18.56 31.74 22H33.8C32.87 17.44 28.84 14 24 14C20.73 14 17.82 15.58 16 18.01V16H14V22H20ZM28 26V28H30.91C29.53 30.39 26.95 32 24 32C20.28 32 17.15 29.44 16.26 26H14.2C15.13 30.56 19.16 34 24 34C27.27 34 30.18 32.42 32 29.99V32H34V26H28Z' fill='#F3F3F3'/></svg>"},L={CAMERA_SWITCH:'gis-cam-switch',CAMERA_ENABLE:'gis-camera-toggle',MIC:'gis-mic',END_CALL:'gis-end-call',VOLUME:'gis-vol',FULL_SCREEN:'gis-full-screen'};return{render:function(){return c=uiUtilitiesService.processView(serverInjectionService.getViews().callControlView,{},!1),function(){var e,C,i,l,n,t=(e={},deviceInfoService.isMobileDevice()?(E.cameraToggle.isEnabled?(e.CAMERA_SWITCH=L.CAMERA_SWITCH,e.CAMERA_ENABLE=L.CAMERA_ENABLE,e.END_CALL=L.END_CALL,e.MIC=L.MIC):(e.MIC=L.MIC,e.END_CALL=L.END_CALL),e.VOLUME=L.VOLUME):E.cameraToggle.isEnabled&&E.fullScreen?(e.CAMERA_ENABLE=L.CAMERA_ENABLE,e.MIC=L.MIC,e.END_CALL=L.END_CALL,e.VOLUME=L.VOLUME,e.FULL_SCREEN=L.FULL_SCREEN):E.cameraToggle.isEnabled&&!E.fullScreen?(e.END_CALL=L.END_CALL,e.CAMERA_ENABLE=L.CAMERA_ENABLE,e.MIC=L.MIC,e.VOLUME=L.VOLUME):!E.cameraToggle.isEnabled&&E.fullScreen?(e.END_CALL=L.END_CALL,e.MIC=L.MIC,e.VOLUME=L.VOLUME,e.FULL_SCREEN=L.FULL_SCREEN):(e.MIC=L.MIC,e.END_CALL=L.END_CALL,e.VOLUME=L.VOLUME),e);for(var o in t)t.hasOwnProperty(o)&&c.appendChild((C=t[o],i=o,n=void 0,l=uiUtilitiesService.createCallControlButton(C,s[i],C),n=["gis-content-align"],deviceInfoService.isMobileDevice()?n.push('gis-small'):n.push('gis-medium'),uiUtilitiesService.addClasses(l,n),l));E.cameraSwitch&&E.cameraToggle.isEnabled&&deviceInfoService.isMobileDevice()&&new callControlSwitchButtonComponent({buttonView:c.querySelector('#'+L.CAMERA_SWITCH),buttonName:Object.keys(L)[0],onClick:E.cameraSwitch.onClick,isMute:E.cameraSwitch.isMute,isHidden:!0}),E.mic&&new callControlSwitchButtonComponent({buttonView:c.querySelector('#'+L.MIC),buttonName:Object.keys(L)[2],onClick:E.mic.onClick,isMute:E.mic.isMute}),E.speaker&&new callControlSwitchButtonComponent({buttonView:c.querySelector('#'+L.VOLUME),buttonName:Object.keys(L)[4],onClick:E.speaker.onClick,isMute:E.speaker.isMute}),E.fullScreen&&new callControlSwitchButtonComponent({buttonView:c.querySelector('#'+L.FULL_SCREEN),buttonName:Object.keys(L)[5],onClick:E.fullScreen.onClick,isMute:E.fullScreen.isMute}),E.cameraToggle&&E.cameraToggle.isEnabled&&new callControlSwitchButtonComponent({buttonView:c.querySelector('#'+L.CAMERA_ENABLE),buttonName:Object.keys(L)[1],onClick:E.cameraToggle.onClick,isMute:E.cameraToggle.isMute,isHidden:!0}),c.querySelector('#'+L.END_CALL).onclick=E.onEndCall}(),c},hide:function(){c.style.display='none'},show:function(){c.style.display='flex'},showButton:function(e){var C=c.querySelector('#'+e);C&&uiUtilitiesService.removeClass(C,'gis-hide')},BUTTONS:L}}};GISAPP.callControlSwitchButtonComponent=function(uiUtilitiesService){return function(C){var i,t,s,g,l,w,h={CAM_MUTE:"<svg width='19' height='19' viewBox='0 0 19 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M19 4.5L15 8.5V5C15 4.45 14.55 4 14 4H7.82L19 15.18V4.5ZM1.27 0L0 1.27L2.73 4H2C1.45 4 1 4.45 1 5V15C1 15.55 1.45 16 2 16H14C14.21 16 14.39 15.92 14.54 15.82L17.73 19L19 17.73L1.27 0Z' fill='#4F4F4F'/></svg>",CAMERA:"<svg width='18' height='12' viewBox='0 0 18 12' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L18 11.5V0.5L14 4.5Z' fill='white'/></svg>",VOLUME_MUTE:"<svg width='18' height='18' viewBox='0 0 18 18' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M13.5 9C13.5 7.23 12.48 5.71 11 4.97V7.18L13.45 9.63C13.48 9.43 13.5 9.22 13.5 9ZM16 9C16 9.94 15.8 10.82 15.46 11.64L16.97 13.15C17.63 11.91 18 10.5 18 9C18 4.72 15.01 1.14 11 0.23V2.29C13.89 3.15 16 5.83 16 9ZM1.27 0L0 1.27L4.73 6H0V12H4L9 17V10.27L13.25 14.52C12.58 15.04 11.83 15.45 11 15.7V17.76C12.38 17.45 13.63 16.81 14.69 15.95L16.73 18L18 16.73L9 7.73L1.27 0ZM9 1L6.91 3.09L9 5.18V1Z' fill='#4F4F4F'/></svg>",VOLUME:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.99998V12H4L9 17V0.99998L4 5.99998H0ZM13.5 8.99998C13.5 7.22998 12.48 5.70998 11 4.96998V13.02C12.48 12.29 13.5 10.77 13.5 8.99998ZM11 0.22998V2.28998C13.89 3.14998 16 5.82998 16 8.99998C16 12.17 13.89 14.85 11 15.71V17.77C15.01 16.86 18 13.28 18 8.99998C18 4.71998 15.01 1.13998 11 0.22998Z" fill="white"/></svg>',MIC:'<svg width="14" height="19" viewBox="0 0 14 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 12C8.66 12 9.99 10.66 9.99 9L10 3C10 1.34 8.66 0 7 0C5.34 0 4 1.34 4 3V9C4 10.66 5.34 12 7 12ZM12.3 9C12.3 12 9.76 14.1 7 14.1C4.24 14.1 1.7 12 1.7 9H0C0 12.41 2.72 15.23 6 15.72V19H8V15.72C11.28 15.24 14 12.42 14 9H12.3Z" fill="white"/></svg>',MIC_MUTE:'<svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 9H14.3C14.3 9.74 14.14 10.43 13.87 11.05L15.1 12.28C15.66 11.3 16 10.19 16 9ZM11.98 9.17C11.98 9.11 12 9.06 12 9V3C12 1.34 10.66 0 9 0C7.34 0 6 1.34 6 3V3.18L11.98 9.17ZM1.27 1L0 2.27L6.01 8.28V9C6.01 10.66 7.34 12 9 12C9.22 12 9.44 11.97 9.65 11.92L11.31 13.58C10.6 13.91 9.81 14.1 9 14.1C6.24 14.1 3.7 12 3.7 9H2C2 12.41 4.72 15.23 8 15.72V19H10V15.72C10.91 15.59 11.77 15.27 12.54 14.82L16.73 19L18 17.73L1.27 1Z" fill="#262626"/></svg>',FULL_SCREEN:'<span class="gis-button-muted gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.53516 9H0.535156V14H5.53516V12H2.53516V9ZM0.535156 5H2.53516V2H5.53516V0H0.535156V5ZM12.5352 12H9.53516V14H14.5352V9H12.5352V12ZM9.53516 0V2H12.5352V5H14.5352V0H9.53516Z" fill="#FFFFFF"/></svg></span>',FULL_SCREEN_MUTE:'<span class="gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 11H3V14H5V9H0V11ZM3 3H0V5H5V0H3V3ZM9 14H11V11H14V9H9V14ZM11 3V0H9V5H14V3H11Z" fill="#0E0E10"/></svg></span>',CAMERA_ENABLE:'<svg width="18" height="12" viewBox="0 0 18 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L18 11.5V0.5L14 4.5Z" fill="white"></path></svg>',CAMERA_ENABLE_MUTE:'<svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5L15 8.5V5C15 4.45 14.55 4 14 4H7.82L19 15.18V4.5ZM1.27 0L0 1.27L2.73 4H2C1.45 4 1 4.45 1 5V15C1 15.55 1.45 16 2 16H14C14.21 16 14.39 15.92 14.54 15.82L17.73 19L19 17.73L1.27 0Z" fill="#4F4F4F"></path></svg>',CAMERA_SWITCH:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 24C21 25.66 22.34 27 24 27C25.66 27 27 25.66 27 24C27 22.34 25.66 21 24 21C22.34 21 21 22.34 21 24Z" fill="#F3F3F3"/><path d="M20 22V20H17.09C18.47 17.61 21.05 16 24 16C27.72 16 30.85 18.56 31.74 22H33.8C32.87 17.44 28.84 14 24 14C20.73 14 17.82 15.58 16 18.01V16H14V22H20ZM28 26V28H30.91C29.53 30.39 26.95 32 24 32C20.28 32 17.15 29.44 16.26 26H14.2C15.13 30.56 19.16 34 24 34C27.27 34 30.18 32.42 32 29.99V32H34V26H28Z" fill="#F3F3F3"/></svg>',CAMERA_SWITCH_MUTE:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 24C21 25.66 22.34 27 24 27C25.66 27 27 25.66 27 24C27 22.34 25.66 21 24 21C22.34 21 21 22.34 21 24Z" fill="#F3F3F3"/><path d="M20 22V20H17.09C18.47 17.61 21.05 16 24 16C27.72 16 30.85 18.56 31.74 22H33.8C32.87 17.44 28.84 14 24 14C20.73 14 17.82 15.58 16 18.01V16H14V22H20ZM28 26V28H30.91C29.53 30.39 26.95 32 24 32C20.28 32 17.15 29.44 16.26 26H14.2C15.13 30.56 19.16 34 24 34C27.27 34 30.18 32.42 32 29.99V32H34V26H28Z" fill="#F3F3F3"/></svg>',PLAY:'<svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.3832 0 0 5.3832 0 12C0 18.6168 5.3832 24 12 24C18.6168 24 24 18.6168 24 12C24 5.3832 18.6168 0 12 0ZM16.6344 12.3242L9.43437 17.5242C9.36484 17.5746 9.28242 17.6 9.2 17.6C9.13789 17.6 9.07539 17.5855 9.01797 17.5562C8.88398 17.4879 8.8 17.3504 8.8 17.2V6.8C8.8 6.64961 8.88398 6.51211 9.01797 6.44375C9.15195 6.37578 9.3125 6.3875 9.43437 6.47578L16.6344 11.6758C16.7383 11.7508 16.8 11.8715 16.8 12C16.8 12.1285 16.7383 12.2492 16.6344 12.3242Z" fill="#F3F3F3"/></svg>',PLAY_MUTE:'<svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.38281 0 0 5.3832 0 12C0 18.6168 5.38281 24 12 24C18.6172 24 24 18.6168 24 12C24 5.3832 18.6172 0 12 0ZM11.2 16.4C11.2 16.6211 11.0211 16.8 10.8 16.8H7.6C7.37891 16.8 7.2 16.6211 7.2 16.4V7.6C7.2 7.37891 7.37891 7.2 7.6 7.2H10.8C11.0211 7.2 11.2 7.37891 11.2 7.6V16.4ZM16.8 16.4C16.8 16.6211 16.6211 16.8 16.4 16.8H13.2C12.9789 16.8 12.8 16.6211 12.8 16.4V7.6C12.8 7.37891 12.9789 7.2 13.2 7.2H16.4C16.6211 7.2 16.8 7.37891 16.8 7.6V16.4Z" fill="#F3F3F3"/></svg>',VIDEO_FULL_SCREEN:'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 9H0V14H5V12H2V9ZM0 5H2V2H5V0H0V5ZM12 12H9V14H14V9H12V12ZM9 0V2H12V5H14V0H9Z" fill="#FAFAFA"/></svg>',VIDEO_FULL_SCREEN_MUTE:'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 11H3V14H5V9H0V11ZM3 3H0V5H5V0H3V3ZM9 14H11V11H14V9H9V14ZM11 3V0H9V5H14V3H11Z" fill="#FAFAFA"/></svg>',VIDEO_VOLUME:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 6V12H4L9 17V1L4 6H0ZM13.5 9C13.5 7.23 12.48 5.71 11 4.97V13.02C12.48 12.29 13.5 10.77 13.5 9ZM11 0.230003V2.29C13.89 3.15 16 5.83 16 9C16 12.17 13.89 14.85 11 15.71V17.77C15.01 16.86 18 13.28 18 9C18 4.72 15.01 1.14 11 0.230003Z" fill="#FAFAFA"/></svg>',VIDEO_VOLUME_MUTE:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 9C13.5 7.23 12.48 5.71 11 4.97V7.18L13.45 9.63C13.48 9.43 13.5 9.22 13.5 9ZM16 9C16 9.94 15.8 10.82 15.46 11.64L16.97 13.15C17.63 11.91 18 10.5 18 9C18 4.72 15.01 1.14 11 0.23V2.29C13.89 3.15 16 5.83 16 9ZM1.27 0L0 1.27L4.73 6H0V12H4L9 17V10.27L13.25 14.52C12.58 15.04 11.83 15.45 11 15.7V17.76C12.38 17.45 13.63 16.81 14.69 15.95L16.73 18L18 16.73L9 7.73L1.27 0ZM9 1L6.91 3.09L9 5.18V1Z" fill="#FAFAFA"/></svg>',CHAT:'<span class="gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 0H2C0.9 0 0.00999999 0.9 0.00999999 2L0 20L4 16H18C19.1 16 20 15.1 20 14V2C20 0.9 19.1 0 18 0ZM4 7H16V9H4V7ZM12 12H4V10H12V12ZM16 6H4V4H16V6Z" fill="#212121"/></svg></span><span id="gis-message-indicator" class="gis-message-indicator" style="display:none;"></span>',CHAT_MUTE:'<span class="gis-button-muted gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 2H4C2.9 2 2.01 2.9 2.01 4L2 22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM6 9H18V11H6V9ZM14 14H6V12H14V14ZM18 8H6V6H18V8Z" fill="#FAFAFA"/></svg><span id="gis-message-indicator" class="gis-message-indicator" style="display:none;"></span>',PRODUCT_MUTE:'<span class="gis-button-muted gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="white"/></svg></span>',PRODUCT:'<span class="gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="#212121"/></svg></span>'};return l=C.buttonName,t=C.isMute,w=C.isHidden,s=C.onClick,i=C.buttonView,g=h[l],i.innerHTML=g,w&&uiUtilitiesService.addClass(i,'gis-hide'),t&&(uiUtilitiesService.addClass(i,'gis-disabled'),uiUtilitiesService.changeSvg(i,h[l+'_MUTE'])),i.onclick=function(){t?(uiUtilitiesService.removeClass(i,'gis-disabled'),uiUtilitiesService.changeSvg(i,h[l])):(uiUtilitiesService.addClass(i,'gis-disabled'),uiUtilitiesService.changeSvg(i,h[l+'_MUTE'])),t=!t,s()},{mute:function(){uiUtilitiesService.changeSvg(i,h[l+'_MUTE']),t=!0},unMute:function(){uiUtilitiesService.changeSvg(i,h[l]),t=!1}}}};GISAPP.callControllerComponent=function(serverInjectionService,uiUtilitiesService){return function(i){var l;return{render:function(){return l=uiUtilitiesService.processView(serverInjectionService.getViews().callControllerView,{},!1),function(){for(var t=i.componentList,e=0;e<t.length;e++){var n=t[e];l.querySelector('#gis-footer-bg').appendChild((o=n,void 0,r=uiUtilitiesService.createElementWithAttributes('div',o,'gis-call-controller-icon'),uiUtilitiesService.addClass(r,'gis-content-align'),r))}var o,r}(),l},hide:function(){l.style.opacity='0'},show:function(){l.style.opacity='1'}}}};GISAPP.callScreenHeaderComponent=function(serverInjectionService,uiUtilitiesService,callTypeComponent,userProfileComponent,utilitiesService){return function(){'use strict';var r,t,o,i,c,l;return{render:function(){var n,e;return r=uiUtilitiesService.processView(serverInjectionService.getViews().callScreenHeaderView,{},!0),t=r.querySelector("#gis-call-screen-retailer-logo-container"),o=r.querySelector("#gis-call-screen-call-type-container"),i=r.querySelector("#gis-call-screen-user-profile-container"),r.querySelector("#gis-call-type-tooltip-container"),n=uiUtilitiesService.getImageUrl("retailer-logo.png",!0),utilitiesService.isImageExists(n,function(e){t.style.display=e?(t.querySelector("img").src=n,"block"):"none"}),l=new userProfileComponent,i.appendChild(l.render()),(e=(c=new callTypeComponent).render()).style.width='100%',e.style.height='100%',o.appendChild(e),r},showRecordingTooltip:function(){c.show(c.CALL_TYPE.REC)},updateConnectionCount:function(e){c.updateConnectionCount(e)},hideRecordingTooltip:function(){c.show(c.CALL_TYPE.LIVE)},setUserProfileInfo:function(e){l.setup(e)}}}};GISAPP.callTypeComponent=function(serverInjectionService,uiUtilitiesService,buttonComponent,deviceInfoService){return function(){'use strict';var e,t,l,o,n,c,i,r,s,u='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.00072 14.3894C11.5299 14.3894 14.3908 11.5287 14.3908 7.99986C14.3908 4.471 11.5299 1.61029 8.00072 1.61029C4.47155 1.61029 1.6106 4.471 1.6106 7.99986C1.6106 11.5287 4.47155 14.3894 8.00072 14.3894Z" stroke="#C4C4C4"/><g opacity="0.85"><path d="M8.0008 8.00027L5.33325 10.6666L8.0008 8.00027L5.33325 5.33331L8.0008 8.00027L10.6666 5.33331L8.0008 8.00027L10.6666 10.6666L8.0008 8.00027Z" fill="black"/><path d="M8.0008 8.00027L5.33325 10.6666L8.0008 8.00027ZM8.0008 8.00027L5.33325 5.33331L8.0008 8.00027ZM8.0008 8.00027L10.6666 5.33331L8.0008 8.00027ZM8.0008 8.00027L10.6666 10.6666L8.0008 8.00027Z" stroke="#C4C4C4" stroke-linejoin="round"/></g></svg>',a={LIVE:{type:"LIVE",color:"#5ADAAC"},REC:{type:"REC",color:"#FC4445"}},y=5;function p(){s&&window.clearTimeout(s),C(),s=setTimeout(g,1e3*y)}function L(){c.onmouseover=null,c.onmouseout=null,c.ontouchstart=null,s&&window.clearTimeout(s),g()}function g(){r.style.display='none'}function C(){r.style.display='block'}function f(e){i.querySelectorAll("circle")[0].style.fill=e,i.querySelectorAll("circle")[1].style.stroke=e}return{render:function(){return e=uiUtilitiesService.processView(serverInjectionService.getViews().callTypeView,{},!0),t=e.querySelector("#gis-call-type-tooltip-button"),e.querySelector("#gis-call-type-tooltip"),r=e.querySelector("#gis-call-type-tooltip-container"),l=e.querySelector("#gis-call-type-text"),o=e.querySelector("#gis-call-type-tooltip-message"),n=e.querySelector("#gis-call-type-user-count"),c=e.querySelector("#gis-call-type"),i=e.querySelector("#gis-call-type-icon"),e},show:function(e){if(e)switch(e.type){case a.LIVE.type:l.innerText=serverInjectionService.getLabels().callScreen_callType_live,f(a.LIVE.color),g();break;case a.REC.type:l.innerText=serverInjectionService.getLabels().callScreen_callType_rec,o.innerText=serverInjectionService.getLabels().callScreen_callType_tooltip_message,function(){if(deviceInfoService.isMobileDevice())t.onclick=L,t.innerHTML=u;else{var e=new buttonComponent({buttonLabel:serverInjectionService.getLabels().callScreen_callType_tooltip_button,color:'#212121',buttonClass:'gis-call-type-button',onClick:L});t.appendChild(e.render()),t.style.height=o.style.height}}(),f(a.REC.color),C(),c.onmouseover=p,c.ontouchstart=p,s=setTimeout(g,1e3*y);break;default:return}},updateConnectionCount:function(e){n.innerText=e+1},CALL_TYPE:a}}};GISAPP.chatComponent=function(serverInjectionService,uiUtilitiesService,utilitiesService,gisService,globalObjectService,logService,deviceInfoService){return function(o){var s,c,a=!1,i=null,l=!1,u=[],g=null,h=0,d=-1,m=!1,t='ChatComponent',f=16;function r(e){var t=utilitiesService.getTimeFromSeconds(e.target.currentTime),r=Math.floor((t.minute+2)/2);d=(e.target.currentTime+120)/120;var n=Math.floor((Math.floor(e.target.currentTime)+10)/120)+1;if(r!==n&&!a||l&&h!=r){if(u[n])return;clearTimeout(i),a=!0,i=setTimeout(function(){a=!1},1e4),gisService.getChatSegment(p(n),v)}h!==r&&function(e){var t=d-Math.floor(d),r=u[e];if(!r)return;var n=Math.floor(r.messages.length*t),a=(i=e,l=s.querySelector('#gis-chat-segment-'+i),l?{ele:l,isRendered:!0,segmentNumber:i}:{ele:uiUtilitiesService.createElementWithAttributes('div','gis-chat-segment-'+i,'gis-replay-chat-content-container'),isRendered:!1,segmentNumber:i});var i,l;(function(r,n,a){clearInterval(g),a.isRendered||function(e){for(var t=c.children,r=null,n=0;n<t.length;n++){var a=t[n],i=parseInt(a.getAttribute('id').split('-')[3]);if(i>e.segmentNumber)return r=a,c.insertBefore(e.ele,r)}c.appendChild(e.ele)}(a);g=setInterval(function(){if(n>=r.length&&clearInterval(g),!o.videoPlayer.getPlayer().paused){var e,t=r[n];t&&!t.isRendered&&((e=function(e,t,r){if(!e)return;var n=uiUtilitiesService.processView(serverInjectionService.getViews().chatMessageView,{});return n.querySelector('#gis-replay-chat-chat-bubble-left').innerHTML=e,n.querySelector('#gis-replay-chat-user-info-detail').innerHTML=r,n}(t.message,t.sentAt,t.name)).setAttribute('id','gis-seg-'+a.segmentNumber+'-msg-'+n),a.ele.appendChild(e),t.isRendered=!0),m||c.scroll({top:function(e,t){var r=s.querySelector('#gis-replay-chat-content-wrapper').querySelector('#gis-chat-segment-'+e),n=function(e){for(var t=s.querySelector('#gis-replay-chat-content-wrapper').children,r=0,n=0;n<t.length;n++){var a=t[n];if(a.getAttribute('id')==='gis-chat-segment-'+e)return r;r+=a.scrollHeight}return r}(e),a=r.children;if(0==a.length)return n;for(var i=0;i<t;i++){var l=a[i];l&&(n+=l.scrollHeight)}return n+t*f}(a.segmentNumber,n),behavior:"smooth"}),n++}},1e3)})(r.messages,n,a),h=e}(r),l=!1}function n(e){u[e.segmentNumber]=e}function p(e){var t=o.broadcast.urls[0].split('/'),r=['chat-segment',t[t.length-2],e+'.js'].join('-');return t[t.length-1]=r,t.join('/')}function v(e){logService.error(t,"Error fetching segment: ",e)}function y(){l=!(a=!1)}function b(e){var t=parseInt(c.scrollHeight-c.scrollTop),r=parseInt(globalObjectService.getWindow().getComputedStyle(c).height);m=!(Math.abs(r-t)<5)}return gisCallbacks.replayChatSegment=function(e){n(e)},{render:function(){s=uiUtilitiesService.processView(serverInjectionService.getViews().replayChat,{}),c=s.querySelector('#gis-replay-chat-content-wrapper');var e=s.querySelector('#gis-replay-chat-header-icon');return o.onChatClick&&(e.onclick=o.onChatClick.bind(null,!1)),gisService.getChatSegment(p('1'),v),o.videoPlayer.getPlayer().addEventListener('timeupdate',r),o.videoPlayer.getPlayer().addEventListener('seeked',y),deviceInfoService.isPhoneOrTablet()?(c.addEventListener('touchmove',b),s.querySelector('#gis-replay-chat-header-icon').style.display='none'):c.addEventListener('mousewheel',b),s},setChatSegment:n}}};GISAPP.chatUserFormComponent=function(uiUtilitiesService,deviceInfoService){return function(e){'use strict';return{render:function(){return function(){var e=uiUtilitiesService.createElementWithAttributes,t=e('div','gis-cs-user-form-container','gis-user-form-container','display:none;');t.append(e('div','gis-user-title','gis-user-title','')),t.append(e('div','gis-user-secondary-title','gis-user-title',''));var s=e('div','gis-cs-user-form','gis-user-form','');t.append(s);var r=e('div','gis-cs-user-form-input','gis-user-form-input','');r.setAttribute("type","text"),r.setAttribute("contenteditable",!0),r.setAttribute("value",''),r.setAttribute("data-placeholder",''),s.append(r),deviceInfoService.isIos()||deviceInfoService.isIPad()?uiUtilitiesService.addClass(r,'gis-ios-device'):uiUtilitiesService.removeClass(r,'gis-ios-device'),s.append(e('div','gis-cs-user-error-msg','gis-user-error-msg',''));var i=e('div','gis-cs-submit-user-form-btn','gis-submit-user-form-btn','');return i.setAttribute("type","button"),i.setAttribute("role","button"),s.append(i),t}()}}}};GISAPP.controlButtonComponent=function(uiUtilitiesService,serverInjectionService){return function(t){'use strict';var o,l,n={states:{on:{image:"<svg width='18' height='18' viewBox='0 0 18 18' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M13.5 9C13.5 7.23 12.48 5.71 11 4.97V7.18L13.45 9.63C13.48 9.43 13.5 9.22 13.5 9ZM16 9C16 9.94 15.8 10.82 15.46 11.64L16.97 13.15C17.63 11.91 18 10.5 18 9C18 4.72 15.01 1.14 11 0.23V2.29C13.89 3.15 16 5.83 16 9ZM1.27 0L0 1.27L4.73 6H0V12H4L9 17V10.27L13.25 14.52C12.58 15.04 11.83 15.45 11 15.7V17.76C12.38 17.45 13.63 16.81 14.69 15.95L16.73 18L18 16.73L9 7.73L1.27 0ZM9 1L6.91 3.09L9 5.18V1Z' fill='#4F4F4F'/></svg>",onclick:function(){console.log(" controlButtonComponent State : On")},stateTransition:"off"},off:{image:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.99998V12H4L9 17V0.99998L4 5.99998H0ZM13.5 8.99998C13.5 7.22998 12.48 5.70998 11 4.96998V13.02C12.48 12.29 13.5 10.77 13.5 8.99998ZM11 0.22998V2.28998C13.89 3.14998 16 5.82998 16 8.99998C16 12.17 13.89 14.85 11 15.71V17.77C15.01 16.86 18 13.28 18 8.99998C18 4.71998 15.01 1.13998 11 0.22998Z" fill="white"/></svg>',onclick:function(){console.log(" controlButtonComponent State : Off")},stateTransition:"on"}},order:10,changeHandler:{true:"on",false:"off"},viewOverlay:null,defaultState:"off",style:{size:"24px",background:"",onHover:"",onClick:""}},i=(t=t||{}).config?t.config:n,r=i.states?i.states:n.states;function s(t,n,e){l=(t=t||r)[n],o.onClick=null,uiUtilitiesService.clearView(o),o.style=l.style?l.style:"",o.innerHTML=l.image,e&&"boolean"==typeof e||l.onclick(n),o.onclick=s.bind(null,t,l.stateTransition)}return{render:function(){var t,n,e;return o=uiUtilitiesService.createElementWithAttributes("div",null,"gis-ctrl-btn",null),t=o,n=i.states,e=i.defaultState,l=n[e],uiUtilitiesService.clearView(t),t.style=l.style?l.style:"",t.style.order=i.order?i.order:"",t.innerHTML=l.image,t.onclick=s.bind(null,n,l.stateTransition),o},states:r,updateState:s,getCurrentState:function(){return l}}}};GISAPP.ctaAwarenessComponent=function(deviceInfoService,serverInjectionService,uiUtilitiesService,utilitiesService,clientStorageService,eventLoggerService){return function(i){'use strict';var a,l,S,s={};s._uiConfig=serverInjectionService.getUiConfig(),s.CTA_AWARENESS_RESHOW_DURATION=s._uiConfig&&s._uiConfig.ctaAwarenessMessage.reshowDuration||1;var E={Large:'gis-cta-awareness-container-l',Medium:'gis-cta-awareness-container-m',Small:'gis-cta-awareness-container-s'};function e(e,s){if(i=e,l.querySelector("svg circle").style.fill=i.closeButton&&i.closeButton.circleColor||"white",l.querySelector("svg polygon").style.stroke=i.closeButton&&i.closeButton.crossColor||"black",l.querySelector("svg polygon").style.strokeWidth=i.closeButton&&i.closeButton.crossWidth||"30",uiUtilitiesService.addClass(S,E[i.ctaSize]),deviceInfoService.isMobileDevice()&&(a.style.maxWidth="200px"),i.messages&&0!=i.messages.length){a.innerHTML='';for(var t=0;t<i.messages.length;t++){var o=document.createElement("div");o.innerHTML=i.messages[t],a.appendChild(o)}}if(1<a.children.length){var n=a.children[a.children.length-1];"right"==i.position?n.style.margin="15px 35px 0px 0px":"left"==i.position&&(n.style.margin="15px 0px 0px 35px"),n.style.fontSize="16px",n.style.color=i.roundelColor,n.style.cursor="pointer",a.firstChild.style.cursor="pointer"}s&&r()&&A()}function t(e){e&&(clientStorageService.setItem(clientStorageService.storageKeys.CTA_AWARENESS_MESSAGE_CLOSED,utilitiesService.getTimeWithOutMilliSeconds()),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AWARENESS_MESSAGE_CLOSED,{message:i.messages.join(" ")}),i.setRoundelCloseButton(!0)),S.style.display='none'}function r(){return'flex'===S.style.display}function A(){var e;i.isAvailable&&'clerk'===i.ctaMode?e=eventLoggerService.GIS_EVENTS.CALL_CTA_AWARENESS_MESSAGE_SHOWN:i.isAvailable||'clerk'!==i.ctaMode?'replay'===i.ctaMode?e=eventLoggerService.GIS_EVENTS.REPLAY_CTA_AWARENESS_MESSAGE_SHOWN:'broadcast'===i.ctaMode&&(e=eventLoggerService.GIS_EVENTS.BROADCAST_CTA_AWARENESS_MESSAGE_SHOWN):e=eventLoggerService.GIS_EVENTS.CTA_AWARENESS_CLERK_UNAVAILABLE_MESSAGE_SHOWN,eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS[e],{message:i.messages.join(" ")})}return{render:function(){return S=uiUtilitiesService.processView(serverInjectionService.getViews().ctaAwarenessView,{},!1),a=S.querySelector("#gis-awareness-msg-container"),l=S.querySelector("#gis-cta-awareness-close"),uiUtilitiesService.addClass(S,i.position),uiUtilitiesService.addClass(a,i.position),uiUtilitiesService.addClass(l,i.position),l.onclick=t.bind(null,!0),e(i,!1),S},hide:t,show:function(){var e=Date.parse(clientStorageService.getItem(clientStorageService.storageKeys.CTA_AWARENESS_MESSAGE_CLOSED));isNaN(e)||utilitiesService.dateDifferenceInDays(e,new Date)>=s.CTA_AWARENESS_RESHOW_DURATION?(S.style.display='flex',A(),i.setRoundelCloseButton(!1)):i.setRoundelCloseButton(!0)},isDisplayed:r,setup:e,setAwarenessMessageOnClickEvent:function(s){var t;i.isAvailable&&'clerk'===i.ctaMode?t=eventLoggerService.GIS_EVENTS.CALL_CTA_AWARENESS_ACTION_MESSAGE_CLICKED:i.isAvailable||'clerk'!==i.ctaMode?'broadcast'===i.ctaMode?t=eventLoggerService.GIS_EVENTS.BROADCAST_CTA_AWARENESS_ACTION_MESSAGE_CLICKED:'replay'===i.ctaMode&&(t=eventLoggerService.GIS_EVENTS.REPLAY_CTA_AWARENESS_ACTION_MESSAGE_CLICKED):t=eventLoggerService.GIS_EVENTS.CTA_AWARENESS_ACTION_CLERK_UNAVAILABLE_CLICKED,a.onclick=function(e){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS[t],{message:i.messages.join(" ")}),s.call(this,e)}}}}};GISAPP.ctaBarComponent=function(serverInjectionService,uiUtilitiesService,eventLoggerService,stateService){return function(e){'use strict';var t,a,n,i,o={};o._uiConfig=serverInjectionService.getUiConfig(),o._gisTheme=o._uiConfig.theme;var r=1e3*o._uiConfig.ctaBarMessage.slideOutDelay,s=1e3*o._uiConfig.ctaBarMessage.slideShowTimeOut+r,c=o._gisTheme?o._gisTheme.foregroundColor:"#fff",u=o._gisTheme?o._gisTheme.backgroundColor:"#000",g=30,C=o._uiConfig.ctaSize;function l(e){a.style.color=c,a.innerHTML=function(){var e=serverInjectionService.getLabels().barCta_message,a=serverInjectionService.getLabels().awarenessCta_message;if(stateService.isCtaCustomMessage()&&a&&a.length<g)return a;return e}(),'Small'===C?uiUtilitiesService.addClass(e.ctaContainer,"gis-cta-bar-s"):uiUtilitiesService.addClass(e.ctaContainer,"gis-cta-bar-m")}function m(){uiUtilitiesService.addClass(e.ctaContainer,"gis-cta-bar-main-container"),uiUtilitiesService.addClass(t,"gis-cta-bar--container-animate"),e.ctaContainer.style.backgroundColor=u,a.style.color=c}function f(){setTimeout(d,500),uiUtilitiesService.removeClass(t,"gis-cta-bar--container-animate")}function d(){uiUtilitiesService.removeClass(e.ctaContainer,"gis-cta-bar-main-container"),e.ctaContainer.style.backgroundColor="transparent"}return{render:function(){return t=uiUtilitiesService.processView(serverInjectionService.getViews().ctaBarView,{},!1),a=t.querySelector("#gis-bar-msg-container"),l(e),t},setOnClick:function(a){t.onclick=function(e){a(e),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_BAR_MESSAGE_CLICKED)}},setup:l,hide:function(){clearTimeout(n),clearTimeout(i),f()},show:function(){n=setTimeout(m,r),i=setTimeout(f,s)}}}};GISAPP.ctaComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,ctaAwarenessComponent,ctaBarComponent,eventLoggerService,clientStorageService,utilitiesService,logService,browserInfoService,stateService,gaService){return function(t){var s,o,l,n,r,a,d,c,C,g,u={},m=null,y="none",p=null,i=!1,S=!1,v=null,A=null,b=2,f=1,E={Medium:'gis-cta-m',Small:'gis-cta-s'},T=serverInjectionService.getUiConfig(),h=T.ctaSize,L=3e4,w=6e3,I="gis-cta-advisor-image",_='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M6.62 10.79C8.06 13.62 10.38 15.93 13.21 17.38L15.41 15.18C15.68 14.91 16.08 14.82 16.43 14.94C17.55 15.31 18.76 15.51 20 15.51C20.55 15.51 21 15.96 21 16.51V20C21 20.55 20.55 21 20 21C10.61 21 3 13.39 3 4C3 3.45 3.45 3 4 3H7.5C8.05 3 8.5 3.45 8.5 4C8.5 5.25 8.7 6.45 9.07 7.57C9.18 7.92 9.1 8.31 8.82 8.59L6.62 10.79Z" fill="#F3F3F3"></path> </svg>',M='<svg width="40" height="28" viewBox="0 0 40 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M31.1109 10.6667V2.88888C31.1109 1.66666 30.1109 0.666656 28.8886 0.666656H2.22198C0.999756 0.666656 -0.000244141 1.66666 -0.000244141 2.88888V25.1111C-0.000244141 26.3333 0.999756 27.3333 2.22198 27.3333H28.8886C30.1109 27.3333 31.1109 26.3333 31.1109 25.1111V17.3333L39.9998 26.2222V1.77777L31.1109 10.6667Z" fill="#f3f3f3" /></svg>';function D(e){if(!utilitiesService.areObjectsEqual(u,e)){var s,a;if(y=e.ctaMode,u=e,!serverInjectionService.getSystemConfig()||!serverInjectionService.getSystemConfig().isRoundelCloseButton||"clerk"!==y||(s=Date.parse(clientStorageService.getItem(clientStorageService.storageKeys.CTA_ROUNDEL_CLOSED)),isNaN(s)||utilitiesService.dateDifferenceInDays(s,new Date)>=f)||(o.style.display="none"),C.style.display='broadcast'==y?(n.style.display='block','none'):(n.style.display='none','block'),(u.isAwarenessMessageEnabled||u.isBarMessageEnabled)&&(a={ctaContainer:o,position:u.position},g||(g=new ctaBarComponent(a),o.appendChild(g.render()),g.setup(a),uiUtilitiesService.addClass(l,'gis-cta-bar-position')),function(){var e={position:u.position,roundelColor:u.roundelColor,closeButton:{circleColor:u.roundelColor,crossColor:"#FFF"},messages:u.ctaMessage,setRoundelCloseButton:B,ctaSize:h,isAvailable:u.isAvailable,ctaMode:y,ctaContainer:o};if(p)p.setup(e,!0);else{var s=(p=new ctaAwarenessComponent(e)).render();o.appendChild(s)}}()),O(),e.showAvailabilityIndicator?(r.style.display="block",e.isAvailable?(uiUtilitiesService.removeClass(r,"unavailable"),uiUtilitiesService.addClass(r,"available")):(uiUtilitiesService.removeClass(r,"available"),uiUtilitiesService.addClass(r,"unavailable"))):r.style.display="none",'right'===e.position?r.style.right='0px':r.style.left='0px',t.roundelColor&&(l.style.borderColor=t.roundelColor,l.style.boxShadow='0 0px 0px 0 '+t.roundelColor),t.roundelImage){var i="#"+I+" {\n  background-image:"+uiUtilitiesService.getImageUrl(t.roundelImage)+";\n}";T.cta.imageFormatOverride.enabled&&(i+=" #"+I+".webp{\n  background-image:"+uiUtilitiesService.getImageUrl(uiUtilitiesService.overrideImageFormat(t.roundelImage,T.cta))+";\n}",uiUtilitiesService.addClass(d,'webp'),browserInfoService.isWebpSupported(function(e,s,a){!a&&s.removeClass(e,'webp')}.bind(null,d,uiUtilitiesService))),uiUtilitiesService.styleSheetInjector(i,d)}u.isAnimated&&u.isAvailable?(T.theme?c.style.backgroundColor=T.theme.mainColor:c.style.backgroundColor="#02DE98",'video'===T.cta.animation.iconType?c.innerHTML=M:c.innerHTML=_,deviceInfoService.isMobileDevice()||deviceInfoService.isIPad()?l.style.padding="1px":l.style.padding="2px",l.style.backgroundImage="none",uiUtilitiesService.removeClass(c,'gis-hide'),uiUtilitiesService.addClass(c,'gis-cta-image-animation'),uiUtilitiesService.addClass(d,'gis-cta-image-animation-reverse'),S=!0,m=setTimeout(V,u.isBarMessageEnabled?w:L)):(m&&clearTimeout(m),V()),e.isCtaOnBroadcast&&(serverInjectionService.getSystemConfig().shopStream&&serverInjectionService.getSystemConfig().shopStream.enabled?(uiUtilitiesService.addClass(l,'in-shopstream'),uiUtilitiesService.addClass(r,'in-shopstream'),deviceInfoService.isPhoneOrTablet()&&(uiUtilitiesService.addClass(l,'gis-mobile'),uiUtilitiesService.addClass(r,'gis-mobile'))):deviceInfoService.isMobileDevice()?(uiUtilitiesService.addClass(l,'in-broadcast'),uiUtilitiesService.addClass(l,'mobile'),uiUtilitiesService.addClass(r,'in-broadcast'),uiUtilitiesService.addClass(r,'mobile')):(uiUtilitiesService.addClass(l,'in-broadcast'),uiUtilitiesService.addClass(r,'in-broadcast'))),e.isFloater&&(e.shopStream||(l.style.margin='1px'),l.style.position='relative',o.style.position="relative",o.style.margin="0px",o.style.top="0",o.style.bottom="0",o.style.left="0",o.style.right="0")}}function k(){v&&clearTimeout(v),v=null,p&&p.isDisplayed()&&p.hide()}function O(){var e;g&&u.isBarMessageEnabled?(g.show(),k()):p&&u.isAwarenessMessageEnabled?(A&&clearTimeout(A),v=setTimeout(function(){p.isDisplayed()||p.show(),g.hide(),u.awarenessMessageHideTimeout&&(A=setTimeout(k,u.awarenessMessageHideTimeout)),i=!0},1e3*((e=T.ctaAwarenessMessage.delay)&&e.enabled&&!i?deviceInfoService.isMobileDevice()?e.mobile:e.desktop:b))):(B(!0),k(),g&&g.hide())}function N(){clientStorageService.setItem(clientStorageService.storageKeys.CTA_ROUNDEL_CLOSED,utilitiesService.getTimeWithOutMilliSeconds()),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_ROUNDEL_CLOSED),o.style.display='none'}function B(e){serverInjectionService.getSystemConfig()&&serverInjectionService.getSystemConfig().isRoundelCloseButton&&'clerk'===y&&(a.style.display=e?(o.style.flexDirection="column",a.style.float="left"==u.position?"left":"right","initial"):(o.style.flexDirection="right"==u.position?"row-reverse":"row","none"))}function V(){uiUtilitiesService.removeClass(c,'gis-cta-image-animation'),uiUtilitiesService.addClass(c,'gis-hide'),uiUtilitiesService.removeClass(d,'gis-cta-image-animation-reverse'),S=!1}return{render:function(){if(s=uiUtilitiesService.processView(serverInjectionService.getCtaRoundelView(),{ctaPreview:!1,ctaMessage:!1}),o=s.querySelector("#gis-cta-container"),s.querySelector("#gis-roundel-close-button-container"),a=s.querySelector("#gis-roundel-close-button"),l=s.querySelector("#gis-cta"),n=s.querySelector("#gis-cta-status-container"),s.querySelector("#gis-since-live-time"),r=s.querySelector("#gis-cta-indicator"),d=s.querySelector("#"+I),c=s.querySelector("#gis-cta-call-icon-image"),C=s.querySelector("#gis-cta-image-container"),a.onclick=N,deviceInfoService.isMobileDevice()&&!t.isCtaOnBroadcast){var e=E[h];e||(logService.warn("ctaComponent","Failed to find valid ctaSize. Medium size will be used as fallback",T),e=E[h='Medium']),uiUtilitiesService.removeClass(l,"gis-cta-l"),uiUtilitiesService.addClass(l,e)}else h='Large';return D(t),s},setup:D,show:O,hide:k,setRoundelCloseButton:B,setOnClickForAwarenessMessage:function(e){p&&p.setAwarenessMessageOnClickEvent(e)},setOnClick:function(a){'function'==typeof a&&(l.onclick=function(e){e.isAnimationInProgress=S,a.call(this,e);var s=deviceInfoService.isMobileDevice()?T.ctaSize:'Large';'clerk'===y?stateService.getClerkAvailability()?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK,{ctaSize:s,isCtaAnimationInProgress:e.isAnimationInProgress}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK,{ctaSize:s})):(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE,{ctaSize:s}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CALL_CTA_CLICK_UNAVAILABLE,{ctaSize:s})):'broadcast'===y?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.BROADCAST_CTA_CLICK,{ctaSize:s}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_CTA_CLICK,{ctaSize:s})):'replay'===y&&(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.BROADCAST_REPLAY_CTA_CLICK,{ctaSize:s}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.BROADCAST_REPLAY_CTA_CLICK,{ctaSize:s}))})},setOnClickForBarMessage:function(e){g&&g.setOnClick(e)}}}};GISAPP.ctaPopup=function(uiUtilitiesService,serverInjectionService,buttonComponent){return function(o){'use strict';var c;return{render:function(){return c=uiUtilitiesService.processView(serverInjectionService.getViews().ctaPopupView,{}),function(){var e=c.querySelector('#gis-cta-popup-main-text'),n=c.querySelector('#gis-cta-popup-sub-main-text'),t=c.querySelector('#gis-cta-popup-buttons-container');e.innerHTML=o.mainText,o.subMainText&&(n.innerHTML=o.subMainText);var r=c.querySelector('#gis-cta-popup-icon');if('object'==typeof o.image?r.appendChild(o.image):r.innerHTML=o.image,o.primaryBtn&&o.primaryBtn.label){var a=new buttonComponent({onClick:o.primaryBtn.onclick,buttonLabel:o.primaryBtn.label,buttonClass:"gis-primary-btn",eventName:o.primaryBtn.eventName}).render();t.append(a)}if(o.secondaryBtn&&o.secondaryBtn.label){var i=new buttonComponent({onClick:o.secondaryBtn.onclick,buttonLabel:o.secondaryBtn.label,buttonClass:"gis-secondary-btn",eventName:o.secondaryBtn.eventName}).render();t.append(i)}}(),c}}}};GISAPP.dialPadComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,gisService,utilitiesService){return function(i){'use strict';var o,s,r,e,a,n,t=2500,c=[['1','2','3'],['4','5','6'],['7','8','9'],['*','0','#']];function d(){if(n)return!1;var e=s.innerText;s.innerText=e+this.innerText,r.style.display='flex',u()}function u(){e&&clearTimeout(e),e=setTimeout(l,t)}function l(){var e=s.innerText;if(e){/^[\#\*0-9]+$/.test(e)&&(n=!0,gisService.sendSipDtmf(["connectionId="+i.connectionId,"sessionId="+i.sessionId,"digit="+e]),s.innerText=serverInjectionService.getLabels().dialPad_submitted_message,s.style.color='#23F0C7',r.style.display='none',setTimeout(function(){s.innerText='',s.style.color='#FFFFFF',n=!1},2e3))}}function g(){o.style.display='none',i.resetDialPadZIndex(),uiUtilitiesService.removeClass(a,'gis-ivrActive'),i.onCloseCallback&&"function"==typeof i.onCloseCallback&&i.onCloseCallback()}return{render:function(){var e,i,n,t,l;return o=uiUtilitiesService.processView(serverInjectionService.getViews().dialPadView,{},!0),s=o.querySelector('#gis-dial-pad-screen'),r=o.querySelector('#gis-dial-pad-flashing-pointer'),a=document.getElementById('gis-std-call-view'),o.style.height='100%',o.querySelector('#gis-dial-pad-heading').innerText=serverInjectionService.getLabels().dialPad_heading,uiUtilitiesService.addClass(a,'gis-ivrActive'),e=o.querySelector('#gis-row-1'),i=o.querySelector('#gis-row-2'),n=o.querySelector('#gis-row-3'),t=o.querySelector('#gis-row-4'),l=[e,i,n,t],c.forEach(function(e,n){e.forEach(function(e){var i=uiUtilitiesService.createElementWithAttributes('div',null,'gis-call-controller',null);uiUtilitiesService.addClasses(i,['gis-call-control-button','gis-medium','gis-white','gis-content-align']),i.innerText=e,i.onclick=d,l[n].appendChild(i)})}),o.querySelector('#gis-dial-pad-erase-button').onclick=function(){var e=s.innerText;s.innerText=e.slice(0,-1),0===s.innerText.length&&(r.style.display='none'),u()},o.querySelector('#gis-dial-pad-close-button').onclick=g,o},showDialPad:function(){o.style.display='flex'},hideDialPad:g}}};GISAPP.dockedPlayerComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,eventLoggerService,gaService,clientStorageService,utilitiesService,logService,videoPlayerComponent,GIS_CONSTANTS){return function(s){'use strict';var a,o={};o.CTA_AUTO_PLAY_MIN_BACKGROUND_COLOR="black",o.CTA_AUTO_PLAY_BROADCAST_TITLE_COLOR="white",o.CTA_AUTO_PLAY_DISMISS_BTN_RIM_COLOR="green",o.CTA_AUTO_PLAY_MIN_BTN_BACKGROUND_COLOR="black",o.components=[],o.subviews=[],o.totalPlayTime=0,o.LOGTAG="dockedPlayerComponent";var i,n,l=62,d=!1,r=!1;function u(e){if(clearInterval(i),o.view.style.animation="2s gis-slide-down forwards",("call"===s.type||"replay_engagement"===s.type||e)&&s.onVideoPlayerDismissed(),e){clientStorageService.setItem(clientStorageService.storageKeys.CTA_AUTO_PLAY_DISMISSED,utilitiesService.getTimeWithOutMilliSeconds());var t=a?o.totalPlayTime+((new Date).getTime()-a)/1e3:o.totalPlayTime;eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_CLOSED,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,viewDuration:t,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,channelConfig:s.broadcast.config,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_CLOSED,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,viewDuration:t,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()})}setTimeout(function(){n.dispose(),o.view&&uiUtilitiesService.clearView(o.view)},1e3),r=!1}function c(){var e=utilitiesService.getTimeFromSeconds(n.getPlayer().currentTime),t=new Date;return t.setHours(e.hour,e.minute,e.second),utilitiesService.getFormattedTime(t)}function t(t){s.mode="minimized";var i=a?o.totalPlayTime+((new Date).getTime()-a)/1e3:o.totalPlayTime;n.hideCaptions(),o.subviews.ctaContainer.style.backgroundColor=o.CTA_AUTO_PLAY_MIN_BACKGROUND_COLOR,o.view.style.backgroundColor=o.CTA_AUTO_PLAY_MIN_BACKGROUND_COLOR,o.view.style.animation="1s gis-min-cta forwards",o.subviews.autoPlayDismissBtn.style.animation="1s gis-min-dismissBtn forwards",o.subviews.title.style.animation="1s gis-min-title forwards",o.subviews.title.style.transform="translate(0, 15px)",o.subviews.videoContainer.querySelector("div").style.animation="1s gis-min-cta forwards",o.subviews.videoContainer.querySelector("div").style.animation="1s gis-min-cta-video forwards",o.subviews.videoContainer.querySelector("div>video").style.animation="1s gis-min-video forwards",o.subviews.muteBtn.style.animation="1s gis-min-cta-mute forwards",o.subviews.muteBtn.style.top="24px",!d&&t||(o.subviews.pauseOverlay.style.animation="1s gis-min-pause-overlay forwards",o.subviews.pauseBtn.style.animation="1s gis-min-kw-container forwards",o.subviews.pauseBtn.children[0].style.animation="1s gis-min-kw-image forwards",o.subviews.pauseBtn.children[1].style.display="none",d&&(o.subviews.title.innerHTML=serverInjectionService.getLabels().ctaAutoPlay_minimizedPauseLabel,o.subviews.autoPlayDismissBtn.querySelector("svg").style.opacity=.5)),o.subviews.fullScreenBtn.style.display="none",o.subviews.autoPlayDismissBtn.querySelector("svg path").style.display="none",o.subviews.autoPlayDismissBtn.querySelector("svg polygon").style.display="block",o.subviews.title.style.background="transparent",o.subviews.autoPlayDismissBtn.querySelector("svg circle").style.fill="transparent",setTimeout(function(){o.view.style.height=l+"px",o.subviews.videoContainer.style.width="auto",o.subviews.videoContainer.style.height=l+"px",o.subviews.videoContainer.querySelector("div").style.width=(16/9*l).toFixed()+"px",o.subviews.videoContainer.querySelector("div").style.height=l+"px",uiUtilitiesService.addClass(o.subviews.videoContainer,"gis-min-transition"),o.subviews.title.style.height="50%",o.subviews.title.style.cursor="pointer",o.subviews.title.onclick=m;var e=t?eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_MINIMISED_CLICKED:eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_AUTO_MINIMISED;eventLoggerService.logEvent(e,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,viewDuration:i,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,channelConfig:s.broadcast.config,videoTimeStamp:c()})},1e3)}function v(){var e,t;if(n.getPlayer().muted){try{n.getPlayer().muted=!1,e=eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_UNMUTE,t=gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_UNMUTE}catch(e){}o.subviews.muteBtn.style.background=uiUtilitiesService.getImageUrl("volume.png")+" no-repeat center center/ "+("maximized"===s.mode?"contain":"15px")}else o.subviews.muteBtn.style.background=uiUtilitiesService.getImageUrl("muted.png")+" no-repeat center center / "+("maximized"===s.mode?"contain":"15px"),n.getPlayer().muted=!0,e=eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_MUTE,t=gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_MUTE;var i=a?o.totalPlayTime+((new Date).getTime()-a)/1e3:o.totalPlayTime;eventLoggerService.logEvent(e,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:s.broadcast.config,viewMode:s.mode,viewDuration:i,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(t,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,viewDuration:i,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()})}function m(){var e=a?o.totalPlayTime+((new Date).getTime()-a)/1e3:o.totalPlayTime;eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_FULLSCREEN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:s.broadcast.config,viewMode:s.mode,viewDuration:e,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_FULLSCREEN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,viewDuration:e,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),u(),s.onVideoPlayerClicked()}function y(e){"touchstart"===e.type?o.subviews.videoContainer.removeEventListener("click",y):"click"===e.type&&o.subviews.videoContainer.removeEventListener("touchstart",y),m()}function b(){o.subviews.pauseOverlay.style.display="flex",o.subviews.pauseBtn.onclick=m,"maximized"===s.mode?(o.subviews.pauseOverlay.style.height="82%",o.subviews.videoContainer.style.width="100%",o.subviews.pauseBtn.style.height="30%"):(o.subviews.pauseOverlay.style.width=(16/9*l).toFixed()+"px",o.subviews.pauseOverlay.style.height="100%",o.subviews.pauseOverlay.style.left="30px",o.subviews.videoContainer.style.width=(16/9*l).toFixed()+"px",o.subviews.pauseBtn.style.height="60%",o.subviews.pauseBtn.style.width="50%",o.subviews.pauseBtnImage.style.width=(16/9*l).toFixed()+"px",o.subviews.pauseBtnLabel.style.display="none")}return{render:function(){"maximized"!==s.mode&&"minimized"!==s.mode&&(s.mode="maximized"),o.view=uiUtilitiesService.processView(serverInjectionService.getViews().dockedPlayerView,{ctaMaximised:'maximized'===s.mode,ctaMinimised:'maximized'!==s.mode});var e="";return"maximized"===s.mode?(e="max",o.subviews.fullScreenBtn=o.view.querySelector("#gis-cta-autoplay-fs-btn")):(e="min",o.subviews.autoPlayContent=o.view.querySelector("#gis-cta-autoplay-content")),o.subviews.ctaContainer=o.view.querySelector("#gis-cta-video-wrap"),o.subviews.videoContainer=o.view.querySelector("#gis-pbvideo-container-"+e),o.subviews.video=o.view.querySelector("#gis-autoplay-video-"+e),o.subviews.title=o.view.querySelector("#gis-cta-video-title-"+e),o.subviews.muteBtn=o.view.querySelector("#gis-cta-video-mute-"+e),o.subviews.autoPlayDismissBtn=o.view.querySelector("#gis-cta-autoplay-btn-"+e),o.subviews.pauseBtn=o.view.querySelector("#gis-cta-autoplay-kw-container"),o.subviews.pauseOverlay=o.view.querySelector("#gis-cta-autoplay-pause-bg"),o.subviews.pauseBtnImage=o.view.querySelector("#gis-pause-btn-img"),o.subviews.pauseBtnLabel=o.view.querySelector("#gis-pause-btn-label"),o.subviews.forEach(function(e){uiUtilitiesService.addClass(e,"gis-mobile")}),"minimized"===s.mode&&(o.subviews.ctaContainer.style.backgroundColor=o.CTA_AUTO_PLAY_MIN_BACKGROUND_COLOR),"maximized"===s.mode&&(o.subviews.title.style.position="absolute",o.subviews.title.style.fontSize="16px"),"minimized"===s.mode&&(o.subviews.title.style.transform="translate(0, 22px)",o.subviews.title.style.justifyContent="left",o.subviews.title.style.alignItems="center",o.subviews.title.style.fontSize="13px"),o.subviews.title.style.width="maximized"===s.mode?"78%":"100%",o.subviews.title.style.padding="maximized"===s.mode?"10px 0px 10px":"0px 0px 0px 6px",o.subviews.title.style.color=o.CTA_AUTO_PLAY_BROADCAST_TITLE_COLOR,o.subviews.title.style.zIndex="9",o.subviews.title.style.top="0",o.subviews.title.style.left="maximized"===s.mode?"40px":"0",o.subviews.title.style.whiteSpace="nowrap",o.subviews.title.style.overflow="hidden",o.subviews.title.style.textOverflow="ellipsis",o.subviews.title.style.textAlign="center",o.subviews.title.innerHTML=s.broadcast&&s.broadcast.name,o.subviews.muteBtn.style.color="white",o.subviews.muteBtn.style.position="maximized"===s.mode?"absolute":"relative",o.subviews.muteBtn.style.right="maximized"===s.mode?"18px":"0px",o.subviews.muteBtn.style.width="maximized"===s.mode?"16px":"30px",o.subviews.muteBtn.style.height="maximized"===s.mode?"16px":"100%",o.subviews.muteBtn.style.top="maximized"===s.mode?"40px":"0px",o.subviews.muteBtn.style.zIndex="10",o.subviews.muteBtn.style.cursor="pointer",o.subviews.muteBtn.style.background=uiUtilitiesService.getImageUrl("muted.png")+" no-repeat center center / "+("maximized"===s.mode?"contain":"15px"),o.subviews.muteBtn.onclick=v,function(){if(o.subviews.fullScreenBtn){if("call"===s.type)return o.subviews.fullScreenBtn.style.display='none';o.subviews.fullScreenBtn.style.position="absolute",o.subviews.fullScreenBtn.style.left="15px",o.subviews.fullScreenBtn.style.top="10px",o.subviews.fullScreenBtn.style.width="15px",o.subviews.fullScreenBtn.style.height="20px",o.subviews.fullScreenBtn.style.zIndex="10",o.subviews.fullScreenBtn.style.cursor="pointer",o.subviews.fullScreenBtn.onclick=m}}(),"maximized"===s.mode?(o.subviews.autoPlayDismissBtn.style.position="absolute",o.subviews.autoPlayDismissBtn.style.right="15px",o.subviews.autoPlayDismissBtn.style.top="10px",o.subviews.autoPlayDismissBtn.style.width="22px",o.subviews.autoPlayDismissBtn.style.height="22px",o.subviews.autoPlayDismissBtn.querySelector("svg circle").style.fill=o.CTA_AUTO_PLAY_MIN_BTN_BACKGROUND_COLOR,"replay"===s.type?o.subviews.autoPlayDismissBtn.onclick=function(){"maximized"===s.mode?t(!0):u(!0)}:(o.subviews.autoPlayDismissBtn.querySelector("svg path").style.display='none',o.subviews.autoPlayDismissBtn.querySelector("svg polygon").style.display='block',o.subviews.autoPlayDismissBtn.onclick=u.bind(null,!0))):(o.subviews.autoPlayDismissBtn.style.width="40px",o.subviews.autoPlayDismissBtn.style.height="100%",o.subviews.autoPlayDismissBtn.style.float="right",o.subviews.autoPlayDismissBtn.querySelector("svg circle").style.fill="transparent",o.subviews.autoPlayDismissBtn.querySelector("svg").style.width="30px",o.subviews.autoPlayDismissBtn.querySelector("svg").onclick=function(){u(!0)}),o.subviews.autoPlayDismissBtn.style.cursor="pointer",o.subviews.autoPlayDismissBtn.style.zIndex="10",o.subviews.autoPlayDismissBtn.querySelector("svg circle").style.stroke=o.CTA_AUTO_PLAY_DISMISS_BTN_RIM_COLOR,n=new videoPlayerComponent({width:"100%",height:"100%",hideControls:[GIS_CONSTANTS.VIDEO_CONTROLS.PLAY,GIS_CONSTANTS.VIDEO_CONTROLS.VOLUME,GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT,GIS_CONSTANTS.VIDEO_CONTROLS.CHAT,GIS_CONSTANTS.VIDEO_CONTROLS.FULL_SCREEN,GIS_CONSTANTS.TIME_TYPES.BOTH,GIS_CONSTANTS.TIME_TYPES.START,GIS_CONSTANTS.TIME_TYPES.END],onPlay:function(){if(n.getPlayer().muted?o.subviews.muteBtn.style.background=uiUtilitiesService.getImageUrl("muted.png")+" no-repeat center center / "+("maximized"===s.mode?"contain":"15px"):o.subviews.muteBtn.style.background=uiUtilitiesService.getImageUrl("volume.png")+" no-repeat center center/ "+("maximized"===s.mode?"contain":"15px"),a=(new Date).getTime(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_AUTOPLAY,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:s.broadcast.config,viewMode:s.mode,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_AUTOPLAY,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),"replay"===s.type||"replay_engagement"===s.type){var e=n.getPlayer(),t=s.broadcast.config.ctaAutoPlay.duration;i=setInterval(function(){try{t=parseInt(t),(Number.isNaN(t)||t<0)&&(t=30),parseInt(c())>=t&&(e.pause(),"replay"===s.type?(b(),o.subviews.pauseBtn.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_KEEP_WATCHING_CLICKED,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:s.broadcast.config,viewMode:s.mode,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_KEEP_WATCHING_CLICKED,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),m()},"maximized"===s.mode?(o.subviews.pauseBtn.style.width="50%",o.subviews.pauseBtnImage.style.width="25%",o.subviews.pauseBtnImage.style.background=uiUtilitiesService.getImageUrl("keep-watching-icon.svg")+" center right / 25px no-repeat ",o.subviews.pauseBtnLabel.innerHTML=serverInjectionService.getLabels().ctaAutoPlay_maximizedPauseLabel):(o.subviews.pauseBtnImage.style.background=uiUtilitiesService.getImageUrl("keep-watching-icon.svg")+" center center / 30px no-repeat ",o.subviews.autoPlayDismissBtn.querySelector("svg").style.opacity=.5,o.subviews.title.innerHTML=serverInjectionService.getLabels().ctaAutoPlay_minimizedPauseLabel),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_KEEP_WATCHING_SHOWN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:s.broadcast.config,viewMode:s.mode,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_KEEP_WATCHING_SHOWN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),d=!0):u(!1),clearInterval(i),o.subviews.video.src='')}catch(e){clearInterval(i),logService.error(o.LOGTAG,"Error occurred on video-player interval.",e)}},1e3)}s.onVideoPlay()},onEnded:function(){if(clearInterval(i),o.totalPlayTime+=((new Date).getTime()-a)/1e3,a=null,eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_ENDED,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,channelConfig:{ctaAutoPlay:s.broadcast.config},viewMode:s.mode,viewDuration:o.totalPlayTime,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,videoTimeStamp:c()}),"call"===s.type||"replay_engagement"===s.type)u();else{if(b(),o.subviews.pauseBtnImage.style.background=uiUtilitiesService.getImageUrl("replay-icon.svg")+" center center / contain no-repeat ","maximized"===s.mode&&(o.subviews.pauseBtn.style.width="20%",o.subviews.pauseBtnImage.style.width="100%",o.subviews.pauseBtnLabel.style.display="none"),"minimized"===s.mode)return;t()}},trackFile:s.broadcast&&s.broadcast.config.textTrack}),o.videoView=n.render(),o.subviews.videoContainer.appendChild(o.videoView),o.subviews.video=n.getPlayer(),o.subviews.videoContainer.style.cursor="pointer",o.subviews.videoContainer.style.zIndex="8",n.hideVideoContainer(),o.subviews.videoContainer.addEventListener('touchstart',y,!0),o.subviews.videoContainer.addEventListener('click',y,!0),o.subviews.videoContainer.style.width="maximized"===s.mode?"100%":(16/9*l).toFixed()+"px",function(){if(deviceInfoService.isMobileDevice()){o.subviews.video.style.width="100%",o.subviews.video.style.height="100%";var e=window.screen.width;deviceInfoService.isIos()||(e=0===window.orientation?window.screen.width:window.screen.height);var t=9/16*e+"px";o.view.style.height="maximized"===s.mode?t:l+"px",o.view.style.width=e+"px",o.subviews.muteBtn.style.top="maximized"===s.mode?"40px":"0px","minimized"===s.mode&&(o.subviews.title.style.padding="0px 10px");var i=((e-(60+16/9*l+10))/8.23).toFixed();s.broadcast&&s.broadcast.name.length>i&&(s.broadcast.name=s.broadcast.name.substring(0,i).trim()+"...")}else o.view.style.position="fixed",o.view.style.width="370px",o.view.style.height="maximized"===s.mode?"210px":l+"px",o.view.style.bottom="0px",o.view.style["left"===s.position?"left":"right"]="0px",o.view.style["borderTop"+("left"===s.position?"Right":"Left")+"Radius"]="5px",o.view.style.overflow="hidden",o.subviews.video.style.width="maximized"===s.mode?"370px":(16/9*l).toFixed()+"px",o.subviews.video.style.height="maximized"===s.mode?"210px":l+"px",s.broadcast&&25<s.broadcast.name.length&&(s.broadcast.name=s.broadcast.name.substring(0,25).trim()+"...")}(),function(){var e=s.broadcast&&s.broadcast.urls[0]||"";if(e){if(s.broadcast.isAutoPlayable){var t=utilitiesService.getFileNameFromUrl(e);e=e.replace(t,t+"_autoplay")}o.subviews.video.src=utilitiesService.addParamToUrl(e,"v=1"),'maximized'===s.mode&&n.showCaptions()}}(),a=null,o.totalPlayTime=0,"maximized"===s.mode?'gis-autoplay-video-max':'gis-autoplay-video-min',o.subviews.autoPlayContent&&(o.subviews.autoPlayContent.onclick=m),o.view},show:function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_SHOWN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,url:utilitiesService.getPageUrl(!0),title:s.broadcast.name,videoType:s.broadcast.type,channelConfig:s.broadcast.config}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CTA_AUTOPLAY_SHOWN,{channelId:s.broadcast.channelId,broadcastId:s.broadcast.id,viewMode:s.mode,title:s.broadcast.name,videoType:s.broadcast.type}),o.view.style.animation="2s gis-slide-up forwards",o.view.style.display="block",n.getPlayer().muted=!0,n.getPlayer().play().then().catch(function(e){logService.error(o.LOGTAG,'Failed to autoplay video for the docked-player.',e)}),r=!0},hide:u,isPlayerVisible:function(){return r}}}};GISAPP.emailSubmitComponent=function(uiUtilitiesService,serverInjectionService,validationUtilitiesService){return function(t){'use strict';var e={};return e.props=t,e.validatingEmail=!1,e.invalidColor="#6d2225",e.render=function(){return e.components={},e.view=uiUtilitiesService.processView(serverInjectionService.getViews().textFieldView,{},!0),e.components.container=e.view.querySelector("#gis-input-container-v2"),e.components.inputBox=e.view.querySelector("#gis-field-input"),e.components.labelText=e.view.querySelector("#gis-email-error-text"),e.components.button=e.view.querySelector("#gis-textfield-button"),e.components.inputBox.placeholder=t.textBoxPlaceHolder,e.components.labelText.innerHTML=t.textBoxLabel,e.components.labelText.style.visibility="hidden",e.components.button.onclick=e.submit,e.components.button.style.background=uiUtilitiesService.getImageUrl("right-caret.svg")+" no-repeat center / 50% 50%",e.components.inputBox.style.animation="1s gis-fade-in forwards",e.components.button.style.animation="1s gis-fade-in forwards",window.addEventListener("keyup",e._pressEnterKey),e.components.inputBox.oninput=function(){e.validatingEmail&&e.validateEmail()},e.view},e.getText=function(){return e.components.inputBox.value},e.validateEmail=function(){return validationUtilitiesService.validateEmail(e.getText().toLowerCase().trim())?(e.components.button.style.backgroundColor="",!(e.components.button.style.borderColor="")):(e.components.button.style.backgroundColor=e.invalidColor,e.components.button.style.border="3px solid"+e.invalidColor,e.components.button.style.filter="brightness(2)",!(e.validatingEmail=!0))},e._pressEnterKey=function(t){t.preventDefault(),13===t.keyCode&&e.submit()},e.submit=function(){e.validateEmail()&&(e.components.labelText.style.visibility="hidden",window.removeEventListener("keyup",e._pressEnterKey),t.buttonClick&&"function"==typeof t.buttonClick&&t.buttonClick())},e.disableButton=function(){e.components.button.style.cursor="unset"},e.enableButton=function(){e.components.button.style.cursor="pointer"},e.showError=function(t){e.components.labelText.innerHTML=t,e.components.labelText.style.visibility="visible"},{render:e.render,getText:e.getText,showError:e.showError,disableButton:e.disableButton,enableButton:e.enableButton}}};GISAPP.infoPopup=function(uiUtilitiesService,serverInjectionService){return function(o){'use strict';var r;return{render:function(){return r=uiUtilitiesService.processView(serverInjectionService.getViews().infoPopupView,{}),function(){var e=r.querySelector('#gis-info-popup-main-text'),n=r.querySelector('#gis-info-popup-sub-main-text');e.innerHTML=o.mainText,n.innerHTML=o.subMainText;var i=r.querySelector('#gis-info-popup-icon');i.innerHTML=o.image,o.svgColor&&(i.children[0].children[0].style.fill=o.svgColor),r.querySelector('#gis-info-popup-close-button').onclick=o.onClose}(),r}}}};GISAPP.labeledTextInputComponent=function(serverInjectionService,uiUtilitiesService){return function(e){'use strict';var t={};return{render:function(){return t.components={},t.view=uiUtilitiesService.processView(serverInjectionService.getViews().textBoxView,{},!0),t.components.fieldWrapper=t.view.querySelector("#gis-text-field-wrapper"),t.components.TextField=t.view.querySelector("#gis-text-field"),e.placeholder?t.components.TextField.placeholder=e.placeholder:t.components.TextField.style.display='none',t.view},getValue:function(){return t.components.TextField.value}}}};GISAPP.loaderComponent=function(uiUtilitiesService){return function(e){'use strict';var n;return{render:function(){var e=uiUtilitiesService.createElementWithAttributes;n=e('div','','','width: 100%; height: 100%; position: absolute; z-index: 10; display: flex; align-items: center; top: 0; background: white; border-radius: 15px;');var t=e('div','','gis-rotate','width: 100%; height: 70px;');return t.style.background=uiUtilitiesService.getImageUrl("connecting.svg")+" center center / contain no-repeat",n.append(t),n},hide:function(){n.style.display='none'}}}};GISAPP.mediaShareComponent=function(serverInjectionService,uiUtilitiesService,buttonComponent,switchComponent,deviceInfoService){return function(a){var s,n,t,i,r,o,d,l=a,c={},u={};function m(e){var i;e.audio.isAllowed?c.mic.unMute():(c.mic.mute(),c.mic.disable()),function(e){e.isDetected||c.camera.disable();c.camera.mute()}(e.video),(i=e).audio.isAllowed&&i.video.isAllowed?t.innerText=serverInjectionService.getLabels().micAndCameraSetup_allowed:i.audio.isAllowed&&!i.video.isAllowed?t.innerText=serverInjectionService.getLabels().micAndCameraSetup_cameraBlocked:i.audio.isAllowed||(t.innerText=serverInjectionService.getLabels().micAndCameraSetup_micBlocked,r.innerText=serverInjectionService.getLabels().micAndCameraSetup_micBlockedPreview),function(e){var i=u[l.buttons[0].name],s=l.buttons[0];s.buttonLabel=serverInjectionService.getLabels().micAndCameraSetup_continue,e.audio.isAllowed?(s.onClick=a.onMediaAllow,s.buttonClass="gis-v3-button",s.responseLabel=null,uiUtilitiesService.removeClass(i.subviews.button,'gis-v3-button-loading')):(s.eventName=null,s.isResponsive=!1,s.onClick=function(){});i.setup(s)}(e),uiUtilitiesService.removeClass(d,'gis-screen-default-aligned'),uiUtilitiesService.removeClass(o,'gis-hide'),uiUtilitiesService.addClass(t,'gis-media-shared'),l.screenProps&&l.screenProps.updateModalImage&&e&&e.audio.isAllowed&&e.video.isAllowed&&l.screenProps.updateModalImage(!0),l.screenProps&&l.screenProps.hideModalImage&&deviceInfoService.isMobileDevice()&&l.screenProps.hideModalImage()}return{render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().mediaShareView,{},!1);return o=e.querySelector('#gis-ms-container'),s=e.querySelector("#gis-ms-buttons-container"),n=e.querySelector("#gis-ms-switch-container"),t=e.querySelector("#gis-ms-title"),i=e.querySelector("#gis-ms-preview-container"),r=e.querySelector("#gis-ms-preview-text"),d=e.querySelector("#gis-connectv3-content-container"),function(){if(Array.isArray(l.buttons))for(var e=0;e<l.buttons.length;e++){var i=new buttonComponent(l.buttons[e]);u[l.buttons[e].name]=i,uiUtilitiesService.appendView(s,i.render())}}(),function(){if(Array.isArray(l.switches))for(var e=0;e<l.switches.length;e++){var i=new switchComponent(l.switches[e]);c[l.switches[e].name]=i,uiUtilitiesService.appendView(n,i.render())}}(),t.innerText=serverInjectionService.getLabels().micAndCameraSetup_title,uiUtilitiesService.addClass(t,'gis-media-shared'),l&&l.mediaDevices&&l.mediaDevices.audio.isAllowed&&l.mediaDevices.video.isAllowed?(m(l.mediaDevices),l.screenProps&&l.screenProps.updateModalImage&&l.screenProps.updateModalImage(!0)):(deviceInfoService.isMobileDevice()||uiUtilitiesService.addClass(d,'gis-screen-default-aligned'),uiUtilitiesService.addClass(o,'gis-hide'),uiUtilitiesService.removeClass(t,'gis-media-shared'),l.screenProps&&l.screenProps.updateModalImage&&l.screenProps.updateModalImage(!1)),e},updateStatus:m,displayPreview:function(e){e.style.width="inherit",e.style.height="inherit",i.appendChild(e)}}}};GISAPP.modalComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,browserInfoService,stepsComponent,eventLoggerService,urlUtilitiesService,stateService){return function(i){'use strict';var s={},l={},r=!1,d=!1,a=[];function c(e){if(uiUtilitiesService.enableBodyScroll(),r){r=!1;try{if(s.background.style.animation="1s gis-fade-out forwards",document.body.removeChild(s.outer),setTimeout(function(){document.body.removeChild(s.background)},1e3),d)return;deviceInfoService.isMobileDevice()&&(browserInfoService.isChrome()||browserInfoService.isSafari())&&window.removeEventListener("resize",h,!1),void 0!==e&&!1!==e||window.dispatchEvent(new GisCustomEvent("gisUIClosed")),window.getSelection&&window.getSelection().removeAllRanges()}catch(e){}}}function u(e,t){if(r)return d=t&&t.isChatFirstCall,uiUtilitiesService.clearView(s.modalContent),l.child=e({updateChild:u,event:i.event,parentView:s.modalContent,steps:l.steps,ctrlFunctions:i.ctrlFunctions,hide:c,setTitle:y,hideFooter:p,showFooter:g,closeButton:s.closeButton,extendOnClose:f,updateFooterText:m,hideInfoButton:C,showInfoButton:w,extraProps:t,modalContainer:s.modal,hideCloseButton:o,showCloseButton:n}),uiUtilitiesService.appendView(s.modalContent,l.child.render()),l.child}function n(){s.closeButton.style.display='inherit'}function o(){s.closeButton.style.display='none'}function f(e){'function'==typeof e&&a.push(e)}function p(){s.footer.style.display='none'}function g(){s.footer.style.display='flex'}function m(e){s.disclaimer.innerHTML=e}function y(e){e?(s.title.style.display="flex",s.title.innerHTML=e):s.title.style.display="none"}function w(){s.infoButton.style.display='flex'}function C(){s.infoButton.style.display='none'}function h(){s.modal.style.height=window.innerHeight+"px",s.modal.style.animation="none"}return{render:function(){d=!(r=!0);var e=serverInjectionService.getUiConfig(),t=uiUtilitiesService.processView(serverInjectionService.getViews().modalView,{},!0);s.background=t.querySelector("#gis-bg-cover"),s.outer=t.querySelector("#gis-outer-panel2"),s.inner=t.querySelector("#gis-inner-panel"),s.modal=t.querySelector("#gis-modal-container"),s.modalContent=t.querySelector("#gis-modal-content"),s.title=t.querySelector("#gis-modal-title"),s.closeButton=t.querySelector("#gis-modal-close"),s.footer=t.querySelector("#gis-footer"),s.disclaimer=t.querySelector("#gis-connectv3-disclaimer"),s.poweredByGis=t.querySelector("#gis-powered-by"),s.infoButton=t.querySelector("#gis-info"),e.gisBranding?(s.poweredByGis.style.backgroundImage=uiUtilitiesService.getImageUrl("powered-by.svg"),s.poweredByGis.onclick=function(){window.open('//www.goinstore.com','_blank'),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_POWEREDBYEMPLIFI_TEXT_CLICKED)}):uiUtilitiesService.addClass(s.poweredByGis,"gis-hide");var n="";if(0===n.length||i.hideDisclaimerOnSurveyScreen?s.disclaimer.style.display="none":(s.disclaimer.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.DISCLAIMER_CLICKED)},s.disclaimer.innerHTML=n),i.steps&&0<i.steps&&(l.steps=new stepsComponent({stepNumber:i.steps}),uiUtilitiesService.appendView(s.footer,l.steps.render())),y(i.title),s.closeButton.onclick=function(){i.eventName&&eventLoggerService.logEvent(i.eventName+eventLoggerService.GIS_ACTIONS.CLOSED,i.eventData?i.eventData:null),a.forEach(function(e){e()}),c()},i.child&&u(i.child,i.extraProps),deviceInfoService.isMobileDevice()&&(uiUtilitiesService.addClass(s.modal,"gis-mobile"),uiUtilitiesService.addClass(s.poweredByGis,"gis-mobile"),uiUtilitiesService.addClass(s.disclaimer,"gis-mobile"),(browserInfoService.isChrome()||browserInfoService.isSafari())&&(h(),window.addEventListener("resize",h,!1)),e.gisBranding&&l.steps&&l.steps.hide()),e.supportInfoLink){var o=urlUtilitiesService.getSupportInfoUrl(e.supportInfoLink,stateService.getLocale());s.infoButton.style.background=uiUtilitiesService.getImageUrl("info-logo.svg")+" center center / 6px no-repeat",o&&(s.infoButton.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SUPPORT_INFO_LINK_CLICKED),window.open(o,'_blank')})}return s.background.style.animation="1s gis-fade-in forwards",s.outer.style.display="table",window.dispatchEvent(new GisCustomEvent("gisUIOpen")),t},getChild:function(){return l.child},updateChild:u,setTitle:y,hide:c,isVisible:function(){return r}}}};GISAPP.multiStreamComponent=function(uiUtilitiesService,videoComponent,streamService,eventLoggerService,stateService){return function(e){'use strict';var d,u,c='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="white"/><path d="M3.5 3H2C0.895447 3 0 3.89539 0 5V6.5C0 6.77612 0.223877 7 0.5 7H1.5C1.77612 7 2 6.77612 2 6.5V5H3.5C3.77612 5 4 4.77612 4 4.5V3.5C4 3.22382 3.77612 3 3.5 3Z" fill="white"/><path d="M22 3H20.5C20.2239 3 20 3.22382 20 3.5V4.5C20 4.77612 20.2239 5 20.5 5H22V6.5C22 6.77612 22.2239 7 22.5 7H23.5C23.7761 7 24 6.77612 24 6.5V5C24 3.89539 23.1046 3 22 3Z" fill="white"/><path d="M23.5 17H22.5C22.2239 17 22 17.2238 22 17.5V19H20.5C20.2239 19 20 19.2238 20 19.5V20.5C20 20.7761 20.2239 21 20.5 21H22C23.1046 21 24 20.1046 24 19V17.5C24 17.2238 23.7761 17 23.5 17Z" fill="white"/><path d="M3.5 19H2V17.5C2 17.2238 1.77612 17 1.5 17H0.5C0.223877 17 0 17.2238 0 17.5V19C0 20.1046 0.895447 21 2 21H3.5C3.77612 21 4 20.7761 4 20.5V19.5C4 19.2238 3.77612 19 3.5 19Z" fill="white"/></svg>';function n(e,t){var n=uiUtilitiesService.createElementWithAttributes("div",null,"gis-tap-to-focus","display:none");n.innerHTML=c;var i=uiUtilitiesService.createElementWithAttributes("div",null,"gis-call-video-pause-image-multi-stream","display:none"),r=uiUtilitiesService.createElementWithAttributes("div",null,"gis-secondary-user-info",null),a=uiUtilitiesService.createElementWithAttributes("div",null,"gis-secondary-user-display-name",null);i.style.backgroundImage=uiUtilitiesService.getImageUrl("video-mute-desktop.jpg");var o,l,s=uiUtilitiesService.createElementWithAttributes("div",null,"gis-video-container",'background:black');r.appendChild(a),s.appendChild(e),s.appendChild(r),s.appendChild(n),s.appendChild(i),s.onclick=m,l=n,(o=s).onmouseover=function(){l.style.display='flex'},o.onmouseout=function(){l.style.display='none'},o.ontouchstart=function(){var e;(e=l).style.display='flex',setTimeout(function(){e.style.display='none'},1e3)},t&&'screen'===t.videoType&&(u=s),d.appendChild(s),C(p(t),a)}function m(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.TAP_TO_FOCUS_BUTTON_CLICKED),e.switchStream(this)}function p(e){if(e&&e.connection&&'string'==typeof e.connection.data){var t=JSON.parse(e.connection.data);return"CLERK"===t.userType?t.publisher.displayName?t.publisher.displayName:"Advisor":i(e)}return i(e)}function i(e){return e&&e.connection&&e.connection.id?"Guest "+stateService.getIdFromConsumerMap(e.connection.id):"Guest 1"}function C(e,t){t&&e&&(t.innerHTML=e,t.style.position='absolute')}return{render:function(){return d=uiUtilitiesService.createElementWithAttributes("div","gis-multi-video-container",null,null)},addVideo:n,addStream:function(e){var t=new videoComponent({id:e.streamId,class:"gis-secondary-subscriber"}).render();streamService.addStreamToMap(e.streamId,e,t),n(t,e)},removeStream:function(e){var t=streamService.getStreamFromMap(e);t&&uiUtilitiesService.removeNode(t.element.parentNode)},getFirstSecondaryStream:function(){if(d&&d.firstChild)return d.firstChild},getScreenShareStream:function(){return u},hideNoVideoImage:function(e){streamService.getStreamFromMap(e).element.parentNode.querySelector(".gis-call-video-pause-image-multi-stream").style.display="none"},showNoVideoImage:function(e){streamService.getStreamFromMap(e).element.parentNode.querySelector(".gis-call-video-pause-image-multi-stream").style.display="block"},isStreamsExists:function(){return d&&uiUtilitiesService.hasChildNodes(d)},showMultiClerkDisplayName:C,getDisplayNameFromStream:p}}};GISAPP.popup=function(serverInjectionService,popupLayout,infoPopup,uiUtilitiesService,ctaPopup){return function(o){'use strict';var l,C={preCallScreen_MicNeeded:ctaPopup,chatInactivityPrompt:ctaPopup,startCallPrompt:ctaPopup,incomingCallPrompt:ctaPopup,endCallPrompt:ctaPopup,outgoingCallDeclined:ctaPopup},i={preCallScreen_MicNeeded:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 1.80665e-09C10.72 8.06968e-10 -8.06968e-10 10.72 -1.80665e-09 24C-2.80633e-09 37.28 10.72 48 24 48C37.28 48 48 37.28 48 24C48 10.72 37.28 2.80633e-09 24 1.80665e-09ZM26.2841 19.8004L26.2841 37.0909L21.6499 37.0909L21.6499 19.8004L26.2841 19.8004ZM21.3782 15.326C21.3782 14.6335 21.6072 14.0636 22.0653 13.6161C22.5341 13.1687 23.168 12.945 23.967 12.945C24.7553 12.945 25.3839 13.1687 25.8526 13.6161C26.3214 14.0636 26.5558 14.6335 26.5558 15.326C26.5558 16.0291 26.3161 16.6044 25.8366 17.0518C25.3679 17.4993 24.7447 17.723 23.967 17.723C23.1893 17.723 22.5607 17.4993 22.0813 17.0518C21.6126 16.6044 21.3782 16.0291 21.3782 15.326Z" fill="#2BBAE7"/></svg>',chatInactivityPrompt:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 1.80665e-09C10.72 8.06968e-10 -8.06968e-10 10.72 -1.80665e-09 24C-2.80633e-09 37.28 10.72 48 24 48C37.28 48 48 37.28 48 24C48 10.72 37.28 2.80633e-09 24 1.80665e-09ZM26.2841 19.8004L26.2841 37.0909L21.6499 37.0909L21.6499 19.8004L26.2841 19.8004ZM21.3782 15.326C21.3782 14.6335 21.6072 14.0636 22.0653 13.6161C22.5341 13.1687 23.168 12.945 23.967 12.945C24.7553 12.945 25.3839 13.1687 25.8526 13.6161C26.3214 14.0636 26.5558 14.6335 26.5558 15.326C26.5558 16.0291 26.3161 16.6044 25.8366 17.0518C25.3679 17.4993 24.7447 17.723 23.967 17.723C23.1893 17.723 22.5607 17.4993 22.0813 17.0518C21.6126 16.6044 21.3782 16.0291 21.3782 15.326Z" fill="#2BBAE7"/></svg>',outgoingCallDeclined:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 1.80665e-09C10.72 8.06968e-10 -8.06968e-10 10.72 -1.80665e-09 24C-2.80633e-09 37.28 10.72 48 24 48C37.28 48 48 37.28 48 24C48 10.72 37.28 2.80633e-09 24 1.80665e-09ZM26.2841 19.8004L26.2841 37.0909L21.6499 37.0909L21.6499 19.8004L26.2841 19.8004ZM21.3782 15.326C21.3782 14.6335 21.6072 14.0636 22.0653 13.6161C22.5341 13.1687 23.168 12.945 23.967 12.945C24.7553 12.945 25.3839 13.1687 25.8526 13.6161C26.3214 14.0636 26.5558 14.6335 26.5558 15.326C26.5558 16.0291 26.3161 16.6044 25.8366 17.0518C25.3679 17.4993 24.7447 17.723 23.967 17.723C23.1893 17.723 22.5607 17.4993 22.0813 17.0518C21.6126 16.6044 21.3782 16.0291 21.3782 15.326Z" fill="#2BBAE7"/></svg>'};return{render:function(){var e=new popupLayout({position:o.position,backgroundClass:o.backgroundClass}),n=(l=e.render()).querySelector('#gis-popup-container'),t=(o.popupContent.image=o.popupContent.image||i[o.type],o.popupContent.onClose=function(){uiUtilitiesService.removeNode(l)},new C[o.type](o.popupContent).render());return n.append(t),l}}}};GISAPP.productCarouselTileComponent=function(serverInjectionService,uiUtilitiesService,eventService,GIS_CONSTANTS,eventLoggerService){return function(i){'use strict';var n={},o={},e=i.id,t=i.sku,r=i.productUrl,s=i.addedToBasket,a=i.ctaMode,l=i.onAccept||function(){},c='<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_869_19479)"><path d="M14.4896 3.16665H13.8434C13.7467 3.16665 13.6549 3.20864 13.5915 3.28156C13.5283 3.35447 13.4997 3.45148 13.5133 3.54718C13.5472 3.78416 13.5632 3.9811 13.5632 4.16665C13.5632 6.55597 11.6191 8.49998 9.22982 8.49998C6.8405 8.49998 4.89648 6.55597 4.89648 4.16665C4.89648 3.9811 4.91244 3.78416 4.94629 3.54718C4.95996 3.45148 4.93132 3.35447 4.86816 3.28156C4.80469 3.20864 4.71289 3.16665 4.61621 3.16665H3.84253L3.57174 2.30109C3.48466 2.02277 3.22685 1.83331 2.93522 1.83331H1.22982C1.04574 1.83331 0.896484 1.98252 0.896484 2.16665V2.83331C0.896484 3.0174 1.04574 3.16665 1.22982 3.16665H2.44531L4.55253 9.90123L3.56315 10.8906C3.18034 11.2731 3.06706 11.8434 3.27409 12.3434C3.48112 12.8434 3.96484 13.1666 4.50586 13.1666H13.8965C14.0806 13.1666 14.2298 13.0174 14.2298 12.8333V12.1666C14.2298 11.9825 14.0806 11.8333 13.8965 11.8333H4.50586L5.83919 10.5H11.9284C12.4424 10.5 12.916 10.1995 13.1351 9.73435L15.4613 4.79132C15.528 4.64907 15.5632 4.49119 15.5632 4.33462V4.24021C15.5632 3.64809 15.0817 3.16665 14.4896 3.16665Z" fill="#B181EA"/><path d="M4.89632 16.5C5.6327 16.5 6.22965 15.9031 6.22965 15.1667C6.22965 14.4303 5.6327 13.8334 4.89632 13.8334C4.15994 13.8334 3.56299 14.4303 3.56299 15.1667C3.56299 15.9031 4.15994 16.5 4.89632 16.5Z" fill="#B181EA"/><path d="M12.8968 16.5C13.6332 16.5 14.2301 15.9031 14.2301 15.1667C14.2301 14.4303 13.6332 13.8334 12.8968 13.8334C12.1604 13.8334 11.5635 14.4303 11.5635 15.1667C11.5635 15.9031 12.1604 16.5 12.8968 16.5Z" fill="#B181EA"/><path d="M9.22966 7.83333C11.2515 7.83333 12.8963 6.18848 12.8963 4.16667C12.8963 2.14486 11.2515 0.5 9.22966 0.5C7.20785 0.5 5.56299 2.14486 5.56299 4.16667C5.56299 6.18848 7.20785 7.83333 9.22966 7.83333ZM7.32731 4.26432C7.45752 4.13411 7.66846 4.13411 7.79867 4.26432L8.56299 5.02865L10.6606 2.93099C10.7909 2.80078 11.0018 2.80078 11.132 2.93099C11.2622 3.0612 11.2622 3.27214 11.132 3.40234L8.79867 5.73568C8.73356 5.80078 8.64827 5.83333 8.56299 5.83333C8.4777 5.83333 8.39242 5.80078 8.32731 5.73568L7.32731 4.73568C7.1971 4.60547 7.1971 4.39453 7.32731 4.26432Z" fill="#B181EA"/></g><defs><clipPath id="clip0_869_19479"><rect width="16" height="16" fill="white" transform="translate(0.22998 0.5)"/></clipPath></defs></svg>';function u(e){var t,i,r;n.props=e,d(n.props.addedToBasket),n.props.imageUrl&&(o.image.style.backgroundImage="url('"+n.props.imageUrl+"')"),n.props.title&&(o.title.innerHTML=n.props.title),n.props.price&&(o.price.innerHTML=n.props.price),n.props.price&&n.props.currency&&(o.price.innerHTML=(t=n.props.price,i=n.props.currency,r=i,(GIS_CONSTANTS.CURRENCY_MAP[r]||GIS_CONSTANTS.CURRENCY_MAP.GBP)+' '+t)),n.props.alignment&&C(n.props.alignment),p()}function p(){switch(a){case"popup":o.container.onclick=function(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.SHOW_PRODUCT_DETAILS_POPUP,{data:f()}),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CLICKED_ON_PRODUCT_CAROUSEL,{data:f()})};break;case"none":o.container.onclick=function(){return!1};break;default:o.container.onclick=g}}function d(e){if(s=e){uiUtilitiesService.addClass(o.container,'gis-added-to-basket'),uiUtilitiesService.removeClass(o.status,'gis-hide'),o.status.innerHTML=c;var t=uiUtilitiesService.createElementWithAttributes('div','gis-carousel-tile-added-to-basket','gis-carousel-tile-added-to-basket',null);t.innerHTML=serverInjectionService.getLabels().product_tile_added_to_basket_label,o.status.appendChild(t),o.price.style.display='none'}else uiUtilitiesService.removeClass(o.container,'gis-added-to-basket'),o.status.setAttribute('class','gis-carousel-tile-info-status gis-hide'),o.status.innerHTML=''}function C(e){uiUtilitiesService.removeClass(o.container,'horizontal mobile'),uiUtilitiesService.removeClass(o.container,'horizontal'),uiUtilitiesService.removeClass(o.container,'vertical'),uiUtilitiesService.addClass(o.container,e)}function g(){window.open(r,'_blank'),window.focus()}function f(){return{id:e,sku:t,productUrl:i.productUrl,title:i.title,imageUrl:i.imageUrl,price:i.price,currency:i.currency||null,addedToBasket:s,onAccept:l}}return{render:function(){var e,t=uiUtilitiesService.processView(serverInjectionService.getViews().productCarouselTileView,{},!1);return o.container=t,o.image=t.querySelector("#gis-carousel-tile-image"),o.infoWrap=t.querySelector("#gis-carousel-tile-infoWrap"),o.title=t.querySelector("#gis-carousel-tile-info-title"),o.price=t.querySelector("#gis-carousel-tile-info-price"),o.status=t.querySelector("#gis-carousel-tile-info-status"),i.customTile?(e=i,n.props=e,uiUtilitiesService.addClassOnList(o.infoWrap.querySelectorAll('*'),'gis-hide'),uiUtilitiesService.removeClass(o.title,'gis-hide'),o.image.innerHTML=e.image,o.title.innerHTML=e.title,e.alignment&&C(e.alignment)):u(i),t},setup:u,updateOrientation:C,getSku:function(){return t},getId:function(){return e},getUrl:function(){return r},isAddedToBasket:function(){return s},addToBasket:function(){l(),d(!0),a='none',p()},updateAddToBasketStatus:d,getInfo:f}}};GISAPP.productPopupComponent=function(uiUtilitiesService,GIS_CONSTANTS,buttonComponent,serverInjectionService,userProfileComponent,productCarouselTileComponent,globalObjectService,carouselService,eventLoggerService,stateService,utilitiesService,addToCartService,deviceInfoService){return function(c){'use strict';var p=[],l='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.707 8.29297C15.3164 7.90234 14.6836 7.90234 14.293 8.29297L12 10.5859L9.70703 8.29297C9.31641 7.90234 8.68359 7.90234 8.29297 8.29297C7.90234 8.68359 7.90234 9.31641 8.29297 9.70703L10.5859 12L8.29297 14.293C7.90234 14.6836 7.90234 15.3164 8.29297 15.707C8.48828 15.9023 8.74414 16 9 16C9.25586 16 9.51172 15.9023 9.70703 15.707L12 13.4141L14.293 15.707C14.4883 15.9023 14.7441 16 15 16C15.2559 16 15.5117 15.9023 15.707 15.707C16.0977 15.3164 16.0977 14.6836 15.707 14.293L13.4141 12L15.707 9.70703C16.0977 9.31641 16.0977 8.68359 15.707 8.29297Z" fill="#0E0E10"/><path fill-rule="evenodd" clip-rule="evenodd" d="M12.0008 3.17828C7.12822 3.17828 3.17828 7.12795 3.17828 12C3.17828 16.8721 7.12822 20.8217 12.0008 20.8217C16.8734 20.8217 20.8234 16.8721 20.8234 12C20.8234 7.12795 16.8734 3.17828 12.0008 3.17828ZM2 12C2 6.4771 6.47757 2 12.0008 2C17.5241 2 22.0016 6.4771 22.0016 12C22.0016 17.5229 17.5241 22 12.0008 22C6.47757 22 2 17.5229 2 12Z" fill="#0E0E10"/></svg>',C=c.popUpContainer,n='<svg width="48" height="49" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_3912_5839)"><path d="M42.7793 8.52832H40.8408C40.5508 8.52832 40.2754 8.6543 40.085 8.87305C39.8955 9.0918 39.8096 9.38281 39.8506 9.66992C39.9521 10.3809 40 10.9717 40 11.5283C40 18.6963 34.168 24.5283 27 24.5283C19.832 24.5283 14 18.6963 14 11.5283C14 10.9717 14.0479 10.3809 14.1494 9.66992C14.1904 9.38281 14.1045 9.0918 13.915 8.87305C13.7246 8.6543 13.4492 8.52832 13.1592 8.52832H10.8381L10.0258 5.93164C9.76453 5.09668 8.99109 4.52832 8.11621 4.52832H3C2.44775 4.52832 2 4.97595 2 5.52832V7.52832C2 8.08057 2.44775 8.52832 3 8.52832H6.64648L12.9681 28.7321L10 31.7002C8.85156 32.8477 8.51172 34.5586 9.13281 36.0586C9.75391 37.5586 11.2051 38.5283 12.8281 38.5283H41C41.5522 38.5283 42 38.0806 42 37.5283V35.5283C42 34.976 41.5522 34.5283 41 34.5283H12.8281L16.8281 30.5283H35.0957C36.6377 30.5283 38.0586 29.627 38.7158 28.2314L45.6943 13.4023C45.8945 12.9756 46 12.502 46 12.0322V11.749C46 9.97266 44.5557 8.52832 42.7793 8.52832Z" fill="#25DAC5"/><path d="M14 48.5283C16.2091 48.5283 18 46.7375 18 44.5283C18 42.3192 16.2091 40.5283 14 40.5283C11.7909 40.5283 10 42.3192 10 44.5283C10 46.7375 11.7909 48.5283 14 48.5283Z" fill="#25DAC5"/><path d="M38 48.5283C40.2091 48.5283 42 46.7375 42 44.5283C42 42.3192 40.2091 40.5283 38 40.5283C35.7909 40.5283 34 42.3192 34 44.5283C34 46.7375 35.7909 48.5283 38 48.5283Z" fill="#25DAC5"/><path d="M27 22.5283C33.0654 22.5283 38 17.5938 38 11.5283C38 5.46289 33.0654 0.52832 27 0.52832C20.9346 0.52832 16 5.46289 16 11.5283C16 17.5938 20.9346 22.5283 27 22.5283ZM21.293 11.8213C21.6836 11.4307 22.3164 11.4307 22.707 11.8213L25 14.1143L31.293 7.82129C31.6836 7.43066 32.3164 7.43066 32.707 7.82129C33.0977 8.21191 33.0977 8.84473 32.707 9.23535L25.707 16.2354C25.5117 16.4307 25.2559 16.5283 25 16.5283C24.7441 16.5283 24.4883 16.4307 24.293 16.2354L21.293 13.2354C20.9023 12.8447 20.9023 12.2119 21.293 11.8213Z" fill="#25DAC5"/></g><defs><clipPath id="clip0_3912_5839"><rect width="48" height="48" fill="white" transform="translate(0 0.52832)"/></clipPath></defs></svg>';function s(){var e=c.payload;uiUtilitiesService.addClass(C,'gis-'+c.type+'-'+e.type),uiUtilitiesService.addClass(C,'gis-ss-player-popup'),uiUtilitiesService.addClass(C,'gis-product-popup'),c.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA?e.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.ADD_A_PERSON?function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().addAPersonView,{});e.querySelector('#gis-popup-title').innerHTML=serverInjectionService.getLabels().product_popup_addAPerson_title;var t=e.querySelector('#gis-close-popup'),i=e.querySelector('#gis-popup-share-links-wrapper'),a=e.querySelector('#gis-popup-mobile-share-button-wrapper');if(deviceInfoService.isPhoneOrTablet()){uiUtilitiesService.removeClass(a,'gis-hide'),uiUtilitiesService.addClass(i,'gis-hide');var o=e.querySelector('#gis-popup-button-share');o.innerHTML+=serverInjectionService.getLabels().product_popup_addAPerson_share_button_text;var p=e.querySelector('#gis-popup-button-cancel');p.innerHTML=serverInjectionService.getLabels().product_popup_addAPerson_cancel_button_text,o.onclick=function(){void 0!==globalObjectService.getWindow().navigator.share&&globalObjectService.getWindow().navigator.share({url:_()})},p.onclick=function(){g(GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.ADD_A_PERSON)}}else{var n=e.querySelector('#gis-popup-share-email'),l=e.querySelector('#gis-popup-share-whatsapp');l.setAttribute('target','_blank'),n.onclick=function(){globalObjectService.getWindow().open('mailto:?body='+encodeURIComponent(_()))},l.onclick=function(){globalObjectService.getWindow().open('https://api.whatsapp.com/send?text='+encodeURIComponent(_()),'_blank')}}t.onclick=function(){g(GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.ADD_A_PERSON)},e.querySelector('#gis-popup-warning-text').innerHTML=serverInjectionService.getLabels().product_popup_addAPerson_warning_text,e.querySelector('#gis-popup-alert-message').innerHTML=serverInjectionService.getLabels().product_popup_addAPerson_alert_text,e.querySelector('#gis-popup-subtext').innerHTML=serverInjectionService.getLabels().product_popup_addAPerson_subtitle;var s=e.querySelector('#gis-popup-alert'),r=e.querySelector('#gis-copy-button-container');if(r.onclick=function(){var e=r.appendChild(uiUtilitiesService.createElementWithAttributes("input",null,null,null));e.value=globalObjectService.getWindow().location.href,c.isOneToOneCall&&(e.value=_()),e.focus(),e.select(),document.execCommand('copy'),e.parentNode.removeChild(e),s.style.display='flex',setTimeout(function(){s.style.display='none',h()},3e3)},c.isMultiParty){var d=e.querySelector('#gis-popup-warning');d.style.display='none'}var u=globalObjectService.getWindow().location.href;c.isOneToOneCall&&(u=_());28<globalObjectService.getWindow().location.href.length&&(u=u.substring(0,24)+'...');e.querySelector('#gis-url').innerHTML=u,C.appendChild(e)}():function(){var e=c.payload,t=uiUtilitiesService.createElementWithAttributes('div','gis-popup-header','gis-popup-header',null);C.appendChild(t);var i=uiUtilitiesService.createElementWithAttributes('div','gis-popup-content','gis-popup-content',null);if(C.appendChild(i),c.payload.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.SHARED){var a=new userProfileComponent;t.appendChild(a.render()),a.setup({userDisplayName:e.clerkName,userImageName:e.clerkName});var o=uiUtilitiesService.createElementWithAttributes('div','gis-popup-subtext','gis-popup-subtext',null);o.innerHTML=r('product_popup_shared_subtext'),i.appendChild(o),i.appendChild(d()),u(e.onReject)}else{var p=uiUtilitiesService.createElementWithAttributes('div','gis-popup-title','gis-popup-title gis-title',null);p.innerHTML=r('product_details_popup_label'),t.appendChild(p);var n=uiUtilitiesService.createElementWithAttributes('div','gis-close-popup','gis-close-popup gis-icon',null);n.onclick=function(){g(GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.DETAILS,d())},n.innerHTML=l,t.appendChild(n),i.appendChild(d()),u(function(){})}}():e.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO_TYPES.CAROUSEL_PROMPT?function(e){var t=uiUtilitiesService.processView(serverInjectionService.getViews().productPromptView,{}),i=t.querySelector('#gis-ss-carousel-prompt-success-message'),a=t.querySelector('#gis-ss-carousel-prompt');a&&uiUtilitiesService.clearView(a);i.innerHTML=serverInjectionService.getLabels().product_carousel_prompt_message;var o=e.querySelector('#gis-carousel-tile-image'),p=e.querySelector('#gis-carousel-tile-infoWrap');uiUtilitiesService.removeClass(e,'horizontal'),uiUtilitiesService.addClass(e,'gis-product-prompt'),uiUtilitiesService.addClass(o,'gis-product-prompt-image'),uiUtilitiesService.addClass(p,'gis-product-prompt-infoWrap'),a.appendChild(e),C.appendChild(t),C.setAttribute('class','gis-ss-carousel-prompt'),setTimeout(function(){uiUtilitiesService.addClass(C,'gis-ss-prompt-animation'),setTimeout(function(){uiUtilitiesService.removeClass(C,'gis-ss-prompt-animation'),uiUtilitiesService.removeClass(C,'gis-ss-carousel-prompt-container'),uiUtilitiesService.addClass(C,'gis-hide')},600)},5e3)}(c.productTile):function(){var e=uiUtilitiesService.createElementWithAttributes('div','gis-popup-info-image','gis-popup-info-image',null);C.appendChild(e),e.innerHTML=c.payload.data.image;var t=uiUtilitiesService.createElementWithAttributes('div','gis-popup-info-title','gis-popup-info-title',null);C.appendChild(t),t.innerHTML=c.payload.data.title;var i=uiUtilitiesService.createElementWithAttributes('div','gis-popup-info-subtitle','gis-popup-info-subtitle',null);C.appendChild(i),i.innerHTML=c.payload.data.subtitle,setTimeout(function(){c.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO&&C.classList.contains('gis-info-addedToCart')&&h()},3e3)}()}function r(e){return c.labels&&c.labels[e]?c.labels[e]:serverInjectionService.getLabels()[e]}function _(){var e=utilitiesService.getPageUrl(!0);if(e.includes('giscallconnect'))return e;var t=utilitiesService.removeQueryParamsExceptSome(['gis']);return t.includes('?')?t+'&giscallconnect='+stateService.getCallUUID():t+'?giscallconnect='+stateService.getCallUUID()}function g(e,t){e===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.DETAILS&&eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CLOSED_BUTTON_CLICKED_ON_DETAILED_CARD,{data:t}),h()}function d(){var e=c.payload.data,t=uiUtilitiesService.createElementWithAttributes('div','gis-popup-productTiles','gis-popup-productTiles',null),i=new productCarouselTileComponent({id:e.id,productUrl:e.productUrl,imageUrl:e.imageUrl,title:e.title,price:e.price,currency:e.currency||null,onAccept:e.onAccept,alignment:"horizontal mobile",addedToBasket:e.addedToBasket,ctaMode:'none'});return t.appendChild(i.render()),p=[i],t}function u(e){var t=uiUtilitiesService.createElementWithAttributes('div','gis-popup-buttons','gis-popup-buttons',null);if(1===p.length&&(!p[0].isAddedToBasket()||c.repeatableATC)&&addToCartService.isAddToCartConfigured()){var i=new buttonComponent({buttonLabel:r('product_popup_add_to_cart_label'),color:'#25DAC5',buttonMargin:'',onClick:function(){p[0].addToBasket(),c.payload.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.SHARED?(P(p[0]),T(p[0]),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_CART_CLICKED_ON_PRODUCT_CARD,{data:c.payload.data})):(T(p[0]),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_CART_CLICKED_ON_DETAILED_CARD,{data:c.payload.data})),function(e){h(),GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO_TYPES.ADDED_TO_CART===e&&(c={type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO,payload:{type:e,data:{image:n,title:r('product_popup_info_add_to_basket_success_title'),subtitle:r('product_popup_info_add_to_basket_success_message')}},labels:c.labels,popUpContainer:C,repeatableATC:c.repeatableATC});s(),E()}(GIS_CONSTANTS.PRODUCT_POPUP_TYPES.INFO_TYPES.ADDED_TO_CART)},buttonClass:'gis-addtocart-btn'});t.appendChild(i.render().firstChild)}if(c.payload.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.DETAILS){var a=new buttonComponent({buttonLabel:r('product_popup_view_details_label'),onClick:function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.MORE_INFO_CLICKED_ON_DETAILED_CARD,{data:p[0].getInfo()}),globalObjectService.getWindow().open(p[0].getUrl(),'_blank')},buttonClass:'gis-secondary-btn'});t.appendChild(a.render().firstChild)}if(c.payload.type===GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.SHARED){var o=new buttonComponent({buttonLabel:r('product_popup_save_to_list_label'),onClick:function(){e(),P(p[0]),h(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SAVE_TO_RECOMMENDED_CLICKED_ON_PRODUCT_CARD,{data:c.payload.data})},buttonClass:'gis-secondary-btn'});t.appendChild(o.render().firstChild)}C.querySelector('#gis-popup-content').appendChild(t)}function P(e){carouselService.addTileToCarousel(e.getInfo())}function T(e){carouselService.updateTileStatus(e.getId(),e.isAddedToBasket())}function E(){uiUtilitiesService.removeClass(C,'gis-hide'),function(){switch(c.payload.type){case GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.SHARED:eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CARD_PROMPTED,{data:c.payload.data});break;case GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.DETAILS:eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.DETAILED_PRODUCT_CARD_DISPLAYED,{data:c.payload.data})}}()}function h(){C.innerHTML='',C.setAttribute('class','gis-ss-player-popup gis-product-popup gis-hide')}return{render:function(){h(),s(),E()},dispose:h,show:E,hide:function(){uiUtilitiesService.addClass(C,'gis-hide')},triggerDetailsPopup:function(e){h(),c.type=GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA,c.payload={type:GIS_CONSTANTS.PRODUCT_POPUP_TYPES.CTA_TYPES.DETAILS,data:e.data},s(),E()}}}};GISAPP.rateComponent=function(serverInjectionService,uiUtilitiesService,logService,deviceInfoService){return function(t){'use strict';var n={};return n._valueRated=0,{render:function(){return n.components={},n.view=uiUtilitiesService.processView(serverInjectionService.getViews().rateView,{},!0),n.components.ratingWrapper=n.view.querySelector("#gis-rating-wrapper"),n.components.stars=n.view.querySelector("#gis-stars"),n.components.label=n.view.querySelector("#gis-stars-label"),n.components.starContainer=n.view.querySelector("#gis-star-container"),n.starsInput=n.components.starContainer.querySelectorAll("input"),n.starsLabel=n.components.starContainer.querySelectorAll("label"),n.RatingWrapper=n.components.ratingWrapper,t.label&&(t.label.length<80?n.components.label.innerHTML=t.label:n.components.label.innerHTML=t.label.substring(0,80)+"..."),deviceInfoService.isMobileDevice()&&(uiUtilitiesService.addClass(n.components.label,"gis-mobile"),uiUtilitiesService.addClass(n.RatingWrapper,"gis-mobile")),t.id&&function(){for(var e=0;e<n.starsInput.length;e++)n.starsInput[e].id="Q-"+(e+1)+"-"+t.id,n.starsInput[e].name="Q-"+t.id,n.starsLabel[e].htmlFor="Q-"+(e+1)+"-"+t.id}(),n.view},getStarsValue:function(){for(var e=0;e<n.starsInput.length;e++)if(n.starsInput[e].checked)return n.starsInput[e].value;return 0},resetValues:function(){n._valueRated=0}}}};GISAPP.sliderComponent=function(serverInjectionService,deviceInfoService,uiUtilitiesService,eventLoggerService,utilitiesService){return function(i){var t,o,l,s,e,n,r,c,d,a;function f(){return i.hiddenArrowsLogic?i.hiddenArrowsLogic.call():deviceInfoService.isPhoneOrTablet()}function u(){var t;if(r.addEventListener('scroll',function(e){clearTimeout(t),t=setTimeout(function(){h(),i.scrollEvent&&c()},66)},!1),f())return o.style.display="none",void(l.style.display="none");e.onclick=function(){var e=r.scrollLeft,t=r.offsetWidth,i=s.offsetWidth/s.childElementCount,o=t-t%i,l=e-t%i;r.scrollLeft=l-o<1?0:l-o},n.onclick=function(){var e=r.scrollLeft,t=r.offsetWidth,i=s.offsetWidth,o=i/s.childElementCount,l=t+t%o,n=e-t%o;r.scrollLeft=i<n+l?i-t:n+l}}function g(e){uiUtilitiesService.removeClass(t,'gis-mobile'),uiUtilitiesService.removeClass(s,'gis-mobile'),'vertical'===(a=e)?(l.className='gis-slider-control-v top gis-content-align',o.className='gis-slider-control-v bottom gis-content-align'):'horizontal'===e?(l.className='gis-slider-control-h right gis-content-align',o.className='gis-slider-control-h left gis-content-align'):'mobile'===e&&(uiUtilitiesService.addClass(l,'gis-hide'),uiUtilitiesService.addClass(o,'gis-hide'),uiUtilitiesService.addClass(t,'gis-mobile'),uiUtilitiesService.addClass(s,'gis-mobile'),s.style=''),h()}function h(){var e=r.scrollLeft,t=r.offsetWidth,i=s.offsetWidth;0!==t?(clearTimeout(d),i<t||t===i||f()?(l.style.display="none",o.style.display="none"):0===e?(o.style.display="none",l.style.display="flex"):o.style.display=(l.style.display=e===-1*(t-i)?"none":"flex","flex")):d=setTimeout(h,100)}return{render:function(){return t=uiUtilitiesService.processView(serverInjectionService.getViews().sliderView,{}),o=t.querySelector('#gis-slider-control-left'),e=t.querySelector('#gis-slider-control-left svg'),l=t.querySelector('#gis-slider-control-right'),n=t.querySelector('#gis-slider-control-right svg'),s=t.querySelector('#gis-slider-content'),r=t.querySelector('#gis-slider-content-container'),i.tiles.forEach(function(e){s.appendChild(e.render())}),i.scrollEvent&&(c=utilitiesService.debounce(function(){eventLoggerService.logEvent(i.scrollEvent)},1e3)),u(),h(),deviceInfoService.isMobileDevice()?g('mobile'):i.orientation?g(i.orientation):g('horizontal'),t},updateOrientation:g,refresh:function(){u(),h()},setupControls:u,slideToEnd:function(){var e=s.offsetWidth-r.offsetWidth;0<e&&(r.scrollLeft=e)},getOrientation:function(){return a}}}};GISAPP.standardCallComponent=function(uiUtilitiesService,serverInjectionService,deviceInfoService,videoComponent,callControlComponent,globalObjectService,callScreenHeaderComponent,multiStreamComponent,streamService,callStatusDialogComponent){return function(r){'use strict';var s,l,d,n,a,c,o,S,m,u,T,g,h,C,I,f="subscribers",i=!1,p=null,t=null,e=3.5;function y(){switch(p===o.STATUS.CALL_RECONNECTED?t:p){case o.STATUS.WAITING_FOR_ASSISTANT:t=p,A(p=o.STATUS.WAITING_FOR_ASSISTANT);break;case o.STATUS.ASSISTANT_IS_JOINING:t=p,A(p=o.STATUS.ASSISTANT_IS_JOINING);break;case o.STATUS.CONNECTING_TO_LOBBY:t=p,A(p=o.STATUS.CONNECTING_TO_LOBBY);break;case o.STATUS.CALL_RECONNECTING:t=p,A(p=o.STATUS.CALL_RECONNECTING);break;case o.STATUS.POOR_NETWORK:t=p,A(p=o.STATUS.POOR_NETWORK);break;case o.STATUS.VIDEO_DISABLED:t=p,A(p=o.STATUS.VIDEO_DISABLED);break;default:N()}}function N(){o.hide(),t=p=null,U()}function A(e){I&&clearTimeout(I),P(),o.show(e)}function E(e){S=e}function v(e){streamService.isStreamIdExistsInStreamMap(e)&&(e===streamService.getPrimaryStream().stream.streamId?m.style.display="none":c.hideNoVideoImage(e))}function O(e){if(streamService.isStreamIdExistsInStreamMap(e)){var t=streamService.getPrimaryStream().stream.streamId,i=streamService.getStreamFromMap(e).stream;'CLERK'===JSON.parse(i.connection.data).userType&&(e===t?m.style.display="block":c.showNoVideoImage(e))}}function w(e){var t=s.querySelector("#"+f);if(e&&t&&uiUtilitiesService.hasChildNodes(t)){var i=e,r=t.firstChild,n=i.firstChild;t.removeChild(r),i.removeChild(n),i.prepend(r),streamService.setPrimaryStream(n.id),uiUtilitiesService.addClass(r,"gis-secondary-subscriber"),r.style.width='100%',r.style.height='100%',t.appendChild(n),l.changeVideoDimension(streamService.getPrimaryStream().stream.streamId);var a=streamService.getPrimaryStream().stream;!function(e){if(e&&e.connection.data){var t=JSON.parse(e.connection.data);if('CLERK'===t.userType&&t.publisher.displayName){var i=t.publisher.displayName,r=t.publisher.imgName;E({userDisplayName:i,userImageName:r}),d.setUserProfileInfo(S)}else E({userDisplayName:V(e)}),d.setUserProfileInfo(S)}}(a),L(a,n);var o=streamService.getStreamFromMap(r.id).stream;!function(e,t){if(e&&e.connection.data){var i=JSON.parse(e.connection.data);if('CLERK'===i.userType&&i.publisher.displayName){var r=i.publisher.displayName;c.showMultiClerkDisplayName(r,t.firstChild)}else t.firstChild.innerHTML=V(e)}}(o,e.children[1]),L(o,r)}}function L(e,t){serverInjectionService.getSystemConfig().noVideoImage&&(e.hasVideo?v(t.id):'CLERK'===JSON.parse(e.connection.data).userType?O(t.id):v(t.id))}function _(){var e=streamService.getPrimaryStream();e&&e.stream&&l.changeVideoDimension(e.stream.streamId)}function b(){i=!i;var e=s.querySelector("#"+f);i?(r.switchToFullScreen(),uiUtilitiesService.removeClass(e,"gis-primary-subscriber")):(r.switchToNormalScreen(),uiUtilitiesService.addClass(e,"gis-primary-subscriber"));var t=streamService.getPrimaryStream();t&&t.stream&&t.stream.streamId&&l.changeVideoDimension(t.stream.streamId),D()}function D(){if(u.scrollHeight!==u.clientHeight){g.style.display='block',0<u.scrollTop?T.style.display='block':T.style.display='none';var e=uiUtilitiesService.getInnerHeight(u);u.scrollTop+e>=u.scrollHeight?g.style.display='none':g.style.display='block'}else g.style.display='none',T.style.display='none'}function U(){I&&clearTimeout(I),I=setTimeout(function(){uiUtilitiesService.removeClass(C,'gis-control-animation-show'),uiUtilitiesService.addClass(C,'gis-control-animation-hide')},1e3*e)}function R(){C.classList.contains('gis-control-animation-show')||(P(),U())}function P(){uiUtilitiesService.removeClass(C,'gis-control-animation-hide'),uiUtilitiesService.addClass(C,'gis-control-animation-show')}function V(e){return c.getDisplayNameFromStream(e)}return{render:function(){var e,t;return s=uiUtilitiesService.processView(serverInjectionService.getViews().standardCallView,{},!0),a=s.querySelector("#gis-call-view"),r.id=f,r.class="gis-primary-subscriber",l=new videoComponent(r),a.appendChild(l.render()),globalObjectService.getWindow().addEventListener('resize',_),e=s.querySelector("#gis-call-multi-stream"),u=s.querySelector("#gis-call-multi-stream"),T=s.querySelector("#gis-scroll-up-button"),g=s.querySelector("#gis-scroll-down-button"),c=new multiStreamComponent({switchStream:w}),e.appendChild(c.render()),g.onclick=function(){u.scrollBy(0,50),D()},T.onclick=function(){u.scrollBy(0,-50),D()},1280<=globalObjectService.getWindow().innerWidth?r.fullScreen={onClick:b,isMute:!1}:b(),t=s.querySelector("#gis-call-head"),d=new callScreenHeaderComponent,t.appendChild(d.render()),(m=s.querySelector("#gis-call-video-pause-image")).style.backgroundImage=uiUtilitiesService.getImageUrl("video-mute-desktop.jpg"),o=new callStatusDialogComponent,a.querySelector("#gis-call-screen-overlay-container").appendChild(o.render()),i=s.querySelector('#gis-call-footer'),r.onEndCall=function(){p&&p===o.STATUS.CALL_DISCONNECTED?h():(o.setEndCallButton(r.onLeaveButtonClick),o.setStayButton(y),A(o.STATUS.CALL_ENDED_CONFIRMATION)),clearTimeout(I)},n=new callControlComponent(r),C=n.render(),r.controlLess||i.appendChild(C),U(),deviceInfoService.isIos()||deviceInfoService.isIPad()?globalObjectService.getWindow().addEventListener('click',R):(globalObjectService.getWindow().addEventListener('touchstart',R),globalObjectService.getWindow().addEventListener('mousemove',R)),s;var i},changeVideoDimension:function(e){var t=streamService.getStreamFromMap(e);t&&t.stream.streamId===streamService.getPrimaryStream().stream.streamId&&l.changeVideoDimension(t.stream.streamId)},addStream:function(e){if(!e.streamId)throw new Error("StreamId missing in stream object: %o",e);var t,i=uiUtilitiesService.createElementWithAttributes("div",e.streamId);return t=s.querySelector("#"+f),uiUtilitiesService.hasChildNodes(t)?(c.addStream(e),'screen'===e.videoType&&w(c.getScreenShareStream()),D()):(function(e,t){for(var i=s.querySelector("#"+f);i.firstChild;)i.removeChild(i.lastChild);i.appendChild(t),streamService.addStreamToMap(e.streamId,e,t),streamService.setPrimaryStream(e.streamId)}(e,i),d.setUserProfileInfo(S)),i},addVideo:function(e){c.addVideo(e)},getMainVideoStreamId:function(){var e=s.querySelector("#"+f).childNodes;for(var t in e)if(e.hasOwnProperty(t))return e[t].id},showRecordingTooltip:function(){d.showRecordingTooltip()},hideRecordingTooltip:function(){d.hideRecordingTooltip()},updateConnectionCount:function(e){d.updateConnectionCount(e)},removeVideoWhenClerkLeave:function(e){e===streamService.getPrimaryStream().stream.streamId&&w(c.getFirstSecondaryStream()),c.isStreamsExists()&&(c.removeStream(e),D())},showReconnectingMessage:function(){t=p,A(p=o.STATUS.CALL_RECONNECTING)},showDisconnectedMessage:function(e){h=e,t=p,A(p=o.STATUS.CALL_DISCONNECTED)},showAssistantIsJoining:function(){t=p,A(p=o.STATUS.ASSISTANT_IS_JOINING)},showConnectingToLobby:function(){t=p,A(p=o.STATUS.CONNECTING_TO_LOBBY)},showWaitingForAssistant:function(){t=p,A(p=o.STATUS.WAITING_FOR_ASSISTANT)},hideCallStatusDialog:N,updateCallScreenOverlayStatus:y,setCallStatus:function(e){p=e},setCameraToggle:function(){n.showButton(n.BUTTONS.CAMERA_ENABLE)},setOnCameraSwitch:function(){deviceInfoService.isMobileDevice()&&n.showButton(n.BUTTONS.CAMERA_SWITCH)},setUserProfileInfo:E,showNoVideoImage:O,hideNoVideoImage:v,showPoorConnectionMessage:function(){p!==o.STATUS.POOR_NETWORK&&(t=p,A(p=o.STATUS.POOR_NETWORK))},showVideoDisabledMessage:function(){t=p,A(p=o.STATUS.VIDEO_DISABLED)},hideVideoDisabledMessage:function(){p===o.STATUS.VIDEO_DISABLED&&N()},hidePoorConnectionMessage:function(){p===o.STATUS.POOR_NETWORK&&N()},getControlsView:function(){return C},destroy:function(){deviceInfoService.isIos()||deviceInfoService.isIPad()?globalObjectService.getWindow().removeEventListener('click',R):(globalObjectService.getWindow().removeEventListener('touchstart',R),globalObjectService.getWindow().removeEventListener('mousemove',R))},getDisplayNameFromStream:V}}};GISAPP.stepsComponent=function(serverInjectionService,uiUtilitiesService){return function(i){'use strict';var u,n,c,o=[],s=0,p=4,a=2.5;function d(e){var t=o[s],r=o[e];t&&r&&(t.setAttribute('r',a),r.setAttribute('r',p),s=e)}return{render:function(){u=uiUtilitiesService.processView(serverInjectionService.getViews().stepsView,{},!0),n=u.querySelector("#gis-steps"),c=u.querySelector("#gis-steps-svg");for(var e=10+2*p,t=0;t<i.stepNumber;t++){var r=document.createElementNS(c.getAttribute('xmlns'),"circle");r.id="gis-steps-c"+t,r.setAttribute('cx',p+t*e),r.setAttribute('cy',10),r.setAttribute('r',a),c.appendChild(r),o.push(r)}var s=(i.stepNumber-1)*e+2*p;return c.setAttribute('viewBox',"0 0 "+Math.max(s,0)+" 25"),d(0),u},getSelectedStep:function(){return s},setSelectedStep:d,hide:function(){uiUtilitiesService.addClass(n,"gis-hide")}}}};GISAPP.switchComponent=function(serverInjectionService,uiUtilitiesService,GIS_CONSTANTS){return function(e){var t,o=e,s=null,r={camera:'<svg id="camera-icon" width="18" height="12" viewBox="0 0 18 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L18 11.5V0.5L14 4.5Z" fill="#909090"/></svg>',cameraMute:'<svg id="camera-mute-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 6.5L17 10.5V7C17 6.45 16.55 6 16 6H9.82L21 17.18V6.5ZM3.27 2L2 3.27L4.73 6H4C3.45 6 3 6.45 3 7V17C3 17.55 3.45 18 4 18H16C16.21 18 16.39 17.92 16.54 17.82L19.73 21L21 19.73L3.27 2Z" fill="#909090"/></svg>',mic:'<svg id="mic-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z" fill="#909090"/></svg>',micMute:'<svg id="mic-mute-icon" width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 9H14.3C14.3 9.74 14.14 10.43 13.87 11.05L15.1 12.28C15.66 11.3 16 10.19 16 9ZM11.98 9.17C11.98 9.11 12 9.06 12 9V3C12 1.34 10.66 0 9 0C7.34 0 6 1.34 6 3V3.18L11.98 9.17ZM1.27 1L0 2.27L6.01 8.28V9C6.01 10.66 7.34 12 9 12C9.22 12 9.44 11.97 9.65 11.92L11.31 13.58C10.6 13.91 9.81 14.1 9 14.1C6.24 14.1 3.7 12 3.7 9H2C2 12.41 4.72 15.23 8 15.72V19H10V15.72C10.91 15.59 11.77 15.27 12.54 14.82L16.73 19L18 17.73L1.27 1Z" fill="#909090"/></svg>'};function c(e,i,n){var t=GIS_CONSTANTS.MEDIA;return e==t.TYPE.CAMERA?a("camera",i,n):e==t.TYPE.MIC?a("mic",i,n):void console.error("GIS: Invalid media type: ",e)}function a(e,i,n){var t=GIS_CONSTANTS.MEDIA;return i==t.STATUS.NOT_DETECTED?(d(!(s.checked=!1)),r[e+"Mute"]):i!=t.STATUS.DETECTED&&i!=t.STATUS.UN_MUTE||n!=t.PERMISSION.ALLOWED?(n==t.PERMISSION.NOT_ALLOWED?d(!0):d(!1),s.checked=!1,r[e+"Mute"]):(d(!(s.checked=!0)),r[e])}function d(e){o.toggleDisabled?s.disabled=!0:s.disabled=e}return{render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().switchView,{},!1),i=e.querySelector(".gis-switch-label");t=e.querySelector(".gis-switch-icon");var n=e.querySelector(".gis-switch-toggle span");return s=e.querySelector(".gis-switch-toggle input"),i.innerText=o.label,t.innerHTML=c(o.media.type,o.media.status,o.media.permission),n.onclick=function(e){if(!s.disabled&&o.media.permission!==GIS_CONSTANTS.MEDIA.PERMISSION.NOT_ALLOWED){var i=s.checked?GIS_CONSTANTS.MEDIA.STATUS.MUTE:GIS_CONSTANTS.MEDIA.STATUS.UN_MUTE;t.innerHTML=c(o.media.type,i,o.media.permission),o.onToggle(s.checked),e.preventDefault()}},e},mute:function(){s.checked=!1,o.media.permission=GIS_CONSTANTS.MEDIA.PERMISSION.ALLOWED,t.innerHTML=c(o.media.type,GIS_CONSTANTS.MEDIA.STATUS.MUTE,o.media.permission),o.onToggle(!1)},unMute:function(){s.checked=!0,o.media.permission=GIS_CONSTANTS.MEDIA.PERMISSION.ALLOWED,t.innerHTML=c(o.media.type,GIS_CONSTANTS.MEDIA.STATUS.UN_MUTE,o.media.permission),o.onToggle(!0)},disable:function(){d(!0),o.media.permission=GIS_CONSTANTS.MEDIA.PERMISSION.NOT_ALLOWED,t.innerHTML=c(o.media.type,GIS_CONSTANTS.MEDIA.STATUS.NOT_DETECTED,o.media.permission)}}}};GISAPP.toastComponent=function(serverInjectionService,uiUtilitiesService,eventLoggerService){return function(o){var i='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0C4.91333 0 0 4.91333 0 11C0 17.0867 4.91333 22 11 22C17.0867 22 22 17.0867 22 11C22 4.91333 17.0867 0 11 0ZM12.0469 9.0752V17H9.92285V9.0752H12.0469ZM9.79834 7.02441C9.79834 6.70703 9.90332 6.4458 10.1133 6.24072C10.3281 6.03564 10.6187 5.93311 10.9849 5.93311C11.3462 5.93311 11.6343 6.03564 11.8491 6.24072C12.064 6.4458 12.1714 6.70703 12.1714 7.02441C12.1714 7.34668 12.0615 7.61035 11.8418 7.81543C11.627 8.02051 11.3413 8.12305 10.9849 8.12305C10.6284 8.12305 10.3403 8.02051 10.1206 7.81543C9.90576 7.61035 9.79834 7.34668 9.79834 7.02441Z" fill="#0E0E10"/></svg>',l=null,e=null;function r(){'function'==typeof o.onClick&&o.onClick(),n()}function n(){l.style.display='none',uiUtilitiesService.removeNode(l)}return{render:function(){var e=(l=uiUtilitiesService.processView(serverInjectionService.getViews().toast,{},!1)).querySelector('#gis-toast-icon'),n=l.querySelector('#gis-toast-description'),t=l.querySelector('#gis-toast-close');return e.innerHTML=i,n.innerText=o.description,t.onclick=r,l},show:function(){l.style.display='flex',e&&clearTimeout(e),e=setTimeout(n,2e3)},hide:n}}};GISAPP.userProfileComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService){return function(){'use strict';var e,i,n;return{render:function(){return e=uiUtilitiesService.processView(serverInjectionService.getViews().userProfileView,{},!0),i=e.querySelector("#gis-user-display-name"),n=e.querySelector("#gis-user-profile-image"),e},setup:function(e){if(e.userDisplayName){var r=e.userDisplayName;deviceInfoService.isMobileDevice()&&10<r.length&&(r=r.slice(0,7),r+='...'),i.innerText=r}else i.innerText=null;e.userImageName?n.style.backgroundImage="url('"+uiUtilitiesService.getClerkImageUrl(e.userImageName)+"')":n.style.backgroundImage=uiUtilitiesService.getImageUrl("clerk-default.png")}}}};GISAPP.videoComponent=function(uiUtilitiesService,globalObjectService,streamService){return function(e){'use strict';var t,h;return{render:function(){return t=uiUtilitiesService.createElementWithAttributes("div",e.id,"gis-child","z-index:1;overflow:hidden"),e.class&&uiUtilitiesService.addClass(t,e.class),t},changeVideoDimension:function(e){var t=streamService.getStreamFromMap(e);if(h=t.element.parentNode,e&&t&&h){var n,i=t.stream.videoDimensions.width,r=t.stream.videoDimensions.height,o=r<i,d=t.element;d.style.height=(d.style.width=(n=o?function(e,t){for(var n=parseInt(globalObjectService.getWindow().getComputedStyle(h).getPropertyValue("width")),i=parseInt(globalObjectService.getWindow().getComputedStyle(h).getPropertyValue("height")),r=t/e,o=Math.round(r*n);i<o;)n--,o=Math.round(r*n);return{width:n,height:o}}(i,r):function(e,t){for(var n=parseInt(globalObjectService.getWindow().getComputedStyle(h).getPropertyValue("height")),i=parseInt(globalObjectService.getWindow().getComputedStyle(h).getPropertyValue("width")),r=e/t,o=Math.round(r*n);i<o;)n--,o=Math.round(r*n);return{width:o,height:n}}(i,r)).width+"px",n.height+"px")}}}}};GISAPP.videoPlayerComponent=function(serverInjectionService,deviceInfoService,uiUtilitiesService,callControlSwitchButtonComponent,GIS_CONSTANTS,utilitiesService,stateService,eventLoggerService,layoutService,logService){return function(o){var i,r,s,l,c,a,u,d,g,v,n,E,f,T,C,t,m,S="videoPlayerComponent",L=!1,y=!0,p=!0,O=!1,h=!1,_=!1,M=.85,V='gis-message-indicator',R={};o.hideControls=Array.isArray(o.hideControls)?o.hideControls:[];var w=15,I=[{id:'gis-vc-play',type:'switch',name:'PLAY',click:function(){v&&v.paused?e():x()}},{id:'gis-vc-vol',type:'button',name:GIS_CONSTANTS.VIDEO_CONTROLS.VOLUME}],A=[{id:'gis-vc-product',type:'switch',name:GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT,click:function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_PRODUCT_CAROUSEL_BUTTON_CLICKED),p=!p,o.onProductClick(p),p?eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_SHOWN_ON_SHOP_STREAM):eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_CAROUSEL_HIDDEN_ON_SHOP_STREAM)}},{id:'gis-vc-chat',type:'switch',name:GIS_CONSTANTS.VIDEO_CONTROLS.CHAT,click:G},{id:'gis-vc-fs',type:'switch',name:GIS_CONSTANTS.VIDEO_CONTROLS.FULL_SCREEN,click:F}];t=[{id:"gis-vc-timebar-start-time",type:"text",name:GIS_CONSTANTS.TIME_TYPES.START}],m=[{id:"gis-vc-timebar-end-time",type:"text",name:GIS_CONSTANTS.TIME_TYPES.END}],I.push({id:'gis-vc-time',type:'text',name:GIS_CONSTANTS.TIME_TYPES.BOTH});var P={PRODUCT:'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.146 10.44L11.732 1.02501C11.4077 0.698993 11.022 0.440531 10.5972 0.264589C10.1723 0.0886468 9.71683 -0.00128008 9.257 1.37655e-05H2C0.897 1.37655e-05 0 0.897014 0 2.00001V9.25701C0 10.192 0.364 11.071 1.025 11.732L10.439 21.146C10.982 21.689 11.733 22 12.5 22C13.267 22 14.018 21.689 14.56 21.146L21.146 14.561C21.689 14.018 22 13.267 22 12.5C22 11.733 21.689 10.982 21.146 10.44ZM12 7.00001C12.551 7.00001 13 7.44901 13 8.00001C13 8.55101 12.551 9.00001 12 9.00001C11.449 9.00001 11 8.55101 11 8.00001C11 7.44901 11.449 7.00001 12 7.00001ZM4 6.00001C2.897 6.00001 2 5.10301 2 4.00001C2 2.89701 2.897 2.00001 4 2.00001C5.103 2.00001 6 2.89701 6 4.00001C6 5.10301 5.103 6.00001 4 6.00001ZM7 12C7 11.449 7.449 11 8 11C8.551 11 9 11.449 9 12C9 12.551 8.551 13 8 13C7.449 13 7 12.551 7 12ZM13.854 13.854C11.73 15.976 8.63 16 8.5 16C8.36739 16.0001 8.24016 15.9476 8.1463 15.8539C8.05244 15.7602 7.99963 15.6331 7.9995 15.5005C7.99937 15.3679 8.05192 15.2407 8.14559 15.1468C8.23927 15.053 8.36639 15.0001 8.499 15C8.527 15 11.323 14.97 13.146 13.146C14.98 11.314 15 8.52801 15 8.50001C15 8.3674 15.0527 8.24023 15.1464 8.14646C15.2402 8.05269 15.3674 8.00001 15.5 8.00001C15.6326 8.00001 15.7598 8.05269 15.8536 8.14646C15.9473 8.24023 16 8.3674 16 8.50001C16 8.63001 15.976 11.731 13.854 13.854Z" fill="white"/></svg>',CHAT:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 2H4C2.9 2 2.01 2.9 2.01 4L2 22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM6 9H18V11H6V9ZM14 14H6V12H14V14ZM18 8H6V6H18V8Z" fill="#FAFAFA"/></svg><span id="gis-message-indicator" class="gis-message-indicator" style="display:none;"></span>',CHAT_WITH_MESSAGE:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 2H4C2.9 2 2.01 2.9 2.01 4L2 22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM6 9H18V11H6V9ZM14 14H6V12H14V14ZM18 8H6V6H18V8Z" fill="#FAFAFA"/></svg>',VIDEO_VOLUME:'<span class="gis-button-muted gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 6V12H4L9 17V1L4 6H0ZM13.5 9C13.5 7.23 12.48 5.71 11 4.97V13.02C12.48 12.29 13.5 10.77 13.5 9ZM11 0.230003V2.29C13.89 3.15 16 5.83 16 9C16 12.17 13.89 14.85 11 15.71V17.77C15.01 16.86 18 13.28 18 9C18 4.72 15.01 1.14 11 0.230003Z" fill="#FAFAFA"/></svg></span>',VIDEO_VOLUME_MUTE:'<span class="gis-content-align" style="border-radius:8px;width:48px;height:48px"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 9C13.5 7.23 12.48 5.71 11 4.97V7.18L13.45 9.63C13.48 9.43 13.5 9.22 13.5 9ZM16 9C16 9.94 15.8 10.82 15.46 11.64L16.97 13.15C17.63 11.91 18 10.5 18 9C18 4.72 15.01 1.14 11 0.23V2.29C13.89 3.15 16 5.83 16 9ZM1.27 0L0 1.27L4.73 6H0V12H4L9 17V10.27L13.25 14.52C12.58 15.04 11.83 15.45 11 15.7V17.76C12.38 17.45 13.63 16.81 14.69 15.95L16.73 18L18 16.73L9 7.73L1.27 0ZM9 1L6.91 3.09L9 5.18V1Z" fill="#0E0E10"/></svg></span>'},H=serverInjectionService.getLabels().shopStream_live_indicator;function N(){return Number(l.style.width.replace("%",""))}function D(){return deviceInfoService.isMobileDevice()||deviceInfoService.isIPad()&&layoutService.getOrientation().match(/portrait/)}function b(e,t){(e=function(e,t){if(t.name!==GIS_CONSTANTS.VIDEO_CONTROLS.VOLUME)return e.innerHTML=P[t.name],e;var n=uiUtilitiesService.createElementWithAttributes('div','gis-vol-icon','gis-content-align gis-controls');D()||uiUtilitiesService.addClass(n,'gis-desktop');return n.innerHTML=P[t.name],n.onclick=B,e.appendChild(n),function(t){var o=uiUtilitiesService.createElementWithAttributes('div','gis-volume-slider','gis-content-align');o.innerHTML='<div id="gis-volume"><div id="gis-vol-progress-bar" class="gis-vol-slider-range"></div><div id="gis-slider" class="gis-vol-slider-handle"></div></div>',t.appendChild(o),f=t.querySelector('#gis-vol-progress-bar');var e=t.querySelector('#gis-volume');T=o.querySelector('#gis-slider'),t.querySelector('#gis-vol-icon').onmouseover=j,e.onclick=function(e){var t=document.getElementById('gis-player-container'),n=t.querySelector('#gis-player-left-pane'),i=o.offsetLeft+t.offsetLeft+n.offsetLeft+T.offsetWidth;K(e,i)},T.onmousedown=function(e){C=e.pageX-T.offsetLeft,h=O=!0},T.onmousemove=z,e.onmousemove=z,e.onmouseover=function(e){_=!0},e.onmousedown=function(e){h=!0},e.onmouseup=function(e){h=!1},o.onmousemove=function(e){(O||h)&&z(e)},o.onmouseup=j,t.onmouseover=function(e){D()?o.style.display='none':(t.style.width='130px',o.style.display='inline-flex')},t.onmouseout=function(e){o.style.display='none',t.style.width='50px'}}(e),e}(e,t)).onclick=k.bind(null,t)}function q(e,t){for(var n in t){var i=t[n];o.hideControls.includes(i.name)||e.appendChild(U(i))}}function U(e){var t,n,i,o,r=uiUtilitiesService.createElementWithAttributes('div',e.id,'gis-content-align gis-controls');return D()||uiUtilitiesService.addClass(r,'gis-desktop'),'button'===e.type&&b(r,e),'switch'===e.type&&(n=new callControlSwitchButtonComponent({buttonView:r,buttonName:(t=e).name,onClick:k.bind(null,t),isMute:!1}),R[t.name]=n),'text'===e.type&&(W(i=r,(o=e).name),o.name!=GIS_CONSTANTS.TIME_TYPES.START&&o.name!=GIS_CONSTANTS.TIME_TYPES.END||i.classList.remove("gis-controls")),r}function k(e){var t=o[e.name];t&&'function'==t.onClick&&t.onClick(),'function'==typeof e.click&&e.click()}function e(t){if(v){var e=v.play();e&&e.then(function(){se()}).catch(function(e){console.error(S,'Error Playing video...',e),function(e){v.muted=!1,B();var t=v.play();t&&t.then(function(){se(),e&&v.muted&&e(B)}).catch(function(e){B(),logService.error(S,'Error AutoPlaying video...',e)})}(t)})}}function x(){v&&v.pause()}function B(){var e=i.querySelector('#gis-vc-vol').querySelector('#gis-vol-icon');v.muted=!v.muted,v.muted?(e.innerHTML=P.VIDEO_VOLUME_MUTE,T.style.left='0%',f.style.width='0%',v.volume=0):(e.innerHTML=P.VIDEO_VOLUME,T.style.left=100*M-2+'%',f.style.width=100*M+'%',v.volume=M)}function F(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_FULL_SCREEN_BUTTON_CLICKED),L=L?(o.initialScreen(),!1):(o.onFullScreen(),!0)}function G(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SHOP_STREAM_CHAT_BUTTON_CLICKED),y=!y,o.onChatClick(y),y?eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_SHOWN_ON_SHOP_STREAM):eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_HIDDEN_ON_SHOP_STREAM)}function Y(e,t,n){var i=function(e){if(e){var t=utilitiesService.getTimeFromSeconds(e.currentTime),n=utilitiesService.getTimeFromSeconds(e.duration||e.attributes.duration);return t.second=utilitiesService.convertInTwoDigits(t.second),n.second=utilitiesService.convertInTwoDigits(n.second),{CURRENT:t,TOTAL:n}}}(t);if(Z()&&t.duration-t.currentTime<w&&e!==GIS_CONSTANTS.TIME_TYPES.END)n.innerHTML=H;else if(Z()&&t.duration>t.currentTime)n.innerHTML=i.CURRENT.minute+":"+i.CURRENT.second;else switch(e){case GIS_CONSTANTS.TIME_TYPES.START:n.innerHTML=i.CURRENT.minute+":"+i.CURRENT.second;break;case GIS_CONSTANTS.TIME_TYPES.END:n.innerHTML=t.duration===1/0?'':i.TOTAL.minute+":"+i.TOTAL.second;break;default:n.innerHTML=i.CURRENT.minute+":"+i.CURRENT.second+" / "+i.TOTAL.minute+":"+i.TOTAL.second}}function Z(){return"BROADCAST_PLAYING"===stateService.getCurrentPhase()||"BROADCAST_START"===stateService.getCurrentPhase()}function W(e,t,n){e&&(n&&(n.duration||n.attributes&&n.attributes.duration)?Y(t,n,e):Z()&&t!==GIS_CONSTANTS.TIME_TYPES.END?e.innerHTML=H:t&&t!==GIS_CONSTANTS.TIME_TYPES.BOTH?Z()&&t===GIS_CONSTANTS.TIME_TYPES.END?e.innerHTML="":e.innerHTML="0:00":e.innerHTML="0:00 / 0:00")}function X(){r=i.querySelector("#gis-video"),a=i.querySelector('#gis-progress-bar-icon');var e=i.querySelector("#gis-vc-time"),t=i.querySelector("#gis-vc-timebar-start-time"),n=i.querySelector("#gis-vc-timebar-end-time");W(e,GIS_CONSTANTS.TIME_TYPES.BOTH,r),W(t,GIS_CONSTANTS.TIME_TYPES.START,r),W(n,GIS_CONSTANTS.TIME_TYPES.END,r)}function K(e,t){s=(e.pageX-t)/T.offsetParent.offsetWidth*100,.85<=(M=(s=s<0?0:s)/100)&&(_=h=!(M=1)),T.style.left=s-2+'%',f.style.width=s+'%',v.volume=M;var n=i.querySelector('#gis-vol-icon');n.innerHTML=s<=0?P.VIDEO_VOLUME_MUTE:P.VIDEO_VOLUME}function j(){h=O=!1}function z(e){(O||h)&&_&&K(e,C)}function J(){R[GIS_CONSTANTS.VIDEO_CONTROLS.PLAY]&&R[GIS_CONSTANTS.VIDEO_CONTROLS.PLAY].mute(),'function'==typeof o.onPlay&&o.onPlay()}function Q(){R[GIS_CONSTANTS.VIDEO_CONTROLS.PLAY]&&R[GIS_CONSTANTS.VIDEO_CONTROLS.PLAY].unMute(),'function'==typeof o.onPause&&o.onPause()}function $(){'function'==typeof o.onEnded&&o.onEnded()}function ee(){X()}function te(){uiUtilitiesService.removeClass(i,'gis-mobile'),uiUtilitiesService.addClass(i.querySelector('#gis-video-controls-container'),'gis-desktop'),uiUtilitiesService.addClass(i.querySelector('#gis-video-controls'),'gis-desktop'),uiUtilitiesService.addClassOnList(i.querySelectorAll('#gis-video-controls .gis-controls'),'gis-desktop')}function ne(e){setTimeout(function(){!document.fullscreenElement&&L&&(R[GIS_CONSTANTS.VIDEO_CONTROLS.FULL_SCREEN].unMute(),F())},200)}function ie(){v.textTracks[0].mode='hidden'}function oe(){var e=r.duration;if(0<e)for(var t=0;t<r.buffered.length;t++)if(r.buffered.start(r.buffered.length-1-t)<r.currentTime){n.style.width=r.buffered.end(r.buffered.length-1-t)/e*100+"%";break}}function re(){var e=r.duration;0<e&&(s=r.currentTime/e*100,l.style.width=s+"%",X(),ce(null,!0))}function se(){u=document.getElementById('gis-player-container'),d=u.querySelector('#gis-player-left-pane'),c=i.querySelector('#gis-video-seek-bar'),g=c.parentElement,r=i.querySelector('#gis-video'),n=i.querySelector('#gis-buffer'),a=i.querySelector('#gis-progress-bar-icon'),r.addEventListener('progress',oe),r.addEventListener('timeupdate',re),g.addEventListener('click',function(e){ce(e),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PROGRESS_BAR_CLICKED)}),deviceInfoService.isPhoneOrTablet()?a.ontouchstart=function(){!0,g.addEventListener('touchmove',ce),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PROGRESS_BAR_DRAGGED)}:a.onmousedown=function(){!0,g.addEventListener('mousemove',ce),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PROGRESS_BAR_DRAGGED)},g.addEventListener('mouseup',le),g.addEventListener('mouseleave',le),a.addEventListener('mouseup',le),c.addEventListener('mouseup',le)}function le(){!1,g.removeEventListener('mousemove',ce),a.removeEventListener('mousemove',ce)}function ce(e,t){if(E=c.offsetLeft+u.offsetLeft+d.offsetLeft,!t){if(e.pageX)s=(e.pageX-E)/c.offsetWidth*100;else{var n=e.targetTouches[0];s=(n.pageX-E)/c.offsetWidth*100}r.currentTime=s*r.duration/100,s=100<s?99:s,l.style.width=s+'%'}N()<=.2?(a.style.left="0",a.style.right="auto"):99<=N()?(l.style.width="100%",a.style.left="auto",a.style.right="0"):(a.style.left="100%",a.style.right="auto"),X(),(N()<=0||99.9<=N())&&(g.removeEventListener('mousemove',ce),a.removeEventListener('mousemove',ce))}return H='<div id="gis-time-liveIndicator">'+H+'</div>',{render:function(){i=uiUtilitiesService.processView(serverInjectionService.getViews().videoPlayerView,{}),(v=i.querySelector('#gis-video')).addEventListener('play',J),v.addEventListener('pause',Q),v.addEventListener('loadedmetadata',ee),v.addEventListener('ended',$),l=i.querySelector('#gis-progress-bar');var e=i.querySelector('#gis-video-timebar');return uiUtilitiesService.addClass(e,'gis-hide'),q(i.querySelector('#gis-vc-left'),I),q(i.querySelector('#gis-vc-right'),A),q(i.querySelector("#gis-vc-timebar-left"),t),q(i.querySelector("#gis-vc-timebar-right"),m),o.trackFile&&(i.querySelector("#gis-video-track").src=uiUtilitiesService.getImageUrl(o.trackFile,!0),ie()),te(),document.addEventListener('fullscreenchange',ne),i},setPlayer:function(e){v=e},getPlayer:function(){return v},play:e,pause:x,toggleFullScreen:F,dispose:function(){document.removeEventListener('fullscreenchange',ne),v.removeEventListener('play',J),v.removeEventListener('pause',Q),v.removeEventListener('loadedmetadata',ee),v.removeEventListener('ended',$),r&&r.removeEventListener('progress',oe),r&&r.removeEventListener('timeupdate',re)},toggleChat:G,internalToggleProduct:function(e){p=e,o.onProductClick(p),e?R[GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT]&&R[GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT].unMute():R[GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT]&&R[GIS_CONSTANTS.VIDEO_CONTROLS.PRODUCT].mute()},internalToggleChat:function(e){y=e,o.onChatClick(y),e?R[GIS_CONSTANTS.VIDEO_CONTROLS.CHAT].unMute():R[GIS_CONSTANTS.VIDEO_CONTROLS.CHAT].mute()},hideControl:function(t){A.concat(I).forEach(function(e){e.name===t&&i.querySelector('#'+e.id)&&(i.querySelector('#'+e.id).style.display='none')})},showControl:function(t){A.concat(I).forEach(function(e){e.name===t&&i.querySelector('#'+e.id)&&(i.querySelector('#'+e.id).style.display='flex')})},showMessageIndicator:function(){uiUtilitiesService.show(V,'flex')},updateMessageIndicatorCounter:function(e){i.querySelector('#'+V).innerText=e},callChatButtonOnClick:function(){i.querySelector('#gis-vc-chat').click()},setupUiForDesktop:te,setupUiForMobile:function(){uiUtilitiesService.addClass(i,'gis-mobile'),uiUtilitiesService.removeClass(i.querySelector('#gis-video-controls-container'),'gis-desktop'),uiUtilitiesService.removeClass(i.querySelector('#gis-video-controls'),'gis-desktop'),uiUtilitiesService.removeClassOnList(i.querySelectorAll('#gis-video-controls .gis-controls'),'gis-desktop')},hideVideoContainer:function(){i.querySelector('#gis-video-controls-container').style.display='none'},showCaptions:function(){v.textTracks[0].mode='showing'},hideCaptions:ie,hideProgressBar:function(){c=i.querySelector('#gis-video-seek-bar'),uiUtilitiesService.addClass(c,'gis-hide')}}}};GISAPP.availableClerkComponent=function(logService,serverInjectionService,uiUtilitiesService){return function(e){'use strict';var i={};return{render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().availableClerkView,{},!0);return i.availableClerkSubContainer=e.querySelector("#gis-Clerk-available-subContainer"),i.availableClerkContainer=e.querySelector("#gis-Clerk-available-container"),i.availableClerkWapper=e.querySelector("#gis-Clerk-available-text-wrapper"),i.availableClerkText=e.querySelector("#gis-Clerk-available-text"),i.availableClerkContainer.style.width="100%",i.availableClerkContainer.style.height="100%",i.availableClerkContainer.style.display="flex",i.availableClerkContainer.style.flexDirection="column-reverse",i.availableClerkContainer.style.alignItems="center",i.availableClerkContainer.style.justifyContent="center",i.availableClerkWapper.style.display="flex",i.availableClerkWapper.style.height="19px",i.availableClerkWapper.style.alignItems="center",i.availableClerkWapper.style.color="#7e7e7e",i.availableClerkWapper.style.fontWeight="700",i.availableClerkWapper.style.fontSize="15px",i.availableClerkText.innerHTML=serverInjectionService.getLabels().connect_v3_clerkAvailableText,serverInjectionService.getUiConfig().availableClerkList&&serverInjectionService.getUiConfig().availableClerkList.forEach(function(e,a){var l,r;i.availableClerkSubContainer.appendChild((l=e,(r=uiUtilitiesService.createElementWithAttributes("div","gis_connect_available_Clerk","gis-default-clerkImg","height: 40px;width: 40px;border-radius: 50%;")).style.background="url('"+serverInjectionService.getGisDomain()+"/images/clerk/"+btoa(l)+"') no-repeat center center / contain",r.style.marginRight="-5px",r))}),e}}}};GISAPP.baseCallLayoutComponent=function(uiUtilitiesService,serverInjectionService){return function(o){'use strict';var t,e;return{render:function(){var o=uiUtilitiesService.processView(serverInjectionService.getViews().baseCallLayoutView,{},!0);return t=o.querySelector("#gis-ss-video-controls-right"),e=o.querySelector("#gis-ss-video-controls-bottom"),o},setBottomControls:function(o){uiUtilitiesService.clearView(e),e.appendChild(o)},setSideControls:function(o){uiUtilitiesService.clearView(t),t.appendChild(o)},addSideControls:function(o){t.appendChild(o)},updateControlType:function(o){"normal"===o?uiUtilitiesService.addClass(e,'gis-ss-gap-bottom-on-compact'):"compact"===o&&uiUtilitiesService.removeClass(e,'gis-ss-gap-bottom-on-compact')}}}};GISAPP.baseShopStreamLayoutComponent=function(uiUtilitiesService,serverInjectionService,layoutService,deviceInfoService,callService){return function(e){'use strict';var t,n,i,o,s,r,a=[],l=[],u=!1;function c(){return u}return{render:function(){return t=uiUtilitiesService.processView(serverInjectionService.getViews().shopStreamBaseLayoutView,{},!0),n=t.querySelector("#gis-ss-right-pane"),t.querySelector("#gis-ss-left-pane"),i=t.querySelector("#gis-ss-left-bottom-pane"),r=t.querySelectorAll("[class*='-compact']"),o=t.querySelector(".gis-shop-stream-row-compact"),s=t.querySelector("#gis-ss-wrapper-content"),deviceInfoService.isMobileDevice()&&!callService.isShopStreamCallProductCarouselEnabled()&&(s.style.height='100%'),e.player&&t.querySelector("#gis-ss-player-view").appendChild(e.player),"function"==typeof e.onLeftBottomContainerHide&&a.push(e.onLeftBottomContainerHide),"function"==typeof e.onRightContainerHide&&l.push(e.onRightContainerHide),layoutService.applyIf(function(){layoutService.applyFullScreenHeight(o)},function(){layoutService.removeFullScreenHeight(o)},[{selector:"<",breakpoint:{type:null,maxWidth:1024}},c]),t},showFullScreen:function(){u=!0,uiUtilitiesService.addClassOnList(r,'full-view'),layoutService.publishResizeEvents()},hideFullScreen:function(){u=!1,uiUtilitiesService.removeClassOnList(r,'full-view'),layoutService.publishResizeEvents()},setupLeftBottomContainer:function(e){uiUtilitiesService.clearView(i),i.appendChild(e)},showRightContainer:function(){uiUtilitiesService.removeClass(n,'gis-rightpane-disabled')},hideRightContainer:function(){uiUtilitiesService.addClass(n,'gis-rightpane-disabled')},showLeftBottomContainer:function(){uiUtilitiesService.removeClass(i,'gis-ss-hide')},hideLeftBottomContainer:function(){uiUtilitiesService.addClass(i,'gis-ss-hide')}}}};GISAPP.callStatusDialogComponent=function(uiUtilitiesService,serverInjectionService,buttonComponent,deviceInfoService){return function(){var l={CONNECTING_TO_LOBBY:"CONNECTING_TO_LOBBY",WAITING_FOR_ASSISTANT:"WAITING_FOR_ASSISTANT",ASSISTANT_IS_JOINING:"ASSISTANT_IS_JOINING",CALL_RECONNECTING:"CALL_RECONNECTING",CALL_DISCONNECTED:"CALL_DISCONNECTED",CALL_ENDED_CONFIRMATION:"CALL_ENDED_CONFIRMATION",CALL_RECONNECTED:"CALL_RECONNECTED",POOR_NETWORK:"POOR_NETWORK",VIDEO_DISABLED:"VIDEO_DISABLED"},s=null,i=null,a=null,n=null,r=null,t=null,o=null,C=null,c="<svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' clip-rule='evenodd' d='M0 12H2.17999C2.17999 14.604 3.215 17.101 5.06 18.9425C6.9 20.7835 9.395 21.818 12 21.818C14.605 21.818 17.1 20.7835 18.94 18.9425C20.785 17.101 21.82 14.604 21.82 12C21.82 9.396 20.785 6.899 18.94 5.0575C17.1 3.2165 14.605 2.18201 12 2.18201V0C15.185 0 18.235 1.2645 20.485 3.5145C22.735 5.765 24 8.8175 24 12C24 15.1825 22.735 18.235 20.485 20.4855C18.235 22.7355 15.185 24 12 24C8.815 24 5.76501 22.7355 3.51501 20.4855C1.26501 18.235 0 15.1825 0 12Z'/></svg>",g="<svg width='22' height='19' viewBox='0 0 22 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 19H22L11 0L0 19ZM12 16H10V14H12V16ZM12 12H10V8H12V12Z' fill='#FFF612'/></svg>",d="<svg width='24' height='19' viewBox='0 0 24 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M20.3077 19H22.1538V17.1H20.3077V19ZM12 0C5.29846 0 0.830772 3.762 0.387695 4.104L11.9908 18.981L12 19L12.0092 18.9905L18.4615 10.716V5.7H22.3754L23.6215 4.104C23.1692 3.762 18.7015 0 12 0ZM20.3077 15.2H22.1538V7.6H20.3077V15.2Z' fill='#FC4445'/></svg>",v=serverInjectionService.getLabels();function T(){deviceInfoService.isMobileDevice()?(C.style.height='48px',C.style.width='144px',uiUtilitiesService.addClass(r,'gis-call-overlay-messages-mobile'),uiUtilitiesService.addClass(C,'gis-call-overlay-container-mobile')):(C.style.width='160px',C.style.height='120px')}return{render:function(){return C=uiUtilitiesService.processView(serverInjectionService.getViews().callStatusDialogView,{},!1),r=C.querySelector("#gis-call-overlay-messages"),s=C.querySelector("#gis-call-overlay-main-message"),i=C.querySelector("#gis-call-overlay-sub-message"),a=C.querySelector("#gis-call-overlay-loader"),n=C.querySelector("#gis-call-overlay-buttons"),T(),C},show:function(e){if(l[e])switch(T(),uiUtilitiesService.addClass(s,"gis-hide"),uiUtilitiesService.addClass(i,"gis-hide"),uiUtilitiesService.addClass(a,"gis-hide"),uiUtilitiesService.addClass(a,'gis-spinner'),uiUtilitiesService.addClass(n,"gis-hide"),a.innerHTML=null,s.innerText=null,i.innerText=null,C.style.display='flex',e){case l.CONNECTING_TO_LOBBY:s.innerText=v.callScreenOverlay_callConnectingStatusText,a.innerHTML=c,a.querySelector('svg').style.fill="#5ADAAC",uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide");break;case l.WAITING_FOR_ASSISTANT:s.innerText=v.callScreenOverlay_callConnectedStatusMainText,i.innerText=v.callScreenOverlay_callConnectedStatusSubText,a.innerHTML=c,a.querySelector('svg').style.fill="#5ADAAC",uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),uiUtilitiesService.removeClass(i,"gis-hide"),deviceInfoService.isMobileDevice()&&(C.style.width='242px');break;case l.ASSISTANT_IS_JOINING:s.innerText=v.callScreenOverlay_callStatus_assistantJoiningText,a.innerHTML=c,a.querySelector('svg').style.fill="#5ADAAC",uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),deviceInfoService.isMobileDevice()&&(C.style.width='212px');break;case l.CALL_RECONNECTING:s.innerText=v.callScreenOverlay_callReconnectingStatusText,a.innerHTML=c,a.querySelector('svg').style.fill="#BDBDBD",uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide");break;case l.CALL_DISCONNECTED:s.innerText=v.callScreenOverlay_callDisconnectedStatusText,a.innerHTML=d,uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),uiUtilitiesService.removeClass(a,'gis-spinner');break;case l.CALL_ENDED_CONFIRMATION:deviceInfoService.isMobileDevice()&&(C.style.width='144px'),C.style.height='148px',s.innerText=v.callScreenOverlay_endCallVerificationDialogueMessage,a.innerHTML=g,function(e){if(uiUtilitiesService.hasChildNodes(n))uiUtilitiesService.removeClass(n,"gis-hide");else for(var l=0;l<e.length;l++){var s=e[l],i=new buttonComponent({buttonLabel:s.buttonLabel,color:s.color,onClick:s.onClick,isResponsive:!1});n.append(i.render())}}([{buttonLabel:v.callScreenOverlay_endCallVerificationDialogueStayCallBtnText,color:'#5ADAAC',onClick:o},{buttonLabel:v.callScreenOverlay_endCallVerificationDialogueEndCallBtnText,color:'#FC4445',onClick:t}]),uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),uiUtilitiesService.removeClass(n,"gis-hide"),uiUtilitiesService.removeClass(a,'gis-spinner'),uiUtilitiesService.removeClass(C,'gis-call-overlay-container-mobile');break;case l.POOR_NETWORK:s.innerText=v.callScreenOverlay_poorNetworkText,a.innerHTML=g,uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),uiUtilitiesService.removeClass(a,'gis-spinner'),C.style.height='48px',C.style.width='144px',uiUtilitiesService.addClass(r,'gis-call-overlay-messages-mobile'),uiUtilitiesService.addClass(C,'gis-call-overlay-container-mobile');break;case l.VIDEO_DISABLED:s.innerText=v.callScreenOverlay_poorNetworkText,i.innerText=v.callScreenOverlay_videoDisabledText,a.innerHTML=g,uiUtilitiesService.removeClass(a,"gis-hide"),uiUtilitiesService.removeClass(s,"gis-hide"),uiUtilitiesService.removeClass(i,"gis-hide"),uiUtilitiesService.removeClass(a,'gis-spinner')}},hide:function(){C.style.display='none'},setEndCallButton:function(e){t=e},setStayButton:function(e){o=e},STATUS:l}}};GISAPP.genericModalContentComponent=function(serverInjectionService,uiUtilitiesService,deviceInfoService,eventLoggerService,buttonComponent,microComponentService){return function(c){'use strict';var p={},u={};return{subviews:p,subcomponent:u,render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().modalContentView,{},!0);if(p.content=e.querySelector("#gis-connectv3-content"),p.contentContainer=e.querySelector("#gis-connectv3-content-container"),p.contentContainer.innerHTML="",function(){for(var e=c.componentList,t=0;t<e.length;t++){var n=null,o=e[t];if(/title|subTitle|primaryText|secondaryText|footer/.test(o.type))a=s=void 0,a=s=null,'title'==(l=o).type?s=microComponentService.getTitleComponent:'subTitle'==l.type?s=microComponentService.getSubTitleComponent:'primaryText'==l.type?s=microComponentService.getPrimaryTextComponent:'secondaryText'==l.type?s=microComponentService.getSecondaryTextComponent:'footer'==l.type&&(s=microComponentService.getFooterComponent),s&&"function"==typeof s&&(a=s.call(null,{text:l.text,className:l.className,style:l.style})),n=a,'footer'===o.type&&(r=void 0,(r=n.firstChild)&&(r.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.DISCLAIMER_CLICKED)}));else if("button"==o.type){var i=new buttonComponent({buttonMargin:o.margin,buttonLabel:o.label,color:o.color,buttonImage:o.image,buttonClass:o.class,onClick:o.onClick,eventName:o.eventName,eventData:o.eventData,isResponsive:o.isResponsive,responseLabel:o.responseLabel});n=i.render().firstChild,u.button=i}else"other"==o.type&&(n=o.value);p.contentContainer.appendChild(n)}var r,l,s,a}(),deviceInfoService.isMobileDevice())for(var t in p)p.hasOwnProperty(t)&&uiUtilitiesService.addClass(p[t],"gis-mobile");return e},hide:function(){p.content&&(p.content.style.display="none")},show:function(){p.content&&(p.content.style.display="initial")}}}};GISAPP.modalContentComponent=function(serverInjectionService,uiUtilitiesService,stateService,deviceInfoService,mediaService,eventLoggerService,overrideService,buttonComponent,urlUtilitiesService){return function(n){'use strict';var o={},a={},i=serverInjectionService.getUiConfig();function s(t,e){e||(e=0),t.exitAnimation&&(o.content.style.animation="0.5s gis-slide-to-left forwards"),setTimeout(function(){if(t.extraSetupFunction&&t.extraSetupFunction(),t.mainText&&t.mainText.text?(o.mainText.innerHTML=t.mainText.text,o.mainText.style.display="block",t.mainText.class&&uiUtilitiesService.addClass(o.mainText,t.mainText.class)):o.mainText.style.display="none",t.mainSubText?(o.mainSubText.innerHTML=t.mainSubText,o.mainSubText.style.display="block"):o.mainSubText.style.display="none",t.secondaryText?(o.secondaryText.innerHTML=t.secondaryText,o.secondaryText.style.display="block"):o.secondaryText.style.display="none",t.topImage?(o.topImage.style.background=uiUtilitiesService.getImageUrl(t.topImage)+" no-repeat center center / contain",o.topImage.style.display="block"):o.topImage.style.display="none",t.centerImage?(t.centerImage.filename&&(o.centerImage.style.background=uiUtilitiesService.getImageUrl(t.centerImage.filename)+" no-repeat center center / contain"),o.centerImage.style.display="block",t.centerImage.height&&(o.centerImage.style.height=t.centerImage.height),t.centerImage.class&&uiUtilitiesService.addClass(o.centerImage,t.centerImage.class)):t.centerImageView?(t.centerImageView.content&&uiUtilitiesService.appendView(o.centerImage,t.centerImageView.content),t.centerImageView.class&&uiUtilitiesService.addClass(o.centerImage,t.centerImageView.class)):o.centerImage.style.display="none",t.button?(a.button.setup({buttonLabel:t.button.label,buttonImage:t.button.image,buttonClass:t.button.class,onClick:t.button.onclick,eventName:t.button.eventName,eventData:t.button.eventData,isResponsive:t.button.isResponsive,responseLabel:t.button.responseLabel}),a.button.show()):a.button.hide(),t.secondaryButton&&(a.secondaryButton=new buttonComponent({}),uiUtilitiesService.appendBefore(o.contentContainer,a.secondaryButton.render(),o.supportInfoLink),a.secondaryButton.setup({buttonLabel:t.secondaryButton.label,buttonImage:t.secondaryButton.image,buttonClass:t.secondaryButton.class,onClick:t.secondaryButton.onclick,eventName:t.secondaryButton.eventName,eventData:t.secondaryButton.eventData,isResponsive:t.secondaryButton.isResponsive,responseLabel:t.secondaryButton.responseLabel}),a.secondaryButton.show()),i&&i.supportInfoLink&&t.linkText){var e=urlUtilitiesService.getSupportInfoUrl(i.supportInfoLink,stateService.getLocale());e&&(o.supportInfoLink.innerHTML=t.linkText,o.supportInfoLink.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.SUPPORT_INFO_LINK_CLICKED),window.open(e,'_blank')})}else o.supportInfoLink.style.display='none';t.tertiaryButton&&(a.tertiaryButton=new buttonComponent({}),uiUtilitiesService.appendBefore(o.contentContainer,a.tertiaryButton.render(),o.footer),a.tertiaryButton.setup({buttonLabel:t.tertiaryButton.label,buttonImage:t.tertiaryButton.image,buttonClass:t.tertiaryButton.class,onClick:t.tertiaryButton.onclick,eventName:t.tertiaryButton.eventName,eventData:t.tertiaryButton.eventData,isResponsive:t.tertiaryButton.isResponsive,responseLabel:t.tertiaryButton.responseLabel}),a.tertiaryButton.show()),t.chatLiveButton&&(a.chatLiveButton=new buttonComponent({}),uiUtilitiesService.appendBefore(o.contentContainer,a.chatLiveButton.render(),o.footer),a.chatLiveButton.setup({buttonLabel:t.chatLiveButton.label,buttonImage:t.chatLiveButton.image,buttonClass:t.chatLiveButton.class,onClick:t.chatLiveButton.onclick,eventName:t.chatLiveButton.eventName,eventData:t.chatLiveButton.eventData,isResponsive:t.chatLiveButton.isResponsive,responseLabel:t.chatLiveButton.responseLabel}),a.chatLiveButton.show()),t.footerText?(o.footer.onclick=function(){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.DISCLAIMER_CLICKED)},o.footer.innerHTML=t.footerText):o.footer.style.display='none',t.connectingScreenDisclaimerText?o.connectingDisclaimer.innerText=t.connectingScreenDisclaimerText:o.connectingDisclaimer.style.display='none',"fadein"===t.enterAnimation&&(o.content.style.animation="2s gis-fade-in forwards"),"slide"===t.enterAnimation&&(o.content.style.animation="0.5s gis-slide-from-right forwards"),"fullscreen"===t.enterAnimation&&(o.content.style.height="100%",o.content.style.width="100%",o.content.style.overflow="hidden",o.content.style.animation="2s gis-fade-in forwards"),t.padding&&(o.content.style.padding=t.padding)},e)}return{subviews:o,components:a,setup:s,render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().modalContentView,{},!0);if(o.content=e.querySelector("#gis-connectv3-content"),o.contentContainer=e.querySelector("#gis-connectv3-content-container"),o.mainText=e.querySelector("#gis-connectv3-mainText"),o.mainSubText=e.querySelector("#gis-connectv3-mainSubText"),o.secondaryText=e.querySelector("#gis-connectv3-secondaryText"),o.topImage=e.querySelector("#gis-connectv2-image"),o.centerImage=e.querySelector("#gis-connectv2-center-image"),o.centerImageLabel=e.querySelector("#gis-connectv2-center-image-label"),o.supportInfoLink=e.querySelector("#gis-connectv3-link"),o.footer=e.querySelector("#gis-connectv3-footer"),o.connectingFooter=e.querySelector("#gis-connectingv3-footer"),o.connectingDisclaimer=e.querySelector("#gis-connectingv3-disclaimer"),a.button=new buttonComponent({}),uiUtilitiesService.appendBefore(o.contentContainer,a.button.render(e),o.supportInfoLink),deviceInfoService.isMobileDevice())for(var t in o)o.hasOwnProperty(t)&&uiUtilitiesService.addClass(o[t],"gis-mobile");return s(n),e},hide:function(){o.content&&(o.content.style.display="none")},show:function(){o.content&&(o.content.style.display="initial")}}}};GISAPP.modalImageComponent=function(serverInjectionService,uiUtilitiesService,stateService,deviceInfoService){return function(a){'use strict';var i={};function t(e){a=e,setTimeout(function(){e.mainImage&&e.mainImage.class&&uiUtilitiesService.addClass(i.mainImage,e.mainImage.class),e.mainImage&&(i.mainImage.style.background=uiUtilitiesService.getImageUrl(e.mainImage.filename)+" no-repeat center center / "+(e.mainImage.backgroundSize?e.mainImage.backgroundSize:"contain")),e.mainImage&&e.mainImage.width&&(i.mainImage.style.width=e.mainImage.width),e.mainImage&&e.mainImage.height&&(i.mainImage.style.height=e.mainImage.height),e.secondImage?i.secondImage.style.background=uiUtilitiesService.getImageUrl(e.secondImage)+" no-repeat center center / contain":i.secondImage.style.display="none"},0)}function e(e){var n=140+(e.pageX-i.mainImage.offsetLeft)/12+'% '+(110-(e.pageY-i.mainImage.offsetTop)/15)+'%';i.imageContainer.style.webkitPerspectiveOrigin=n,i.imageContainer.style.perspectiveOrigin=n;var a=document.getElementById("gis-connectv3-mainText");a&&(a.innerHTML=a.innerHTML)}return{subviews:i,setup:t,render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().modalImageView,{},!0);if(i.imageContainer=e.querySelector("#gis-connectv3-imageContainer"),i.mainImage=e.querySelector("#gis-v2-mainImage"),i.secondImage=e.querySelector("#gis-connectv3-secondImage"),deviceInfoService.isMobileDevice())for(var n in i)i.hasOwnProperty(n)&&uiUtilitiesService.addClass(i[n],"gis-mobile");return t(a),e},hide:function(){i.imageContainer&&(i.imageContainer.style.display="none")},show:function(){i.imageContainer&&(i.imageContainer.style.display="block")},usePerspective:function(){deviceInfoService.isMobileDevice()||(i.imageContainer.style.perspective="3000px",i.mainImage.style.webkitTransform="rotateY(35deg)",i.mainImage.style.transform="rotateY(35deg)"),a.event&&e(a.event),document.body.addEventListener('mousemove',e,!1)},stopPerspective:function(){i.imageContainer.style.perspective="initial",i.mainImage.style.webkitTransform="initial",i.mainImage.style.transform="initial"},setImageToFullCover:function(){deviceInfoService.isMobileDevice()?i.imageContainer.style.padding='0px':(i.mainImage.style.borderTopLeftRadius='15px',i.mainImage.style.borderBottomLeftRadius='15px')}}}};GISAPP.modalVideoComponent=function(serverInjectionService,uiUtilitiesService,stateService,deviceInfoService){return function(o){'use strict';var n={};function t(e){setTimeout(function(){e.video?(n.videoSrc.setAttribute('src',serverInjectionService.getStaticImagesDomain()+e.video),n.video.load(),n.video.play(),n.video.style.animation="5s gis-fade-in forwards"):n.video.style.display="none"},0)}return{setup:t,render:function(){var e=uiUtilitiesService.processView(serverInjectionService.getViews().modalVideoView,{},!0);if(n.videoContainer=e.querySelector("#gis-connectv3-videoContainer"),n.video=e.querySelector("#gis-connectv3-video"),n.videoSrc=e.querySelector("#gis-connectv3-videoSrc"),deviceInfoService.isMobileDevice())for(var i in n)n.hasOwnProperty(i)&&uiUtilitiesService.addClass(n[i],"gis-mobile");return t(o),e},hide:function(){n.videoContainer&&(n.videoContainer.style.display="none")},show:function(){n.videoContainer&&(n.videoContainer.style.display="block")}}}};GISAPP.popupLayout=function(uiUtilitiesService,serverInjectionService){return function(s){'use strict';var n;return{render:function(){return n=uiUtilitiesService.processView(serverInjectionService.getViews().popupView,{}),s.position?uiUtilitiesService.addClass(n,'gis-'+s.position+'-popup'):uiUtilitiesService.addClass(n,'gis-center-popup'),s.backgroundClass&&uiUtilitiesService.addClass(n,s.backgroundClass),n}}}};GISAPP.shopStreamVideoHeaderComponent=function(uiUtilitiesService,serverInjectionService,utilitiesService,deviceInfoService){return function(){'use strict';var e,s,a,i,t,l,o,g;return{render:function(){var r;return e=uiUtilitiesService.processView(serverInjectionService.getViews().shopStreamVideoHeaderView,{}),s=e.querySelector('#gis-retailer-logo-container'),a=e.querySelector('#gis-retailer-logo'),i=e.querySelector('#gis-player-stream-type-container'),t=e.querySelector('#gis-player-cta-container'),g=e.querySelector('#gis-player-cta-message-container'),l=e.querySelector('#gis-player-cta-message'),o=e.querySelector('#gis-player-cta'),r=uiUtilitiesService.getImageUrl("retailer-logo.png",!0),utilitiesService.isImageExists(r,function(e){a.style.display=e?(a.style.backgroundImage="url("+r+")","block"):"none"}),l.innerText=serverInjectionService.getLabels().shopStream_cta_message,deviceInfoService.isMobileDevice()&&(uiUtilitiesService.addClass(s,'gis-mobile'),uiUtilitiesService.addClass(a,'gis-mobile'),uiUtilitiesService.addClass(i,'gis-mobile'),uiUtilitiesService.addClass(o,'gis-mobile'),uiUtilitiesService.addClass(t,'gis-mobile'),uiUtilitiesService.addClass(g,'gis-mobile'),uiUtilitiesService.addClass(l,'gis-mobile')),e}}}};GISAPP.videoSegmentComponent=function(logService,uiUtilitiesService,utilitiesService,serverInjectionService,deviceInfoService){return function(i){'use strict';var r,d={},o="videoSegmentComponent",n=serverInjectionService.getUiConfig().theme,l=i.playTo;return{render:function(){if(!i.videoSegmentList||0==i.videoSegmentList.length)return logService.debug(o,"videoSegmentList should not be null or empty"),r=uiUtilitiesService.createElementWithAttributes("div","gis-video-segment-wrapper","","width:100%;height:100%;background: gray;color: white;display: flex;align-items: center;justify-content: center;text-align: center;");if(i.videoSegmentContainer){if(i.playTo){i.videoSegmentContainer.lastElementChild&&i.videoSegmentContainer.removeChild(i.videoSegmentContainer.lastElementChild);var e='.gis-Video-Segment-selected{ background: #dadada }';deviceInfoService.isMobileDevice()||(e+='#gis-Video-Segment-container:hover { background-color: '+(n&&n.main_button_color?n.main_button_color:'#c4c5c4')+' } #gis-Video-Segment-container:hover .gis-hide{display:inline-block;} #gis-Video-Segment-container {-webkit-tap-highlight-color: rgba(0, 0, 0, 0)}');var t=document.createElement('style');return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(r=uiUtilitiesService.createElementWithAttributes("div","gis-video-segment-wrapper","","height: 100%;width: 100%;overflow-y: auto;-webkit-overflow-scrolling: touch;")).appendChild(t),i.videoSegmentList.forEach(function(e,t){var i,o,n;r.appendChild((i=e,o=uiUtilitiesService.processView(serverInjectionService.getViews().videoSegmentView,{},!0),n=utilitiesService.getSecondsFromStringTime(i.startTime),d.videoSegmentContainer=o.querySelector("#gis-Video-Segment-container"),d.videoSegment=o.querySelector("#gis-Video-Segment"),d.videoSegmentImage=o.querySelector("#gis-Video-Segment-image"),d.videoSegmentTitle=o.querySelector("#gis-Video-Segment-title"),d.videoSegmentTime=o.querySelector("#gis-Video-Segment-time"),d.videoSegment.setAttribute("title",i.title),d.videoSegmentImage.style.backgroundImage="url(\""+i.snapShotUrl+"\")",d.videoSegmentTitle.innerHTML=i.title,d.videoSegmentTime.innerHTML=i.startTime,d.videoSegment.style.borderBottom='1px solid #dbd9d9',d.videoSegment.addEventListener("click",function(e,t,i,o){deviceInfoService.isMobileDevice()&&(t.style.backgroundColor='#ebe9e9',setTimeout(function(){t.style.backgroundColor='white'},50)),i.style.color='#9e9d9d',l(e,o)}.bind(null,n,d.videoSegmentContainer,d.videoSegmentTitle,i.title)),o))}),uiUtilitiesService.enableBodyScroll(),gisAppLib.bodyScrollLock.disableBodyScroll(r),r}logService.debug(o,"playTo method should not be null or empty")}else logService.debug(o,"videoSegmentContainer should not be null or empty")}}}};GISAPP.broadcastDOMProc=function(ctaComponent,serverInjectionService,uiUtilitiesService,retailerFunctionalityCtrl,stateService,logService,chatInputDOMProc){'use strict';var i,n,a,s,r,c,l,d,u,t,g,f,y,p,C,b,m,h,S,v,w,O="broadcastDOMProc",q='gis-live-container',L="gis-cta-wrapper",T='gis-no-broadcast-msg-container',V="gis-live-video",k="gis-tap-play",M="gis-tap-play-img",B="gis-go-to-shop-btn",_="gis-bc-not-found",x="gis-bc-invalid-url",A="gis-specific-shop-page-btn",I='gis-rtlr-custom-btn',E="gis-broadcast-video",D='gis-extra-button-1',H='gis-extra-button-2',P="gis-broadcast-ended-wrapper",U='gis-hide',o=function(){},F=function(){},N={BROADCAST_FOUND:0,BROADCAST_NOT_FOUND:1,INVALID_ALIAS:2};function R(e){chatInputDOMProc.dispose(),t&&t(e),K(),uiUtilitiesService.hideModal(),uiUtilitiesService.removeClass(g,"gis-hide"),uiUtilitiesService.removeClass(r,"gis-hide"),uiUtilitiesService.addClass(c,"gis-hide"),uiUtilitiesService.addClass(m,"gis-hide"),chatInputDOMProc.enableChat()}function G(){if(i&&s){var e=s.play();if(null==e)return void uiUtilitiesService.addClass(n,U);e.then(function(){uiUtilitiesService.addClass(n,U)}).catch(function(e){e instanceof DOMException?n.onclick=G:logService.error(O,"Exception while playing broadcast.",e)})}}function z(){i.querySelector('#gis-broadcast-one-to-one-cta-container').style.display='block'}function j(){i.querySelector('#gis-broadcast-one-to-one-cta-container').style.display='none'}function e(){}function J(e){i=uiUtilitiesService.processView(serverInjectionService.getBroadcastView(),{}),e||(i.querySelector('#gis-broadcast').appendChild(chatInputDOMProc.render()),chatInputDOMProc.setOnClose(R)),s=i.querySelector("#"+V),r=i.querySelector("#"+q),n=i.querySelector("#"+k),a=i.querySelector("#"+M),l=i.querySelector("#"+B),d=i.querySelector("#"+A),u=i.querySelector("#"+I),c=i.querySelector('#'+T),g=i.querySelector('#'+E),f=i.querySelector('#'+_),y=i.querySelector('#'+x),p=i.querySelector('#'+D),C=i.querySelector('#'+H),m=i.querySelector("#"+P),a.src=uiUtilitiesService.getImageUrl("play-button.png",!0);var t=serverInjectionService.getUiConfig();t.gisBranding&&b&&(b.style.backgroundImage=uiUtilitiesService.getImageUrl("powered-by.svg"),b.onclick=function(){window.open('//www.goinstore.com','_blank')}),function(e){if(!e)return LOGGER.warn(O,"video element doesn't exist, can't listen to video events");e.addEventListener("play",W),e.addEventListener("pause",X)}(s);var o=t.theme;o&&(r.style.fontFamily=o.font,l.style.backgroundColor=o.mainColor,l.style.color=o.foregroundColor,l.style.fontFamily=o.font,C.style.backgroundColor=o.mainColor),h=i.querySelector("#"+L),w=serverInjectionService.getUiConfig(),v=new ctaComponent({ctaMode:"humanized",position:"right",roundelColor:w.theme&&w.theme.mainColor,roundelImage:"cta-logo.png",isCtaOnBroadcast:!0,isFloater:!0}),S=v.render(),h.appendChild(S)}function K(){setTimeout(function(){uiUtilitiesService.removeClass(S.querySelector("#gis-cta"),"gis-circle-animate-show"),uiUtilitiesService.addClass(S.querySelector("#gis-cta"),"gis-circle-animate-hide")},400)}function Q(){var e=stateService.getBroadcastResponse().status,t=stateService.getBroadcastResponse().requestType,o=void 0===e||e==N.BROADCAST_FOUND,n=void 0!==e&&e==N.INVALID_ALIAS;"alias"==t&&(o||(uiUtilitiesService.addClass(g,"gis-hide"),uiUtilitiesService.addClass(r,"gis-hide"),uiUtilitiesService.removeClass(c,'gis-hide'),chatInputDOMProc.disableChat(),n?(uiUtilitiesService.removeClass(y,"gis-hide"),uiUtilitiesService.addClass(f,"gis-hide")):(uiUtilitiesService.addClass(y,"gis-hide"),uiUtilitiesService.removeClass(f,"gis-hide"))))}function W(e){o()}function X(){F()}function Y(){r.innerHTML=serverInjectionService.getLabels().broadcastViewer_LiveMessage,d.innerHTML=serverInjectionService.getLabels().broadcastViewer_specificShopPageText,l.innerHTML=serverInjectionService.getLabels().broadcastViewer_goToShopPageText,f.querySelector(".msg-one").innerHTML=serverInjectionService.getLabels().broadcastViewer_broadcastNotFoundText1,f.querySelector(".msg-two").innerHTML=serverInjectionService.getLabels().broadcastViewer_broadcastNotFoundText2,y.querySelector(".msg-one").innerHTML=serverInjectionService.getLabels().broadcastViewer_invalidBroadcastUrlText1,y.querySelector(".msg-two").innerHTML=serverInjectionService.getLabels().broadcastViewer_invalidBroadcastUrlText2,p.innerHTML=serverInjectionService.getLabels().broadcastViewer_extraButton1,C.innerHTML=serverInjectionService.getLabels().broadcastViewer_extraButton2,m.querySelector("#gis-broadcast-ended-text").innerHTML=serverInjectionService.getLabels().broadcastViewer_broadcastEndedMessage}return{show:function(){i||J(),Q(),Y(),uiUtilitiesService.showModal(i),retailerFunctionalityCtrl&&'function'==typeof retailerFunctionalityCtrl.init&&retailerFunctionalityCtrl.init()},hide:R,setOnClickClose:function(e){i&&(j(),e&&'function'==typeof e&&(t=e))},setOnClickPlay:function(e){i&&e&&'function'==typeof e&&(n.onclick=e)},setOnClickShop:function(e){i&&e&&'function'==typeof e&&(l.onclick=e)},setOnClickSpecificShop:function(e){i&&e&&'function'==typeof e&&d&&(d.onclick=e)},setOnClickRetailerCustomButton:function(e){i&&e&&'function'==typeof e&&(u.onclick=e)},getVideoElement:function(){return s},playVideo:G,pauseVideo:function(){i&&s&&(s.pause(),uiUtilitiesService.removeClass(n,'gis-hide'),n.onclick=G)},toggleMute:function(){s&&(s.muted=!s.muted)},stopVideo:function(){i&&s&&(s.pause(),s.src="")},onVideoPlay:function(e){'function'==typeof e&&(o=e)},onVideoPause:function(e){'function'==typeof e&&(F=e)},setupExtraButton:function(e,t,o){var n;i&&o&&'function'==typeof o&&(1===e&&(n=p),2===e&&(n=C),n&&(t&&(n.innerHTML=t),n.onclick=o,uiUtilitiesService.removeClass(n,U)))},broadcastEnded:function(){i&&(chatInputDOMProc.disableChat(),uiUtilitiesService.removeClass(m,U))},setOneToOneCtaOnBroadcast:function(e,t){v.setup({showAvailabilityIndicator:e,isAvailable:t,isCtaOnBroadcast:!0});var o=serverInjectionService.getSystemConfig();t||o.persistentCta?(setTimeout(function(){uiUtilitiesService.removeClass(S.querySelector("#gis-cta"),"gis-circle-animate-hide"),uiUtilitiesService.addClass(S.querySelector("#gis-cta"),"gis-circle-animate-show")},400),z()):(K(),j())},showOneToOneCtaOnBroadcast:z,hideOneToOneCtaOnBroadcast:j,setOnCtaClickEvent:function(t){S&&'function'==typeof t&&(S.querySelector('#gis-cta').onclick=function(e){t.call(this,e)})},getView:function(){return i||(J(!0),Q(),Y(),i=i.firstElementChild),i},setIntervalOnVideoElement:e,clearIntervalOnVideoElement:e,extendPlayer:function(e){s&&e(s)}}};GISAPP.callDOMProc=function(serverInjectionService,uiUtilitiesService,browserInfoService,deviceInfoService,logService,stateService,overrideService,callStatusDialogComponent,callControllerComponent,bookingService,eventLoggerService,addToBasketRequestComponent,callService){var a={LOGTAG:"callDOMProc"};a.uiUtilitiesService=uiUtilitiesService;var l,o,r,i,c,d,u,g,h,m,C,y,p,f,b,v,S,w,I,L,E,T,N,M,O,k,A,B,V,H,e,t=logService,x=new Map,n=!1,q=!0,s=3500,_=serverInjectionService.getUiConfig(),D={WELCOME:"WELCOME",SHARE_MIC:"SHARE_MIC",MIC_SHARED:"MIC_SHARED",MIC_DENIED:"MIC_DENIED"};a.shouldShowBrand=function(){return!1},a.getBrandImage=function(){};var G=null,R=null,F="<svg width='19' height='19' viewBox='0 0 19 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M19 4.5L15 8.5V5C15 4.45 14.55 4 14 4H7.82L19 15.18V4.5ZM1.27 0L0 1.27L2.73 4H2C1.45 4 1 4.45 1 5V15C1 15.55 1.45 16 2 16H14C14.21 16 14.39 15.92 14.54 15.82L17.73 19L19 17.73L1.27 0Z' fill='#4F4F4F'/></svg>",U="<svg width='18' height='18' viewBox='0 0 18 18' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 6.00001V12H4L9 17V1.00001L4 6.00001H0ZM13.5 9.00001C13.5 7.23001 12.48 5.71001 11 4.97001V13.02C12.48 12.29 13.5 10.77 13.5 9.00001ZM11 0.230011V2.29001C13.89 3.15001 16 5.83001 16 9.00001C16 12.17 13.89 14.85 11 15.71V17.77C15.01 16.86 18 13.28 18 9.00001C18 4.72001 15.01 1.14001 11 0.230011Z' fill='white'/></svg>",Z="<svg width='14' height='19' viewBox='0 0 14 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M7 12C8.66 12 9.99 10.66 9.99 9L10 3C10 1.34 8.66 0 7 0C5.34 0 4 1.34 4 3V9C4 10.66 5.34 12 7 12ZM12.3 9C12.3 12 9.76 14.1 7 14.1C4.24 14.1 1.7 12 1.7 9H0C0 12.41 2.72 15.23 6 15.72V19H8V15.72C11.28 15.24 14 12.42 14 9H12.3Z' fill='white'/></svg>",W="<svg width='24' height='9' viewBox='0 0 24 9' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M12 2C10.4 2 8.85 2.25 7.4 2.72V5.82C7.4 6.21 7.17 6.56 6.84 6.72C5.86 7.21 4.97 7.84 4.18 8.57C4 8.75 3.75 8.85 3.48 8.85C3.2 8.85 2.95 8.74 2.77 8.56L0.29 6.08C0.11 5.91 0 5.66 0 5.38C0 5.1 0.11 4.85 0.29 4.67C3.34 1.78 7.46 0 12 0C16.54 0 20.66 1.78 23.71 4.67C23.89 4.85 24 5.1 24 5.38C24 5.66 23.89 5.91 23.71 6.09L21.23 8.57C21.05 8.75 20.8 8.86 20.52 8.86C20.25 8.86 20 8.75 19.82 8.58C19.03 7.84 18.13 7.22 17.15 6.73C16.82 6.57 16.59 6.23 16.59 5.83V2.73C15.15 2.25 13.6 2 12 2Z' fill='#FC4445'/></svg>",P="<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M21 24C21 25.66 22.34 27 24 27C25.66 27 27 25.66 27 24C27 22.34 25.66 21 24 21C22.34 21 21 22.34 21 24Z' fill='#F3F3F3'/><path d='M20 22V20H17.09C18.47 17.61 21.05 16 24 16C27.72 16 30.85 18.56 31.74 22H33.8C32.87 17.44 28.84 14 24 14C20.73 14 17.82 15.58 16 18.01V16H14V22H20ZM28 26V28H30.91C29.53 30.39 26.95 32 24 32C20.28 32 17.15 29.44 16.26 26H14.2C15.13 30.56 19.16 34 24 34C27.27 34 30.18 32.42 32 29.99V32H34V26H28Z' fill='#F3F3F3'/></svg>";function j(){var e=document.getElementById('subscribers');if(e){var i=e.childNodes;for(var t in i)if(i.hasOwnProperty(t)&&"oldsubscribers"!==i[t].id)return i[t].id}}function z(e,i){l=e,o=i}function J(e,i){m.innerText=e,C.innerText=i}function $(){r&&(r.onmousemove=re)}function Y(e){switch(y.className="gis-mic-share-overlay",I.className="",m.className="",C.className="",w.className="",e){case D.WELCOME:uiUtilitiesService.addClass(I,'gis-call-icon-visible-hidden'),uiUtilitiesService.addClass(m,'gis-mic-share-heading gis-heading-size'),uiUtilitiesService.addClass(w,'gis-hide'),J("Welcome","");break;case D.SHARE_MIC:uiUtilitiesService.addClass(I,'gis-mic-share-icon'),uiUtilitiesService.addClass(m,'gis-mic-share-heading'),uiUtilitiesService.addClass(w,'gis-hide'),J("Allow your browser to use mic so we can speak","");break;case D.MIC_SHARED:uiUtilitiesService.addClass(I,'gis-call-icon-visible-hidden'),uiUtilitiesService.addClass(m,'gis-mic-share-heading gis-heading-size'),uiUtilitiesService.addClass(w,'gis-hide'),J("Enjoy your visit!","");break;case D.MIC_DENIED:uiUtilitiesService.addClass(I,'gis-mic-share-icon gis-icon-margin'),uiUtilitiesService.addClass(m,'gis-mic-share-heading gis-heading-margin'),uiUtilitiesService.addClass(C,'gis-mic-share-message'),J("It appears you've blocked your mic","To speak to us, unblock your mic and give us a call back")}}function K(e){if(e&&x.get(e)){var i,t=x.get(e).videoDimensions.width,n=x.get(e).videoDimensions.height,s=n<t,l=t<n,o=document.getElementById(e);browserInfoService.isSafari()&&(o.style.overflow='visible'),"subscribers"===o.parentNode.id&&(deviceInfoService.isMobileDevice()&&uiUtilitiesService.isLandscape()?o.style.height=(o.style.width=(i=l?uiUtilitiesService.adjustAspectRatioBasedOnHeight(t,n):uiUtilitiesService.adjustAspectRatioBasedOnWidth(t,n)).width+"px",i.height+"px"):o.style.height=(o.style.width=(i=s?uiUtilitiesService.adjustAspectRatioBasedOnWidth(t,n):uiUtilitiesService.adjustAspectRatioBasedOnHeight(t,n)).width+"px",i.height+"px"))}}function Q(){B.querySelector('video')&&ae(),R=G,G=O.STATUS.CALL_RECONNECTING,O.show(G),ne('none','#252424')}function X(){switch(ne('flex','#000'),G===O.STATUS.CALL_RECONNECTED?R:G){case O.STATUS.WAITING_FOR_ASSISTANT:le();break;case O.STATUS.ASSISTANT_IS_JOINING:oe();break;case O.STATUS.CONNECTING_TO_LOBBY:se();break;case O.STATUS.CALL_RECONNECTING:Q();break;default:ee()}}function ee(){ne('flex','#000'),O&&O.hide(),R=G=null}function ie(){e=setTimeout(function(){r.querySelector('#gis-call-controller').style.opacity='0'},s)}function te(){e&&(window.clearTimeout(e),r.querySelector('#gis-call-controller').style.opacity='1',ie())}function ne(e,i){var t=j();t&&(document.getElementById(t).style.display=e),document.getElementById('subscribers').style.backgroundColor=i}function se(){G=O.STATUS.CONNECTING_TO_LOBBY,O.show(G),ne('none','#252424')}function le(){G=O.STATUS.WAITING_FOR_ASSISTANT,O.show(G),ne('none','#252424')}function oe(){G=O.STATUS.ASSISTANT_IS_JOINING,O.show(G),ne('none','#252424')}function ae(){if(!G){var e=E.firstChild,i=B.childNodes[3];E.removeChild(e),B.removeChild(i),B.appendChild(e),e.style.width='100%',e.style.height='100%',E.appendChild(i),K(i.id),deviceInfoService.isMobileDevice()&&setTimeout(function(){V.style.display='none'},200),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.TAP_TO_FOCUS_BUTTON_CLICKED)}}function re(){n||(n=!0,c.style.bottom="0px",c.style.opacity="1",null!=d&&(d.style.right="10px",d.style.opacity="1"),i=setTimeout(ce,1e4))}function ce(){n&&(n=!1,null!=d&&(d.style.right="-150px",d.style.opacity="0"))}function de(){var e;_.showClerkProfile&&(l&&(u.style.backgroundImage="url('"+(e=l,serverInjectionService.getGisDomain()+"/images/clerk/"+btoa(e))+"')"),h&&o&&(h.innerHTML=o))}function ue(){var e,i,t=document.getElementById('subscribers'),n=document.getElementById('oldsubscriber');null!==t.childNodes[1]&&null!==n.childNodes[1]&&(e=t.childNodes[1],i=n.childNodes[1],n.appendChild(e),t.appendChild(i),e.style.width="100%",e.style.height="100%",K(i.id))}function ge(){}return a.setOnEndCallClick=function(e){'function'==typeof e?p.onclick=function(){clearTimeout(i),O.setEndCallButton(e),O.setStayButton(X),O.show(O.STATUS.CALL_ENDED_CONFIRMATION)}:t.error(a.LOGTAG,"setOnEndCallClick argument not a function")},overrideService.override(a.LOGTAG,a),{show:function(e){!function(e,i){var t;r=uiUtilitiesService.processView(serverInjectionService.getCallView(),{micSetupRequired:e}),c=r.querySelector('#gis-call-footer');var n='gis-cam-mute',s='gis-call-drop',l='gis-call-mute',o='gis-call-vol';t=i&&bookingService.isTwoWayVideoCallEnabled()||!i&&callService.isTwoWayVideoCall()?deviceInfoService.isMobileDevice()?['gis-cam-switch',n,s,l,o]:[l,n,o,s]:[l,s,o],H=new callControllerComponent({componentList:t}),c.appendChild(H.render()),d=r.querySelector('#gis-call-userinfo'),u=r.querySelector('#gis-clerkImgDivId'),g=r.querySelector('#gis-retailer-brand-logo'),T=r.querySelector('#gis-brand-logo'),h=r.querySelector('#gis-userinfo-text'),m=r.querySelector("#gis-mic-share-heading"),C=r.querySelector("#gis-mic-share-message"),y=r.querySelector("#gis-mic-share-overlay"),p=r.querySelector("#gis-call-drop"),f=r.querySelector("#gis-call-mute"),b=r.querySelector("#gis-call-vol"),A=r.querySelector('#gis-call-drop'),w=r.querySelector('#gis-help-unblock'),I=r.querySelector('#gis-mic-share-icon'),E=r.querySelector('#subscribers'),L=r.querySelector('#no-video-img-holder'),k=r.querySelector('#gis-footer-bg'),N=r.querySelector('#gis-call-signal-container'),r.querySelector('#gis-call-signal-header-img'),r.querySelector('#gis-call-signal-header-text'),r.querySelector('#gis-call-signal-info-img'),r.querySelector('#gis-call-signal-info-title'),r.querySelector('#gis-call-signal-info-price'),r.querySelector('#gis-call-signal-info-size'),r.querySelector('#gis-call-signal-actions .confirmation-btn'),r.querySelector('#gis-call-signal-actions .confirmation-btn .gis-v3-button-icon'),r.querySelector('#gis-call-signal-actions .reject-btn'),B=r.querySelector('#publisher'),V=r.querySelector('#gis-tap-button-container'),f.innerHTML=Z,b.innerHTML=U,M=r.querySelector("#gis-overlay-container"),A.innerHTML=W,e||$(),O=new callStatusDialogComponent({}),M.appendChild(O.render()),i&&bookingService.isTwoWayVideoCallEnabled()||!i&&callService.isTwoWayVideoCall()?((v=r.querySelector("#gis-cam-mute")).innerHTML=F,deviceInfoService.isMobileDevice()&&((S=r.querySelector("#gis-cam-switch")).innerHTML=P)):(k.style.width='240px',f.style.margin='12px',b.style.margin='12px',A.style.margin='12px'),uiUtilitiesService.addClass(c,"gis-hide")}(e.isMicSetupRequired,e.isBookingCall),e.isMicSetupRequired&&Y(D.WELCOME),uiUtilitiesService.showModal(r),de(),function(){if(a.shouldShowBrand()){var e=a.getBrandImage();if(Image){var i=new Image;i.onload=function(){i.style.width='auto',i.style.height='auto',i.style.maxWidth='100%',i.style.maxHeight='100%',i.style.position='absolute',i.style.bottom='0',e.background&&(i.style.background=e.background),uiUtilitiesService.addClass(T,e.class?e.class:""),T.appendChild(i),T.style.display='block'},i.onerror=function(){logService.error(a.LOGTAG,"Error while requesting brand logo image name = "+e.name)},e&&e.name&&(i.src=uiUtilitiesService.getImageUrl(e.name,!0))}}}()},hide:function(){x.clear(),!1;var e=document.getElementById("oldsubscriber");uiUtilitiesService.removeNode(e),uiUtilitiesService.hideModal()},setOnMicClick:function(e){'function'==typeof e?f.onclick=e:t.error(a.LOGTAG,"setOnMicClick argument not a function")},setOnSpeakerClick:function(e){'function'==typeof e?b.onclick=e:t.error(a.LOGTAG,"setOnSpeakerClick argument not a function")},setOnEndCallClick:a.setOnEndCallClick,setOnHelpUnblockClick:function(e){'function'==typeof e?w&&(w.onclick=e):t.error(a.LOGTAG,"setOnHelpUnblockClick argument not a function")},changeMicIcon:function(e){f.innerHTML=e?"<svg width='18' height='19' viewBox='0 0 18 19' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M16 9H14.3C14.3 9.74 14.14 10.43 13.87 11.05L15.1 12.28C15.66 11.3 16 10.19 16 9ZM11.98 9.17C11.98 9.11 12 9.06 12 9V3C12 1.34 10.66 0 9 0C7.34 0 6 1.34 6 3V3.18L11.98 9.17ZM1.27 1L0 2.27L6.01 8.28V9C6.01 10.66 7.34 12 9 12C9.22 12 9.44 11.97 9.65 11.92L11.31 13.58C10.6 13.91 9.81 14.1 9 14.1C6.24 14.1 3.7 12 3.7 9H2C2 12.41 4.72 15.23 8 15.72V19H10V15.72C10.91 15.59 11.77 15.27 12.54 14.82L16.73 19L18 17.73L1.27 1Z' fill='#4F4F4F'/></svg>":Z},changeSpeakerIcon:function(e){b.innerHTML=e?"<svg width='18' height='18' viewBox='0 0 18 18' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M13.5 9C13.5 7.23 12.48 5.71 11 4.97V7.18L13.45 9.63C13.48 9.43 13.5 9.22 13.5 9ZM16 9C16 9.94 15.8 10.82 15.46 11.64L16.97 13.15C17.63 11.91 18 10.5 18 9C18 4.72 15.01 1.14 11 0.23V2.29C13.89 3.15 16 5.83 16 9ZM1.27 0L0 1.27L4.73 6H0V12H4L9 17V10.27L13.25 14.52C12.58 15.04 11.83 15.45 11 15.7V17.76C12.38 17.45 13.63 16.81 14.69 15.95L16.73 18L18 16.73L9 7.73L1.27 0ZM9 1L6.91 3.09L9 5.18V1Z' fill='#4F4F4F'/></svg>":U},setupClerkProfile:z,updateMessage:J,hideMicShareOverlay:function(){y&&uiUtilitiesService.addClass(y,"gis-hide")},displayControls:function(){c&&uiUtilitiesService.removeClass(c,'gis-hide')},enableControlSlide:$,updateOverlayTo:Y,overlayStages:D,showNoVideoImage:function(){uiUtilitiesService.addClass(E,'gis-hide'),uiUtilitiesService.removeClass(L,'gis-hide')},hideNoVideoImage:function(){uiUtilitiesService.removeClass(E,'gis-hide'),uiUtilitiesService.addClass(L,'gis-hide')},showReconnectingMessage:Q,showDisconnectedMessage:function(e){G=O.STATUS.CALL_DISCONNECTED,O.show(G),p.onclick=e,ne('none','#252424')},updateCallScreenOverlayStatus:X,hideCallStatusDialog:ee,setPublishedVideo:function(e){var i=document.getElementById('publisher');i.style.display="block",deviceInfoService.isMobileDevice()&&uiUtilitiesService.addClass(i,"publisher-mobile"),i.appendChild(e)},disableCamMuteBtn:function(){var e=document.getElementById("gis-cam-mute");e.style.pointerEvents="none",e.style.opacity="0.4"},setOnCamClick:function(e){'function'==typeof e?v.onclick=e:t.error(a.LOGTAG,"setOnCamClick argument not a function")},setOnCameraSwitch:function(e){'function'==typeof e?deviceInfoService.isMobileDevice()&&(S.onclick=e):t.error(a.LOGTAG,"setOnCameraSwitch argument not a function")},changeCamIcon:function(e){v.innerHTML=e?F:"<svg width='18' height='12' viewBox='0 0 18 12' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L18 11.5V0.5L14 4.5Z' fill='white'/></svg>"},setupTapToFocus:function(){B.addEventListener('mouseover',function(){G||(V.style.display='flex')}),B.addEventListener('mouseout',function(){G||(V.style.display='none')}),B.onclick=ae},hideCallController:ie,setCallControllerAnimation:function(){document.addEventListener('mousemove',te),document.addEventListener('touchstart',te)},destroyEventListeners:function(){document.removeEventListener('mousemove',te),document.removeEventListener('touchstart',te)},showRecordingDialog:ge,hideRecordingDialog:ge,updateConnectionCount:ge,addRecommendedProduct:ge,addStream:function(i){x.set(i.streamId,i);var e,t=document.createElement("div");if(t.id='storevideo',document.getElementById('storevideoParent').appendChild(t),uiUtilitiesService.show('storevideo'),t.setAttribute('id',i.streamId),0<document.getElementById('subscribers').childElementCount){document.getElementById('subscribers').style.zIndex='0';var n=document.getElementById('subscribers').childNodes[0],s=uiUtilitiesService.createElementWithAttributes("div","oldsubscriber","","width: 200px;height:150px;position: absolute;background: black;z-index: 1;bottom: 10px; left: 10px;"),l=uiUtilitiesService.createElementWithAttributes("div","videoSwitch","gis-video-switch-arrow");l.onclick=ue,l.style.backgroundImage=uiUtilitiesService.getImageUrl("switch.png"),s.appendChild(l),n.style.width="100%",n.style.height="100%",s.appendChild(n),document.getElementById('subscribers').appendChild(s),!!0===q&&(document.getElementById('oldsubscriber').style.display="none",q=!!1)}try{var o=JSON.parse(i.connection.data);o.clerkRetailer&&o.clerkRetailer.key&&(e=o.clerkRetailer.key,_.showRetailerBrand&&e&&'string'==typeof e&&(g.style.backgroundImage="url('"+uiUtilitiesService.getImageUrl(e.toLowerCase()+".png",!0)+"')")),o.publisher&&o.publisher.displayName&&o.publisher.imgName&&(z(o.publisher.imgName,o.publisher.displayName),de(),re())}catch(e){logService.error(a.LOGTAG,"Error while processing stream connection data= "+i.connection.data,e)}return document.getElementById('subscribers').appendChild(t),t},getMainVideoStreamId:j,removeVideoWhenClerkLeave:function(e){var i=document.getElementById(e),t=document.getElementById('oldsubscriber');if(document.getElementById('subscribers').style.zIndex='-1',"oldsubscriber"===i.parentNode.id)uiUtilitiesService.removeNode(t);else if("subscribers"===i.parentNode.id&&t){var n=document.getElementById('subscribers'),s=t.childNodes[1];uiUtilitiesService.removeNode(n.childNodes[1]),n.appendChild(s),uiUtilitiesService.removeNode(t)}!1},showVideoOfClerk:function(e){var i=document.getElementById(e);"oldsubscriber"===i.parentNode.id&&!1===q?(ue(),q=!0):"oldsubscriber"===i.parentNode.id&&(document.getElementById("oldsubscriber").style.display="block",!0)},hideVideoOfClerk:function(e){var i=document.getElementById("oldsubscriber"),t=window.getComputedStyle(i,null).getPropertyValue("display"),n=document.getElementById(e);"subscribers"===n.parentNode.id&&"none"!==t?ue():"subscribers"===n.parentNode.id&&"none"===t&&(q=!1),"oldsubscriber"===n.parentNode.id&&!1,document.getElementById("oldsubscriber").style.display="none"},changeVideoDimension:K,setSubscriberVideoState:function(e){q=e},showSignalMessage:function(e,i,t){var n={data:JSON.parse(e.data),onAccept:i,onReject:t,exit:function(){N.style.display="none",N.innerHTML=""},clerkImageURL:uiUtilitiesService.getClerkImageUrl(l||"clerk-default"),clerkName:o},s=new addToBasketRequestComponent(n);N.innerHTML="",N.appendChild(s.render()),N.style.animation="1s gis-call-signal-container-show forwards",N.style.display="block"},showAssistantIsJoining:oe,showConnectingToLobby:se,showWaitingForAssistant:le,setCallStatus:function(e){G=e}}};GISAPP.chatInputDOMProc=function(logService,gisService,uiUtilitiesService,stateService,clientStorageService,gaService,utilitiesService,deviceInfoService,serverInjectionService,userService,GIS_CONSTANTS){var t,r,a,s,i,o,l,d,n,c,u,g,v,h,p,C=gisService,f=uiUtilitiesService,m=stateService,y=clientStorageService,b=utilitiesService,E=deviceInfoService,S='gis-convo-container',T='gis-question-tb',x='gis-user-name-tb',q='gis-chat-container',L='gis-broadcast-close',k=!1,A=y.storageKeys,I=serverInjectionService.getSystemConfig(),D="chatInputDOMProc",_=logService,N=100,U=1,P=30,M=1,w=function(){var e=I.questionDelay;{if(0<=e&&e<=60)return I.questionDelay;if(60<e)return 60}return 30}(),Q={8:!0,35:!0,36:!0,37:!0,38:!0,39:!0,40:!0,46:!0},H=!1;function O(e){var t=r.textContent.length,n=r.textContent.trim().length,s=n<=N&&U<=n,i=E.isMobileDevice()||E.isIPad();if(13===e.keyCode&&!i&&!e.shiftKey)return s&&!k&&te(),void e.preventDefault();!Q[e.keyCode]&&N<=t&&e.preventDefault(),R()}function R(){var e=r.textContent.length,t=r.textContent.trim().length;B(e,"question"),k||(U<=t?$():Y())}function V(e){var t=l.textContent.length,n=t<=P&&M<=t;if(13===e.keyCode&&!e.shiftKey)return n&&ne(),void e.preventDefault();!Q[e.keyCode]&&P<=t&&e.preventDefault(),G()}function G(){var e=l.textContent.length,t=l.textContent.trim().length;B(e,"username"),U<=t?$():Y()}function K(e){var t=e.clipboardData||window.clipboardData;if(t&&""!=t.getData("Text")){var n=t.getData("Text"),s=n.length;if(r.textContent.length+s<N)return'ie'!=m.getBrowser()&&e.preventDefault(),void document.execCommand('inserttext',!1,n)}e.stopPropagation(),e.preventDefault()}function J(e){e.preventDefault(),e.stopPropagation()}function Y(){h.style.cursor="auto",f.addClass(h,"gis-btn-disabled")}function $(){h.style.cursor="pointer",f.removeClass(h,"gis-btn-disabled")}function B(e,t){if(0!=e){var n="question"==t?N:P;s.innerText=e+" / "+n,function(e){s.style.color=e?"red":"#666666",f.hasClass(r,"gis-hide")?f.hasClass(l,"gis-hide")||(l.style=e?"border: 1px solid red":"none"):r.style=e?"border: 1px solid red":"none";ae(e?"failed.svg":"send.svg")}(n<e),f.removeClass(s,"gis-hide")}else Z()}function j(e){a.innerText="",f.removeClass(a,"gis-ques-status-sending"),f.addClass(a,"gis-hide"),f.addClass(o,'gis-hide'),h.onclick=(e?(X(),a.innerText="Thanks for your question",f.removeClass(a,"gis-hide"),f.removeClass(h,"gis-hide"),ae("delivered.png")):(ee(),Z(),W(),f.addClass(a,"gis-hide"),f.removeClass(h,"gis-hide"),ae("failed.svg")),"")}function z(){j(!0),r.innerText="",l.innerText="",h.style.cursor="auto",setTimeout(function(){!function(){if(a.innerText="",f.addClass(a,"gis-hide"),f.addClass(h,"gis-hide"),w<=0)return W();i.innerText=w,a.innerText="Please wait a moment to ask your next question",f.removeClass(a,"gis-hide"),f.removeClass(i,"gis-hide"),h.onclick="";var t=w-1,n=setInterval(function(){var e;t<0?(clearInterval(n),a.innerText="",f.addClass(a,"gis-hide"),f.addClass(i,"gis-hide"),W()):(e=t,i.innerText=e,t--)},1e3);h.onclick=""}()},1e3)}function F(){j(!(k=!0)),h.style.cursor="auto",setTimeout(function(){a.innerText="",f.addClass(a,"gis-hide"),W(),k=!1},1e4)}function W(){r.style.visibility='visible',h.style.cursor="pointer",f.removeClass(r,"gis-hide"),ae("send.svg"),f.removeClass(h,"gis-hide"),h.onclick=te,R()}function X(){f.addClass(r,"gis-hide")}function Z(){f.addClass(s,"gis-hide")}function ee(){f.addClass(l,"gis-hide"),f.addClass(h,"gis-hide"),l.onclick=""}function te(){var e=r.textContent.trim();0!=e.length&&(e.length>N||(gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CHAT_MESSAGE_SENT,{length:e.length,durationInSec:re()}),""==(d=y.getItem(A.CHAT_USER_NAME)||"")?(gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CHAT_NAME_ASK,{durationInSec:re()}),Z(),X(),f.removeClass(l,"gis-hide"),h.onclick=ne,G()):ne()))}function ne(){if(""==d){var e=(d=l.textContent.trim()).length;if(0==e)return;if(P<e)return void(d="");gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CHAT_NAME_SENT,{length:d.length,durationInSec:re()})}h.style.cursor="auto",Z(),X(),ee(),a.innerText="Sending...",f.removeClass(a,"gis-hide"),f.addClass(a,"gis-ques-status-sending"),f.removeClass(o,'gis-hide'),h.onclick="";var t=userService.getUserUUID()||'',n=r.innerHTML.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&nbsp;/gi," ").replace(/<div>|<br>/gi,"\n").replace(/<\/div>|<\/br>/gi,""),s={callUserUUID:t,callUUID:m.getCallUUID(),chatMessage:n,chatUserName:d},i=b.utf8ToBase64(JSON.stringify(s));C.submitQuestion(i,"GISAPP.chatInputDOMProc.submitQuestionResponse",function(){},function(){F(),_.error(D,"Some error occurred while requesting for question submission")})}function se(e){e.stopPropagation()}function ie(){p=uiUtilitiesService.processView(serverInjectionService.getViews().chatView,{}),r=p.querySelector('#gis-question-tb'),l=p.querySelector('#gis-user-name-tb'),a=p.querySelector('#gis-ques-status'),h=p.querySelector('#gis-ques-img'),s=p.querySelector('#gis-char-count'),i=p.querySelector("#gis-ques-delay"),o=p.querySelector('#gis-sending'),t=(n=p).querySelector("#"+L),c=p.querySelector('#'+S),u=p.querySelector('#'+T),g=p.querySelector('#'+x),v=p.querySelector('#'+q),h=p.querySelector("#gis-ques-img"),c.querySelector("#gis-heading").innerHTML=serverInjectionService.getLabels().liveQa_pinnedPostHeading,c.querySelector("#gis-msg").innerHTML=serverInjectionService.getLabels().liveQa_pinnedPostMessage,u.setAttribute("gis-data-placeholder",serverInjectionService.getLabels().liveQa_chatPlaceholderText),g.setAttribute("gis-data-placeholder",serverInjectionService.getLabels().liveQa_namePlaceholderText),t.style.background=uiUtilitiesService.getImageUrl("close-button.svg")+" no-repeat center / 25px",stateService.getInputAlignment()===GIS_CONSTANTS.INPUT_ALIGNMENT.RTL&&(uiUtilitiesService.addClass(u,'gis-rtl'),uiUtilitiesService.addClass(g,'gis-rtl')),r.addEventListener("keydown",O),r.addEventListener("keyup",O),r.addEventListener("paste",K),r.addEventListener("drop",J),l.addEventListener("keydown",V),l.addEventListener("keyup",V),l.addEventListener("paste",K),l.addEventListener("drop",J),n.addEventListener("touchmove",se,{passive:!1}),ae("send.svg"),h.onclick=te,H=!0}function re(){var e=m.getCallStartTime();return e?((new Date).getTime()-e)/1e3:0}function ae(e){h.style.background=uiUtilitiesService.getImageUrl(e)+" no-repeat center center / 30px"}return{init:ie,submitQuestionResponse:function(n,t){if(t){var s=JSON.parse(t);F(),_.error(D,"Error response on submit question.",s,{data:n})}else try{var i=JSON.parse(n);z(),y.setItem(A.CHAT_USER_NAME,i.name)}catch(t){_.error(D,e,{data:n},"Exception on submit question Response.")}},dispose:function(){H&&(r.removeEventListener("keydown",O),r.removeEventListener("keyup",O),r.removeEventListener("paste",K),r.removeEventListener("drop",J),l.removeEventListener("keydown",V),l.removeEventListener("keyup",V),l.removeEventListener("paste",K),l.removeEventListener("drop",J),n.removeEventListener("touchmove",se,!1),H=!1)},render:function(){return p||ie(),p&&stateService.isEmbed()&&(p.querySelector('#gis-broadcast-close').style.display='none'),p},disableChat:function(){n.style.backgroundColor='#a5a5a5',uiUtilitiesService.addClass(v,"gis-disable-chat"),uiUtilitiesService.addClass(c,"gis-disable-chat"),u.contentEditable=!1,u.style.cursor='default',h.style.background=uiUtilitiesService.getImageUrl("send.svg")+" no-repeat center center / 30px"},enableChat:function(){n.style.backgroundColor='',uiUtilitiesService.removeClass(v,"gis-disable-chat"),uiUtilitiesService.removeClass(c,"gis-disable-chat"),u.contentEditable=!0,u.style.cursor='pointer'},setOnClose:function(e){t&&(t.onclick=e)}}};GISAPP.ctaRoundelDOMProc=function(serverInjectionService,clientStorageService,uiUtilitiesService,systemInfoService,deviceInfoService,stateService,utilitiesService,overrideService,logService,ctaComponent,eventLoggerService,bookingService){'use strict';var o,n={};function r(e,a){return n._isAwarenessMessageEnabled(e,a)&&'clerk'==e&&!a&&bookingService.isEnabledForUnavailableCta()?n.CTA_AWARENESS_MESSAGE_HIDE_TIMEOUT:null}return n.LOGTAG="ctaRoundelDOMProc",n.CTA_NOTIFICATION_INTERVAL=400,n.CTA_TEXTBOX_DELAY=1500,n.BROADCAST_PREVIEW_DURATION=4e3,n.BROADCAST_PREVIEW_DELAY=150,n.BROADCAST_OVERLAY_DELAY=n.BROADCAST_PREVIEW_DURATION-1500,n.BROADCAST_PLAY_BTN_DELAY=n.BROADCAST_PREVIEW_DURATION-1e3,n.CTA_AWARENESS_MESSAGE_TIMEOUT=2e3,n.CTA_AWARENESS_MESSAGE_HIDE_TIMEOUT=3e4,n.BROADCAST='broadcast',n.REPLAY='replay',n.CLERK='clerk',n._ctaBrandNoticeMessage='Sponsored by Go Instore',n._connectToStoreTabId='gis-connect-to-store-tab',n._ctaId='gis-cta',n._ctaMsgBoxId='gis-cta-msg-box',n._broadcastNotificationCloseId='gis-close-broadcast',n._notificationTextId='gis-notification-text',n._broadcastPlayBtnId='gis-bd-play-btn',n._broadcastPlayContainerId='gis-bd-play-container',n._broadcastPreviewContainerId='gis-bd-preview-container',n._ctaNotificationMsgContainerId='gis-notification-msg-container',n._broadcastPreviewId='gis-bd-preview',n._ctaContainerId="gis-cta-container",n._ctaNotificationMsgSlideInClass='gis-cta-msg-slide-in',n._ctaStatusContainerId="gis-cta-status-container",n._ctaStatusTimeId="gis-since-live-time",n._ctaReplayTimeId="gis-replay-time",n._ctaReplayTimeIconId="gis-replay-time-icon",n._ctaReplayTimeLabelId="gis-replay-time-label",n._ctaLiveIconId="gis-cta-live-icon",n._liveTextId="gis-cta-live-icon",n._liveTimerId="gis-since-live-time",n._ctaNotificationMsgSlideOutClass='gis-cta-msg-slide-out',n._broadcastPlayButtonAnimationClass='gis-bd-play-button-animation',n._broadcastPreviewContainerSlideUpAnimationClass='gis-bd-slide-up-container',n._broadcastPreviewOverlayClass='gis-bd-overlay',n._circleAnimateShowClass='gis-circle-animate-show',n._circleAnimateHideClass='gis-circle-animate-hide',n._hideClass="gis-hide",n._circleClass="gis-circle",n._ctaMessageBarClass="gis-cta-buttons-message-bar",n._ctaMessageClass="gis-cta-msg",n._ctaMsgBoxClass='gis-cta-msg-box',n._gifPositionClass="gis-bd-gif-position",n._msgBarSharpEdgeClass="gis-msg-bar-sharp-edge",n._gisBrandLegalNoticeId="gis-legal-notice-div",n._gisLegalNoticeMsgId="gis-legal-notice-msg",n._gisLegalNoticeMsgClass="gis-legal-notice-text",n._ctaAvailabilityIndicatorId="gis-cta-indicator",n._ctaImageContainerId="gis-cta-image-container",n._ctaIconBackground="gis-cta-call-icon-image",n._ctaBarMessageSlide="gis-cta-bar-main-container",n._callPreviewArray=["previewCall.gif"],n._uiConfig=serverInjectionService.getUiConfig(),n._systemConfig=serverInjectionService.getSystemConfig(),n._gisTheme=n._uiConfig.theme,n._retailerStaticRoot=serverInjectionService.getStaticRetailerResources(),n._ctaMode='',n._ctaCustom=n._uiConfig.ctaCustom||!1,n._ctaPosition=n._uiConfig.ctaPosition?n._uiConfig.ctaPosition:"right",n._gisBrandLegalNotice=n._uiConfig.brandLegalNotice||!1,n._ctaActive=!1,n._messageBarActive=!1,n._previewActive=!1,n._previewAnimations=[],n.isHumanizedCta=!1,n._borderColor='#61ca43',n._boxShadow='0 0px 0px 0 #61ca43',n._background=uiUtilitiesService.getImageUrl(uiUtilitiesService.overrideImageFormat("cta-logo.png",n._uiConfig.cta)),n._liveBorderColor='#f83f3d',n._liveBoxShadow='0 0px 0px 0 #f83f3d',n._liveBackground='linear-gradient(to top, #474747, #6e6e6e)',n._liveTextBackground="#f83f3d",n._liveTextColor="#fff",n._liveTimerTextColor="#9d9d9c",n.show=function(e){n._view||n._init(),e||(e=0),n._ctaActive||(n._ctaActive=!0,n.showTimeout=setTimeout(function(){uiUtilitiesService.removeClass(n._connectTab,n._hideClass),n._showCircleNotification(),n._ctaMode!==n.BROADCAST||n._timerInterval||n._setLiveTimeSinceStarted(),n._messageBarActive||!n._ctaMode||n.isHumanizedCta||n._slideOutMessageBar()},e))},n.setMode=function(e,a,i,t){if(n._isCtaPreviewAllowed=n._isShowPreviewAllowed(e),a&&(n.broadcast=a),n._view||n._init(e),"clerk"==e||e!==n._ctaMode||'clerk'!==e&&n.broadcast.id!==a.id){if(n._ctaMode=e,n.isHumanizedCta)return o=e==n.BROADCAST?n._liveBorderColor:n._uiConfig.awarenessMessage&&n._uiConfig.awarenessMessage.mainBtnColor||n._borderColor,n.ctaComp.setup({ctaMode:n._ctaMode,position:n._ctaPosition,roundelColor:o,isAvailable:t,isAnimated:n.isAnimationEnabled(),roundelImage:"cta-logo.png",showAvailabilityIndicator:i,ctaMessage:n._getAwarenessMessage(n._ctaMode,t),isBarMessageEnabled:n.isBarMessageEnabled(n._ctaMode,t),isAwarenessMessageEnabled:n._isAwarenessMessageEnabled(n._ctaMode,t),awarenessMessageHideTimeout:r(n._ctaMode,t)}),n._setupRetailerSpecificCta(e),void(e===n.BROADCAST&&(n._setLiveTimeSinceStarted(),'ie'==stateService.getBrowser()&&(n._ctaStatusContainer.style.margin="17px 0px")));var s="";e===n.CLERK?(s=serverInjectionService.getLabels().clerkAvailable_message,n._ctaStatusContainer.style.display='none',uiUtilitiesService.addClass(n._ctaReplayStreamedContainer,"gis-hideAll")):s=n.broadcast.ctaMessage,n._ctaActive||(n._notificationText.innerText=s),n._ctaActive&&!n._messageBarActive&&(n._notificationText.innerText=s,n._slideOutMessageBar()),n._messageBarActive&&n._slideInMessageBar(function(){n._notificationText.innerText=s,n._slideOutMessageBar()}),e===n.BROADCAST&&(n._setLiveTimeSinceStarted(),'ie'==stateService.getBrowser()&&(n._ctaStatusContainer.style.margin="17px 0px"),n._ctaStatusContainer.style.display='block',n._ctaImageContainer.style.display='none',uiUtilitiesService.addClass(n._ctaReplayStreamedContainer,"gis-hideAll")),e===n.REPLAY&&(n._ctaStatusContainer.style.display='none',uiUtilitiesService.removeClass(n._ctaReplayStreamedContainer,"gis-hideAll")),n._setupRetailerSpecificCta(e),n._setAvailabilityIndicator(i,t)}},n.setOnClickEvent=function(a){if(n._view&&'function'==typeof a){n.isHumanizedCta||(n._cta.onclick=function(e){a.call(this,e)}),n._ctaMsgBox&&(n._ctaMsgBox.onclick=function(e){a.call(this,e)});var e=document.getElementById(n._broadcastPlayContainerId);e&&(e.onclick=function(){a()}),n.ctaComp&&n.isHumanizedCta&&(n.ctaComp.setOnClick(a),n.ctaComp.setOnClickForAwarenessMessage(a),n.ctaComp.setOnClickForBarMessage(a))}},n.hide=function(){n._ctaActive&&(clearTimeout(n.showTimeout),clearTimeout(n._timerInterval),n._timerInterval=null,n._ctaActive=!1,n.isHumanizedCta||n._slideInMessageBar(),n._hideCircleNotification(),n.ctaComp&&(n.ctaComp.hide(),n.ctaComp.setRoundelCloseButton(!1)))},n._getAwarenessMessage=function(e,a){var i,t,s=[];return i=e==n.CLERK?a?(t=serverInjectionService.getLabels().awarenessCta_startCallMessage,serverInjectionService.getLabels().awarenessCta_message):(t=serverInjectionService.getLabels().awarenessCta_unavailableBookCall,serverInjectionService.getLabels().awarenessCta_unavailableMessage):(t=serverInjectionService.getLabels().awarenessCta_startBroadcastMessage,n.broadcast&&n.broadcast.name&&n.broadcast.name.slice(0,55)),s.push(i),s.push(t),s},n._init=function(e){n._view=uiUtilitiesService.processView(serverInjectionService.getCtaRoundelView(),{ctaPreview:!0,ctaMessage:!0}),'humanized'==n._uiConfig.ctaType&&(n._gisTheme&&(n._borderColor=n._gisTheme.mainColor),n.isHumanizedCta=!0,o=e==n.BROADCAST?n._liveBorderColor:n._uiConfig.awarenessMessage&&n._uiConfig.awarenessMessage.mainBtnColor||n._borderColor,n.ctaComp=new ctaComponent({ctaMode:e,position:n._ctaPosition,roundelColor:o,ctaMessage:n._getAwarenessMessage(e,stateService.getClerkAvailability()),roundelImage:"cta-logo.png",isAnimated:n.isAnimationEnabled(),isAwarenessMessageEnabled:n._isAwarenessMessageEnabled(e,stateService.getClerkAvailability()),isBarMessageEnabled:n.isBarMessageEnabled(e,stateService.getClerkAvailability()),awarenessMessageHideTimeout:r(e,stateService.getClerkAvailability()),isAvailable:stateService.getClerkAvailability(),showAvailabilityIndicator:e!=n.BROADCAST}),n._view=n.ctaComp.render()),n._cta=n._view.querySelector("#"+n._ctaId),n._connectTab=n._view.querySelector("#"+n._connectToStoreTabId),n._notificationMessageContainer=n._view.querySelector("#"+n._ctaNotificationMsgContainerId),n._notificationText=n._view.querySelector("#"+n._notificationTextId),n._ctaMsgBox=n._view.querySelector("#"+n._ctaMsgBoxId),n._broadcastNotificationCloseButton=n._view.querySelector("#"+n._broadcastNotificationCloseId),n._ctaContainer=n._view.querySelector("#"+n._ctaContainerId),n._ctaStatusContainer=n._view.querySelector('#'+n._ctaStatusContainerId),n._ctaStatusTime=n._view.querySelector('#'+n._ctaStatusTimeId),n._ctaReplayStreamedContainer=n._view.querySelector('#'+n._ctaReplayTimeId),n._ctaReplayStreamedIcon=n._view.querySelector('#'+n._ctaReplayTimeIconId),n._ctaReplayStreamedLabel=n._view.querySelector('#'+n._ctaReplayTimeLabelId),n._ctaLiveIcon=n._view.querySelector('#'+n._ctaLiveIconId),n._liveText=n._view.querySelector('#'+n._liveTextId),n._liveTimer=n._view.querySelector('#'+n._liveTimerId),n._gisBrandLegalNoticeDiv=n._view.querySelector('#'+n._gisBrandLegalNoticeId),n._gisLegalNoticeMsg=n._view.querySelector('#'+n._gisLegalNoticeMsgId),n._ctaAvailabilityIndicator=n._view.querySelector("#"+n._ctaAvailabilityIndicatorId),n._ctaImageContainer=n._view.querySelector("#"+n._ctaImageContainerId),n._cta.style.backgroundSize='cover',n._gisTheme&&(n._borderColor=n._gisTheme.mainColor,n._boxShadow="0px 0px 0px 0px "+n._gisTheme.mainColor,n.isHumanizedCta||(n._notificationMessageContainer.style.backgroundColor=n._gisTheme.backgroundColor,n._notificationText.style.color=n._gisTheme.foregroundColor,n._notificationText.style.fontFamily=n._gisTheme.font)),n.isHumanizedCta||(n._cta.style.backgroundImage=n._background,n._notificationText.style.display="none",n._gisBrandLegalNotice||(n._gisBrandLegalNoticeDiv.style.display="none"),n._previewContainer=n._view.querySelector("#"+n._broadcastPreviewContainerId),n._preview=n._view.querySelector("#"+n._broadcastPreviewId),n._previewPlayContainer=n._view.querySelector("#"+n._broadcastPlayContainerId),n._previewPlayButton=n._view.querySelector("#"+n._broadcastPlayBtnId),n._setMessageBarCloseClick(),n._gisBrandLegalNotice&&(uiUtilitiesService.removeClass(n._gisBrandLegalNoticeDiv,'gis-hide'),n._gisLegalNoticeMsg.innerText=n._ctaBrandNoticeMessage)),n._setupCtaPosition(n._ctaPosition),document.body.appendChild(n._view)},n._setupCtaPosition=function(e){"left"!=e&&"right"!=e&&(e="right"),uiUtilitiesService.addClass(n._ctaContainer,n._circleClass+"-"+e),uiUtilitiesService.addClass(n._notificationMessageContainer,n._ctaMessageBarClass+"-"+e),uiUtilitiesService.addClass(n._notificationText,n._ctaMessageClass+"-"+e),uiUtilitiesService.addClass(n._previewContainer,n._gifPositionClass+"-"+e),uiUtilitiesService.addClass(n._gisLegalNoticeMsg,n._gisLegalNoticeMsgClass+"-"+e),uiUtilitiesService.addClass(n._ctaMsgBox,n._ctaMsgBoxClass+"-"+e),"left"===e&&n._broadcastNotificationCloseButton&&(n._broadcastNotificationCloseButton.style.left="initial",n._broadcastNotificationCloseButton.style.right="10px"),'right'===e?n._ctaAvailabilityIndicator.style.right='0px':n._ctaAvailabilityIndicator.style.left='0px',n._ctaNotificationMsgSlideInClass=n._ctaNotificationMsgSlideInClass+"-"+e,n._ctaNotificationMsgSlideOutClass=n._ctaNotificationMsgSlideOutClass+"-"+e,n._msgBarSharpEdgeClass=n._msgBarSharpEdgeClass+"-"+e},n._isShowPreviewAllowed=function(e){var a={clerk:n._uiConfig.ctaCallPreview||{mobile:!1,desktop:!0},replay:n._uiConfig.ctaBroadcastPreview||{mobile:!1,desktop:!0},broadcast:n._uiConfig.ctaBroadcastPreview||{mobile:!1,desktop:!0}};return deviceInfoService.isMobileDevice()?a[e].mobile:a[e].desktop},n._setMessageBarCloseClick=function(){n._broadcastNotificationCloseButton.onclick=function(e){e.stopPropagation(),n._slideInMessageBar(),systemInfoService.saveUserDismissCtaNotificationBar()}},n._showCircleNotification=function(){setTimeout(function(){uiUtilitiesService.removeClass(n._cta,n._circleAnimateHideClass),uiUtilitiesService.addClass(n._cta,n._circleAnimateShowClass),n.ctaComp&&n.ctaComp.show()},n.CTA_NOTIFICATION_INTERVAL)},n._hideCircleNotification=function(){setTimeout(function(){uiUtilitiesService.removeClass(n._cta,n._circleAnimateShowClass),uiUtilitiesService.addClass(n._cta,n._circleAnimateHideClass)},n.CTA_NOTIFICATION_INTERVAL)},n._slideOutMessageBar=function(){n._messageBarActive=!0,!clientStorageService.isLocalStorageAccessible()||systemInfoService.isCtaNotificationBarShown()&&!systemInfoService.isCtaNotificationBarDismissTimeExpired()||(n._messageBarAnimation=setTimeout(function(){n._notificationText.style.display="inherit",n._ctaMsgBox.style.display="inherit",uiUtilitiesService.removeClass(n._notificationMessageContainer,n._ctaNotificationMsgSlideInClass),uiUtilitiesService.addClass(n._notificationMessageContainer,n._ctaNotificationMsgSlideOutClass)},n.CTA_TEXTBOX_DELAY),n._isCtaPreviewAllowed?n._showPreview(n._ctaMode):uiUtilitiesService.removeClass(n._notificationMessageContainer,n._msgBarSharpEdgeClass))},n._slideInMessageBar=function(e){clearTimeout(n._messageBarAnimation),n._messageBarActive=!1,n._previewActive&&n._hidePreview(),uiUtilitiesService.removeClass(n._notificationMessageContainer,n._ctaNotificationMsgSlideOutClass),uiUtilitiesService.addClass(n._notificationMessageContainer,n._ctaNotificationMsgSlideInClass),setTimeout(function(){e&&e(),n._ctaMsgBox.style.display='none'},n.CTA_NOTIFICATION_INTERVAL)},n._showPreview=function(e){if(n._previewActive=!0,uiUtilitiesService.addClass(n._notificationMessageContainer,n._msgBarSharpEdgeClass),e===n.CLERK)n._preview.style.background=uiUtilitiesService.getImageUrl(n._callPreviewArray[0]+"?rand="+Math.random())+" center no-repeat";else{var a=n.broadcast.ctaImage;if(!a)return void n._hidePreview();e==n.REPLAY&&n._setReplayTimeSinceStarted(),n._preview.style.background=uiUtilitiesService.getImageUrl(a+'?rand='+Math.random())+" center no-repeat"}n._preview.style.backgroundSize='cover',n._previewPlayButton.src=uiUtilitiesService.getImageUrl("preview-play-button.png",!0),uiUtilitiesService.removeClass(n._previewContainer,n._hideClass);var i=setTimeout(function(){uiUtilitiesService.addClass(n._previewContainer,n._broadcastPreviewContainerSlideUpAnimationClass)},n.BROADCAST_PREVIEW_DELAY+n.CTA_TEXTBOX_DELAY),t=setTimeout(function(){uiUtilitiesService.addClass(n._previewPlayContainer,n._broadcastPreviewOverlayClass)},n.BROADCAST_OVERLAY_DELAY+n.CTA_TEXTBOX_DELAY),s=setTimeout(function(){uiUtilitiesService.addClass(n._previewPlayButton,n._broadcastPlayButtonAnimationClass)},n.BROADCAST_PLAY_BTN_DELAY+n.CTA_TEXTBOX_DELAY);n._previewAnimations.push(i,t,s)},n._hidePreview=function(){n._previewActive=!1,n._notificationMessageContainer.style.borderTopLeftRadius="12px",n._previewAnimations.forEach(function(e){clearTimeout(e)}),uiUtilitiesService.removeClass(n._previewContainer,n._broadcastPreviewContainerSlideUpAnimationClass),uiUtilitiesService.removeClass(n._previewPlayButton,n._broadcastPlayButtonAnimationClass),uiUtilitiesService.removeClass(n._previewPlayContainer,n._broadcastPreviewOverlayClass),uiUtilitiesService.addClass(n._previewContainer,'gis-hide')},n._setLiveTimeSinceStarted=function(){-1!==n.broadcast.secondsSinceStarted&&(n.currentBroadcastLiveTime=new Date,n.currentBroadcastLiveTime.setHours(0,0,0,0),n.currentBroadcastLiveTime.setSeconds(n.currentBroadcastLiveTime.getSeconds()+n.broadcast.secondsSinceStarted),n._ctaStatusTime.innerHTML=utilitiesService.getFormattedTime(n.currentBroadcastLiveTime),n._timerInterval=setInterval(n._updateLiveTime,1e3))},n._updateLiveTime=function(){n.currentBroadcastLiveTime.setSeconds(n.currentBroadcastLiveTime.getSeconds()+1),n._ctaStatusTime.innerHTML=utilitiesService.getFormattedTime(n.currentBroadcastLiveTime)},n._setReplayTimeSinceStarted=function(){n._ctaReplayStreamedIcon.src=uiUtilitiesService.getImageUrl("time-ago.svg",!0);var e=["year","month","week","day","hour","minute","second"],a=n.broadcast?n.broadcast.secondsSinceStarted:0;if(0!==a)for(var i=utilitiesService.getTimeFromSeconds(a),t=0;t<e.length;t++){var s=e[t];if(0<i[s]){var o=i[s]+("month"===s?"mo":s.charAt(0));n._ctaReplayStreamedLabel.innerHTML=" "+o;break}}},n._setupRetailerSpecificCta=function(e){e!==n.CLERK&&e!==n.REPLAY||(n._cta.style.borderColor=n._borderColor,n._cta.style.boxShadow=n._boxShadow,n._cta.style.backgroundSize='cover'),e===n.BROADCAST&&(n._cta.style.borderColor=n._liveBorderColor,n._cta.style.boxShadow=n._liveBoxShadow,n._cta.style.background=n._liveBackground,n._liveText.style.background=n._liveTextBackground,n._liveText.style.color=n._liveTextColor,n._liveTimer.style.color=n._liveTimerTextColor)},n._setAvailabilityIndicator=function(e,a){e?(n._ctaAvailabilityIndicator.style.display='block',a?uiUtilitiesService.addClass(n._ctaAvailabilityIndicator,"available"):uiUtilitiesService.addClass(n._ctaAvailabilityIndicator,"unavailable")):n._ctaAvailabilityIndicator.style.display='none'},n._isAwarenessMessageEnabled=function(e,a){if(!Array.isArray(n._uiConfig.ctaAwarenessMessage.enabled))return!1;var i=n._uiConfig.ctaAwarenessMessage.enabled;return(deviceInfoService.isMobileDevice()&&n._uiConfig.ctaAwarenessMessage.isEnabledOn&&n._uiConfig.ctaAwarenessMessage.isEnabledOn.mobile||!deviceInfoService.isMobileDevice()&&n._uiConfig.ctaAwarenessMessage.isEnabledOn&&n._uiConfig.ctaAwarenessMessage.isEnabledOn.desktop)&&(i.includes('clerk')&&(a||bookingService.isEnabledForUnavailableCta())&&'clerk'===e||'clerk'!=e&&i.includes(e))},n.isBarMessageEnabled=function(e,a){return(deviceInfoService.isMobileDevice()||deviceInfoService.isIPad())&&n._uiConfig.ctaBarMessage&&n._uiConfig.ctaBarMessage.enabled&&n._uiConfig.ctaBarMessage.mobile&&'clerk'===e&&a},n.isAnimationEnabled=function(){return!!stateService.getClerkAvailability()&&(deviceInfoService.isMobileDevice()||deviceInfoService.isIPad()?n._uiConfig.cta.animation.enabled&&n._uiConfig.cta.animation.mobile:n._uiConfig.cta.animation.enabled&&n._uiConfig.cta.animation.desktop)},overrideService.override(n.LOGTAG,n),{show:n.show,hide:n.hide,setOnClickEvent:n.setOnClickEvent,setMode:n.setMode}};GISAPP.ctaTabDOMProc=function(serverInjectionService,clientStorageService,uiUtilitiesService){'use strict';var e,o,n,c,t,i,s='GoInStoreDiv',r='gis-connect-to-store-tab',l='gis-clerk-notification',a='gis-tab',u='gis-tabtext',d='gis-hide',g=serverInjectionService.getUiConfig(),f=g.theme,y=g.ctaCustom||!1,b=!1;function C(){e=uiUtilitiesService.processView(serverInjectionService.getCtaTabView(),{ctaCustom:y}),o=n=e.querySelector("#"+s),n=e.querySelector("#"+r),c=e.querySelector("#"+l),t=e.querySelector("#"+a),i=e.querySelector("#"+u),y&&(c.style.background=uiUtilitiesService.getImageUrl("gis_button_vertical.png")+" center center no-repeat #000",c.style.backgroundSize="40px auto"),f&&!y&&(t.style.backgroundColor=f.backgroundColor,i.style.color=f.foregroundColor,i.style.fontFamily=f.font),document.body.appendChild(e)}return{show:function(t){e||C(),t||(t=0),b||(b=!0,uiUtilitiesService.removeClass(n,d),uiUtilitiesService.removeClass(c,d),null!==o&&(window.setTimeout(function(){window.setTimeout(function(){o.classList.add('displayblock')},10)},t),o.classList.add('displayblock')))},hide:function(){b&&(b=!1,uiUtilitiesService.addClass(n,d))},setOnClickEvent:function(t){e&&'function'==typeof t&&(n.onclick=t)},setMode:function(){e||C()}}};GISAPP.replayConnectDOMProc=function(serverInjectionService,uiUtilitiesService,validationUtilitiesService,gisService,logService){'use strict';var t,n,e,o,i,l,r,c,s,a,y,u,d,g,p,f,C,b="replayConnectDOMProc",v=3e3,m=2e3,k=!1,w=!1,S='<video id="gis-playback-video" class="gis-video-v2 video-js vjs-big-play-centered" playsinline><source id="gis-replayConnect-video-src" src="" type="video/mp4"></video>';function q(){n&&(f.innerHTML=S,o=n.querySelector("#gis-replayConnect-video-src"),uiUtilitiesService.hideModal(),T(),C())}function h(){l.onclick=function(){t&&(clearTimeout(t),t=null),k?(U(),T()):I()}}function T(){y.style.display="none",u.style.display="none",s.style.display="inline-block",w=!1,d.value="",g.style.backgroundColor=""}function I(){l.style.background="#fff "+uiUtilitiesService.getImageUrl("down-caret.svg")+" no-repeat center / 60% 60%",l.style.animation="0.8s gis-replayConnect-button-slide-up forwards",i.style.animation="0.8s gis-replayConnect-slide-up forwards",k=!0}function U(){l.style.background="#fff "+uiUtilitiesService.getImageUrl("info.svg")+" no-repeat center / 60% 60%",i.style.animation="0.8s gis-replayConnect-slide-down forwards",l.style.animation="0.8s gis-replayConnect-button-slide-down forwards",k=!1}return{show:function(){n||(n=uiUtilitiesService.processView(serverInjectionService.getReplayConnectView()),e=n.querySelector("#boxclose"),f=n.querySelector("#gis-pbvideo-container"),a=n.querySelector("#gis-pbvideo-container"),o=n.querySelector("#gis-replayConnect-video-src"),i=n.querySelector("#gis-replayConnect-banner"),r=n.querySelector("#gis-replayConnect-call-btn"),c=n.querySelector("#gis-replayConnect-arrange-btn"),s=n.querySelector("#gis-replayConnect-view1"),y=n.querySelector("#gis-replayConnect-view2"),u=n.querySelector("#gis-replayConnect-view3"),d=n.querySelector("#gis-replayConnect-contact-input"),g=n.querySelector("#gis-replayConnect-contact-submit-btn"),l=n.querySelector("#gis-replayConnect-banner-toggle-btn"),p=n.querySelector("#gis-replayConnect-success"),e.style.background=uiUtilitiesService.getImageUrl("close-button.svg")+" no-repeat center / 25px",l.style.background="#fff "+uiUtilitiesService.getImageUrl("info.svg")+" no-repeat center / 60% 60%",g.style.background=uiUtilitiesService.getImageUrl("right-caret.svg")+" no-repeat center / 60% 60%",p.src=uiUtilitiesService.getImageUrl("success.gif",!0),n.addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&"none"!==y.style.display&&g.click()}),d.oninput=function(){w&&(validationUtilitiesService.validateEmail(d.value.toLowerCase().trim())?g.style.backgroundColor="":g.style.backgroundColor="red")},e.onclick=function(){q()},c.onclick=function(){clearTimeout(t),k||I(),s.style.display="none",y.style.display="inline-block",uiUtilitiesService.addClass(l,"show-back-button"),l.style.animation="0.8s rotate-CW-90 forwards",l.onclick=function(){s.style.display="inline-block",y.style.display="none",l.style.animation="0.8s rotate-CWW-90 forwards",uiUtilitiesService.removeClass(l,"show-back-button"),h()}},g.onclick=function(){var e,n;validationUtilitiesService.validateEmail(d.value.toLowerCase().trim())?(e={source:"replayConnect",contact:{email:d.value.toLowerCase().trim()}},n=btoa(JSON.stringify(e)),gisService.submitContactDetails(n,function(){},function(){logService.error(b,"Error on submitting contact info from ReplayConnect.")}),y.style.display="none",u.style.display="inline-block",c.style.display="none",uiUtilitiesService.removeClass(l,"show-back-button"),uiUtilitiesService.addClass(l,"gis-hide"),h(),t=setTimeout(function(){U(),u.style.display="none",s.style.display="inline-block",uiUtilitiesService.removeClass(l,"gis-hide"),t=setTimeout(function(){I()},m)},v)):(g.style.backgroundColor="red",w=!0)},h()),uiUtilitiesService.showModal(n),t=setTimeout(function(){I(),t=setTimeout(function(){U()},1e4)},3e3)},hide:q,setVideoSrc:function(e){n&&(o.src=e)},setOnClickConnect:function(e){n&&'function'==typeof e&&(r.onclick=function(){clearTimeout(t),e(),q()})},setOnClickClose:function(e){'function'==typeof e&&(C=e)},extendPlayer:function(e){a&&e(a)}}};GISAPP.replayDOMProc=function(serverInjectionService,uiUtilitiesService,retailerFunctionalityCtrl,deviceInfoService,stateService,ctaComponent){'use strict';var n,s,r,l,c,a,y,d,g,p,t,u,h,w,f,x,v,b,S,m,C,e='<video id="gis-playback-video" class="gis-hls-video-size video-js vjs-big-play-centered" playsinline><source id="gis-playback-video-src" type="video/mp4"></video>',q='gis-playback-video-src',k='gis-rec-container',T='gis-replay-close',O='gis-go-to-shop-btn',L='gis-specific-shop-page-btn',M='gis-rtlr-custom-btn',B="gis-pbvideo-container",V='gis-extra-button-1',I='gis-extra-button-2',P="gis-cta-wrapper",A=50,H=400,D=940,E=!1,R=!1,_=null;function U(){p.innerHTML=e,g=n.querySelector("#"+q),t&&t(),j(),stateService.setClerkAvailability(!1),deviceInfoService.isAndroid()&&'firefox'===stateService.getBrowser()&&(window.screen.orientation.onchange=_),window.removeEventListener("orientationchange",G),uiUtilitiesService.hideModal(),n=null}function o(){n.querySelector('#gis-replay-one-to-one-cta-container').style.display='block'}function F(){n.querySelector('#gis-replay-one-to-one-cta-container').style.display='none'}function j(){setTimeout(function(){uiUtilitiesService.removeClass(C.querySelector("#gis-cta"),"gis-circle-animate-show"),uiUtilitiesService.addClass(C.querySelector("#gis-cta"),"gis-circle-animate-hide")},400)}function z(){var e=window.screen.width,t=9/16*e;h.style.flexDirection='column',h.style.width='100%',h.style.height=R?'100%':t+'px',p.style.width=e+'px',p.style.height=t+'px',p.querySelector('div').style.position='absolute',w.style.width=e+'px',w.style.height='calc(100% - '+(t+(E?A:0))+'px)',f.style.display='flex',f.style.width=e+'px',f.style.height=(E?t+A:t)+'px',v.style.paddingTop='10px'}function G(e){0==(window.screen&&window.screen.orientation&&window.screen.orientation.angle||window.orientation)?z():J()}function J(){var e=deviceInfoService.isIos()?window.screen.height:window.screen.width,t=R?.3*e:0,i=e-t;h.style.flexDirection='row',h.style.width='100%',h.style.height='100%',p.style.width=i+'px',p.style.height='100%',f.style.width=i+'px',f.style.height='100%',f.style.display='flex',w.style.width=t+'px',w.style.height='100%',v.style.paddingTop='50px'}return{show:function(e,t){E=e,R=t,n||function(){n=uiUtilitiesService.processView(serverInjectionService.getReplayView(),{}),p=n.querySelector("#"+B),g=n.querySelector("#"+q),u=n.querySelector("#gis-playback-video"),s=n.querySelector("#"+O),r=n.querySelector("#"+L),l=n.querySelector("#"+M),d=n.querySelector("#"+T),y=n.querySelector("#"+k),c=n.querySelector('#'+V),a=n.querySelector('#'+I),h=n.querySelector("#gis-replay-modal"),w=n.querySelector("#gis-segment-drawer"),v=n.querySelector("#gis-segment-container"),f=n.querySelector("#gis-replay-video"),x=n.querySelector("#gis-extra-buttons");var e=n.querySelector("#gis-powered-by-segment");b=n.querySelector("#"+P),S=serverInjectionService.getUiConfig(),m=new ctaComponent({ctaMode:"humanized",position:"right",roundelColor:S.theme&&S.theme.mainColor,roundelImage:"cta-logo.png",isCtaOnBroadcast:!0,isFloater:!0}),C=m.render(),b.appendChild(C),d.style.background=uiUtilitiesService.getImageUrl("close-button.svg")+" no-repeat center / 25px",d.onclick=U;var t=serverInjectionService.getUiConfig().theme;if(t&&(s.style.backgroundColor=t.mainColor,s.style.color=t.foregroundColor,s.style.fontFamily=t.font,y.style.fontFamily=t.font),p.style.position='relative',x.style.height=A+'px',c.style.height='inherit',a.style.height='inherit',f.style.height='inherit',E&&(x.style.display='flex'),e.style.background=uiUtilitiesService.getImageUrl("powered-by.svg")+" no-repeat center / 100px 20px",e.style.width='100%',e.style.height='30px',e.style.position='relative',e.style.cursor='pointer',e.style.borderTop='solid 2px #e3e3e3',e.onclick=function(){window.open('//www.goinstore.com','_blank')},R){var i=16/9*(E?H-A:H);h.style.width=D+'px',h.style.height=H+'px',w.style.width=D-i+'px',w.style.float='left',w.style.height='100%',w.style.backgroundColor='white',w.style.position='relative',w.style.display='flex',w.style.flexDirection='column',v.style.height='100%',v.style.width='100%',f.style.width=i+'px'}else w.style.display='none',p.style.width='100%',f.style.width='100%';if(deviceInfoService.isMobileDevice()){var o=window.screen&&window.screen.orientation&&window.screen.orientation.angle||window.orientation;0===o?z():J(),deviceInfoService.isAndroid()&&'firefox'==stateService.getBrowser()?(_=window.screen.orientation.onchange,window.screen.orientation.onchange=G):window.addEventListener("orientationchange",G)}else v.style.paddingTop='50px'}(),r.innerHTML=serverInjectionService.getLabels().broadcastViewer_specificShopPageText,s.innerHTML=serverInjectionService.getLabels().broadcastViewer_goToShopPageText,c.innerHTML=serverInjectionService.getLabels().broadcastViewer_extraButton1,a.innerHTML=serverInjectionService.getLabels().broadcastViewer_extraButton2,uiUtilitiesService.showModal(n),retailerFunctionalityCtrl&&'function'==typeof retailerFunctionalityCtrl.init&&retailerFunctionalityCtrl.init()},setVideoSrc:function(e){n&&(g.src=e)},setOnClickClose:function(e){n&&(F(),e&&'function'==typeof e&&(t=e))},setOnClickShop:function(e){n&&e&&'function'==typeof e&&(s.onclick=e)},setOnClickSpecificShop:function(e){n&&e&&'function'==typeof e&&(r.onclick=e)},setOnClickRetailerCustomButton:function(e){n&&e&&'function'==typeof e&&(l.onclick=e)},setupExtraButton:function(e,t,i){var o;n&&i&&'function'==typeof i&&(1===e&&(o=c),2===e&&(o=a),o&&(t&&(o.innerHTML=t),o.onclick=i,uiUtilitiesService.removeClass(o,"gis-hide")))},setOneToOneCtaOnReplay:function(e,t){m.setup({showAvailabilityIndicator:e,isAvailable:t,isOneToOneInBroadcast:!0});var i=serverInjectionService.getSystemConfig();t||i.persistentCta?(setTimeout(function(){uiUtilitiesService.removeClass(C.querySelector("#gis-cta"),"gis-circle-animate-hide"),uiUtilitiesService.addClass(C.querySelector("#gis-cta"),"gis-circle-animate-show")},400),o()):(j(),F())},showOneToOneCtaOnReplay:o,hideOneToOneCtaOnReplay:F,setOnCtaClickEvent:function(t){C&&'function'==typeof t&&(C.querySelector('#gis-cta').onclick=function(e){t.call(this,e)})},hide:U,setPlayer:function(){},getVideoElement:function(){return B},extendPlayer:function(e){u&&e(u)}}};GISAPP.API=function(logService,stateService,eventLoggerService,systemInfoService,validationUtilitiesService,gaService,Sym_Sys){'use strict';var n,s,e,a={CALL_CTA_SHOWN:"CALL_CTA_SHOWN",CALL_CTA_CLICK:"CALL_CTA_CLICK",BROADCAST_CTA_SHOWN:"BROADCAST_CTA_SHOWN",BROADCAST_CTA_CLICK:"BROADCAST_CTA_CLICK",BROADCAST_REPLAY_CTA_SHOWN:"BROADCAST_REPLAY_CTA_SHOWN",BROADCAST_REPLAY_CTA_CLICK:"BROADCAST_REPLAY_CTA_CLICK"};function r(){"string"!==n&&n()}function o(){"string"!==s&&s()}function l(){"string"!==e&&e()}var i={};function t(){console.error("GIS API not ready")}return i.Events=a,i.checkSystemSupported=function(){return systemInfoService.checkSystemSupported()},i.checkClerkAvailable=function(i,t){n=i,Sym_Sys.checkClerkAvailable(r,t)},i.checkClerkAvailability=function(i,t,e){n=i,s=t,Sym_Sys.checkClerkAvailability(r,o,e)},i.startCall=function(i,t){e=i,Sym_Sys.startCall(l,t)},i.getVersionInfo=function(){return{version:"1.0.8"}},i.submitContactDetails=function(i,t,e){var n=validationUtilitiesService.validateContactData(i);if(!n.isValid)return{statusCode:101,message:'Invalid data.',errorFields:n.errorFields};var s={contact:{name:i.name,phone:i.phone,email:i.email,message:i.message}},a=btoa(JSON.stringify(s));return Sym_Sys.submitContactDetails(a,t,e),{statusCode:100,message:'Request sent on GIS server'}},i.registerAnalyticsEventListener=function(i){'function'==typeof i?Sym_Sys.registerAnalyticsEventCallback(i):logService.error("Api","Failed to register analytics event listener. Not a function")},i.checkMicrophone=function(i,t){Sym_Sys.detectDevices(i,t)},i.isPluginInstalled=function(){return Sym_Sys.isPluginInstalled()},i.installPlugin=function(){Sym_Sys.installPlugin()},i.checkBroadcastAvailability=function(i){return'function'!=typeof i?{status:-1,message:"invalid parameter: callback is not a function"}:Sym_Sys.checkBroadcastAvailability(i)},i.playBroadcast=function(i){return Sym_Sys.playBroadcast(i)},i.setupABTest=function(i,t){if(!i||!t||'string'!=typeof i||'string'!=typeof t)return logService.error("Api","API: Couldn't setup an AB Test. Invalid Parameters."),{status:-1,message:"invalid parameters"};stateService.setABTestId(i),stateService.setABTestGroup(t),gaService.setCategory("gis-"+i+"-"+t)},i.enableStandardJourney=function(){stateService.setAPIStandardJourney(!0)},i.logEvent=function(i,t){if(!a.hasOwnProperty(i))return{status:-1,message:"invalid event"};eventLoggerService.logEvent(i,t),gaService.sendAnalyticsEvent(i)},i.GisApi1_0=i,window.gisApi={},window.gisApi.Events=t,window.gisApi.checkSystemSupported=t,window.gisApi.checkClerkAvailable=t,window.gisApi.checkClerkAvailability=t,window.gisApi.startCall=t,window.gisApi.getVersionInfo=t,window.gisApi.submitContactDetails=t,window.gisApi.registerAnalyticsEventListener=t,window.gisApi.checkMicrophone=t,window.gisApi.isPluginInstalled=t,window.gisApi.installPlugin=t,window.gisApi.checkBroadcastAvailability=t,window.gisApi.playBroadcast=t,window.gisApi.setupABTest=t,window.gisApi.enableStandardJourney=t,window.gisApi.logEvent=t,i};GISAPP.activityLoggerService=function(stateService,logService,utilitiesService,gisService){'use strict';var A="activityLoggerService";return{GIS_ACTIVITY_TYPES:{CALL_ABORT_BY_CONSUMER:'CALL_ABORT_BY_CONSUMER',CALL_BLOCKED_UNSUPPORTED_BROWSER:'CALL_BLOCKED_UNSUPPORTED_BROWSER',CALL_BLOCKED_MIC_DENIED:"CALL_BLOCKED_MIC_DENIED",CALL_BLOCKED_IOS_NOT_ENABLED:"CALL_BLOCKED_IOS_NOT_ENABLED",CALL_BLOCKED_NO_MIC:"CALL_BLOCKED_NO_MIC",CALL_NO_CLERK_AVAIL:"CALL_NO_CLERK_AVAIL",CALL_MIC_REQUESTED:"CALL_MIC_REQUESTED",CALL_MIC_ALLOWED:"CALL_MIC_ALLOWED",CALL_CONNECTING:"CALL_CONNECTING",CALL_CONNECTING_CANCELLED:"CALL_CONNECTING_CANCELLED",CALL_UI_LOADED:"CALL_UI_LOADED",CALL_SURVEY_SHOWN:"CALL_SURVEY_SHOWN",CALL_CONNECT_FAILED:"CALL_CONNECT_FAILED",CALL_MIC_SHARE_TIMED_OUT:"CALL_MIC_SHARE_TIMED_OUT",CALL_DISCONNECTED_BY_CONSUMER:"CALL_DISCONNECTED_BY_CONSUMER",CALL_MIC_REQUESTED_IN_CALL:"CALL_MIC_REQUESTED_IN_CALL",CALL_MIC_BLOCKED_IN_CALL:"CALL_MIC_BLOCKED_IN_CALL",CALL_MIC_ALLOWED_IN_CALL:"CALL_MIC_ALLOWED_IN_CALL",CALL_SURVEY_SUBMIT:"CALL_SURVEY_SUBMIT",CALL_SURVEY_SKIP:"CALL_SURVEY_SKIP",CALL_PLUGIN_PROMPTED:"CALL_PLUGIN_PROMPTED",CALL_PLUGIN_DOWNLOADED:"CALL_PLUGIN_DOWNLOADED",CALL_PLUGIN_CANCELLED:"CALL_PLUGIN_CANCELLED",CALL_MIC_ACCESS_ERROR:"CALL_MIC_ACCESS_ERROR",CALL_CLERK_STREAM_RECEIVED:"CALL_CLERK_STREAM_RECEIVED",CALL_MIC_PUBLISHED:"CALL_MIC_PUBLISHED",BOOKING_CUSTOMER_JOINED:"BOOKING_CUSTOMER_JOINED",BOOKING_CUSTOMER_LEFT:"BOOKING_CUSTOMER_LEFT",CALL_CAMERA_DETECTED:"CALL_CAMERA_DETECTED",CALL_CAMERA_UNDETECTED:"CALL_CAMERA_UNDETECTED",CALL_CAMERA_ALLOWED:"CALL_CAMERA_ALLOWED",CALL_CAMERA_DENIED:"CALL_CAMERA_DENIED",CALL_CONSUMER_JOINED_CAMERA_MUTE:"CALL_CONSUMER_JOINED_CAMERA_MUTE",CALL_CONSUMER_JOINED_CAMERA_UNMUTE:"CALL_CONSUMER_JOINED_CAMERA_UNMUTE",CALL_CONSUMER_JOINED_MIC_MUTE:"CALL_CONSUMER_JOINED_MIC_MUTE",CALL_CONSUMER_JOINED_MIC_UNMUTE:"CALL_CONSUMER_JOINED_MIC_UNMUTE",CALL_CONSUMER_CAMERA_MUTE_IN_CALL:"CALL_CONSUMER_CAMERA_MUTE_IN_CALL",CALL_CONSUMER_CAMERA_UNMUTE_IN_CALL:"CALL_CONSUMER_CAMERA_UNMUTE_IN_CALL",CALL_CONSUMER_MIC_MUTE_IN_CALL:"CALL_CONSUMER_MIC_MUTE_IN_CALL",CALL_CONSUMER_MIC_UNMUTE_IN_CALL:"CALL_CONSUMER_MIC_UNMUTE_IN_CALL",CALL_CHAT_STARTED_IN_CALL:'CALL_CHAT_STARTED_IN_CALL',FRIEND_ADDED_IN_CALL:'FRIEND_ADDED_IN_CALL',TRANSITION_CHAT_TO_CALL_ACCEPTED_BY_CONSUMER:'TRANSITION_CHAT_TO_CALL_ACCEPTED_BY_CONSUMER',TRANSITION_CHAT_TO_CALL_SENT_BY_CONSUMER:'TRANSITION_CHAT_TO_CALL_SENT_BY_CONSUMER',CHAT_TO_CALL_REQUEST_CANCEL_BY_CONSUMER:'CHAT_TO_CALL_REQUEST_CANCEL_BY_CONSUMER',CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY:'CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY'},GIS_ACTIVITY_ENDPOINTS:{CALL_STARTED:'/jsapi/callstarted',CALL_FINISHED:'/jsapi/callfinished',CALL_FINISHED_PAGE_UNLOAD:"/jsapi/callfinishedPageUnload"},logActivity:function(_,L){var C=stateService.getCallUUID();if(C){if(_.match(/\/.*\/.*/))return logService.debug(A,"Logging Call Activity by endpoint: "+_,C),void gisService.logActivityByEndpoint(_,C);var E={call_uuid:C};L&&(E.data=L),logService.debug(A,"Logging Call Activity: "+_,E),gisService.logActivity(_,utilitiesService.encodeJSONtoBase64(E))}else logService.error(A,"Call-UUID not found. Failed to log activity: "+_)}}};GISAPP.addAPersonService=function(utilitiesService){'use strict';var n=!1;return{isAddAPersonCall:function(){return!n&&null!=utilitiesService.extractUrlParamsValues(window.location.href).giscallconnect},addAPersonEndCallScreenShown:function(){n=!0}}};GISAPP.addToCartService=function(eventLoggerService,gaService,GIS_CONSTANTS,overrideService){'use strict';var a={},d=function(d,n,t){};function T(d){var n={};return d.uuid&&(n.basketUUID=d.uuid),d.title&&(n.title=d.title),d.productCode&&(n.productCode=d.productCode),d.addOnId&&(n.addOnId=d.addOnId),d.addOnType&&(n.addOnType=d.addOnType),n}function i(d,n){var t={title:d.title,action:n,productCode:d.productCode};return d.addOnType&&(t.addOnType=d.addOnType),d.addOnId&&(t.addOnId=d.addOnId),t}return a.addProductToBasket=d,overrideService.override("addToCartService",a),{addProductToBasket:a.addProductToBasket,onAddToBasketTriggered:function(d,n,t,e,o){a.addProductToBasket(d,function(d,n){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_SUCCESS,{basketInfo:T(n)}),"function"==typeof d&&d()}.bind(null,e,d),function(d,n){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_ERROR,{basketInfo:T(n)}),"function"==typeof d&&d()}.bind(null,t,d)),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_ACCEPTED,{basketInfo:T(d)}),gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.ITEM_ADDED_TO_BASKET,{basketInfo:T(d)}),o&&o.sendSignal(o.getSession().connections.get(n.from.id),GIS_CONSTANTS.SIGNAL_TYPE.ADD_TO_BASKET,i(d,"accepted"))},onAddToBasketDenied:function(d,n,t){eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.ADD_TO_BASKET_DENIED,{basketInfo:T(d)}),t&&t.sendSignal(t.getSession().connections.get(n.from.id),GIS_CONSTANTS.SIGNAL_TYPE.ADD_TO_BASKET,i(d,"denied"))},isAddToCartConfigured:function(){return a.addProductToBasket!==d},getBasketInfo:T,overrideATC:function(d){a.addProductToBasket=d}}};GISAPP.autoPlayService=function(eventLoggerService,clientStorageService,utilitiesService,dockedPlayerComponent){var a,o,l={playerInitialize:function(){},playerClicked:function(){},playerDismissed:function(){},playerPlay:function(){}},i=null,r=!1,c=null;function s(e){'replay'==e.autoPlayType?function(e){var t=e.config.ctaAutoPlay.initialSize||"maximized",i=clientStorageService.getItem(clientStorageService.storageKeys.CTA_AUTO_PLAY_DISMISSED);if(i&&0==utilitiesService.dateDifferenceInDays(Date.parse(i),new Date))return;var n=clientStorageService.getItem(clientStorageService.storageKeys.CTA_AUTO_PLAY_MAXIMISED_SHOWN);n&&0==utilitiesService.dateDifferenceInDays(Date.parse(n),new Date)&&(t="minimized");y(e,t),"maximized"===t&&clientStorageService.setItem(clientStorageService.storageKeys.CTA_AUTO_PLAY_MAXIMISED_SHOWN,utilitiesService.getTimeWithOutMilliSeconds())}(e):'call'!=e.autoPlayType&&'replay_engagement'!=e.autoPlayType||(y(e,"maximized"),clientStorageService.setItem(clientStorageService.storageKeys.ONE_TO_ONE_ENGAGEMENT,utilitiesService.getTimeWithOutMilliSeconds()))}function y(e,t){i=new dockedPlayerComponent({broadcast:e,mode:t,type:e.autoPlayType,position:c,onVideoPlayerClicked:function(){clearTimeout(a),'function'==typeof l.playerClicked&&l.playerClicked()},onVideoPlayerDismissed:function(){'function'==typeof l.playerDismissed&&l.playerDismissed()},onVideoPlay:function(){'function'==typeof l.playerPlay&&l.playerPlay()}}),document.body.appendChild(i.render()),l.playerInitialize(),i.show()}return{setupAutoplay:function(t,e,i){l=i,c=e;var n=t.config.ctaAutoPlay.displayTriggers;n.enabled?(a=setTimeout(function(){var e={channelId:t.channelId,broadcastId:t.id,channelConfig:t.config,viewMode:t.config.ctaAutoPlay.initialSize,url:utilitiesService.getPageUrl(!0),title:t.name,videoType:t.type};0<n.timeOnPage&&eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_TOP_TRIGGERED,e),n.userScrollsDown?eventLoggerService.actionsStatus.scroll?(eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_SCROLLED_TRIGGERED,e),s(t)):(o=function(e){window.removeEventListener("scroll",o),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CTA_AUTOPLAY_SCROLLED_TRIGGERED,{channelId:e.channelId,broadcastId:e.id,channelConfig:e.config,viewMode:e.config.ctaAutoPlay.initialSize,url:utilitiesService.getPageUrl(!0),title:e.name,videoType:e.type}),s(e)}.bind(null,t),window.addEventListener("scroll",o)):s(t)},1e3*n.timeOnPage),r=!0):s(t)},storeAutoPlayReshowTimestamp:function(e){if(clientStorageService.isLocalStorageAccessible()){var t=clientStorageService.getItem(clientStorageService.storageKeys.VIDEO_VIEWED);t||(t={}),t[e.id]=utilitiesService.getTimeWithOutMilliSeconds(),clientStorageService.setItem(clientStorageService.storageKeys.VIDEO_VIEWED,t)}},destroyAutoPlay:function(){clearTimeout(a),window.removeEventListener("scroll",o),i&&(i=null,r=!1)},isAutoPlaySetup:function(){return r}}};GISAPP.availabilityService=function(gisService){'use strict';var e,c;return gisCallbacks.clerkIsAvailable=function(){e()},gisCallbacks.clerkIsNotAvailable=function(){c()},{checkIsClerkAvailable:function(l,a,i){e=l,c=a,gisService.isClerkAvailable("gisCallbacks.clerkIsAvailable","gisCallbacks.clerkIsNotAvailable",i)}}};GISAPP.bookingService=function(serverInjectionService,stateService,urlUtilitiesService,overrideService,logService){'use strict';var f={};function o(){var o,n,e,i,t,g='';try{f.systemConfig=serverInjectionService.getSystemConfig();var s=f.systemConfig.booking.url,r=s[stateService.getLocale()]?s[stateService.getLocale()]:s.default,a=urlUtilitiesService.getLocationObject(r);n=(o=a).toString().replace(o.search,''),e=urlUtilitiesService.getParamsObjectFromUrl(o),i=f.getCustomBookingUrlParams(),t=urlUtilitiesService.mergeParamsObject(e,i),g=urlUtilitiesService.appendParamsToUrl(n,t)}catch(o){logService.error(f.LOGTAG,"Error in getting the schedule call URL",o)}return g}function n(){return f.systemConfig=serverInjectionService.getSystemConfig(),f.systemConfig&&f.systemConfig.booking&&f.systemConfig.booking.enabled&&f.isBookingEnabledForCategory()||!1}return f.LOGTAG='bookingService',f.getCustomBookingUrlParams=function(){return{}},f.isBookingEnabledForCategory=function(){return!0},overrideService.override(f.LOGTAG,f),{isBookingEnabledForCategory:f.isBookingEnabledForCategory,getScheduleCallButtonUrl:o,isBookingEnabled:n,openBookingPage:function(){window.open(o(),'_blank')},isTwoWayVideoCallEnabled:function(){return f.systemConfig=serverInjectionService.getSystemConfig(),f.systemConfig&&f.systemConfig.booking&&f.systemConfig.booking.twoWayVideo&&f.systemConfig.booking.twoWayVideo.enabled||!1},isMultiParticipantEnabled:function(){return f.systemConfig=serverInjectionService.getSystemConfig(),f.systemConfig&&f.systemConfig.booking&&f.systemConfig.booking.enabled&&f.systemConfig.booking.multiParticipant||!1},isAddAPersonEnabled:function(){return f.systemConfig=serverInjectionService.getSystemConfig(),f.systemConfig&&f.systemConfig.booking&&f.systemConfig.booking.enabled&&f.systemConfig.booking.addAPerson},isOpenBookingWidgetInNewTab:function(){return f.systemConfig=serverInjectionService.getSystemConfig(),f.systemConfig&&f.systemConfig.booking&&f.systemConfig.booking.enabled&&f.systemConfig.booking.openBookingWidgetInNewTab},isEnabledForUnavailableCta:function(){return f.systemConfig=serverInjectionService.getSystemConfig(),n()&&f.systemConfig.booking.isEnabledForUnavailableCta}}};GISAPP.browserInfoService=function(clientStorageService){'use strict';var e=void 0!==window.chrome||-1<navigator.userAgent.indexOf("CriOS"),r=-1<navigator.userAgent.toLowerCase().indexOf('firefox')||-1<navigator.userAgent.indexOf("FxiOS"),a=window.ActiveXObject||window.hasOwnProperty('ActiveXObject')||-1<navigator.userAgent.indexOf("Edge"),t=!e&&!r&&-1<navigator.userAgent.indexOf("Safari"),i={name:"safari",displayName:"Safari"},n={name:"chrome",displayName:"Chrome"},o={name:"firefox",displayName:"Firefox"},A={name:"ie",displayName:"Internet Explorer"};return{isChrome:function(){return e},isFirefox:function(){return r},isExplorer:function(){return a},isSafari:function(){return t},getBrowser:function(){var e,r=navigator.userAgent,a=r.match(/(opera|chrome|safari|fxios|crios|firefox|msie|trident)/i)||[];if(null==a[0])return'other';var t,i,n=a[0].toLowerCase();switch(n){case'trident':case'ie':case'msie':return'ie';case'chrome':return null!=(e=r.match(/(OPR|Edge|YaBrowser)/))?e.slice(1)[0].replace('OPR','Opera').toLowerCase():(t=r.split(/\s*[;)(]\s*/),null!=(i=t[t.length-1]).match(/^Chrome\/[.0-9]*\sSafari\/[.0-9]*/i)||null!=i.match(/^Chrome\/[.0-9]*\sMobile\sSafari\/[.0-9]*/i)?'chrome':'other');case'crios':return'chrome';case'fxios':return'firefox';default:return n}},isWebpSupported:function(r){var e=clientStorageService.getItem(clientStorageService.storageKeys.BROWSER_FEATURE_SUPPORT);if(e&&'object'==typeof e)return"function"==typeof r?void r(e.webp):e.webp;var a=function(e){clientStorageService.setItem(clientStorageService.storageKeys.BROWSER_FEATURE_SUPPORT,{webp:e}),'function'==typeof r&&r(e)},t=document.createElement('img');t.onload=function(){var e=0<t.width&&0<t.height;a(e)},t.onerror=function(){a(!1)},t.src="data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"},getBrowserDisplayName:function(e){switch(e){case i.name:return i.displayName;case n.name:return n.displayName;case o.name:return o.displayName;case A.name:return A.displayName;default:return e}}}};GISAPP.callService=function(serverInjectionService,stateService,GIS_CONSTANTS,bookingService){'use strict';var i={'#gis-std-call-view':'#gis-ss-player-view','#gis-cs-signal-container':'#gis-ss-player-popup','#gis-cs-right-pane':'#gis-ss-right-pane'};function e(){return serverInjectionService.getSystemConfig().oneToOne&&serverInjectionService.getSystemConfig().oneToOne.inCallChat&&serverInjectionService.getSystemConfig().oneToOne.inCallChat.enabled}function o(){return serverInjectionService.getSystemConfig().oneToOne&&serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall&&serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall.enabled}function n(e){return e.type===GIS_CONSTANTS.CALL_TYPES.DIRECT?e.isInvalidUrl?GIS_CONSTANTS.VIEWS.INVALID_URL:e.isMissed?GIS_CONSTANTS.VIEWS.MEETING_MISSED:e.isCanceled?GIS_CONSTANTS.VIEWS.MEETING_CANCELED:e.isMeeting?GIS_CONSTANTS.VIEWS.MEETING_CONNECT:e.isMeetingError?GIS_CONSTANTS.VIEWS.MEETING_ERROR:e.isMeetingEnded?GIS_CONSTANTS.VIEWS.MEETING_ENDED:e.isAddAPersonCall?GIS_CONSTANTS.VIEWS.ADD_A_PERSON_SCREEN:(e.isDepartmentCall,GIS_CONSTANTS.VIEWS.DIRECT):serverInjectionService.getUiConfig().connectScreenHumanized?serverInjectionService.getApiEnabled()||stateService.getClerkAvailability()?GIS_CONSTANTS.VIEWS.HUMANIZED_CONNECT:bookingService.isEnabledForUnavailableCta()?GIS_CONSTANTS.VIEWS.BOOKING:GIS_CONSTANTS.VIEWS.CLERK_UNAVAILABLE_CONNECT:GIS_CONSTANTS.VIEWS.CONNECT}return{getCallJourneyInitiationScreen:function(e){return serverInjectionService.getApiEnabled()&&e.type!==GIS_CONSTANTS.CALL_TYPES.DIRECT?serverInjectionService.getSystemConfig()&&serverInjectionService.getSystemConfig().apiConnectScreenEnabled?n(e):null:n(e)},isTwoWayVideoCall:function(){return serverInjectionService.getSystemConfig().oneToOne&&serverInjectionService.getSystemConfig().oneToOne.twoWayVideo&&serverInjectionService.getSystemConfig().oneToOne.twoWayVideo.enabled},isInCallChatEnabled:e,isShopStreamCallEnabled:o,isShopStreamCallProductCarouselEnabled:function(){return o()&&serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall.productCarousel&&serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall.productCarousel.enabled},getElementReference:function(e,n,t){return o()&&i.hasOwnProperty(n)?t?i[n]:e.querySelector(i[n]):t?n:e.querySelector(n)},isAddAPersonEnabled:function(){return serverInjectionService.getSystemConfig().oneToOne&&serverInjectionService.getSystemConfig().oneToOne.addAPerson&&serverInjectionService.getSystemConfig().oneToOne.addAPerson.enabled},isRedirectJourney:function(){return bookingService.isEnabledForUnavailableCta()&&bookingService.isOpenBookingWidgetInNewTab()&&!stateService.getClerkAvailability()},isChatFirstCallEnabled:function(){return o()&&e()&&serverInjectionService.getSystemConfig().oneToOne.isShopStreamCall.isChatFirstCall.enabled}}};GISAPP.callUserService=function(logService,stateService,clientStorageService,gisService,cookieService,utilitiesService,userService){'use strict';var t,n="callUserService",i=logService,r=null;function s(){r&&(r(),r=null)}function o(e,r,a,l){var t={callUserUUID:null!=e?e:"",callUUID:stateService.getCallUUID(),viewType:d(r),referrerUrl:null!=a?decodeURIComponent(a):"",pageUUID:stateService.getPageUUID(),duration:null!=l?l:0};return stateService.getABTestId()&&(t.abTestId=stateService.getABTestId(),t.abGroupId=stateService.getABTestGroup()),JSON.stringify(t)}function d(e){return'broadcast'===e?'live':('call'===e||'replay'===e)&&e||'replay'}return{add:function(e,r){if(e){var a=userService.getUserUUID();t=e,i.debug(n,"Calling service to add call user for call="+stateService.getCallUUID()),gisService.addCallUser("GISAPP.callUserService.onAddCallUserOnServer",btoa(o(a,e,r)),s)}else i.error(n,"Failed to add call user.",null,{view_type:e})},sendBroadcastViewDuration:function(e,r){if(e&&r&&!isNaN(r)){var a=userService.getUserUUID();if(a){var l=stateService.getViewerRecId();if(!l)return gisService.addCallUser("GISAPP.callUserService.blankCallBack",btoa(o(a,e,"",r))),void i.error(n,"Failed to send view duration. Invalid viewer-id",null,{viewerId:l,viewType:e,callUserUUID:a,duration:r});i.debug(n,"Calling endpoint to update duration");var t=JSON.stringify({callUserUUID:a,callUUID:stateService.getCallUUID(),viewType:d(e),duration:r,id:l});gisService.sendBroadcastViewDuration(btoa(t))}else i.warn(n,"Cannot update view duration. callUserUUID is not present in storage.",{viewType:e})}else i.warn(n,"Failed to send view duration. Invalid values",{viewType:e,duration:r})},onAddCallUserOnServer:function(r){i.debug(n,"onAddCallUserOnServer json="+r);try{var e=JSON.parse(r).uuid,a=JSON.parse(r).id;stateService.setCallUserUUID(e),stateService.setViewerRecId(a);var l=clientStorageService.isLocalStorageAccessible();cookieService.isCookieEnabled()&&cookieService.isCookieEnabledInBrowser()?cookieService.setCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID,e,365,cookieService.getMainDomainForCookie()):l&&clientStorageService.setItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID,e),stateService.setCallUserUUID(e),l&&(clientStorageService.setItem(clientStorageService.storageKeys.VIEWED_BROADCAST_UUID,stateService.getCallUUID()),clientStorageService.setItem(clientStorageService.storageKeys.VIEWED_BROADCAST_TYPE,t))}catch(e){i.error(n,"Exception while adding call user on server.",e,{server_resp_json:r})}s()},setAddUserCallBack:function(e){'function'==typeof e&&(r=e)},showReplayCallback:s,blankCallBack:function(e){}}};GISAPP.carouselService=function(sliderComponent,globalObjectService,productCarouselTileComponent,eventLoggerService,uiUtilitiesService,stateService){'use strict';var n,r,o,a,u=[],c=[],d=[];function l(){n.refresh()}return globalObjectService.getWindow().addEventListener('gisUIClosed',function(){stateService.getCurrentPhase()===stateService.phase.IN_CALL||GISAPP.callCtrl.isChatFirstCall()||(u=[])}),{addTileToCarousel:function(t){if(n=t.id,o=!1,u.forEach(function(e){e.getInfo().id===n&&(o=!0)}),!o){var n,o;t.alignment=a||"horizontal",t.ctaMode='popup';var e,i=new productCarouselTileComponent(t);u.push(i),r.querySelector('#gis-slider-content').appendChild(i.render()),e=i.getId(),-1<d.indexOf(e)&&i.updateAddToBasketStatus(!0),l(),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.PRODUCT_SUCCESSFULLY_ADDED_TO_CAROUSEL,{data:t}),c.forEach(function(e){e.call(null,i,t)})}},updateTileStatus:function(t,n){u.forEach(function(e){e.getId()===t&&e.updateAddToBasketStatus(n)})},getCarouselComponentView:function(e){return(e="object"==typeof e?e:{}).tiles=[],n=new sliderComponent(e),r=n.render()},getTileFromCarousel:function(e,t){for(var n=0;n<u.length;n++)if(u[n].getInfo().id===e)return t?u[n]:new productCarouselTileComponent(u[n].getInfo())},updateOrientation:function(e,t){o=e,a=t,n.updateOrientation(e),u.forEach(function(e){e.updateOrientation(t)})},addTileToCarouselCallback:function(e){c.push(e)},getTiles:function(){return u},refresh:l,getSliderInstance:function(){if(n)return n},getOrientation:function(){return o||n.getOrientation()},resetState:function(){n={},r={},u=[],c=[],a=o=''},clearOldProducts:function(){u=[]},setBasketProducts:function(){u.forEach(function(e){e.isAddedToBasket()&&d.push(e.getId())})},removeAllTilesFromDOM:function(){if(r){var e=r.querySelector('#gis-slider-content');e&&0<e.childElementCount&&uiUtilitiesService.clearView(e)}}}};GISAPP.clientStorageService=function(logService,stateService){'use strict';var r="clientStorageService",o=logService,l='gis',c={};function t(e){try{var t=JSON.parse(localStorage.getItem(l))||{};return void 0!==t[e]?t[e]:null}catch(e){return o.warn(r,"Error while reading local storage",e),null}}return{storageKeys:{SERVICE_AWARENESS_KEY:'gis_visit',BROADCAST_PREVIEW_KEY:'gis-broadcast-preview-display',CHAT_CALL_USER_UUID:'gis-chat-call-user-uuid',CHAT_USER_NAME:'gis-chat-user-name',VIEWED_BROADCAST_UUID:'viewed-broadcast-uuid',VIEWED_BROADCAST_TYPE:'viewed-broadcast-type',VIDEO_VIEWED:'video-viewed',CTA_AUTO_PLAY_DISMISSED:"ctaAutoPlayDismissed",CTA_AUTO_PLAY_MAXIMISED_SHOWN:"ctaAutoPlayMaximisedShown",BROADCAST_CONTACT_CAPTURE:'broadcast-contact-capture',SHOW_AVAILABLE_CLERK:'show-available-clerk',CTA_AWARENESS_MESSAGE_CLOSED:'cta-awareness-message-closed',POLLING_START_TIMESTAMP:"pollingStartTimeStamp",ONE_TO_ONE_ENGAGEMENT:"oneToOneEngagement",CTA_ROUNDEL_CLOSED:"cta-roundel-closed",BROWSER_FEATURE_SUPPORT:"browser-feature-support",ACTIVE_MVT:"active-mvt"},getItem:t,setItem:function(e,t){try{var a=localStorage.getItem(l);(c=null==a?{}:JSON.parse(a))[e]=t,localStorage.setItem(l,JSON.stringify(c))}catch(e){o.warn(r,"Error while writing to local storage",e)}},hasProperty:function(e){try{return localStorage.hasOwnProperty(l)&&null!=t(e)}catch(e){return o.warn(r,"Error while checking property in local storage",e),!1}},removeItem:function(e){try{var t=localStorage.getItem(l);t&&(c=JSON.parse(t)),c[e]&&delete c[e],localStorage.setItem(l,JSON.stringify(c))}catch(e){o.warn(r,"Error while deleting from local storage",e)}},isLocalStorageAccessible:function(){try{return localStorage.setItem('test','test'),localStorage.removeItem('test'),!0}catch(e){return o.warn(r,"Unable to access local storage",e),!1}},clearLocalStorageFromOpenTokProps:function(){stateService.setOTData({opentok_client_id:localStorage.getItem('opentok_client_id'),debug:localStorage.getItem('debug')}),localStorage.removeItem('opentok_client_id'),localStorage.removeItem('debug')},restoreOpenTokPropsToLocalStorage:function(){localStorage.setItem('opentok_client_id',stateService.getOTData().opentok_client_id),localStorage.setItem('debug',stateService.getOTData().debug)}}};GISAPP.cookieService=function(serverInjectionService,urlUtilitiesService){'use strict';var e=serverInjectionService.getSystemConfig();function t(){return document.cookie}function a(){return navigator.cookieEnabled}function o(){return e.cookie&&e.cookie.enabled}return{getAllCookies:t,getCookie:function(e){if(e+="=",!t())return null;for(var o=t().split(';'),n=0;n<o.length;n++){for(var i=o[n];' '==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null},setCookie:function(e,o,n,i){if(a()){var t="";if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),t="; expires="+r.toUTCString()}document.cookie=e+"="+o+t+";path=/; domain="+i}},isCookieEnabledInBrowser:a,getMainDomainForCookie:urlUtilitiesService.getMainDomainForCookie,isOptInEnabledForCookies:function(){return o()&&e.cookie.optIn},isCookieEnabled:o,deleteCookie:function(e){document.cookie=e+'=; path=/; domain='+urlUtilitiesService.getMainDomainForCookie()+'; expires='+new Date(0).toUTCString()}}};GISAPP.deviceInfoService=function(stateService,globalObjectService){'use strict';var i=navigator.userAgent.match(/iPad/i)||!1,n={ANDROID:"android",IOS:"ios"};function t(){return stateService.getOs()==n.ANDROID}function e(){return stateService.getOs()==n.IOS&&!r()}function r(){return(i||function(){var i=globalObjectService.getWindow().navigator;if(i.maxTouchPoints&&2<i.maxTouchPoints){if(i.platform)return/MacIntel/.test(i.platform);if(i.userAgentData.platform)return/MacIntel/.test(i.userAgentData.platform)}}()||'apple ipad'==stateService.getDeviceName())&&"instagram"!==stateService.getBrowser()}function a(){return t()||e()}return{isAndroid:t,isIos:e,isIPad:r,isMobileDevice:a,getDeviceOS:function(){var i,n,t=navigator.userAgent,e=t.match(/(windows|linux|mac os|iPhone OS)/i)||[];if(null==e[0])return'Android'==(i=t.match(/(Android)/i)||[])[0]?'android':'other';switch(n=e[0].toLowerCase()){case'linux':return'Android'==(i=t.match(/(Android)/i)||[])[0]?'android':n;case'mac os':if('Macintosh'===(i=t.match(/(Macintosh)/i)||[])[0])return'macintosh';if('iPad'===(i=t.match(/(iPad|iPhone)/i)||[])[0]||'iPhone'===i[0])return'ios';break;case'iphone os':if('iPad'===(i=t.match(/(iPad|iPhone)/i)||[])[0]||'iPhone'===i[0])return'ios';break;case'windows':return'windows'}},isPhoneOrTablet:function(){return a()||r()}}};GISAPP.eventLoggerService=function(stateService,utilitiesService,logService,gisService,serverInjectionService){'use strict';var A,_,L,O="eventLoggerService",N={SCRIPT_INIT_SUCCESS:"SCRIPT_INIT_SUCCESS",SCRIPT_INIT_FAILED:"SCRIPT_INIT_FAILED",SERVICE_OFFERED:"SERVICE_OFFERED",CALL_USER_BLOCKED:"CALL_USER_BLOCKED",SERVICE_NOT_OFFERED:"SERVICE_NOT_OFFERED",PAGE_METADATA:"PAGE_METADATA_EXTRACTED",PAGE_NAVIGATE:"PAGE_NAVIGATED",SCRIPT_BROWSER_NOT_SUPPORTED:"SCRIPT_BROWSER_NOT_SUPPORTED",CTA_POWEREDBYEMPLIFI_TEXT_CLICKED:"CTA_POWEREDBYEMPLIFI_TEXT_CLICKED",CALL_CTA_SHOWN:"CALL_CTA_SHOWN",CALL_CTA_SHOWN_UNAVAILABLE:"CALL_CTA_SHOWN_UNAVAILABLE",CALL_CTA_CLICK:"CALL_CTA_CLICKED",CALL_CTA_CLICK_UNAVAILABLE:"CALL_CTA_CLICKED_UNAVAILABLE",BROADCAST_CTA_SHOWN:"BROADCAST_CTA_SHOWN",BROADCAST_CTA_CLICK:"BROADCAST_CTA_CLICKED",BROADCAST_REPLAY_CTA_SHOWN:"REPLAY_CTA_SHOWN",BROADCAST_REPLAY_CTA_CLICK:"REPLAY_CTA_CLICKED",CALL_ENDED_BY_CLERK:"CALL_ENDED_BY_CLERK",CALL_ENDED_NETWORK_DISCONNECT:"CALL_ENDED_NETWORK_DISCONNECT",CALL_ENDED_FORCE:"CALL_ENDED_FORCE",CALL_RECONNECTING:"CALL_RECONNECTING",CALL_RECONNECTED:"CALL_RECONNECTED",ORDER_CONFIRMATION_PAGE:"ORDER_CONFIRMATION_PAGE",MIC_SHARE_INFO_CLICKED:"MIC_SHARE_INFO_CLICKED",SUPPORT_INFO_LINK_CLICKED:"SUPPORT_INFO_LINK_CLICKED",DISCLAIMER_CLICKED:"DISCLAIMER_CLICKED",CALL_CLERK_STREAM_RECEIVED:"CALL_CLERK_STREAM_RECEIVED",TAB_INACTIVE:"TAB_INACTIVE",CTA_AUTOPLAY_SHOWN:"CTA_AUTOPLAY_SHOWN",CTA_AUTOPLAY_CLICKED:"CTA_AUTOPLAY_CLICKED",CTA_AUTOPLAY_CLOSED:"CTA_AUTOPLAY_CLOSED",CTA_AUTOPLAY_MINIMISED_CLICKED:"CTA_AUTOPLAY_MINIMISED_CLICKED",CTA_AUTOPLAY_ENDED:"CTA_AUTOPLAY_ENDED",CTA_AUTOPLAY_UNMUTE:"CTA_AUTOPLAY_UNMUTE",CTA_AUTOPLAY_MUTE:"CTA_AUTOPLAY_MUTE",CTA_AUTOPLAY_FULLSCREEN:"CTA_AUTOPLAY_FULLSCREEN",CTA_AUTOPLAY_TOP_TRIGGERED:"CTA_AUTOPLAY_TOP_TRIGGERED",CTA_AUTOPLAY_SCROLLED_TRIGGERED:"CTA_AUTOPLAY_SCROLLED_TRIGGERED",CTA_AUTOPLAY_AUTOPLAY:"CTA_AUTOPLAY_AUTOPLAY",CTA_AUTOPLAY_AUTO_MINIMISED:"CTA_AUTOPLAY_AUTO_MINIMISED",CTA_AUTOPLAY_KEEP_WATCHING_SHOWN:"CTA_AUTOPLAY_KEEP_WATCHING_SHOWN",CTA_AUTOPLAY_KEEP_WATCHING_CLICKED:"CTA_AUTOPLAY_KEEP_WATCHING_CLICKED",BROADCAST_CONTACT_CAPTURE_SUBMITTED:"BROADCAST_CONTACT_CAPTURE_SUBMITTED",SEGMENT_CLICKED:"SEGMENT_CLICKED",SEGMENT_VIEW_DURATION:"SEGMENT_VIEW_DURATION",IN_CALL_CHAT_SHOWN:"IN_CALL_CHAT_SHOWN",ADD_TO_BASKET_SHOWN:"ADD_TO_BASKET_SHOWN",ADD_TO_BASKET_ACCEPTED:"ADD_TO_BASKET_ACCEPTED",ADD_TO_BASKET_DENIED:"ADD_TO_BASKET_DENIED",ADD_TO_BASKET_SUCCESS:"ADD_TO_BASKET_SUCCESS",ADD_TO_BASKET_ERROR:"ADD_TO_BASKET_ERROR",CTA_AWARENESS_MESSAGE_CLOSED:"CTA_AWARENESS_MESSAGE_CLOSED",CALL_CTA_AWARENESS_MESSAGE_SHOWN:"CALL_CTA_AWARENESS_MESSAGE_SHOWN",CTA_AWARENESS_CLERK_UNAVAILABLE_MESSAGE_SHOWN:"CTA_AWARENESS_CLERK_UNAVAILABLE_MESSAGE_SHOWN",BROADCAST_CTA_AWARENESS_MESSAGE_SHOWN:"BROADCAST_CTA_AWARENESS_MESSAGE_SHOWN",REPLAY_CTA_AWARENESS_MESSAGE_SHOWN:"REPLAY_CTA_AWARENESS_MESSAGE_SHOWN",CALL_CTA_AWARENESS_ACTION_MESSAGE_CLICKED:"CALL_CTA_AWARENESS_ACTION_MESSAGE_CLICKED",CTA_AWARENESS_ACTION_CLERK_UNAVAILABLE_CLICKED:"CTA_AWARENESS_ACTION_CLERK_UNAVAILABLE_CLICKED",BROADCAST_CTA_AWARENESS_ACTION_MESSAGE_CLICKED:"BROADCAST_CTA_AWARENESS_ACTION_MESSAGE_CLICKED",REPLAY_CTA_AWARENESS_ACTION_MESSAGE_CLICKED:"REPLAY_CTA_AWARENESS_ACTION_MESSAGE_CLICKED",CTA_BAR_MESSAGE_CLICKED:"CTA_BAR_MESSAGE_CLICKED",CALL_CTA_SHOWN_ON_BROADCAST:"CALL_CTA_SHOWN_ON_BROADCAST",CALL_CTA_CLICK_FROM_BROADCAST:"CALL_CTA_CLICK_FROM_BROADCAST",CALL_CTA_CLICK_UNAVAILABLE_ON_BROADCAST:"CALL_CTA_CLICK_UNAVAILABLE_ON_BROADCAST",CALL_CTA_SHOWN_ON_BROADCAST_UNAVAILABLE:"CALL_CTA_SHOWN_ON_BROADCAST_UNAVAILABLE",CALL_CTA_SHOWN_ON_REPLAY:"CALL_CTA_SHOWN_ON_REPLAY",CALL_CTA_CLICK_FROM_REPLAY:"CALL_CTA_CLICK_FROM_REPLAY",CALL_CTA_CLICK_UNAVAILABLE_ON_REPLAY:"CALL_CTA_CLICK_UNAVAILABLE_ON_REPLAY",CALL_CTA_SHOWN_ON_REPLAY_UNAVAILABLE:"CALL_CTA_SHOWN_ON_REPLAY_UNAVAILABLE",AUTO_CALL_USER:"AUTO_CALL_USER",IS_CLERK_AVAILABLE_REQUEST_SENT:"IS_CLERK_AVAILABLE_REQUEST_SENT",IS_CLERK_AVAILABLE_REQUEST_RECEIVED:"IS_CLERK_AVAILABLE_REQUEST_RECEIVED",RESPECT_MESSAGE_DISPLAYED_ON_CONNECTING_SCREEN:"RESPECT_MESSAGE_DISPLAYED_ON_CONNECTING_SCREEN",TAP_TO_FOCUS_BUTTON_CLICKED:"TAP_TO_FOCUS_BUTTON_CLICKED",CHAT_INITIATED:"CHAT_INITIATED",CTA_ROUNDEL_CLOSED:"CTA_ROUNDEL_CLOSED",SHOP_STREAM_PLAY_BUTTON_CLICKED:"SHOP_STREAM_PLAY_BUTTON_CLICKED",SHOP_STREAM_PAUSE_BUTTON_CLICKED:"SHOP_STREAM_PAUSE_BUTTON_CLICKED",SHOP_STREAM_USER_DURATION:"SHOP_STREAM_USER_DURATION",CHAT_SHOWN_ON_SHOP_STREAM:"CHAT_SHOWN_ON_SHOP_STREAM",PRODUCT_CAROUSEL_SHOWN_ON_SHOP_STREAM:"PRODUCT_CAROUSEL_SHOWN_ON_SHOP_STREAM",CHAT_HIDDEN_ON_SHOP_STREAM:"CHAT_HIDDEN_ON_SHOP_STREAM",PRODUCT_CAROUSEL_HIDDEN_ON_SHOP_STREAM:"PRODUCT_CAROUSEL_HIDDEN_ON_SHOP_STREAM",CHAT_SHOWN_ON_ONE_TO_ONE:"CHAT_SHOWN_ON_ONE_TO_ONE",SHOP_STREAM_CHAT_BUTTON_CLICKED:"SHOP_STREAM_CHAT_BUTTON_CLICKED",SHOP_STREAM_PRODUCT_CAROUSEL_BUTTON_CLICKED:"SHOP_STREAM_PRODUCT_CAROUSEL_BUTTON_CLICKED",SHOP_STREAM_FULL_SCREEN_BUTTON_CLICKED:"SHOP_STREAM_FULL_SCREEN_BUTTON_CLICKED",ONE_TO_ONE_CHAT_BUTTON_CLICKED:"ONE_TO_ONE_CHAT_BUTTON_CLICKED",SHOP_STREAM_FULL_SCREEN:"SHOP_STREAM_FULL_SCREEN",SHOP_STREAM_INITIAL_SCREEN:"SHOP_STREAM_INITIAL_SCREEN",PRODUCT_CARD_PROMPTED:"PRODUCT_CARD_PROMPTED",ADD_TO_CART_CLICKED_ON_PRODUCT_CARD:"ADD_TO_CART_CLICKED_ON_PRODUCT_CARD",SAVE_TO_RECOMMENDED_CLICKED_ON_PRODUCT_CARD:"SAVE_TO_RECOMMENDED_CLICKED_ON_PRODUCT_CARD",PRODUCT_SUCCESSFULLY_ADDED_TO_CAROUSEL:"PRODUCT_SUCCESSFULLY_ADDED_TO_CAROUSEL",PRODUCT_CLICKED_ON_PRODUCT_CAROUSEL:"PRODUCT_CLICKED_ON_PRODUCT_CAROUSEL",DETAILED_PRODUCT_CARD_DISPLAYED:"DETAILED_PRODUCT_CARD_DISPLAYED",ADD_TO_CART_CLICKED_ON_DETAILED_CARD:"ADD_TO_CART_CLICKED_ON_DETAILED_CARD",MORE_INFO_CLICKED_ON_DETAILED_CARD:"MORE_INFO_CLICKED_ON_DETAILED_CARD",CLOSED_BUTTON_CLICKED_ON_DETAILED_CARD:"CLOSED_BUTTON_CLICKED_ON_DETAILED_CARD",PRODUCT_CAROUSEL_HIDDEN:"PRODUCT_CAROUSEL_HIDDEN",PRODUCT_CAROUSEL_OPENED:"PRODUCT_CAROUSEL_OPENED",PRODUCT_CAROUSEL_SCROLLED:"PRODUCT_CAROUSEL_SCROLLED",ADD_A_PERSON_BUTTON_CLICKED:"ADD_A_PERSON_BUTTON_CLICKED",CONSUMER_JOINED_THE_CALL:"CONSUMER_JOINED_THE_CALL",CHAT_ROOM_FULL_MESSAGE_SHOWN:"CHAT_ROOM_FULL_MESSAGE_SHOWN",PROGRESS_BAR_CLICKED:"PROGRESS_BAR_CLICKED",PROGRESS_BAR_DRAGGED:"PROGRESS_BAR_DRAGGED",CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY:"CALL_ENDED_DUE_TO_CONSUMER_INACTIVITY",CHAT_USERNAME_AUTO_SUBMIT_TRIGGERED:"CHAT_USERNAME_AUTO_SUBMIT_TRIGGERED"},S={wheel:!1,scroll:!1,mouseUp:0},I=window.gisProfilingStartTime||performance.now(),D=0;function E(_,A){if(!stateService.isDataCollectionDisabled()){A||(A={}),'object'!=typeof A&&(A={});var E={};Object.keys(A).forEach(function(_){E[_]=A[_]}),stateService.getABTestId()&&(E.abTestId=stateService.getABTestId(),E.abTestGroup=stateService.getABTestGroup()),stateService.getActiveABTests()&&(E.activeABTests=stateService.getActiveABTests()),stateService.getCallUUID()&&(E.callUUID=stateService.getCallUUID()),stateService.getSocialRedirectionInfo()&&null!==stateService.getSocialRedirectionInfo()&&(E.redirectedFrom=stateService.getSocialRedirectionInfo()),E.activity=function(_){var A=performance.now(),E=parseFloat((A-I).toFixed(3)),C=L?A-L:0,T={};T.timeElapsed=E,(_==N.CALL_CTA_CLICK||_==N.BROADCAST_CTA_CLICK||_==N.BROADCAST_REPLAY_CTA_CLICK)&&(T.wheel=S.wheel,T.scroll=S.scroll);0<S.mouseUp&&(T.clicks=S.mouseUp);return T.totalActiveTime=parseFloat((D+C).toFixed(3)),T}(_),E.referrer||(E.referrer=utilitiesService.getReferer()),logService.debug(O,"Logging event "+_+", "+JSON.stringify({data:E,CallUserUUID:stateService.getCallUserUUID(),pageUUID:stateService.getPageUUID()}));var C=utilitiesService.utf8ToBase64(JSON.stringify(E));if(gisService.logEvent(_,stateService.getCallUserUUID(),stateService.getPageUUID(),C),serverInjectionService.getSystemConfig().analytics&&serverInjectionService.getSystemConfig().analytics.enabled){var T={};T.eventName=_,T.retailerKey=serverInjectionService.getRetailerKey(),T.userUUID=stateService.getCallUserUUID(),T.pageUUID=stateService.getPageUUID(),T.data=E,gisService.logEventOnStream(encodeURIComponent(T.retailerKey),utilitiesService.utf8ToBase64(JSON.stringify(T)))}}}function C(){var _=performance.now();document[A]?(D+=_-L,L=0,E(N.TAB_INACTIVE),stateService.setPageStatus(stateService.pageStatus.INACTIVE)):(L=_,stateService.setPageStatus(stateService.pageStatus.ACTIVE)),logService.debug(O,"visibility = "+document[A]+" totalActiveTime = "+D+" ms")}function T(){S.scroll=!0,window.removeEventListener("scroll",T)}function R(){S.wheel=!0,window.removeEventListener("wheel",R)}function U(){S.mouseUp++}return void 0!==document.hidden?(A="hidden",_="visibilitychange"):void 0!==document.msHidden?(A="msHidden",_="msvisibilitychange"):void 0===document.webkitHidden&&(A="webkitHidden",_="webkitvisibilitychange"),{GIS_ACTIONS:{CLICKED:"_CLICKED",CLOSED:"_CLOSED",SHOWN:"_SHOWN"},GIS_EVENTS:N,GIS_VIEWS:{DIRECT_CALL:"DIRECT_CALL_VIEW",DIRECT_CALL_BTN:"DIRECT_CALL_VIEW_BUTTON",INVALID_DIRECT_CALL:"INVALID_DIRECT_CALL_VIEW",INVALID_DIRECT_CALL_BTN:"INVALID_DIRECT_CALL_VIEW_BUTTON",CONNECT:"CONNECT_VIEW",CONNECT_BUTTON:"_CONNECT_BUTTON",BOOKING_SCHEDULE_BUTTON:"BOOKING_SCHEDULE_BUTTON",EXTERNAL_CHAT_BUTTON:"EXTERNAL_CHAT_BUTTON",LIVE_CHAT_BUTTON:"LIVE_CHAT_BUTTON",CONNECTING:"CONNECTING_VIEW",CALL:"CALL_VIEW",SURVEY:"SURVEY_VIEW",NO_MIC:"NO_MIC_VIEW",MIC_BLOCKED:"MIC_BLOCKED_VIEW",CLERK_UNAVAILABLE_CONNECT:"CLERK_UNAVAILABLE_CONNECT",NO_CLERK_AVAILABLE:"NO_CLERK_AVAILABLE_VIEW",BROWSER_UNSUPPORTED:"BROWSER_UNSUPPORTED_VIEW",MIC_SETUP:"MIC_SETUP_VIEW",MIC_DENIED:"MIC_DENIED_VIEW",MIC_AND_CAMERA_SETUP:"MIC_AND_CAMERA_SETUP_VIEW",MIC_OPTIN:"MIC_OPTIN_VIEW",MIC_ALLOW_BUTTON:"_MIC_ALLOW_BUTTON",MIC_DONT_ALLOW_BUTTON:"_MIC_DONT_ALLOW_BUTTON",MIC_AND_CAMERA_ALLOW_BUTTON:"MIC_AND_CAMERA_ALLOW_BUTTON",MIC_AND_CAMERA_CANCEL_BUTTON:"MIC_AND_CAMERA_CANCEL_BUTTON",HUMANIZED_MIC_SHARE:"HUMANIZED_MIC_SHARE_VIEW",BROADCAST:"BROADCAST_VIEW",BROADCAST_REPLAY:"BROADCAST_REPLAY_VIEW",BROADCAST_CONTACT_CAPTURE:"BROADCAST_CONTACT_CAPTURE_VIEW",LINK:"_LINK",LINK2:"_LINK2",EXTRABTN1:"_EXTRABTN1",EXTRABTN2:"_EXTRABTN2",AVAILABLE_CLERKS:"_AVAILABLE_CLERKS",MEETING_CONNECT:"MEETING_CONNECT_VIEW",MEETING_ERROR:"MEETING_ERROR_VIEW",MEETING_CANCELED:"MEETING_CANCELED_VIEW",MEETING_MISSED:"MEETING_MISSED_VIEW",MEETING_ENDED:"MEETING_ENDED_VIEW",MEETING_CONNECT_BTN:"MEETING_CONNECT_BTN",BOOKING:"BOOKING",ADD_A_PERSON_VIEW:"ADD_A_PERSON_VIEW",ADD_A_PERSON_CALL_BUTTON:"ADD_A_PERSON_CALL_BUTTON",ADD_A_PERSON_SESSION_IS_FULL_VIEW:"ADD_A_PERSON_SESSION_IS_FULL_VIEW",ADD_A_PERSON_CALL_ENDED_VIEW:"ADD_A_PERSON_CALL_ENDED_VIEW",ADD_A_PERSON_CALL_ENDED_BUTTON:"ADD_A_PERSON_CALL_ENDED_BUTTON",CHAT_CALL_INACTIVITY_POPUP:"CHAT_CALL_INACTIVITY_POPUP",CHAT_CALL_START_POPUP:"CHAT_CALL_START_POPUP",CHAT_INCOMING_CALL_POPUP:'CHAT_INCOMING_CALL_POPUP',CHAT_END_CALL_POPUP:'CHAT_END_CALL_POPUP',CHAT_OUTGOING_CALL_DECLINED:'CHAT_OUTGOING_CALL_DECLINED'},actionsStatus:S,logEvent:E,setupEventListeners:function(){window.addEventListener&&(window.addEventListener('wheel',R),window.addEventListener("scroll",T)),document.body.addEventListener&&document.body.addEventListener('mouseup',U,!0),document.addEventListener&&void 0!==A?(document.addEventListener(_,C,!1),document[A]?(E(N.TAB_INACTIVE),stateService.setPageStatus(stateService.pageStatus.INACTIVE)):(L=I,stateService.setPageStatus(stateService.pageStatus.ACTIVE))):D=-1}}};GISAPP.eventService=function(utilitiesService){var e={};return{subscribe:function(r,n){Array.isArray(e[r])||(e[r]=[]),-1===e[r].indexOf(n)&&e[r].push(n)},publish:function(r,n){Array.isArray(e[r])&&e[r].forEach(function(r){r(n)})},unsubscribe:function(r,n){if(Array.isArray(e[r]))for(var i=0;i<e[r].length;i++)e[r][i]===n&&utilitiesService.removeFromArray(e[r],n)},unsubscribeAll:function(r){if(Array.isArray(e[r]))for(var n=0;n<e[r].length;n++)utilitiesService.removeFromArray(e[r],e[r][n])}}};GISAPP.externalChatIntegrationService=function(serverInjectionService,uiUtilitiesService,overrideService){'use strict';var e={},n=function(){};e.openExternalChat=n;var t=function(){return serverInjectionService.getSystemConfig()},r=function(){return t().externalChatIntegration},a=function(){return void 0!==r()&&r().isEnabled&&void 0!==t().persistentCta&&!0===t().persistentCta&&e.openExternalChat!==n};return overrideService.override("externalChatIntegrationService",e),{isEnabled:a,onChatButtonClick:function(n){n&&"function"==typeof n&&n.call(),e.openExternalChat.call()},isEnabledOnConnectScreen:function(){return!!a()&&void 0!==r().onConnectScreen&&r().onConnectScreen},isEnabledOnUnavailableScreen:function(){return!!a()&&void 0!==r().onUnavailableScreen&&r().onUnavailableScreen},manuallyOverrideChatTriggerFunction:function(n){e.openExternalChat=n}}};GISAPP.gaService=function(logService,serverInjectionService,stateService,validationUtilitiesService,overrideService,clientStorageService){'use strict';var _={LOGTAG:"gaService"};return _.logService=logService,_.stateService=stateService,_.validationUtilitiesService=validationUtilitiesService,_.GA_CONSTANTS={MAX_LABEL_LENGTH:1e3,TRACK_EVENT:'_trackevent'},_.USE_GA_DEFAULT_REFERENCE_NAME="useDefaultGAReferenceName",_.TAG_MANAGER_CONSTANTS={GIS_EVENT_NAME:'GISEvent'},_.GA_METHOD_STRINGS={SEND:'send',EVENT:'event'},_.category='GoInStore',serverInjectionService.getRetailerToken()&&(_.category=serverInjectionService.getRetailerKey()+"-"+_.category),_.hasBeenError=!1,_.GIS_EVENT_ACTIONS={CALL_CTA_SHOWN:'GIS Call-CTA-Shown',CALL_CTA_SHOWN_UNAVAILABLE:'GIS Call-CTA-Unavailable-Shown',CALL_CTA_CLICK:'GIS Call-CTA-Click',CALL_CTA_CLICK_UNAVAILABLE:'GIS Call-CTA-Unavailable-Click',BROADCAST_CTA_SHOWN:'GIS Broadcast-CTA-Shown',BROADCAST_CTA_CLICK:'GIS Broadcast-CTA-Click',BROADCAST_REPLAY_CTA_SHOWN:'GIS Broadcast-Replay-CTA-Shown',BROADCAST_REPLAY_CTA_CLICK:'GIS Broadcast-Replay-CTA-Click',BROADCAST_DURATION:'GIS Broadcast-Duration',BROADCAST_LINK_CLICK:'GIS Broadcast-link-click',BROADCAST_LINK2_CLICK:'GIS Broadcast-link2-click',BROADCAST_EXTRABTN1_CLICK:'GIS Broadcast-extrabtn1-click',BROADCAST_EXTRABTN2_CLICK:'GIS Broadcast-extrabtn2-click',BROADCAST_REPLAY_DURATION:'GIS Broadcast-Replay-Duration',BROADCAST_REPLAY_LINK_CLICK:'GIS Broadcast-Replay-link-click',BROADCAST_REPLAY_LINK2_CLICK:'GIS Broadcast-Replay-link2-click',BROADCAST_REPLAY_EXTRABTN1_CLICK:'GIS Broadcast-Replay-extrabtn1-click',BROADCAST_REPLAY_EXTRABTN2_CLICK:'GIS Broadcast-Replay-extrabtn2-click',CALL_MADE:'GIS Call-Made',CALL_ACCEPTED:'GIS Call-Accepted',CALL_MIC_ALLOWED:'GIS Mic-Allowed',CALL_MIC_DENIED:'GIS Mic-Denied',CALL_ENDED:'GIS Call-Ended',CALL_DURATION:'GIS Call-Duration',CALL_MISSED:'GIS Call-Missed',CALL_ABORTED:'GIS Call-Aborted',SURVEY_RESULT:'GIS Survey-Result',CONTACT_SUBMISSION:'GIS Contact-Submission',CALL_BLOCKED_UNSUPPORTED_BROWSER:'GIS Call-Blocked-Unsupported-Browser',CALL_BLOCKED_NO_MIC:'GIS No-Mic',CALL_NO_CLERK_AVAILABLE:'GIS No-One-Available',CALL_CONNECTING_CANCELLED:'GIS Call-Connecting-Cancelled',CHAT_MESSAGE_SENT:'GIS Chat-Message-Sent',CHAT_NAME_SENT:'GIS Chat-Name-Sent',CHAT_NAME_ASK:'GIS Chat-Name-Ask',CTA_AUTOPLAY_SHOWN:"GIS Cta-Autoplay-Shown",CTA_AUTOPLAY_FULLSCREEN:"GIS Cta-Autoplay-Fullscreen",CTA_AUTOPLAY_CLICKED:"GIS Cta-Autoplay-Clicked",CTA_AUTOPLAY_AUTOPLAY:"GIS Cta-Autoplay-Autoplay",CTA_AUTOPLAY_MUTE:"GIS Cta-Autoplay-Mute",CTA_AUTOPLAY_UNMUTE:"GIS Cta-Autoplay-Unmute",CTA_AUTOPLAY_CLOSED:"GIS Cta-Autoplay-Closed",CTA_AUTOPLAY_KEEP_WATCHING_CLICKED:"GIS Cta-Autoplay-keep-watching-clicked",CTA_AUTOPLAY_KEEP_WATCHING_SHOWN:"GIS Cta-Autoplay-keep-watching-shown",SEGMENT_CLICKED:"GIS Segment-Clicked",SEGMENT_VIEW_DURATION:"GIS Segment-View-Duration",DIRECT_CALL:"GIS Direct-Call",STANDARD_CALL:"GIS Standard-Call",ITEM_ADDED_TO_BASKET:"GIS Item-Added-To-Basket",CALL_CTA_SHOWN_ON_BROADCAST:"GIS call-CTA-shown-on-broadcast",CALL_CTA_CLICK_FROM_BROADCAST:"GIS call-CTA-click-from-broadcast",CALL_CTA_CLICK_UNAVAILABLE_ON_BROADCAST:"GIS Unavailable-call-CTA-click-on-broadcast",CALL_CTA_SHOWN_ON_BROADCAST_UNAVAILABLE:"GIS call-CTA-shown-unavailable-on-broadcast",CALL_CTA_SHOWN_ON_REPLAY:"GIS call-CTA-shown-on-replay",CALL_CTA_CLICK_FROM_REPLAY:"GIS call-CTA-click-from-replay",CALL_CTA_CLICK_UNAVAILABLE_ON_REPLAY:"GIS Unavailable-call-CTA-click-on-replay",CALL_CTA_SHOWN_ON_REPLAY_UNAVAILABLE:"GIS call-CTA-shown-unavailable-on-replay",CLERK_JOINED:"GIS clerk-joined",IS_CLERK_AVAILABLE_REQUEST_RECEIVED:"GIS is-clerk-available-request-received",SERVICE_NOT_OFFERED:"GIS service-not-offered"},_.ANALYTICS_TYPES={NONE:'none',CLASSIC:'classic',UNIVERSAL:'universal',TAG_MANAGER:'tag manager',CUSTOM:'custom',CUSTOM_API:'custom api',TEALIUM:'tealium',ADOBE:'adobe'},_.ANALYTICS_DEFAULT_REFENCE_NAMES={CLASSIC:'_gaq',UNIVERSAL:'ga',TAG_MANAGER:'dataLayer',TEALIUM:'utag',ADOBE:'_satellite'},_.setCategory=function(e){e&&validationUtilitiesService.isString(e)?(_.category=e,serverInjectionService.getRetailerToken()&&(_.category=serverInjectionService.getRetailerKey()+"-"+_.category)):_.logService.warn(_.LOGTAG,"Invalid parameter: Couldn't set analytics category.")},_.sendAnalyticsEvent=function(e,a,A){if(_._isEventLoggingAllowed(e)){A&&!validationUtilitiesService.isInt(A)&&(logService.warn(_.LOGTAG,"Ignoring invalid value for analytics event"+e+": "+A),A=null);var t={};t.userId=stateService.getCallUserUUID(),t.pageId=stateService.getPageUUID(),stateService.getCallUUID()&&(t.CallId=stateService.getCallUUID());var n=JSON.stringify(t);if(a)if('object'!=typeof a)_.logService.warn(_.LOGTAG,"Ignoring invalid extra data for analytics event"+e+": "+a);else if(JSON.stringify(a).length+n.length>_.GA_CONSTANTS.MAX_LABEL_LENGTH)logService.warn(_.LOGTAG,"Ignoring extra data for analytics event because it was too long");else{for(var C in a)a.hasOwnProperty(C)&&(t[C]=a[C]);n=JSON.stringify(t)}_.logService.debug(_.LOGTAG,"Sending Analytics event "+e+"; category: "+_.category+"; label: "+n+"; value: "+A),_._dispatchEvent(e,n,A)}},_.registerCustomAnalyticsReference=function(e){_.customApiCallback=e},_._dispatchEvent=function(e,a,A){try{switch(serverInjectionService.getGAType()){case _.ANALYTICS_TYPES.NONE:break;case _.ANALYTICS_TYPES.CLASSIC:_._sendGaEvent(e,a,A);break;case _.ANALYTICS_TYPES.UNIVERSAL:_._sendAnalyticsEvent(e,a,A);break;case _.ANALYTICS_TYPES.TAG_MANAGER:_._sendDataLayerEvent(e,a,A);break;case _.ANALYTICS_TYPES.CUSTOM_API:_._sendCustomApiAnalyticsEvent(e,a,A);break;case _.ANALYTICS_TYPES.TEALIUM:_._sendTealiumAnalyticsEvent(e,a,A);break;case _.ANALYTICS_TYPES.CUSTOM:_._sendCustomAnalyticsEvent(_.category,e,a,A);break;case _.ANALYTICS_TYPES.ADOBE:_._sendAdobeAnalyticsEvent(_.category,e,a,A);break;default:_.logService.error(_.LOGTAG,'Invalid analytics type: event cannot be sent')}}catch(e){_.logService.error(_.LOGTAG,"Error dispatching analytics event",e)}},_._sendGaEvent=function(e,a,A){var t=window[_.ANALYTICS_DEFAULT_REFENCE_NAMES.CLASSIC];if(_.validReference(t)){var n=[_.GA_CONSTANTS.TRACK_EVENT,_.category,e,a];A&&n.push(A),t.push(n)}},_._sendAnalyticsEvent=function(e,a,A){var t=window[_.ANALYTICS_DEFAULT_REFENCE_NAMES.UNIVERSAL];if(_.validReference(t)){var n=_.GA_METHOD_STRINGS.SEND,C=serverInjectionService.getGATrackerName();C&&(n=C+"."+n),t(n,_.GA_METHOD_STRINGS.EVENT,_.category,e,a,A)}},_._sendDataLayerEvent=function(e,a,A){var t=window[_.ANALYTICS_DEFAULT_REFENCE_NAMES.TAG_MANAGER];_.validReference(t)&&t.push(_._getDataLayerObject(_.TAG_MANAGER_CONSTANTS.GIS_EVENT_NAME,_.category,e,a,A))},_._sendTealiumAnalyticsEvent=function(e,a,A){var t=window[_.ANALYTICS_DEFAULT_REFENCE_NAMES.TEALIUM];if(_.validReference(t)){var n=clientStorageService.getItem("gis-chat-call-user-uuid");_.event={},_.event.link_cat=_.category,_.event.link_id=e,_.event.link_position='gis_events',_.event.event_name=e,_.event.gis_vuid=n||'',t.link(_.event)}},_._getDataLayerObject=function(e,a,A,t,n){var C={event:e,gisEventCategory:a,gisEventAction:A,gisEventLabel:t};return n&&(C.gisEventValue=n),C},_.validReference=function(e){return e?!(_.hasBeenError=!1):(_.hasBeenError||logService.error(_.LOGTAG,"Couldn't find Analytics reference: no events being sent."),!(_.hasBeenError=!0))},_._sendCustomApiAnalyticsEvent=function(e,a,A){"function"==typeof _.customApiCallback?_.customApiCallback(_.category,e,a,A):_.logService.error(_.LOGTAG,"Failed to send custom analytics event via callback. Invalid event callback specified.")},_._sendAdobeAnalyticsEvent=function(e,a,A,t){var n=window[_.ANALYTICS_DEFAULT_REFENCE_NAMES.ADOBE],C=serverInjectionService.getGATrackerName();if(_.validReference(n))if(window.digitalData)if(C){window.digitalData.event||(window.digitalData.event=[]);var i={eventName:e,eventAction:a,data:JSON.parse(A),value:t||''},l=[];l.push(i),setTimeout(function(){var e=l.shift();e&&(window.digitalData.event.push(e),n.track(C))},100)}else logService.error(_.LOGTAG,"Couldn't find adobe direct-call rule: no events being sent.");else logService.error(_.LOGTAG,"Couldn't find adobe digitalData object: no events being sent.")},_._isEventLoggingAllowed=function(e){if(stateService.isDataCollectionDisabled())return!1;if(!serverInjectionService.getGAType())return!1;if(!e||e&&!validationUtilitiesService.isString(e))return logService.error(_.LOGTAG,"Invalid analytics event: "+e),!1;var a=serverInjectionService.getSystemConfig();if(a.blockedEvents.enabled){var A=a.blockedEvents.events;if(0==A.length)return!0;for(var t=0;t<A.length;t++){var n=A[t];if("string"==typeof n&&n.trim()==e)return!1}}return!0},_._sendCustomAnalyticsEvent=function(e,a,A,t){},overrideService.override(_.LOGTAG,_),{ANALYTICS_EVENTS:_.GIS_EVENT_ACTIONS,setCategory:_.setCategory,sendAnalyticsEvent:_.sendAnalyticsEvent,registerCustomAnalyticsReference:_.registerCustomAnalyticsReference}};GISAPP.gisService=function(logService,serverInjectionService,stateService,gaService,utilitiesService,overrideService,i18nService,mvtService){'use strict';var u={LOGTAG:"gisService"},c=M(),d=function(){var e=serverInjectionService.getBrowserSecurityToken();if(e)return'secToken='+e}(),s='/jsapi/isClerkAvailable',i='/jsapi/booking',o='/jsapi/connecttostore',a="/jsapi/survey",t="/jsapi/saveReview",n="/contact",l="/contact/broadcast/submit",r="/log/activity",p="/jsapi/initiateCall",g="/jsapi/booking/join",f="/connectCall",h="/jsapi/isClerkAvailableByAlias",v="/jsapi/getSecurityToken",U="/jsapi/all-active-broadcasts",y="/jsapi/get-broadcast-event",m="/broadcast/isLiveById",C="/chat/send/message",A="/broadcast/user/add",T="/broadcast/user/update",I="/jsapi/init-info",R="/event/create",b="/jsapi/video-segments",S="/sip/send-dtmf",k="/jsapi/product-carousel",L="/jsapi/add-friend-in-call",P="/jsapi/isClerkAvailable/callAutolaunch",D="/jsapi/connecttostore/callAutolaunch",j="/chat/cometchat/group/{groupUuid}/memberCount",E="/jsapi/product-carousel",B=2e3;function O(t,e,a){var r=document.createElement('script');r.type='text/javascript',r.src=t,utilitiesService.isReferrerPolicyEnable()&&(r.referrerPolicy=utilitiesService.getReferrerPolicy()),r.onload=e,r.onerror=function(e){logService.error(u.LOGTAG,"JSONP request returned an error: "+t,e),a&&a()};try{document.getElementsByTagName('head')[0].appendChild(r)}catch(e){logService.error(u.LOGTAG,"Exception occurred on JSONP call: "+t,e)}}function G(e,t,a,r){var n=serverInjectionService.getGisDomain()+e;if(null!=t&&t.forEach(function(e){n+="/"+e}),a)for(var i=0;i<a.length;i++)n=utilitiesService.addParamToUrl(n,a[i]);return d?(n=utilitiesService.addParamToUrl(n,d),n=utilitiesService.addParamToUrl(n,"referer="+serverInjectionService.getReferer())):(c&&(n=utilitiesService.addParamToUrl(n,c)),serverInjectionService.getRetailerToken()&&(n=utilitiesService.addParamToUrl(n,"retailerToken="+serverInjectionService.getRetailerToken()))),r&&(n=utilitiesService.addParamToUrl(n,"rand="+Math.random())),n}function w(e){for(var t=document.getElementsByTagName('head')[0],a=t.getElementsByTagName('script'),r=0;r<a.length;r++)-1<a[r].src.indexOf(e)&&t.removeChild(a[r])}function N(e,t,a,r,n){var i,l,s=document.getElementsByTagName('head')[0],o=document.createElement('link');o.rel=e,o.type=t,o.href=(i=a,new RegExp('^(?:[a-z]+:)?//','i').test(i)?i:(l=serverInjectionService.getDomain()+i,d?utilitiesService.addParamToUrl(l,d):(c&&(l=utilitiesService.addParamToUrl(l,c)),serverInjectionService.getRetailerToken()&&(l=utilitiesService.addParamToUrl(l,"retailerToken="+serverInjectionService.getRetailerToken())),l))),o.onload=r,o.onerror=n,utilitiesService.isReferrerPolicyEnable()&&(o.referrerPolicy=utilitiesService.getReferrerPolicy());try{s.appendChild(o)}catch(e){logService.error(u.LOGTAG,"Exception while injecting link tag in Head.",e)}}function M(){var e=serverInjectionService.getChromeExtensionToken();if(e)return"q="+e}function x(){return"noCacheParam="+(new Date).getTime()}function K(e,t){return t?"routingKey="+utilitiesService.utf8ToBase64(e.trim()):"routingKey="+encodeURIComponent(e.trim())}function q(){return"locale="+serverInjectionService.getLocale()}return u.isClerkAvailable=function(e,t,a){var r=0,n=serverInjectionService.getSystemConfig();n&&n.clerkAvailabilityReqDelay&&!isNaN(n.clerkAvailabilityReqDelay)&&(r=n.clerkAvailabilityReqDelay),setTimeout(u.isClerkAvailableByAlias.bind(null,null,e,t,a),1e3*r)},u.isClerkAvailableByAlias=function(e,t,a,r){if(!utilitiesService.isHttpsPageRedirected()){var n=[];n.push(t),n.push(a);var i=[];i.push(x()),r&&i.push(K(r,!0)),stateService.getCallUserUUID()&&i.push("callUserUUID="+stateService.getCallUserUUID()),i.push("referer="+utilitiesService.getReferer(!0));var l=s;w(s),e&&(w(l=h),n.unshift(e)),O(G(l,n,i))}},overrideService.override(u.LOGTAG,u),{URL_MAX_SIZE:B,loadScript:O,loadCss:function(e,t){var a=serverInjectionService.getUiConfig().theme&&serverInjectionService.getUiConfig().theme.name||"";N('stylesheet','text/css','/gis/css'+(a?"?theme="+a:""),e,t)},loadExternalCss:function(e,t,a){N('stylesheet','text/css',e,t,a)},getSurveyQuestionsFromCallUUID:function(e){var t=[];t.push("referer="+serverInjectionService.getReferer()),t.push("callUuid="+e),t.push(M()),serverInjectionService.getLocale()&&t.push(q()),O(G(a,null,t))},submitSurveyResult:function(e){O(G(t,null,["payload="+e]))},submitContactDetails:function(e,t,a){var r=[];r.push("payload="+e),r.push(K(stateService.getRoutingKey())),r.push("referer="+serverInjectionService.getReferer()),O(G(n,null,r),function(){gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CONTACT_SUBMISSION),t()},function(){a()})},isBroadcastActiveByBroadcastId:function(e,t,a){w(m);var r=[];e&&r.push("broadcastId="+e),O(G(m,[t],r),function(){},function(){a()})},getVideoSegmentsByBroadcastId:function(e,t){w(b),O(G(b,[e,'GISAPP.replayCtrl.displayVideoSegments']),function(){},function(){'function'==typeof t&&t()})},submitBroadcastContactDetails:function(e,t,a){var r=[];r.push("payload="+e),r.push(K(stateService.getRoutingKey())),r.push("referer="+serverInjectionService.getReferer()),O(G(l,null,r),function(){gaService.sendAnalyticsEvent(gaService.ANALYTICS_EVENTS.CONTACT_SUBMISSION),t()},function(){a()})},getBroadcasts:function(e,t){w(U);var a=[];e&&a.push("gischannel="+e),a.push("referer="+utilitiesService.getReferer(!0)),O(G(U,[t],a))},getBroadcastsEvent:function(e,t,a){if(e){w(y);var r=[];r.push("gisevent="+e),t&&r.push("giskey="+t),r.push("referer="+utilitiesService.getReferer(!0)),O(G(y,[a],r))}},isClerkAvailable:u.isClerkAvailable,isClerkAvailableByAlias:u.isClerkAvailableByAlias,getMeetingStatus:function(e,t){if(!utilitiesService.isHttpsPageRedirected()){var a=[];a.push(t);var r=[];r.push(x()),stateService.getCallUserUUID()&&r.push("callUserUUID="+stateService.getCallUserUUID()),r.push("referer="+utilitiesService.getReferer(!0)),r.push("bookingExtId="+e);var n=i;w(i),O(G(n,a,r))}},connectCall:function(e,t,a,r,n){if(e){var i=[];i.push("callId="+e),a?i.push("referer="+a):i.push("referer="+utilitiesService.getReferer(!0)),t&&i.push(K(t,!0)),n?i.push("chatFirst=true"):i.push("chatFirst=false"),stateService.getCallUserUUID()&&i.push("callUserUUID="+stateService.getCallUserUUID()),i.push();var l=G(o,null,i);O(l+=utilitiesService.addObjectAsParamToUrl(r,"pageMetadata",l,B,"title"))}else logService.warn(u.LOGTAG,"Failed to send call to server. Invalid callId",{call_id:e})},connectSSLCall:function(e,t,a,r,n){var i=[];r&&i.push("callConnectCallback="+encodeURIComponent(r)),t&&i.push(K(t,!0)),stateService.getLogLevel()&&i.push("gis-log="+stateService.getLogLevel()),stateService.getLocale()&&i.push("locale="+stateService.getLocale()),stateService.getPageUUID()&&i.push("pageUUID="+stateService.getPageUUID()),i.push("rk="+serverInjectionService.getRetailerKey()),i.push("callType="+n);var l="https:"+G(f,[e],i);l+=utilitiesService.addObjectAsParamToUrl(a,"pageMetadata",l,B,"title"),window.location.href=l},logActivity:function(e,t){O(G(r,[e,t]))},initiateCall:function(e,t){var a=[];a.push("callbackName="+e),a.push("callType="+t),a.push("referer="+utilitiesService.getReferer(!0)),O(G(p,null,a,!0))},initiateMeetingCall:function(e,t,a){var r=[];r.push("callType="+t),r.push("referer="+utilitiesService.getReferer(!0)),r.push("bookingId="+a),O(G(g+"/"+e,null,r,!0))},getSecurityToken:function(e){O(G(v,[e],null))},logActivityByEndpoint:function(e,t){O(G(e,[t]))},loadHlsJs:function(t,e){"function"==typeof window.require&&'SOFOLOGY'!==serverInjectionService.getRetailerKey()?require(['https://cdn.jsdelivr.net/npm/hls.js@latest'],function(e){window.Hls=e,t()},e):O('https://cdn.jsdelivr.net/npm/hls.js@latest',t,e)},loadVideoJs:function(e,t,a){"function"==typeof window.require&&'SOFOLOGY'!==serverInjectionService.getRetailerKey()?require([e],function(e){window.videojs=e,t()},a):O(e,t,a)},submitQuestion:function(e,t,a,r){w(C),O(G(C,[t],["payload="+e]),a,r)},addCallUser:function(e,t,a){O(G(A,[t,e]),null,a)},sendBroadcastViewDuration:function(e){O(G(T,[e]))},getInitInfo:function(e,t){var a=[];a.push("callUserUUID="+stateService.getCallUserUUID()),a.push("referer="+utilitiesService.getReferer(!0)),serverInjectionService.getLocale()&&a.push(q()),i18nService.getLocaleCategory()&&a.push("ctaMessageKey="+i18nService.getLocaleCategory());var r=mvtService.getEncodedSavedActiveMvt();r&&a.push("mvt="+r),O(G(I,[e],a),null,t)},logEvent:function(e,t,a,r){var n=[];n.push(e),n.push(serverInjectionService.getRetailerKey()),n.push(t),n.push(a),r&&n.push(r),O(G(R,n))},logEventOnStream:function(e,t){var a=serverInjectionService.getSystemConfig().analytics.eventStreamLog.URL,r=""!==a&&"prod"===serverInjectionService.getEnv()?a:serverInjectionService.getGisEventDomain();O(r+="/?retailerKey="+e+"&payload="+t)},sendSipDtmf:function(e){O(G(S,null,e))},getProductsForBroadcast:function(e,t){O(G(k,[e,t]))},initiateAddAFriendCall:function(e,t,a){var r=[];r.push(e),r.push(t);var n=[];n.push("referer="+utilitiesService.getReferer(!0)),n.push("callUUID="+a),O(G(L,r,n,!0))},checkAutoLaunchClerkIsAvailable:function(e,t,a){var r=[];r.push(a),r.push(e),r.push(t);var n=[];n.push("referer="+utilitiesService.getReferer(!0)),O(G(P,r,n,!0))},connectAutoLaunchCall:function(e,t,a){if(e){var r=[];r.push(e);var n=[];n.push("callId="+t),n.push("referer="+utilitiesService.getReferer(!0)),stateService.getCallUserUUID()&&n.push("callUserUUID="+stateService.getCallUserUUID()),n.push();var i=G(D,r,n);O(i+=utilitiesService.addObjectAsParamToUrl(a,"pageMetadata",i,B,"title"))}else logService.error(u.LOGTAG,"Failed to send call to server. Invalid autoLaunchId",{autoLaunchId:e})},getChatMemberCount:function(e,t,a){if(a){var r=j;r=r.replace('{groupUuid}',a);var n=[];n.push(e);var i=[];i.push("referer="+utilitiesService.getReferer(!0)),O(G(r,n,i,!0),null,t)}},getChatSegment:function(e,t){O(e,null,t)},isProductCarouselVersionUpdated:function(e,t,a){O(G(E,[e,'isVersionChanged',t],["version="+a]))}}};GISAPP.globalObjectService=function(){return{getWindow:function(){return window},getDocument:function(){return document}}};GISAPP.i18nService=function(overrideService,serverInjectionService){var a={LOGTAG:"i18nService",getLocaleCategory:function(){},updateLabel:function(e,a){var t=serverInjectionService.getLabels();t[e]=a,serverInjectionService.updateLabels(t)},updateCTAMessage:function(e){a.updateLabel("awarenessCta_message",e)}};return overrideService.override(a.LOGTAG,a),{updateLabel:a.updateLabel,getLocaleCategory:a.getLocaleCategory,updateCTAMessage:a.updateCTAMessage}};GISAPP.iframeService=function(uiUtilitiesService,browserInfoService){return{initializeSourceLessIframeWithScriptInjection:function(r,e,o,a){var c=uiUtilitiesService.createElementWithAttributes('iframe',r+'Iframe',null,"height: 100%;width: 100%; border: none;");function t(){var e=c.contentWindow;if(e.GISAPP={},e.GISAPP.debugMode=-1<window.location.href.indexOf("gis=debug"),e.document.body.append(uiUtilitiesService.createElementWithAttributes('div','root',null,"width: 100%;height: 100%;")),e.document.body.append(uiUtilitiesService.createElementWithAttributes('div','spinner-container',null,"width: 100%;height: 100%;border-radius: 8px;background: #f2f2f2; position: absolute; top: 0; right: 0;")),e.document.getElementById('spinner-container').append(uiUtilitiesService.createElementWithAttributes('div',null,"spinner","")),a.isSrc)c.src=o;else{var t=uiUtilitiesService.createElementWithAttributes('script',null,null,null);t.src=o,(e.document.head||e.document.getElementsByTagName('head')[0]).append(t)}if(a.isCrossCommunication)var n=0,i=setInterval(function(){e.postRobotListener&&(clearInterval(i),gisAppLib.postRobot.send(e,r,a,{timeout:1e4}).then(function(e){console.log(e.source,e.origin)}).catch(function(e){console.error(e)})),50==++n&&clearInterval(i)},200)}return c.frameborder=0,browserInfoService.isFirefox()&&(c.onload=function(){t()}),e.appendChild(c),browserInfoService.isFirefox()||t(),c}}};GISAPP.layoutService=function(eventService,globalObjectService,GIS_CONSTANTS,uiUtilitiesService,deviceInfoService,browserInfoService){var n,r=uiUtilitiesService.getScreenBreakpoints();function e(){var e=globalObjectService.getWindow();return{WIDTH:e.innerWidth,HEIGHT:e.innerHeight}}function i(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.SCREEN_RESIZE,function(e){var n;if(!deviceInfoService.isMobileDevice())for(var i=0;i<r.length;i++){var t=r[i];if(e.WIDTH>=t.minWidth&&e.WIDTH<=t.maxWidth&&e.HEIGHT>=t.minHeight)return n=t}n||(n=r[4]);return n}(e()))}function t(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.WINDOW_SCROLL,e())}function a(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.ORIENTATION_CHANGE,s())}function o(e){eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.SCREEN_RESIZE,e),i()}function u(e){eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.ORIENTATION_CHANGE,e),a()}function h(e){if("string"!=typeof e)return e;for(var n,i=0;i<r.length;i++)r[i].type===e&&(n=r[i]);return n}function s(){var e=globalObjectService.getWindow();return e.screen&&e.screen.orientation?e.screen.orientation.type:e.matchMedia("(orientation: portrait)").matches?'portrait':'landscape'}return(n=globalObjectService.getWindow()).addEventListener('gisUIOpen',function(){if(n.addEventListener('resize',i),n.addEventListener('scroll',t),n.screen&&n.screen.orientation)n.screen.orientation.addEventListener('change',a);else{var e=n.matchMedia("(orientation: portrait)");a(),e.addListener(function(e){a()})}}),n.addEventListener('gisUIClosed',function(){n.removeEventListener('resize',i),n.removeEventListener('scroll',t),n.screen.orientation.removeEventListener('change',a),eventService.unsubscribeAll(GIS_CONSTANTS.EVENT_NAMES.SCREEN_RESIZE),eventService.unsubscribeAll(GIS_CONSTANTS.EVENT_NAMES.WINDOW_SCROLL)}),{resizeCallback:o,applyIf:function(s,c,E,l){function e(e){for(var n=!1,i=0;i<E.length;i++){var t=E[i],r=!1;if('object'==typeof t){var a=h(t.breakpoint),o=globalObjectService.getWindow();switch(t.selector){case"<=":o.innerWidth<=a.maxWidth&&(r=!0);break;case">=":o.innerWidth>=a.minWidth&&(r=!0);break;case"<":o.innerWidth<a.maxWidth&&(r=!0);break;case">":o.innerWidth>a.minWidth&&(r=!0);break;case"=":default:e.type===a.type&&(r=!0)}}if('function'==typeof t&&(r=t.call()),n&&l&&r&&(n=!0),n&&l&&!r&&(n=!1),!l&&r){n=!0;break}}n?s.call():c.call()}E&&s&&(o(e),u(e))},applyFullScreenHeight:function(e){var n=globalObjectService.getWindow();(deviceInfoService.isMobileDevice()&&deviceInfoService.isIos()||deviceInfoService.isIPad())&&!browserInfoService.isSafari()?e.style.height=document.documentElement.clientHeight+"px":e.style.height=n.innerHeight+"px"},removeFullScreenHeight:function(e){e.style.height='auto'},publishResizeEvents:i,publishScrollEvents:t,publishOrientationChangeEvents:a,scrollCallback:function(e){eventService.subscribe(GIS_CONSTANTS.EVENT_NAMES.WINDOW_SCROLL,e),t()},orientationChangeCallback:u,getOrientation:s,getWindowSize:e}};GISAPP.logService=function(stateService,serverInjectionService,utilitiesService){'use strict';var t,i="logService",r="gis-log",c="GIS: ",e="browser-"+serverInjectionService.getEnv(),o="c8f8cb7e-94fd-4e89-ab09-19e7712967f0",l={TRACE:{id:0,name:"TRACE"},DEBUG:{id:1,name:"DEBUG"},LOG:{id:2,name:"LOG"},INFO:{id:3,name:"INFO"},WARN:{id:4,name:"WARN"},ERROR:{id:5,name:"ERROR"}},g=l.WARN,R=l.ERROR;function n(e,r){a(l.INFO,e,r)}function a(e,r,o,n,a){r||(console.warn(i+" log tag missing",""),r="UNKNOWN",s(l.WARN.name,r,"log tag missing")),stateService.getPageStatus()===stateService.pageStatus.UNLOADING&&e.id===l.ERROR.id&&(e=l.WARN),s(e,r,o,n,a),d(e,r,o,n,a)}function s(e,r,o,n,a){if(t){if(!(e.id<g.id)){var i=f();if(!stateService.isStrictLogging()||i.browser&&i.os&&i.deviceType){var s={level:e.name,msg:o,tag:r,phase:stateService.getCurrentPhase(),sysInfo:f(),additionalInfo:a};e.id===l.ERROR.id&&n&&(n instanceof Error?s.error={stack:n.stack,message:n.name+': '+n.message}:s.error=n),s.msg&&(s.msg=s.msg.replace(/:/g,"=")),t.push(s)}}}else console.log("Loggly failed to load or not initialized")}function d(e,r,o,n,a){if(!(e.id<R.id)){var i=[];a&&(i.info=a),n instanceof Error?(i.errorStack=n.stack,i.errorMessage=n.name+': '+n.message):!n||n instanceof Event||(i.errorObject=n);var s='GIS-'+r+': '+o;switch(e.id){case l.TRACE.id:console.trace();break;case l.DEBUG.id:console.debug(s,i);break;case l.LOG.id:console.log(s,i);break;case l.INFO.id:console.info(s,i);break;case l.WARN.id:console.warn(s,i);break;case l.ERROR.id:console.error(s,i);break;default:console.warn(c+"Failed to log to console. Invalid log level "+e.name)}}}function f(){return{env:serverInjectionService.getEnv(),referrer:serverInjectionService.getReferer()||document.location.href,retailer:serverInjectionService.getRetailerName(),callUUID:stateService.getCallUUID(),os:stateService.getOs(),osVersion:stateService.getOsVersion(),browser:stateService.getBrowser(),browserVersion:stateService.getBrowserVersion(),deviceType:stateService.getDeviceType(),deviceName:stateService.getDeviceName()}}return{LOG_LEVELS:l,init:function(){!function(){var e=utilitiesService.getUrlParams()[r];if(e)if(l.hasOwnProperty(e.toUpperCase()))switch(stateService.setLogLevel(e),e.toUpperCase()){case l.TRACE.name:R=l.TRACE;break;case l.DEBUG.name:R=l.DEBUG,g=l.DEBUG;break;case l.LOG.name:R=l.LOG,g=l.LOG;break;case l.INFO.name:R=l.INFO,g=l.INFO;break;case l.WARN.name:R=l.WARN,g=l.WARN;break;case l.ERROR.name:R=l.ERROR,g=l.ERROR}else console.error(c+"Unknown log level= "+e)}(),window._LTracker&&((t=window._LTracker||[]).push({logglyKey:o,sendConsoleErrors:!1,tag:e}),n("logService","LOGGLY intitalized."))},trace:function(){d(l.TRACE)},debug:function(e,r){a(l.DEBUG,e,r)},log:function(e,r){a(l.LOG,e,r)},info:n,warn:function(e,r,o){a(l.WARN,e,r,null,o)},error:function(e,r,o,n){a(l.ERROR,e,r,o,n)}}};GISAPP.mediaService=function(){var i=-1;return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(e){e.forEach(function(e){i=e.label?1:0})}):(i=0,console.log("browser doesn't support media")),{isMicAllowed:function(){return i}}};GISAPP.metadataService=function(logService,serverInjectionService,stateService,overrideService,utilitiesService){'use strict';var c={};return c.LOGTAG="metadataService",c.ogTags=["og:title","og:description","og:price:amount","og:price:currency","og:availability","og:image","og:image:url","og:locale"],c.twitterTags=["twitter:title","twitter:description","twitter:image","twitter:image:url"],c.systemConfig=serverInjectionService.getSystemConfig(),c.customTags=c.systemConfig.customMetadataTags,c.parseMetadata=function(){try{c.metadata={};var t=document.querySelectorAll('meta');c.metadata["Device Type"]=stateService.getDeviceType();for(var e=0;e<t.length;e++){var a=t[e],r=a.getAttribute("property");r&&(c.customTags&&"object"==typeof c.customTags?Object.keys(c.customTags).forEach(function(t){t===r&&a.getAttribute("content")&&(c.metadata[c.customTags[r]]=a.getAttribute("content"))}):-1<r.indexOf("og:")?c.ogTags.forEach(function(t){t===r&&a.getAttribute("content")&&(c.metadata[r.substring(3,r.length)]=a.getAttribute("content"))}):-1<r.indexOf("twitter:")&&c.twitterTags.forEach(function(t){t===r&&!c.metadata[r]&&a.getAttribute("content")&&(c.metadata[r.substring(8,r.length)]=a.getAttribute("content"))}))}c.metadata.title||(c.metadata.title=document.title);var i=c.metadata["price:amount"];if(i){var o=c.metadata["price:currency"];o&&(i+=" "+o,delete c.metadata["price:currency"]),c.metadata.price=i,delete c.metadata["price:amount"]}c.metadata["image:url"]&&(c.metadata.image=c.metadata["image:url"],delete c.metadata["image:url"]);var g=utilitiesService.getLocaleFromHtmlTag()||stateService.getLocale();g&&(c.metadata.locale=g),stateService.setPageMetadata(c.metadata)}catch(t){logService.error(c.LOGTAG,"Error parsing metadata from page",t)}},overrideService.override(c.LOGTAG,c),{parseMetadata:c.parseMetadata}};GISAPP.microComponentService=function(uiUtilitiesService,deviceInfoService){function o(e){var t="gis-secondary-text";return deviceInfoService.isMobileDevice()&&(t+=" gis-mobile"),n(e,{className:t})}function n(e,t){var i=uiUtilitiesService.createElementWithAttributes("div",e.id,t.className,e.style);return e.className&&uiUtilitiesService.addClass(i,e.className),e.text&&(i.innerHTML=e.text),i}return{getTitleComponent:function(e){var t="gis-title";return deviceInfoService.isMobileDevice()&&(t+=" gis-mobile"),n(e,{className:t})},getSubTitleComponent:function(e){var t="gis-sub-title";return deviceInfoService.isMobileDevice()&&(t+=" gis-mobile"),n(e,{className:t})},getSecondaryTextComponent:o,getPrimaryTextComponent:function(e){var t="gis-primary-text";return deviceInfoService.isMobileDevice()&&(t+=" gis-mobile"),n(e,{className:t})},getFooterComponent:function(e){var t="";deviceInfoService.isMobileDevice()&&(t="gis-mobile");var i=n({id:"gis-connectv3-footer"},{className:t});e.footerClass&&uiUtilitiesService.addClass(i,e.footerClass);var s=o({className:e.footerTextClassName,text:e.text});return i.appendChild(s),i}}};GISAPP.mvtService=function(clientStorageService,utilitiesService){'use strict';return{updateActiveMvtInLocalStorageIfChanged:function(e){var t=clientStorageService.getItem(clientStorageService.storageKeys.ACTIVE_MVT);0===e.length&&null===t||(0===e.length&&null!==t?clientStorageService.removeItem(clientStorageService.storageKeys.ACTIVE_MVT):t&&t.length===e.length||clientStorageService.setItem(clientStorageService.storageKeys.ACTIVE_MVT,e))},getEncodedSavedActiveMvt:function(){var e=clientStorageService.getItem(clientStorageService.storageKeys.ACTIVE_MVT);if(e){var t='';for(var n in e)t+=e[n].mvtId+":"+e[n].groupNo,n!=e.length-1&&(t+=',');return utilitiesService.utf8ToBase64(t)}return null}}};GISAPP.otService=function(logService,activityLoggerService,otSession,otPublisher){'use strict';var t="otService",n=null,o=null,l={audio:{isDetected:!1,isAllowed:!1},video:{isDetected:!1,isAllowed:!1}},r=[],c=[];function s(){return window.OT}function u(){e(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_PLUGIN_DOWNLOADED)}function a(){e(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_PLUGIN_CANCELLED)}function e(){for(var e=0;e<n.length;e++)n[e].removeEventListener('click',u);for(var i=0;i<o.length;i++)o[i].removeEventListener('click',a)}return{getOT:s,detectDevices:function(t){if(s())try{s().getDevices(function(e,i){e?t(e,l):function(e,i){for(var t=0;t<e.length;t++){var n=e[t];'audioInput'===n.kind?(l.audio.isDetected=!0,n.deviceId&&n.label&&(l.audio.isAllowed=!0)):'videoInput'===n.kind&&(l.video.isDetected=!0,n.deviceId&&n.label&&(l.video.isAllowed=!0))}i(null,l)}(i,t)})}catch(e){t(e,!1)}},initializePluginInstallationProcess:function(){s().upgradeSystemRequirements(),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_PLUGIN_PROMPTED);try{var e=document.getElementsByClassName("OT_ModalDialog")[0];if(n=e.querySelectorAll("[role=\"OT_download\"]"),o=e.querySelectorAll("[role=\"OT_close\"]"),n)for(var i=0;i<n.length;i++)n[i].addEventListener('click',u);else logService.warn(t,"Failed to find download button on OT plugin dialog, activity will not be sent");if(o)for(i=0;i<o.length;i++)o[i].addEventListener('click',a);else logService.warn(t,"Failed to find cancel button on OT plugin dialog, activity will not be sent")}catch(e){logService.error(t,"Exception while initializing Opentok installation process.",e)}},getMediaDevicesStatus:function(){return l},initSession:function(e,i,t){var n=s().initSession(e,i,t),o=new otSession(n);return o.setUpOTSessionHandlers(),r.push(o),o},initPublisher:function(e,i){var t=s().initPublisher(e,i),n=new otPublisher(t);return n.setUpOTPublisherHandler(),c.push(n),n},log:function(e){s().log(e)},getSessions:function(){return r},getPublishers:function(){return c}}};GISAPP.overrideService=function(){'use strict';return{override:function(n,i){var t=GISAPP[n+"Extension"];if(t)for(var r in t){var e;if(t.hasOwnProperty(r)&&(i[r]=function(){var n=r;return function(){return t[n].apply(i,arguments)}}()),-1<(e=r.indexOf("Extension"))){var o=r.substring(0,e);t.hasOwnProperty(r)&&(i[o]=function(){var n=o,r=i[n].bind({});return function(){return t[n+"Extension"].apply(i,arguments),r.apply(null,arguments)}}())}}}}};GISAPP.pageUnloadService=function(logService,stateService){'use strict';var o="pageUnloadService",e=[],t=window.onbeforeunload;return window.onbeforeunload=function(n){stateService.setPageStatus(stateService.pageStatus.UNLOADING),logService.debug(o,"Executing GIS custom pageUnload functions"),e.forEach(function(n){n()}),t&&t(n)},{registerFunction:function(n){"function"==typeof n?e.unshift(n):logService.warn(o,"Cannot register. Not a function")},unregisterFunction:function(t){"function"==typeof t?e=e.filter(function(n){return n!==t}):logService.warn(o,"Cannot unregister. Not a function")}}};GISAPP.playerUtilService=function(logService){'use strict';var t,e,n=0,r=0,i=!1;function u(e){!i&&!e.target.seeking&&e.target.currentTime>=n&&(r+=e.target.currentTime-n,n=e.target.currentTime)}return{setup:function(e){n=0,i=!1,(t=e).addEventListener("play",function(e){i||e.target.seeking||(n=e.target.currentTime)}),t.addEventListener("pause",function(e){u(e)}),t.addEventListener("timeupdate",function(e){u(e)}),t.addEventListener("seeking",function(e){i=!0}),t.addEventListener("seeked",function(e){n=e.target.currentTime,i=!1})},getWatchedTime:(e=0,function(){return!t||20<r-e?e:e=r}),resetWatchedDuration:function(){t&&(r=n=0,i=!1)}}};GISAPP.pollingService=function(stateService,utilitiesService,clientStorageService){var t={},s=!1;function n(e){var n=clientStorageService.getItem(clientStorageService.storageKeys.POLLING_START_TIMESTAMP+e);return!n||utilitiesService.dateDifferenceInDays(Date.parse(n),new Date)>t[e].expiry}function e(e){clientStorageService.setItem(clientStorageService.storageKeys.POLLING_START_TIMESTAMP+e,utilitiesService.getTimeWithOutMilliSeconds())}function l(e){stateService.isUIActive()&&stateService.getCurrentPhase()!==stateService.phase.BROADCAST_START&&stateService.getCurrentPhase()!==stateService.phase.BROADCAST_PLAYING&&stateService.getCurrentPhase()!==stateService.phase.REPLAY_START&&stateService.getCurrentPhase()!==stateService.phase.REPLAY_PLAYING&&stateService.getCurrentPhase()!==stateService.phase.NO_BROADCAST_AVAILABLE&&!utilitiesService.isDepartmentCall()||stateService.isUIActive()&&stateService.getCurrentPhase()===stateService.phase.EMBED_CALL_INITIATED||!s&&stateService.getPageStatus()===stateService.pageStatus.INACTIVE||0===t[e].subscribers.length||(t[e].poll(),t[e].self&&n(e)&&(clearInterval(t[e].self),t[e].isPolling=!1))}function r(e,n,i){for(var l=0;l<e.length;l++)if(e[l].onSuccess===n||e[l].onFailure===i)return{index:l}}return{BASE_EVENTS:{CLERK_AVAILABILITY_POLLING:"clerkPolling",BROADCAST_POLLING:"broadcastPolling",BROADCAST_VIEW_DURATION_POLLING:"broadcastViewDurationPolling",SCHEDULED_BROADCAST_POLLING:"scheduledBroadcastPolling",AUTO_LAUNCH_CALL_POLLING:"autoLaunchPolling",PRODUCTS_FOR_CAROUSEL_POLLING:"productsForCarouselPolling"},events:t,registerPollingEvent:function(e,n,i){if(!t[e]&&(n||"function"==typeof n.poll)){var l=n.pollArguments||[];void 0===n.pollWithOnSuccessAndFailure&&(n.pollWithOnSuccessAndFailure=!0),n.pollWithOnSuccessAndFailure&&(l.unshift("GISAPP.pollingService.events."+e+".onFailure"),l.unshift("GISAPP.pollingService.events."+e+".onSuccess")),l.unshift(null),t[e]={},t[e].name=e,t[e].expiry=n.expiry||7,t[e].interval=n.interval||1e4,t[e].poll=n.poll.bind.apply(n.poll,l),t[e].isExpired=!0,t[e].isPolling=!1,t[e].onSuccess=function(){0!==t[e].subscribers.length&&t[e].subscribers.forEach(function(e){e.onSuccess()})},t[e].onFailure=function(){0!==t[e].subscribers.length&&t[e].subscribers.forEach(function(e){e.onFailure()})},t[e].self=null,t[e].subscribers=[],i&&(s=i)}},startPollingEvent:function(n){var i=t[n];if(i)try{i&&i._self&&i.isPolling||(t[n].isPolling=!0,l(n)),i._self&&clearInterval(t[n].self),i._self=setInterval(l.bind(null,n),i.interval),e(n)}catch(e){i._self&&clearInterval(t[n].self)}},stopPollingEvent:function(e){var n=t[e];n&&n&&n._self&&n.isPolling&&(clearInterval(n._self),n.isPolling=!1)},unSubscribe:function(e,n,i){if("function"==typeof n&&"function"==typeof i){var l=t[e].subscribers;if(0!==l.length){var s=r(l,n,i);s&&"number"==typeof s.index&&l.splice(s.index,1)}}},subscribe:function(e,n,i){if("function"==typeof n&&"function"==typeof i){var l=t[e].subscribers;0!==l.length&&r(l,n,i)||t[e].subscribers.push({onSuccess:n,onFailure:i})}},resetPollingTimeExpiryForEvent:e,isPollingTimeExpiredForEvent:n}};GISAPP.serverInjectionService=function(){var _scope={host:'gis.goinstore.com',authToken:'$authToken',browserSecurityToken:"$securityToken",dependencyCheckingMaxRetries:"20",dependencyCheckingSleepTime:"2",locale:'$locale',env:'prod',referer:'$referer'};for(var property in _scope.domain="//"+_scope.host,_scope.gisDomain=_scope.domain+"/gis",_scope.gisStaticImagesDomain=_scope.domain+"/static-common/assets/img",_scope.gisStaticDomain=_scope.domain+"/static-common",_scope.gisS3Domain="//static-"+_scope.host,_scope.gisEventDomain="//events-"+_scope.host,_scope.gisStaticRetailerResources=_scope.domain+"/static/rtlr",_scope.gisImagesResources=_scope.gisDomain+"/images/img",_scope.iosEnabled='$retailer.iosEnabled',_scope.retailerKey='RIBBLECYCLES',_scope.retailerName='Ribble Cycles',_scope.googleAnalyticsType='tag manager',_scope.googleAnalyticsTrackerName='$retailer.gaTrackerName',_scope.googleAnalyticsReferenceName="useDefaultGAReferenceName",_scope.apiEnabled='false',_scope.surveyEnabled='true',_scope.tokboxApiKey='46608302',_scope.retailerToken='$retailerToken',_scope.cometChatAuthKey='9c8647bb1a7b4edddbc46486523ac8691b8a6f66',_scope.cometChatAppId='306534b38d546a4',_scope.cometChatRegion='EU',_scope.gisStaticChatDomain=_scope.gisStaticDomain+'/js/chat',_scope.broadcastView="<div class='gis-modal gis-broadcast-reset'> <!-- Modal content --> <div id='gis-broadcast' class='gis-modal-wrap'> <div class='gis-modal-content broadcast-video'> <div class='gis-top-wrapper'> <div id='gis-live-container' class='gis-view-indicator live'></div> </div> <div id='gis-broadcast-video' class='gis-video'> <video id='gis-live-video' class='gis-hls-video-size' playsinline> <source id='gis-live-video-src'> </video> <div class='gis-bottom-wrapper'> <div class='gis-btm-button-wrap'> <div class='gis-live-chat-div'> <div id='gis-specific-shop-page-btn' class='gis-bd-btn gis-shop-specific-page-btn'></div> <div id='gis-rtlr-custom-btn' class='gis-rtlr-custom-btn gis-hide'></div> </div> <div class='gis-go-to-shop-div' style='display: none !important;'> <div id='gis-go-to-shop-btn' class='gis-bd-btn gis-go-to-shop-btn'></div> </div> <div id='gis-broadcast-one-to-one-cta-container'> <div style='display: flex; margin: 15px 5px;'> <div id='gis-cta-wrapper'></div> </div> </div> </div> </div> <div id='gis-broadcast-ended-wrapper' class='gis-hide'> <div id='gis-broadcast-ended-text'></div> </div> <div id='gis-tap-play' class='gis-center-transform'> <img id='gis-tap-play-img' src='' class='gis-connect-panel-img' alt='play button'/> </div> <div id='gis-no-broadcast-msg-container' class='gis-no-broadcast-msg gis-hide'> <div id='gis-no-broadcast-msg' class=' gis-no-broadcast-msg'> <div id='gis-bc-not-found'> <div class='msg-one'></div> <div class='msg-two'></div> </div> <div id='gis-bc-invalid-url'> <div class='msg-one'></div> <div class='msg-two'></div> </div> </div> </div> </div> <div id='gis-extra-buttons' class='gis-broadcast-extra-buttons'> <div id='gis-extra-button-1' class='gis-material-button secondary gis-hide'></div> <div id='gis-extra-button-2' class='gis-material-button primary gis-hide'></div> </div> </div> </div></div>",_scope.callView="<aside id='gis-connect-panel' class='gis-connect-panel' style='z-index: 100;overflow: hidden;position: relative;'> <div id='gis-call-screen' class='gis-call-screen' style='width: 100%;height: 100%;'> <div id='gis-call-head' class='gis-call-head'> <div id='gis-call-userinfo' class='gis-call-userinfo' style='position: absolute; top: 16px; right: 10px; text-align: center; z-index: 1; opacity: 1;'> <div id='gis-userinfo-imageholder' style='background: white none repeat scroll 0% 0%; width: 37px; height: 37px; border-radius: 19px; margin: auto; float: right;'> <div id='gis-clerkImgDivId' class='gis-clerkImg'></div> </div> <div id='gis-userinfo-text' class='gis-clerk-name'></div> </div> <div id='gis-call-signal-container' style='display:none;'></div> <div id='gis-retailer-brand-logo' class='gis-call-live' style='position: absolute;top: 16px;left: 10px;z-index: 9;height: 37px;width: 100px;background-size: contain;background-repeat: no-repeat;background-position: left;'> </div> </div> <div id='gis-callscreen' class='gis-callScreen' style='width: 100%;height: 100%;'> <div id='storevideoParent' class='gis-child'> <div id='gis-mic-share-overlay' class='gis-mic-share-overlay' cndt='micSetupRequired'> <div id='gis-mic-share-icon' class='gis-mic-share-icon'></div> <div id='gis-mic-share-heading' class='gis-mic-share-heading'></div> <div id='gis-mic-share-message' class='gis-mic-share-message'></div> <div id='gis-help-unblock' class='gis-hide'> <div id='gis-help-unblock-button' class='gis-button gis-button-child nobranding gis-text-align icon-arrow-blk gis-cs-overlay-btn'> Not sure how to unblock? </div> </div> </div> </div> <div id='no-video-img-holder' class='gis-child gis-camera-mute gis-hide'></div> <div id='subscribers' class='gis-child'></div> <div id='publisher' class='publisher' style='display: none'> <div id='gis-tap-button-container' style='display: none' class='gis-tap-button-container gis-tap-button'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z' fill='white'/> <path d='M3.5 3H2C0.895447 3 0 3.89539 0 5V6.5C0 6.77612 0.223877 7 0.5 7H1.5C1.77612 7 2 6.77612 2 6.5V5H3.5C3.77612 5 4 4.77612 4 4.5V3.5C4 3.22382 3.77612 3 3.5 3Z' fill='white'/> <path d='M22 3H20.5C20.2239 3 20 3.22382 20 3.5V4.5C20 4.77612 20.2239 5 20.5 5H22V6.5C22 6.77612 22.2239 7 22.5 7H23.5C23.7761 7 24 6.77612 24 6.5V5C24 3.89539 23.1046 3 22 3Z' fill='white'/> <path d='M23.5 17H22.5C22.2239 17 22 17.2238 22 17.5V19H20.5C20.2239 19 20 19.2238 20 19.5V20.5C20 20.7761 20.2239 21 20.5 21H22C23.1046 21 24 20.1046 24 19V17.5C24 17.2238 23.7761 17 23.5 17Z' fill='white'/> <path d='M3.5 19H2V17.5C2 17.2238 1.77612 17 1.5 17H0.5C0.223877 17 0 17.2238 0 17.5V19C0 20.1046 0.895447 21 2 21H3.5C3.77612 21 4 20.7761 4 20.5V19.5C4 19.2238 3.77612 19 3.5 19Z' fill='white'/> </svg> </div> </div> <div id='gis-overlay-container' style='width: 100%; height: 100%; display: flex; justify-content: center; align-items: center'></div> </div> <div id='gis-call-footer' class='gis-call-footer'> <div id='gis-brand-logo' class='gis-brand-logo'></div> </div> </div></aside>",_scope.ctaRoundelView="<div class='gis-cta-reset'> <div id='gis-connect-to-store-tab'> <nav id='gis-cta-container' class='gis-circle'> <div id='gis-roundel-close-button-container'> <div id='gis-roundel-close-button' style='display: none'> <svg viewBox='0 0 560 560'> <circle class='cls-1' style='cursor: pointer' cx='280.5' cy='280.5' r='280.5' /> <polygon style='cursor: pointer' points='391.94 190.02 371.36 169.44 280.68 260.13 189.88 169.33 169.31 189.91 260.1 280.7 169.34 371.46 189.92 392.04 280.68 301.28 371.32 391.93 391.9 371.35 301.25 280.7 391.94 190.02' /> </svg> </div> </div> <div cndt='ctaPreview' id='gis-bd-preview-container' class='gis-bd-preview-container gis-bd-gif-position gis-hide'> <div id='gis-bd-preview' class='gis-bd-preview'></div> <div id='gis-bd-play-container'> <img alt='play button' id='gis-bd-play-btn' class='gis-bd-play-button'> </div> <div id='gis-replay-time' class='gis-hideAll'> <img id='gis-replay-time-icon' alt='time icon'> <div id='gis-replay-time-label'></div> </div> </div> <div cndt='ctaMessage' id='gis-notification-msg-container' class='gis-cta-buttons gis-radius-control gis-cta-buttons-message-bar'> <div id='gis-cta-msg-box' class='gis-cta-msg-box gis-text-align'> <div id='gis-close-broadcast' class='gis-close-X'> <svg viewPort='0 0 12 12' version='1.1' xmlns='http://www.w3.org/2000/svg'> <line x1='1' y1='11' x2='11' y2='1' stroke='black' stroke-width='2' /> <line x1='1' y1='1' x2='11' y2='11' stroke='black' stroke-width='2' /> </svg> </div> <p id='gis-notification-text' class='gis-cta-msg'></p> </div> <div id='gis-legal-notice-div' class='gis-hide'> <div id='gis-legal-notice-msg' class='gis-legal-notice-text'></div> </div> </div> <div id='gis-cta' class='gis-cta-buttons gis-cta-circle gis-cta-l'> <div id='gis-cta-image-container'> <div id='gis-cta-advisor-image' class='gis-cta-image'></div> <div id='gis-cta-call-icon-image' class='gis-cta-image gis-content-align gis-hide'></div> </div> <div id='gis-cta-status-container' style='display:none'> <div id='gis-cta-live-icon' class='gis-cta-live-icon'>LIVE</div> <div id='gis-since-live-time' class='gis-since-live-time'>00:00</div> </div> <div id='gis-cta-indicator' class='gis-cta-indicator'></div> </div> </nav> </div></div>",_scope.ctaTabView="<div id='gis-tabParentdiv' class='gis-tabParentdiv'> <div id='GoInStoreDiv' class='GoInStoreDiv displayblock'> <div cndt='!ctaCustom' id='gis-box-bg' class='gis-box-bg'></div> <a cndt='ctaCustom' id='gis-connect-to-store-tab'> <div id='gis-clerk-notification' class='gis-tab gis-customtab gis-hide'> </div> </a> <a cndt='!ctaCustom' id='gis-connect-to-store-tab'> <div id='gis-clerk-notification' class='gis-hide'> <div id='gis-tabtext' class='gis-tabtext'>Find out more</div> <div id='gis-tab' class='gis-tab'></div> </div> </a> </div></div>",_scope.replayView="<div class='gis-modal gis-replay-reset'> <!-- Modal content --> <div id='gis-replay-modal' class='gis-modal-wrap gis-replay-modal'> <div class='gis-top-wrapper'> <div id='gis-rec-container' class='gis-view-indicator replay' style='display:none'></div> <div class='gis-close-div'> <div id='gis-replay-close' class='gis-close'></div> </div> </div> <div id='gis-replay-video' style='position:relative;display:flex;flex-direction:column'> <div id='gis-pbvideo-container' class='gis-pbvideo-container' oncontextmenu='return false'> <video id='gis-playback-video' class='gis-hls-video-size video-js vjs-big-play-centered' controls='' playsinline> <source id='gis-playback-video-src' type='video/mp4'> </video> <div class='gis-bottom-wrapper'> <div class='gis-btm-button-wrap gis-btm-replay-wrap'> <div class='gis-live-chat-div'> <div id='gis-specific-shop-page-btn' class='gis-bd-btn gis-shop-specific-page-btn'></div> <div id='gis-rtlr-custom-btn' class='gis-rtlr-custom-btn gis-hide'></div> </div> <div class='gis-go-to-shop-div' style='display: none !important;'> <div id='gis-go-to-shop-btn' class='gis-bd-btn gis-go-to-shop-btn'></div> </div> <div id='gis-replay-one-to-one-cta-container'> <div style='display: flex; margin: 15px 5px;'> <div id='gis-cta-wrapper'></div> </div> </div> </div> </div> </div> <div id='gis-extra-buttons' class='gis-broadcast-extra-buttons' style='display:none'> <div id='gis-extra-button-1' class='gis-material-button secondary gis-hide'></div> <div id='gis-extra-button-2' class='gis-material-button primary gis-hide'></div> </div> </div> <div id='gis-segment-drawer'> <div id='gis-segment-container'></div> <div id='gis-powered-by-segment'></div> </div> </div></div>",_scope.replayConnectView="<aside class='gis-modal-v2 gis-replay-reset'> <div class='gis-container-v2'> <a id='boxclose' class='gis-boxclose-v2'></a> <div id='gis-pbvideo-container' class='gis-pbvideo-container' oncontextmenu='return false'> <video id='gis-playback-video' class='video-js gis-video-v2 vjs-big-play-centered' playsinline> <source id='gis-replayConnect-video-src' src='' type='video/mp4'> </video> </div> <div id='gis-replayConnect-banner-toggle-btn'></div> <div id='gis-replayConnect-banner'> <div id='gis-replayConnect-view1' class='gis-replayConnect-banner-content'> <div id='gis-replayConnect-call-btn'> I would like some product advice </div> <div id='gis-replayConnect-arrange-btn'> Arrange to speak at another time </div> </div> <div id='gis-replayConnect-view2' class='gis-replayConnect-banner-content' style='display: none'> <div id='gis-replayConnect-banner-title'> Let's arrange a live product demo at your convenience </div> <input id='gis-replayConnect-contact-input' type='text' placeholder='Email'/> <div id='gis-replayConnect-contact-submit-btn'></div> </div> <div id='gis-replayConnect-view3' class='gis-replayConnect-banner-content' style='display: none;'> <img id='gis-replayConnect-success' alt='success'> Thank you. We'll get in touch shortly. </div> </div> </div></aside>",_scope.views={},_scope.views.modalView="<div id='gis-bg-cover' class='gis-bg-cover'></div><div id='gis-outer-panel2'> <div id='gis-inner-panel' class='gis-inner-panel'> <aside id='gis-modal' class='gis-modal-v2 gis-replay-reset'> <div id='gis-modal-container' class='gis-modal-container-v2 overflow-on'> <div id='gis-modal-close' class='gis-modal-icon-button'> <svg viewBox='0 0 561 561'> <filter id='gis-dropshadow' x='-1' y='-1' width='100' height='100'> <feGaussianBlur stdDeviation='100'/> </filter> <circle class='cls-1 gis-path' stroke-width='30' stroke='#000' style='cursor: pointer' cx='280.5' cy='280.5' r='280.5'/> <polygon style='cursor: pointer' points='391.94 190.02 371.36 169.44 280.68 260.13 189.88 169.33 169.31 189.91 260.1 280.7 169.34 371.46 189.92 392.04 280.68 301.28 371.32 391.93 391.9 371.35 301.25 280.7 391.94 190.02'/> </svg> </div> <div id='gis-info' class='gis-modal-icon-button' style='display: none;'></div> <div id='gis-modal-title'></div> <div id='gis-modal-content'></div> <div id='gis-footer'> <div id='gis-connectv3-disclaimer'></div> </div> <div id='gis-powered-by'></div> </div> </aside> </div></div>",_scope.views.stepsView="<div id='gis-steps'> <svg id='gis-steps-svg' viewBox='0 0 0 25' xmlns='http://www.w3.org/2000/svg'></svg></div>",_scope.views.textFieldView="<div id='gis-input-container-v2'> <input id='gis-field-input' class='gis-v2-textfield'/> <div id='gis-textfield-button' class='gis-v2-form-button'></div> <div class='gis-error-label-container'> <p id='gis-email-error-text' class='gis-error-label'></p> </div></div>",_scope.views.textBoxView="<div id='gis-text-field-wrapper' class='gis-text-field-wrapper'> <textarea id='gis-text-field' class='gis-text-field' placeholder=''></textarea></div>",_scope.views.buttonView="<div id='gis-v3-button' class='gis-v3-button'> <div id='gis-v3-button-icon' class='gis-v3-button-icon'></div> <span id='gis-v3-button-label' style='cursor: inherit;'></span></div>",_scope.views.splitLayoutView="<div id='gis-splitLayout'> <div id='gis-splitLayout-1' class='gis-splitLayout-element gis-splitLayout-1'></div> <div id='gis-splitLayout-2' class='gis-splitLayout-element gis-splitLayout-2'></div></div>",_scope.views.modalContentView="<div id='gis-connectv3-content'> <div id='gis-connectv3-content-container' class='v-center'> <div id='gis-connectv2-image'></div> <div id='gis-connectv3-mainText'></div> <div id='gis-connectv3-mainSubText'></div> <div id='gis-connectv2-center-image'> <div id='gis-connectv2-center-image-label'></div> </div> <div id='gis-connectv3-secondaryText'></div> <div id='gis-connectv3-link'></div> <div id='gis-connectv3-footer'></div> </div> <div id='gis-connectingv3-footer' class='gis-hide'> <div id='gis-connectingv3-disclaimer' class='gis-disclaimer-text'></div> </div></div>",_scope.views.genericModalContentView="$genericModalContentView",_scope.views.modalImageView="<div id='gis-connectv3-imageContainer'> <div id='gis-v2-mainImage'></div> <div id='gis-connectv3-secondImage'></div></div>",_scope.views.modalVideoView="<div id='gis-connectv3-videoContainer'> <video id='gis-connectv3-video' autoplay playsinline muted loop> <source id='gis-connectv3-videoSrc' type='video/mp4'> </video> <div class='gis-connectingv3-content' ></div> <div id='volumeBar' style='width:200px; height:25px; background-color:white;'></div></div>",_scope.views.connectCall2View="$connectCall2View",_scope.views.micShare2View="$micShare2View",_scope.views.rateView="<div id ='gis-rating-wrapper' class='gis-rating-wrapper'> <div id='gis-stars-label' class='gis-stars-label'></div> <div id='gis-stars'class='gis-v2-stars'> <svg> <symbol id='gis-star' viewBox='155 90 100 100'> <polygon id='star-shape' fill='currentColor' points='206 162.5 176.610737 185.45085 189.356511 150.407797 158.447174 129.54915 195.713758 130.842203 206 95 216.286242 130.842203 253.552826 129.54915 222.643489 150.407797 235.389263 185.45085'></polygon> </symbol> </svg> </div> <div id='gis-star-container' class='gis-star-container'> <input type='radio' name='gis-rating' id='1' value='5' > <label for='1'> <svg class='gis-svg-stars'> <use xlink:href='#gis-star'/> </svg> </label> <input type='radio' name='gis-rating' id='2' value='4'> <label for='2'> <svg class='gis-svg-stars'> <use xlink:href='#gis-star'/> </svg> </label> <input type='radio' name='gis-rating' id='3' value='3'> <label for='3'> <svg class='gis-svg-stars'> <use xlink:href='#gis-star'/> </svg> </label> <input type='radio' name='gis-rating' id='4' value='2'> <label for='4'> <svg class='gis-svg-stars'> <use xlink:href='#gis-star' /> </svg> </label> <input type='radio' name='gis-rating' id='5' value='1'> <label for='5'> <svg class='gis-svg-stars'> <use xlink:href='#gis-star' /> </svg> </label> </div></div>",_scope.views.surveyScreenView="<div id='gis-survey-wrap' class='gis-survey-wrap'> <div id='gis-survey-upper-div' class='gis-survey-upper-div'> <div id='gis-survey-upper-div-wrap' class='gis-survey-upper-div-wrap'> </div> </div> <div id='gis-text-error' class='gis-text-error'></div> <div id='gis-survey-lower-div' class='gis-survey-lower-div'> </div></div>",_scope.views.dockedPlayerView="<aside id='gis-cta-video' style='display:none;z-index:999999'> <div id='gis-cta-video-wrap' style='height:100%'> <div id='gis-cta-video-wrap-maximised' cndt='ctaMaximised' style='height: 100%'> <div id='gis-cta-autoplay-btn-max'> <svg viewBox='0 0 600 600' style='overflow: initial'> <circle class='cls-1' stroke-width='40' stroke='green' style='cursor: pointer' cx='280.5' cy='280.5' r='280.5'/> <path id='XMLID_106_' fill='#FFF' style='transform: translate(110px, 120px);display:block;' d='M327,99.8c-5-6.6-14.4-8-21-3L165,202.5L24,96.8c-6.6-5-16-3.6-21,3c-5,6.6-3.6,16,3,21l150,112.5 c2.7,2,5.8,3,9,3c3.2,0,6.3-1,9-3l150-112.5C330.6,115.8,332,106.4,327,99.8z'/> <polygon fill='#FFF' style='cursor: pointer;display:none;' points='391.94 190.02 371.36 169.44 280.68 260.13 189.88 169.33 169.31 189.91 260.1 280.7 169.34 371.46 189.92 392.04 280.68 301.28 371.32 391.93 391.9 371.35 301.25 280.7 391.94 190.02'/> </svg> </div> <div id='gis-cta-video-title-max'></div> <div id='gis-cta-autoplay-fs-btn'> <svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve' fill='#FFF'> <path d='M128,32V0H16C7.2,0,0,7.2,0,16v112h32V54.6l148.6,148.6l22.6-22.6L54.6,32H128z'/> <path d='M496,0H384v32h73.4L308.8,180.6l22.6,22.6L480,54.6V128h32V16C512,7.2,504.8,0,496,0z'/> <path d='M480,457.4L331.4,308.8l-22.6,22.6L457.4,480H384v32h112c8.8,0,16-7.2,16-16V384h-32V457.4z'/> <path d='M180.6,308.6L32,457.4V384H0v112c0,8.8,7.2,16,16,16h112v-32H54.6l148.6-148.6L180.6,308.6z'/> </svg> </div> <div id='gis-cta-video-mute-max'></div> <div id='gis-pbvideo-container-max' class='gis-pbvideo-container' oncontextmenu='return false'></div> </div> <div id='gis-cta-video-wrap-minimised' cndt='ctaMinimised' style='height: 100%'> <div id='gis-cta-video-mute-min'></div> <div id='gis-pbvideo-container-min' class='gis-pbvideo-container' oncontextmenu='return false'></div> <div id='gis-cta-autoplay-content' style='cursor:pointer'> <div id='gis-cta-video-title-min'></div> </div> <div id='gis-cta-autoplay-btn-min'> <svg viewBox='0 0 600 600' style='overflow: initial'> <circle class='cls-1' stroke-width='40' fill='transparent' stroke='green' style='cursor: pointer' cx='280.5' cy='280.5' r='280.5'/> <polygon fill='#FFF' style='cursor: pointer' points='391.94 190.02 371.36 169.44 280.68 260.13 189.88 169.33 169.31 189.91 260.1 280.7 169.34 371.46 189.92 392.04 280.68 301.28 371.32 391.93 391.9 371.35 301.25 280.7 391.94 190.02'/> </svg> </div> </div> <div id='gis-cta-autoplay-pause-bg' style='display:none'> <div id='gis-cta-autoplay-kw-container'> <div id='gis-pause-btn-img' style='height:100%'></div> <div id='gis-pause-btn-label' style='width: 75%;text-align: center;color:white'></div> </div> </div> </div></aside>",_scope.views.availableClerkView="<div id='gis-Clerk-available-container'> <div id='gis-Clerk-available-text-wrapper'> <div class='gis-Clerk-available-text'style='background: #43f943;height: 10px;width: 10px;border-radius: 50%;margin-right: 5px;'></div> <div id='gis-Clerk-available-text' style='font-size: inherit;'></div> </div> <div id='gis-Clerk-available-subContainer' style='height: 50%;display: flex;align-items: center;justify-content: center;'> </div></div>",_scope.views.videoSegmentView="<div id='gis-Video-Segment-container' style='cursor:pointer; height:80px;padding: 0 15px;width: 100%;'> <div id='gis-Video-Segment' style='cursor: inherit;height: 80px;padding: 15px 0;'> <div id='gis-Video-Segment-image' style='cursor: inherit; height: 50px; width: 80px; float: left; background-size: 100%; background-repeat: no-repeat; margin-right: 5px; background-position: center;'> <div id='gis-Video-Segment-Play-bth' class='gis-hide' style='cursor: inherit;width: 100%;height: 100%;background-position: center center;background-size: 60%; background-repeat: no-repeat; background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAA90lEQVR4Ae2aERBCQRQAi8I0nyxp7jTX3CHn3D33XHOHfOIw6pes887snsPO/L///t1b+XESERERERERfub9sHMLLPM9Lqu1WeC/xmPs1QJzGZ9x3W+sAkg858kqgMJ33ObWKsB6Hc9aARZx1QoQV7EAcVULEFexAHFVCxBXsQBxVQsQV7UAcRULEFe1AHEVCxBXtQBxFQsQV7UAcVULEFexAHFVCxBXsQBxVQsQV7EAcU1A9gj1EpdRPmRtJdrMSbbT/dAQzH7qO1YRBLOjRYLZ8brpgqMrpi75CGYX3Y0aOIY9GrchmI2cNfSnGLuMiIiIiIiIiB/Mjsuc+0XgRQAAAABJRU5ErkJggg==)'></div> </div> <div id='gis-Video-Segment-subContainer' style='cursor: inherit; display: flex;flex-direction: column;'> <div id='gis-Video-Segment-title' style='cursor: inherit; height: 34px; font-size: 14px; font-weight: bold; overflow: hidden;'></div> <div id='gis-Video-Segment-time' style='cursor: inherit;font-size: 13px;'></div> </div> </div></div>",_scope.views.humanizedMicShareImageView="<div id='gis-humanized-micshare-wrapper' style='width: 100%;height: 100%;'> <div style='height: 50%;'> <div class='gis-humanized-micshare-img gis-humanized-micshare-no-camera'></div> <div class='gis-humanized-micshare-text'>We won't see you</div> </div> <div style='height: 50%;margin-top: 15px;'> <div class='gis-humanized-micshare-img gis-humanized-micshare-request-mic'></div> <div class='gis-humanized-micshare-text'>We’ll only hear you</div> </div></div>",_scope.views.ctaAwarenessView="<div id='gis-cta-awareness-container' style='display: none'> <div id='gis-cta-awareness-close'> <svg viewBox='0 0 560 560'> <circle class='cls-1' style='cursor: pointer' cx='280.5' cy='280.5' r='280.5' /> <polygon style='cursor: pointer' points='391.94 190.02 371.36 169.44 280.68 260.13 189.88 169.33 169.31 189.91 260.1 280.7 169.34 371.46 189.92 392.04 280.68 301.28 371.32 391.93 391.9 371.35 301.25 280.7 391.94 190.02' /> </svg> </div> <div id='gis-awareness-msg-container'></div></div>",_scope.views.alertView="<div id='gis-alert-container'> <div id='gis-alert-message-container' class='gis-alert-text'></div> <div id='gis-alert-button-container' class='gis-alert-text'></div></div>",_scope.views.callStatusDialogView="<div id='gis-call-overlay-container' style='display: none' class='gis-call-overlay-container'> <div id='gis-call-overlay-loader' class='gis-hide gis-spinner'></div> <div id='gis-call-overlay-messages'> <div id='gis-call-overlay-main-message' class='gis-hide'></div> <div id='gis-call-overlay-sub-message' class='gis-hide'></div> </div> <div id='gis-call-overlay-buttons' class='gis-hide'></div></div>",_scope.views.callControlView="<div id='gis-call-control' class='gis-call-control gis-content-align'></div>",_scope.views.callControllerView="<div id='gis-call-controller' class='gis-content-align gis-fade' style='opacity: 1;'> <div id='gis-footer-bg' class='gis-footer-bg gis-content-align'></div></div>",_scope.views.mediaShareView="<div id='gis-connectv3-content'> <div id='gis-connectv3-content-container' class='v-center'> <div id='gis-ms-container'> <div id='gis-ms-preview-container' class='gis-content-align'> <div id='gis-ms-preview-video-disabled' class='gis-ms-preview-video-disabled'> <svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='46.166px' height='46.36px' viewBox='0 0 46.166 46.36' enable-background='new 0 0 46.166 46.36' xml:space='preserve'> <g> <path fill='#CECECF' d='M46.166,11.127l-9.719,9.719v-8.504c0-1.333-1.096-2.43-2.43-2.43H19l27.166,27.165V11.127z M3.085,0.193 L0,3.28l6.632,6.632H4.86c-1.338,0-2.43,1.096-2.43,2.43v24.298c0,1.338,1.091,2.43,2.43,2.43h29.158 c0.508,0,0.949-0.194,1.311-0.437l7.754,7.726l3.084-3.084L3.085,0.193z' /> </g> </svg> </div> <div id='gis-ms-preview-text' class='gis-alert-text' style='position: absolute;'></div> </div> <div id='gis-ms-switch-container'></div> </div> <div id='gis-ms-title' class='gis-title gis-text-align'></div> <div id='gis-ms-buttons-container'></div> </div></div>",_scope.views.switchView="<div> <div class='gis-switch-container gis-content-align'> <div class='gis-switch-icon gis-content-align'></div> <div class='gis-switch-label gis-text-align'></div> <div id='gis-switch-toggle' class='gis-switch-toggle gis-content-align'> <label class='gis-switch'> <input type='checkbox'> <span class='gis-slider gis-round'></span> </label> </div> </div></div>",_scope.views.callScreenView="<div class='gis-modal gis-call-reset'> <!-- Modal content --> <div id='gis-cs-container' class='gis-modal-wrap gis-content-align'> <div id='gis-inner-container' class='gis-inner-container'> <div id='gis-cs-left-pane'> <div id='gis-std-call-view'></div> <div id='gis-cs-bottom-drawer' style='display: none'></div> <div id='gis-cs-signal-container' style='display:none;'></div> <div id='gis-dial-pad-main-container' style='display: none;'></div> <div id='gis-dial-pad-icon' class='gis-content-align' style='width: 48px; height: 48px; display: none;'> <svg width='16' height='22' viewBox='0 0 16 22' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M8 18C6.9 18 6 18.9 6 20C6 21.1 6.9 22 8 22C9.1 22 10 21.1 10 20C10 18.9 9.1 18 8 18ZM2 0C0.9 0 0 0.9 0 2C0 3.1 0.9 4 2 4C3.1 4 4 3.1 4 2C4 0.9 3.1 0 2 0ZM2 6C0.9 6 0 6.9 0 8C0 9.1 0.9 10 2 10C3.1 10 4 9.1 4 8C4 6.9 3.1 6 2 6ZM2 12C0.9 12 0 12.9 0 14C0 15.1 0.9 16 2 16C3.1 16 4 15.1 4 14C4 12.9 3.1 12 2 12ZM14 4C15.1 4 16 3.1 16 2C16 0.9 15.1 0 14 0C12.9 0 12 0.9 12 2C12 3.1 12.9 4 14 4ZM8 12C6.9 12 6 12.9 6 14C6 15.1 6.9 16 8 16C9.1 16 10 15.1 10 14C10 12.9 9.1 12 8 12ZM14 12C12.9 12 12 12.9 12 14C12 15.1 12.9 16 14 16C15.1 16 16 15.1 16 14C16 12.9 15.1 12 14 12ZM14 6C12.9 6 12 6.9 12 8C12 9.1 12.9 10 14 10C15.1 10 16 9.1 16 8C16 6.9 15.1 6 14 6ZM8 6C6.9 6 6 6.9 6 8C6 9.1 6.9 10 8 10C9.1 10 10 9.1 10 8C10 6.9 9.1 6 8 6ZM8 0C6.9 0 6 0.9 6 2C6 3.1 6.9 4 8 4C9.1 4 10 3.1 10 2C10 0.9 9.1 0 8 0Z' fill='white' /> </svg> </div> </div> <div id='gis-cs-right-pane'> </div> </div> </div></div>",_scope.views.standardCallView="<div id='gis-call-head' class='gis-call-head gis-cv-layer'></div><div id='gis-call-view' class='gis-callScreen'> <div id='gis-call-multi-stream-container'> <div id='gis-scroll-up-button' class='gis-scroll-button' style='display: none'> <svg width='32' height='18' viewBox='0 0 32 18' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M-0.000488431 14.5749L3.75951 18L15.9995 6.87449L28.2395 18L31.9995 14.5749L15.9995 -6.99382e-07L-0.000488431 14.5749Z' fill='white'/> </svg> </div> <div id='gis-call-multi-stream'></div> <div id='gis-scroll-down-button' class='gis-scroll-button' style='display: none'> <svg width='32' height='18' viewBox='0 0 32 18' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M32.0005 3.4251L28.2405 -1.71398e-07L16.0005 11.1255L3.76049 -1.28731e-06L0.000488138 3.4251L16.0005 18L32.0005 3.4251Z' fill='white'/> </svg> </div> </div> <div id='gis-call-screen-overlay-container'></div> <div id='gis-call-video-pause-image' class='gis-child gis-call-video-pause-image' style='display: none'></div></div><div id='gis-product-popup' class='gis-product-popup gis-hide'></div><div id='gis-call-footer' class='gis-call-footer gis-cv-layer gis-content-align'></div>",_scope.views.callTypeView="<div id='gis-call-type-container' class='gis-hide'> <div id='gis-call-type' class='gis-content-align'> <div id='gis-call-type-icon' class='gis-content-align'> <svg width='100%' height='100%' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'> <circle cx='8.00008' cy='8.00002' r='5.33333' fill='#5ADAAC'/> <circle cx='8' cy='8' r='7.5' stroke='#5ADAAC'/> </svg> </div> <div id='gis-call-type-text' class='gis-disclaimer-text gis-white gis-content-align'></div> <div id='gis-call-type-line-icon' class='gis-content-align'> <svg width='1' height='12' viewBox='0 0 1 12' fill='none' xmlns='http://www.w3.org/2000/svg'> <line x1='0.25' y1='1.27491e-08' x2='0.249999' y2='12' stroke='#FAFAFA' stroke-width='0.5'/> </svg> </div> <div id='gis-call-type-user-count' class='gis-disclaimer-text gis-white gis-content-align'></div> </div> <div id='gis-call-type-tooltip-container' style='margin-top: 7px; display: none'> <div id='gis-rectangle' class='gis-rectangle'></div> <div id='gis-call-type-tooltip' class='gis-call-type-tooltip'> <div id='gis-call-type-tooltip-message' class='gis-disclaimer-text gis-white'></div> <div id='gis-call-type-tooltip-button' class='gis-call-type-tooltip-button'></div> </div> </div></div>",_scope.views.callScreenHeaderView="<div id='gis-call-screen-header-container' class='gis-call-screen-header-container'> <div id='gis-call-screen-retailer-logo-container' class='gis-call-screen-retailer-logo-container' style='display: none'> <img src='' alt=''> </div> <div id='gis-call-screen-call-type-container' class='gis-call-screen-call-type-container gis-content-align'></div> <div id='gis-call-screen-user-profile-container' class='gis-call-screen-user-profile-container'></div></div>",_scope.views.userProfileView="<div id='gis-user-profile' class='gis-user-profile'> <div id='gis-user-display-name' class='gis-user-display-name gis-disclaimer-text gis-white'></div> <div id='gis-user-profile-image' class='gis-user-profile-image'></div></div>",_scope.views.toolTipView="<div id='gis-call-type-tooltip' class='gis-call-type-tooltip' style='display: none'> <div id='gis-rectangle' class='gis-rectangle'></div> <div id='gis-call-type-tooltip-message' class='gis-disclaimer-text gis-white'></div> <div id='gis-call-type-tooltip-button'></div></div>",_scope.views.addToBasketRequestView="<div id='gis-call-signal-header' > <div id='gis-call-signal-header-img' style='width: 25px;height: 25px;border-radius: 25px;'></div> <div id='gis-call-signal-header-text' style='padding-left: 15px;color: black;'></div></div><div id='gis-call-signal-info'> <div id='gis-call-signal-info-img' ></div> <div style='padding-left: 5px'> <div id='gis-call-signal-info-addon-type'></div> <div id='gis-call-signal-info-title'></div> <div id='gis-call-signal-info-price'></div> <div id='gis-call-signal-info-size'></div> </div></div><div id='gis-signal-additional-details'> <div id='gis-call-signal-info-care-plan-disclaimer'></div> <div id='gis-call-signal-info-care-plan-detail'></div></div><div id='gis-call-signal-actions'> <div class='gis-v3-button confirmation-btn' style='display: flex;'> <span id='gis-v3-button-label' style='cursor: inherit;'></span> <div class='gis-v3-button-icon' style='display: none;'></div> </div> <div class='gis-v3-button gis-transparent-btn reject-btn' style='margin-top: 0px;margin-bottom: 0px;display: flex;'> <div id='gis-v3-button-icon' class='gis-v3-button-icon' style='display: none;'></div> <span style='cursor: inherit;'></span> </div></div>",_scope.views.chatView="<div id='gis-chat-box-wrap' class='gis-chat-box-wrap'> <div class='gis-close-div'> <div id='gis-broadcast-close' class='gis-close'></div> </div> <!-- live-qa --> <div id='gis-convo-container' class='gis-convo-container'> <div id='gis-convo-line-container' class='gis-convo-line-container'> <div id='gis-convo-line' class='gis-convo-line'></div> </div> <div id='gis-convo' class='gis-convo'> <div id='gis-pinned-post' class='gis-pinned-post'> <div id='gis-heading' class='gis-heading'></div> <div id='gis-msg' class='gis-msg'></div> <div id='gis-img' class='gis-img'></div> </div> </div> </div> <div id='gis-chat-container' class='gis-chat-container'> <div id='gis-chat-container-head'> <div id='gis-powered-by-bc'></div> <div id='gis-char-count' class='gis-char-count gis-hide'></div> </div> <div id='gis-q-panel' class='gis-q-panel'> <div id='gis-text-box-container' class='gis-ques-text-container gis-content-align'> <div id='gis-question-tb' class='gis-text-box gis-editable-text-box' contenteditable='true'></div> <div id='gis-user-name-tb' class='gis-text-box gis-editable-text-box gis-hide' contenteditable='true'></div> <div id='gis-ques-status' class='gis-ques-status gis-hide'></div> </div> <div id='gis-ques-img-container' class='gis-ques-img-container gis-content-align'> <div id='gis-ques-img' class='gis-ques-img gis-ques-submit gis-btn-disabled'></div> <div id='gis-ques-delay' class='gis-ques-delay gis-text-align gis-hide'></div> <div id='gis-sending' class='gis-sending gis-hide'><div></div><div></div><div></div></div> </div> </div> </div></div>",_scope.views.gisPlayerView="<div class='gis-modal gis-replay-reset'> <div id='gis-player-container' class='gis-modal-wrap gis-content-align' style='flex-direction: row'> <div id='gis-player-close-button-container' class='gis-player-close-button-container gis-content-align'> <div id='gis-player-close-button'> <svg viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M16 0C7.17773 0 0 7.17773 0 16C0 24.8223 7.17773 32 16 32C24.8223 32 32 24.8223 32 16C32 7.17773 24.8223 0 16 0ZM22.4713 20.5859C22.7317 20.8462 22.7317 21.2683 22.4713 21.5286L21.5287 22.4713C21.2683 22.7316 20.8463 22.7316 20.5859 22.4713L16 17.8854L11.4141 22.4713C11.1537 22.7316 10.7317 22.7316 10.4713 22.4713L9.52873 21.5286C9.26831 21.2683 9.26831 20.8462 9.52873 20.5859L14.1146 15.9999L9.52873 11.4141C9.26831 11.1537 9.26831 10.7316 9.52873 10.4713L10.4713 9.52865C10.7317 9.26831 11.1537 9.26831 11.4141 9.52865L16 14.1145L20.5859 9.52865C20.8463 9.26831 21.2683 9.26831 21.5287 9.52865L22.4713 10.4713C22.7317 10.7316 22.7317 11.1537 22.4713 11.4141L17.8854 15.9999L22.4713 20.5859Z' fill='white' /> </svg> </div> </div> <div id='gis-player-left-pane'> <div id='gis-mobile-portrait-player-header'> </div> <div id='gis-player-video-container'> <div id='gis-player-video-header' class='gis-player-video-header'></div> <div id='gis-player-overlay-message' class='gis-content-align gis-player-overlay-message gis-hide'> <div id='gis-player-overlay-unmute' class='gis-hide'></div> <div id='gis-player-msg-title' class='gis-player-msg-title'></div> <div id='gis-player-msg-subtitle' class='gis-player-msg-subtitle'></div> <div id='gis-player-msg-text' class='gis-player-msg-text'></div> </div> </div> <div id='gis-product-carousel-container' class='gis-hide'></div> <div id='gis-player-secondary-cta-container' class='gis-player-secondary-cta-container gis-content-align gis-hide'> <div id='gis-player-secondary-cta-icon'> <svg width='25' height='24' viewBox='0 0 25 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M24.0127 16.0748C23.8652 15.983 23.6807 15.9752 23.5264 16.0528L21.2212 17.2056C21.084 16.5191 20.4766 16.0001 19.75 16.0001H13.75C12.292 16.0001 12.25 19.5909 12.25 20.0001C12.25 20.4092 12.292 24.0001 13.75 24.0001H19.75C20.4766 24.0001 21.084 23.481 21.2212 22.7945L23.5264 23.9473C23.5972 23.9825 23.6733 24.0001 23.75 24.0001C23.8413 24.0001 23.9326 23.9752 24.0127 23.9254C24.1602 23.834 24.25 23.6734 24.25 23.5001V16.5001C24.25 16.3267 24.1602 16.1661 24.0127 16.0748Z' fill='#262626' /> <path d='M11.25 12C14.5637 12 17.25 9.31371 17.25 6C17.25 2.68629 14.5637 0 11.25 0C7.93629 0 5.25 2.68629 5.25 6C5.25 9.31371 7.93629 12 11.25 12Z' fill='#262626' /> <path d='M13.75 15H16.7578C17.002 15 17.21 14.8237 17.251 14.5835C17.2915 14.3428 17.1528 14.1079 16.9224 14.0278C14.9644 13.3457 13.0562 13 11.25 13C7.82324 13 4.71484 14.2261 2.71094 15.2549C1.19287 16.0342 0.25 17.5723 0.25 19.2681V20C0.25 21.103 1.14697 22 2.25 22H10.8364C10.9785 22 11.1138 21.9395 11.209 21.8335C11.3037 21.728 11.3491 21.5869 11.3335 21.4453C11.2764 20.9263 11.25 20.4668 11.25 20C11.25 18.4966 11.4937 15 13.75 15Z' fill='#262626' /> </svg> </div> <div id='gis-player-secondary-cta-message' class='gis-player-secondary-cta-message'></div> </div> <div id='gis-ss-player-popup' class='gis-ss-popup-container gis-product-popup'></div> </div> <div id='gis-player-right-pane'> <div id='gis-chat-carousel-toggle-container' class='gis-hide'> <div id='gis-chat-toggle' class='gis-rightPane-toggle'></div> <div id='gis-product-toggle' class='gis-rightPane-toggle'></div> </div> <div id='gis-player-chat-container'> <div class='gis-user-form-container' id='gis-user-form-container' style='display:none;'> <div id='gis-user-title' class='gis-user-title'></div> <div id='gis-user-secondary-title' class='gis-user-title'></div> <div class='gis-user-form' id='gis-user-form'> <div type='text' value='' id='gis-user-form-input' class='gis-user-form-input' data-placeholder='' contenteditable='true'></div> <div id='gis-user-error-msg' class='gis-user-error-msg'> </div> <div id='gis-submit-user-form-btn' class='gis-submit-user-form-btn' type='submit'></div> </div> </div> </div> </div> </div></div>",_scope.views.shopStreamBaseLayoutView="<div id='gis-ss-container' class='gis-shop-stream-container'> <div class='gis-shop-stream-mobile-view gis-shop-stream-row-compact'> <div id='gis-ss-left-pane' class='gis-shop-stream-mobile-view gis-shop-stream-left-pane-compact'> <div id='gis-ss-player-view' class='gis-shop-stream-mobile-view gis-shop-stream-left-vid-compact'> <div id='gis-ss-player-popup' class='gis-ss-hide'></div> </div> <div id='gis-ss-left-bottom-pane' class='gis-shop-stream-mobile-view gis-ss-hide gis-shop-stream-left-carousel-compact'> </div> </div> <div class='gis-shop-stream-mobile-view gis-shop-stream-right-chat-compact gis-rightpane-disabled' id='gis-ss-right-pane'> <div id='gis-ss-wrapper-content' class='gis-ss-wrapper-content'> <div id='gis-ss-chat-content' class='gis-ss-content-wrap gis-ss-chat-content gis-ss-hide'> <div id=''></div> </div> <div id='gis-ss-carousel-content' class='gis-ss-content-wrap gis-ss-carousel-content gis-ss-hide'></div> </div> </div> </div> <div class='gis-shop-stream-chat-carousel-mobile'> </div></div>",_scope.views.baseCallLayoutView="<!-- Player control div for testing only please remove START --><div id='gis-ss-video-controls-bottom' class='gis-ss-video-control-compact'></div><!-- Player control div for testing only please remove END --><!-- Video Player Right Side controls div for testing only please remove START --><div id='gis-ss-video-controls-right' class='gis-shop-stream-mobile-view gis-shop-stream-inner-video-controls'></div><!-- Video Player Right Side controls div for testing only please remove START --><!-- IVR Container --><div id='gis-dial-pad-main-container' class='gis-dial-pad-main-container'></div>",_scope.views.videoPlayerView="<div id='gis-video-container'> <video id='gis-video' playsinline> <source id='gis-video-src' type='video/mp4'> <track id='gis-video-track' kind='captions'> </video> <div id='gis-video-controls-container'> <div id='gis-video-seek-bar-wrapper'> <div id='gis-video-seek-bar'> <div id='gis-buffer'></div> <div id='gis-progress-bar'> <div id='gis-progress-bar-icon'></div> </div> </div> </div> <div id='gis-video-timebar'> <div id='gis-vc-timebar-left'></div> <div id='gis-vc-timebar-right'></div> </div> <div id='gis-video-controls'> <div id='gis-vc-left'></div> <div id='gis-vc-right'></div> </div> </div></div>",_scope.views.shopStreamVideoHeaderView="<div id='gis-player-video-header-container'> <div id='gis-player-video-header-left-pane'> <div id='gis-retailer-logo-container' class='gis-retailer-logo-container gis-content-align'> <div id='gis-retailer-logo' class='gis-retailer-logo'></div> </div> </div> <div id='gis-player-video-header-right-pane' class='gis-content-align'> <div id='gis-player-cta-container' class='gis-player-cta-container'> <div id='gis-player-cta-message-container' class='gis-player-cta-message-container gis-content-align'> <div id='gis-player-cta-message' class='gis-player-cta-message'></div> </div> <div id='gis-player-cta' class='gis-player-cta'></div> </div> </div></div>",_scope.views.shopStreamChatCarouselToggle="<div class='gis-ss-rightpane-header' id='gis-ss-rightpane-header'> <div id='gis-ss-header-content' style='display: flex'> <div id='gis-ss-start-call-btn' class='gis-content-align'></div> <div id='gis-ss-chat-close-btn' class='gis-ss-chat-close-btn'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M12 0C5.3833 0 0 5.3833 0 12C0 18.6167 5.3833 24 12 24C18.6167 24 24 18.6167 24 12C24 5.3833 18.6167 0 12 0ZM16.8535 15.4394C17.0488 15.6346 17.0488 15.9512 16.8535 16.1465L16.1465 16.8535C15.9512 17.0487 15.6347 17.0487 15.4394 16.8535L12 13.4141L8.56061 16.8535C8.3653 17.0487 8.04877 17.0487 7.85345 16.8535L7.14655 16.1465C6.95123 15.9512 6.95123 15.6346 7.14655 15.4394L10.5859 11.9999L7.14655 8.56055C6.95123 8.3653 6.95123 8.04871 7.14655 7.85345L7.85345 7.14648C8.04877 6.95123 8.3653 6.95123 8.56061 7.14648L12 10.5859L15.4394 7.14648C15.6347 6.95123 15.9512 6.95123 16.1465 7.14648L16.8535 7.85345C17.0488 8.04871 17.0488 8.3653 16.8535 8.56055L13.4141 11.9999L16.8535 15.4394Z' fill='#858589'/></svg> </div> </div> <div id='gis-ss-wrapper-tab' class='gis-ss-wrapper-tab'> <div id='gis-ss-chat-tab' class='gis-ss-chat-tab gis-ss-rightpane-tab'> <div id='gis-ss-tab-text-chat' class='gis-ss-tab-text-chat'></div> </div> <div id='gis-ss-carousel-tab' class='gis-ss-carousel-tab gis-ss-rightpane-tab'> <div id='gis-ss-tab-text-carousel' class='gis-ss-tab-text-carousel'></div> </div> </div></div>",_scope.views.dialPadView="<div id='gis-dial-pad-container'> <div id='gis-dial-pad-background-container'></div> <div id='gis-dial-pad-header'> <div id='gis-dial-pad-heading' class='gis-content-align'></div> <div id='gis-dial-pad-close-button' class='gis-content-align'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M12 0C5.3833 0 0 5.3833 0 12C0 18.6167 5.3833 24 12 24C18.6167 24 24 18.6167 24 12C24 5.3833 18.6167 0 12 0ZM16.8535 15.4394C17.0488 15.6346 17.0488 15.9512 16.8535 16.1465L16.1465 16.8535C15.9512 17.0487 15.6347 17.0487 15.4394 16.8535L12 13.4141L8.56061 16.8535C8.3653 17.0487 8.04877 17.0487 7.85345 16.8535L7.14655 16.1465C6.95123 15.9512 6.95123 15.6346 7.14655 15.4394L10.5859 11.9999L7.14655 8.56055C6.95123 8.3653 6.95123 8.04871 7.14655 7.85345L7.85345 7.14648C8.04877 6.95123 8.3653 6.95123 8.56061 7.14648L12 10.5859L15.4394 7.14648C15.6347 6.95123 15.9512 6.95123 16.1465 7.14648L16.8535 7.85345C17.0488 8.04871 17.0488 8.3653 16.8535 8.56055L13.4141 11.9999L16.8535 15.4394Z' fill='#959595'/> </svg> </div> </div> <div id='gis-dial-pad-screen-container' class='gis-content-align'> <div id='gis-dial-pad-screen-and-flashing-pointer-container' style='display: flex;'> <div id='gis-dial-pad-screen' class='gis-content-align'></div> <div id='gis-dial-pad-flashing-pointer' style='display: none;'> <svg width='2' height='21' viewBox='0 0 2 21' fill='none' xmlns='http://www.w3.org/2000/svg'> <rect y='0.513428' width='2' height='20' fill='#23F0C7'/> </svg> </div> </div> <div id='gis-dial-pad-erase-button' class='gis-content-align'> <svg width='24' height='18' viewBox='0 0 24 18' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M22 0H7C6.31 0 5.77 0.35 5.41 0.88L0 9L5.41 17.11C5.77 17.64 6.31 18 7 18H22C23.1 18 24 17.1 24 16V2C24 0.9 23.1 0 22 0ZM22 16H7.07L2.4 9L7.06 2H22V16ZM10.41 14L14 10.41L17.59 14L19 12.59L15.41 9L19 5.41L17.59 4L14 7.59L10.41 4L9 5.41L12.59 9L9 12.59L10.41 14Z' fill='white'/> </svg> </div> </div> <div id='gis-key-pad-container' class='gis-content-align'> <div id='gis-row-1' class='gis-row'></div> <div id='gis-row-2' class='gis-row'></div> <div id='gis-row-3' class='gis-row'></div> <div id='gis-row-4' class='gis-row'></div> </div></div>",_scope.views.productCarouselTileView="<div id='gis-carousel-tile-container' class='gis-carousel-tile-container'> <div class='gis-carousel-tile-image' id='gis-carousel-tile-image'></div> <div class='gis-carousel-tile-infoWrap' id='gis-carousel-tile-infoWrap'> <div class='gis-carousel-tile-info-title' id='gis-carousel-tile-info-title'></div> <div class='gis-carousel-tile-info-price' id='gis-carousel-tile-info-price'></div> <div class='gis-carousel-tile-info-status gis-hide' id='gis-carousel-tile-info-status'></div> </div></div>",_scope.views.sliderView="<div id='gis-slider-container' body-scroll-lock-ignore> <div id='gis-slider-content-container'> <div id='gis-slider-content' class='gis-content-align gis-slider-container-transition'></div> </div> <div id='gis-slider-control-left' class='gis-slider-control-h left gis-content-align'> <svg width='23' height='32' viewBox='0 0 23 32' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M4.63849 0L0.332031 3.76L14.3204 16L0.332031 28.24L4.63849 32L22.9639 16L4.63849 0Z' fill='#262626'></path> </svg> </div> <div id='gis-slider-control-right' class='gis-slider-control-h right gis-content-align'> <svg width='23' height='32' viewBox='0 0 23 32' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M4.63849 0L0.332031 3.76L14.3204 16L0.332031 28.24L4.63849 32L22.9639 16L4.63849 0Z' fill='#262626'></path> </svg> </div></div>",_scope.views.bookingWidgetView="<div id='gis-booking-widget-container'> <div id='gis-booking-widget-header'> <div id='gis-booking-widget-back-button-container'> <div id='gis-booking-widget-back-button-icon'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M21.5 12C21.5 17.2467 17.2467 21.5 12 21.5C6.75329 21.5 2.5 17.2467 2.5 12C2.5 6.75329 6.75329 2.5 12 2.5C17.2467 2.5 21.5 6.75329 21.5 12Z' fill='white' stroke='#0E0E10'/> <path d='M16.793 11.9181L12.2495 7.10951C12.2168 7.0748 12.1779 7.04726 12.1352 7.02846C12.0924 7.00967 12.0465 7 12.0002 7C11.9539 7 11.908 7.00967 11.8653 7.02846C11.8225 7.04726 11.7836 7.0748 11.7509 7.10951L7.20738 11.9181C7.07501 12.0583 7 12.2487 7 12.4473C7 12.8597 7.31658 13.195 7.70596 13.195H8.1847V16.6262C8.1847 16.8329 8.34243 17 8.53768 17H11.2942V14.3831H12.5297V17H15.4627C15.658 17 15.8157 16.8329 15.8157 16.6262V13.195H16.2944C16.482 13.195 16.6618 13.1167 16.7941 12.9753C17.0688 12.6833 17.0688 12.2101 16.793 11.9181Z' fill='#0E0E10'/> </svg> </div> <div id='gis-booking-widget-back-button-message'></div> </div> <div id='gis-booking-widget-close-button-container'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M12.0012 22.0008C17.5247 22.0008 22.0024 17.5234 22.0024 12.0004C22.0024 6.47732 17.5247 2 12.0012 2C6.47769 2 2 6.47732 2 12.0004C2 17.5234 6.47769 22.0008 12.0012 22.0008Z' fill='white'/> <path d='M12.0012 21.5842C17.295 21.5842 21.5864 17.2932 21.5864 11.9999C21.5864 6.70659 17.295 2.41553 12.0012 2.41553C6.70745 2.41553 2.41602 6.70659 2.41602 11.9999C2.41602 17.2932 6.70745 21.5842 12.0012 21.5842Z' stroke='#0E0E10'/> <g opacity='0.85'> <path d='M12.0013 12.0004L8 16L12.0013 12.0004L8 8L12.0013 12.0004L16 8L12.0013 12.0004L16 16L12.0013 12.0004Z' fill='#0E0E10'/> <path d='M12.0013 12.0004L8 16L12.0013 12.0004ZM12.0013 12.0004L8 8L12.0013 12.0004ZM12.0013 12.0004L16 8L12.0013 12.0004ZM12.0013 12.0004L16 16L12.0013 12.0004Z' stroke='#0E0E10'/> </g> </svg> </div> </div> <div id='gis-booking-widget-body'></div></div>",_scope.views.addAPersonView="<div> <div id='gis-popup-header' class='gis-popup-header'> <div id='gis-popup-title' class='gis-popup-title gis-title'></div> <div id='gis-close-popup' class='gis-close-popup gis-icon'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M15.707 8.29297C15.3164 7.90234 14.6836 7.90234 14.293 8.29297L12 10.5859L9.70703 8.29297C9.31641 7.90234 8.68359 7.90234 8.29297 8.29297C7.90234 8.68359 7.90234 9.31641 8.29297 9.70703L10.5859 12L8.29297 14.293C7.90234 14.6836 7.90234 15.3164 8.29297 15.707C8.48828 15.9023 8.74414 16 9 16C9.25586 16 9.51172 15.9023 9.70703 15.707L12 13.4141L14.293 15.707C14.4883 15.9023 14.7441 16 15 16C15.2559 16 15.5117 15.9023 15.707 15.707C16.0977 15.3164 16.0977 14.6836 15.707 14.293L13.4141 12L15.707 9.70703C16.0977 9.31641 16.0977 8.68359 15.707 8.29297Z' fill='#0E0E10' /> <path fill-rule='evenodd' clip-rule='evenodd' d='M12.0008 3.17828C7.12822 3.17828 3.17828 7.12795 3.17828 12C3.17828 16.8721 7.12822 20.8217 12.0008 20.8217C16.8734 20.8217 20.8234 16.8721 20.8234 12C20.8234 7.12795 16.8734 3.17828 12.0008 3.17828ZM2 12C2 6.4771 6.47757 2 12.0008 2C17.5241 2 22.0016 6.4771 22.0016 12C22.0016 17.5229 17.5241 22 12.0008 22C6.47757 22 2 17.5229 2 12Z' fill='#0E0E10' /> </svg> </div> </div> <div id='gis-popup-share-links-wrapper'> <div id='gis-popup-share-email' class='gis-popup-share-icon'> <svg width='16' height='12' viewBox='0 0 16 12' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M7.51531 7.12533C7.66731 7.26333 7.83064 7.33333 7.99998 7.33333C8.16864 7.33333 8.33198 7.264 8.48331 7.12667C9.61664 6.10533 13.47 2.83333 15.666 0.973333C15.7317 0.917576 15.7733 0.838512 15.782 0.75274C15.7907 0.666967 15.7659 0.58116 15.7126 0.513333C15.589 0.353623 15.4305 0.224327 15.2492 0.135349C15.0679 0.0463711 14.8686 7.25897e-05 14.6666 0H1.33331C0.924643 0 0.542643 0.186667 0.286643 0.513333C0.233503 0.581241 0.208746 0.6671 0.217572 0.752876C0.226398 0.838652 0.268121 0.91767 0.333976 0.973333C2.52998 2.83333 6.38331 6.10533 7.51531 7.12533Z' fill='white' /> <path d='M15.8067 1.98141C15.7491 1.95455 15.685 1.9448 15.622 1.95331C15.559 1.96182 15.4998 1.98823 15.4513 2.02941C13.016 4.09407 9.908 6.74007 8.93 7.62141C8.38133 8.11674 7.61933 8.11674 7.06933 7.62141C6.02733 6.68141 2.53667 3.71474 0.549334 2.02941C0.500809 1.98812 0.441468 1.96161 0.378339 1.953C0.31521 1.9444 0.250938 1.95407 0.193135 1.98087C0.135333 2.00767 0.0864203 2.05047 0.0521913 2.1042C0.0179622 2.15794 -0.00014956 2.22036 9.3024e-07 2.28407V10.6667C9.3024e-07 11.4021 0.598001 12.0001 1.33333 12.0001H14.6667C15.402 12.0001 16 11.4021 16 10.6667V2.28407C16 2.22043 15.9818 2.15811 15.9476 2.10448C15.9133 2.05084 15.8644 2.00814 15.8067 1.98141V1.98141Z' fill='white' /> </svg> </div> <div id='gis-popup-share-whatsapp' class='gis-popup-share-icon'> <svg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M0 16L1.13023 11.893C0.431793 10.6876 0.0651209 9.32008 0.0672257 7.92851C0.0672257 3.55526 3.64239 0 8.03342 0C9.0798 9.98581e-05 10.1159 0.205412 11.0826 0.604211C12.0493 1.00301 12.9276 1.58749 13.6674 2.32426C14.4071 3.06103 14.9939 3.93568 15.3941 4.89824C15.7944 5.8608 16.0002 6.89243 16 7.93421C15.9981 12.3075 12.4241 15.8627 8.03342 15.8627H8.02884C6.6989 15.8627 5.39018 15.5308 4.22221 14.8976L0 16ZM4.41892 13.462L4.6607 13.605C5.68103 14.2064 6.84499 14.5238 8.03075 14.5237H8.03342C11.6831 14.5237 14.6532 11.567 14.6547 7.93345C14.6553 6.18512 13.9584 4.50815 12.7172 3.2714C11.476 2.03464 9.79214 1.3394 8.0361 1.33859C4.38378 1.33859 1.41364 4.29453 1.41211 7.92813C1.4102 9.16881 1.76113 10.3847 2.42431 11.4351L2.58206 11.6846L1.91287 14.1184L4.41892 13.462Z' fill='white' /> <path fill-rule='evenodd' clip-rule='evenodd' d='M6.0426 4.61294C5.89363 4.28285 5.73703 4.27639 5.59494 4.27068C5.48035 4.26574 5.3459 4.26612 5.21298 4.26612C5.11215 4.2688 5.01297 4.29221 4.92167 4.33487C4.83037 4.37754 4.74892 4.43855 4.68243 4.51406C4.49985 4.71257 3.98535 5.19173 3.98535 6.16677C3.98535 7.14181 4.69886 8.08416 4.79817 8.21649C4.89748 8.34883 6.17514 10.4134 8.19763 11.2078C9.87826 11.868 10.222 11.7368 10.5864 11.7022C10.9508 11.6676 11.764 11.2226 11.9298 10.7598C12.0955 10.297 12.0959 9.90076 12.0444 9.81786C11.9928 9.73496 11.8622 9.68552 11.6624 9.58665C11.4626 9.48778 10.4848 9.00786 10.3026 8.94207C10.1204 8.87628 9.98712 8.84282 9.85458 9.04133C9.72204 9.23983 9.34046 9.68552 9.22434 9.81786C9.10822 9.9502 8.99211 9.96693 8.79311 9.86768C8.5941 9.76843 7.95279 9.55927 7.1923 8.88427C6.60064 8.35872 6.20111 7.71034 6.08461 7.51183C5.96811 7.31332 6.07239 7.2076 6.17208 7.10759C6.26146 7.0186 6.37109 6.876 6.47078 6.76039C6.57047 6.64479 6.60332 6.56188 6.6694 6.42993C6.73548 6.29797 6.70263 6.18198 6.65297 6.08273C6.60332 5.98347 6.21945 5.00463 6.0426 4.61294Z' fill='white' /> </svg> </div> </div> <div id='gis-popup-content' class='gis-popup-content'> <div id='gis-popup-subtext' class='gis-popup-add-a-person-subtext'></div> <div id='gis-url-container' class='gis-url-container'> <div id='gis-url' class='gis-url'></div> <div id='gis-copy-button-container' class='gis-copy-button-container'> <div id='gis-popup-copy-svg' class='gis-popup-copy-svg'> <svg width='12' height='14' viewBox='0 0 12 14' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M10 0.333336H4C3.26667 0.333336 2.66667 0.933336 2.66667 1.66667V9.66667C2.66667 10.4 3.26667 11 4 11H10C10.7333 11 11.3333 10.4 11.3333 9.66667V1.66667C11.3333 0.933336 10.7333 0.333336 10 0.333336ZM10 9.66667H4V1.66667H10V9.66667ZM0 9V7.66667H1.33333V9H0ZM0 5.33334H1.33333V6.66667H0V5.33334ZM4.66667 12.3333H6V13.6667H4.66667V12.3333ZM0 11.3333V10H1.33333V11.3333H0ZM1.33333 13.6667C0.6 13.6667 0 13.0667 0 12.3333H1.33333V13.6667ZM3.66667 13.6667H2.33333V12.3333H3.66667V13.6667ZM7 13.6667V12.3333H8.33333C8.33333 13.0667 7.73333 13.6667 7 13.6667ZM1.33333 3V4.33334H0C0 3.6 0.6 3 1.33333 3Z' fill='#858589' /> </svg> </div> </div> </div> <div id='gis-popup-warning' class='gis-popup-warning'> <div id='gis-popup-warning-svg' class='gis-popup-warning-svg'> <svg width='13' height='13' viewBox='0 0 13 13' fill='none' xmlns='http://www.w3.org/2000/svg'> <circle cx='6.5' cy='6.5' r='6' fill='#F7D74B' /> </svg> </div> <div id='gis-popup-warning-text' class='gis-popup-warning-text'></div> </div> </div> <div id='gis-popup-alert' style='display: none' class='gis-popup-alert'> <div id='gis-popup-tick-svg' class='gis-popup-tick-svg'> <svg width='22' height='22' viewBox='0 0 22 22' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M11 0C4.93469 0 0 4.93469 0 11C0 17.0653 4.93469 22 11 22C17.0653 22 22 17.0653 22 11C22 4.93469 17.0653 0 11 0ZM17.2823 7.84717L9.35645 15.7731C9.17741 15.9521 8.94287 16.0417 8.70833 16.0417C8.4738 16.0417 8.23926 15.9521 8.06022 15.7731L3.801 11.5138C3.62196 11.3349 3.62196 11.0446 3.801 10.8657L4.449 10.2176C4.62804 10.0386 4.91819 10.0386 5.09722 10.2176L8.70833 13.8288L15.9861 6.55094C16.1651 6.37196 16.4553 6.37196 16.6343 6.55094L17.2823 7.199C17.4614 7.37798 17.4614 7.66819 17.2823 7.84717Z' fill='#0E0E10' /> </svg> </div> <div id='gis-popup-alert-message' class='gis-popup-alert-message'></div> </div> <div id='gis-popup-mobile-share-button-wrapper' class='gis-popup-mobile-share-button-wrapper gis-hide'> <div id='gis-popup-button-share' class='gis-popup-button-share'> <svg width='13' height='15' viewBox='0 0 13 15' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M10.5 10.2199C9.99333 10.2199 9.54 10.4199 9.19333 10.7333L4.44 7.96659C4.47333 7.81325 4.5 7.65992 4.5 7.49992C4.5 7.33992 4.47333 7.18659 4.44 7.03325L9.14 4.29325C9.5 4.62659 9.97333 4.83325 10.5 4.83325C11.6067 4.83325 12.5 3.93992 12.5 2.83325C12.5 1.72659 11.6067 0.833252 10.5 0.833252C9.39333 0.833252 8.5 1.72659 8.5 2.83325C8.5 2.99325 8.52667 3.14659 8.56 3.29992L3.86 6.03992C3.5 5.70659 3.02667 5.49992 2.5 5.49992C1.39333 5.49992 0.5 6.39325 0.5 7.49992C0.5 8.60659 1.39333 9.49992 2.5 9.49992C3.02667 9.49992 3.5 9.29325 3.86 8.95992L8.60667 11.7333C8.57333 11.8733 8.55333 12.0199 8.55333 12.1666C8.55333 13.2399 9.42667 14.1133 10.5 14.1133C11.5733 14.1133 12.4467 13.2399 12.4467 12.1666C12.4467 11.0933 11.5733 10.2199 10.5 10.2199Z' fill='#0E0E10' /> </svg> </div> <div id='gis-popup-button-cancel' class='gis-popup-button-cancel'></div> </div></div>",_scope.views.productPromptView="<div id='gis-ss-carousel-prompt-background'> <div id='gis-ss-carousel-prompt-success-message' class='gis-content-align'></div> <div id='gis-ss-carousel-prompt'></div></div>",_scope.views.informationView="<div id='gis-information-container' style='display: block'> <div id='gis-information-header'> <div id='gis-information-close-button-container'> <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M12.0012 22.0008C17.5247 22.0008 22.0024 17.5234 22.0024 12.0004C22.0024 6.47732 17.5247 2 12.0012 2C6.47769 2 2 6.47732 2 12.0004C2 17.5234 6.47769 22.0008 12.0012 22.0008Z' fill='white'/> <path d='M12.0012 21.5842C17.295 21.5842 21.5864 17.2932 21.5864 11.9999C21.5864 6.70659 17.295 2.41553 12.0012 2.41553C6.70745 2.41553 2.41602 6.70659 2.41602 11.9999C2.41602 17.2932 6.70745 21.5842 12.0012 21.5842Z' stroke='#0E0E10'/> <g opacity='0.85'> <path d='M12.0013 12.0004L8 16L12.0013 12.0004L8 8L12.0013 12.0004L16 8L12.0013 12.0004L16 16L12.0013 12.0004Z' fill='#0E0E10'/> <path d='M12.0013 12.0004L8 16L12.0013 12.0004ZM12.0013 12.0004L8 8L12.0013 12.0004ZM12.0013 12.0004L16 8L12.0013 12.0004ZM12.0013 12.0004L16 16L12.0013 12.0004Z' stroke='#0E0E10'/> </g> </svg> </div> </div> <div id='gis-information-body' class='gis-content-align'> <div id='gis-connectv3-mainText' class='gis-humanized'></div> </div></div>",_scope.views.ctaBarView="<div id='gis-cta-bar-container' class='gis-cta-bar--container'> <div id='gis-bar-msg-container' class='gis-cta-bar--message'></div></div>",_scope.views.popupView="<div id='gis-popup-wrapper'> <div id='gis-popup-container'></div></div>",_scope.views.infoPopupView="<div id='gis-info-popup'> <div id='gis-info-popup-close-button'> <svg width='14' height='14' viewBox='0 0 14 14' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z' fill='#0E0E10'/> </svg> </div> <div id='gis-info-popup-icon'></div> <div id='gis-info-popup-main-text'></div> <div id='gis-info-popup-sub-main-text'></div></div>",_scope.views.replayChat="<div id='gis-replay-chat' class='gis-replay-chat'> <div id='gis-replay-chat-header' class='gis-replay-chat-header'> <div id='gis-replay-chat-header-icon' class='gis-replay-chat-header-icon'> <svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='15.167px' height='18px' viewBox='0 0 15.167 18' enable-background='new 0 0 15.167 18' xml:space='preserve'> <path fill='#212121' d='M2.958,9.254l8.223,8.596c0.105,0.11,0.268,0.146,0.409,0.089c0.142-0.057,0.234-0.194,0.234-0.347v-1.496 c0-0.095-0.036-0.187-0.102-0.256L5.237,8.995l6.485-6.844c0.065-0.069,0.102-0.161,0.102-0.257V0.399 c0-0.152-0.093-0.29-0.234-0.347c-0.045-0.018-0.093-0.027-0.139-0.027c-0.101,0-0.198,0.04-0.271,0.115L2.958,8.737 C2.82,8.882,2.82,9.109,2.958,9.254z' /> </svg> </div> <div id='gis-replay-chat-header-txt' class='gis-replay-chat-header-txt'> <h3>Chat</h3> </div> </div> <div id='gis-replay-chat-content-wrapper' class='gis-replay-chat-content-wrapper'> </div></div>",_scope.views.chatMessageView="<div id='gis-replay-chat-chatbox-left' class='gis-replay-chat-chatbox-left'> <div id='gis-replay-chat-chat-bubble-left' class='gis-replay-chat-chat-bubble-left'></div> <div id='gis-replay-chat-user-info-wrapper' class='gis-replay-chat-user-info-wrapper'> <div id='gis-replay-chat-user-info-time' class='gis-replay-chat-user-info-time' style='display: none'></div> <div id='gis-replay-chat-user-info-detail' class='gis-replay-chat-user-info-detail'></div> </div></div>",_scope.views.ctaPopupView="<div id='gis-cta-popup'> <div id='gis-cta-popup-icon'></div> <div id='gis-cta-popup-main-text'></div> <div id='gis-cta-popup-sub-main-text'></div> <div id='gis-cta-popup-buttons-container'></div></div>",_scope.views.toast="<div id='gis-toast' style='display: none'> <div id='gis-toast-icon' class='gis-content-align'></div> <div id='gis-toast-description' class='gis-content-align'></div> <div id='gis-toast-close' class='gis-content-align'> <svg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M11.6436 9.9802C12.1188 10.4554 12.1188 11.1683 11.6436 11.6436C11.4059 11.8812 11.1089 12 10.8119 12C10.5149 12 10.2178 11.8812 9.9802 11.6436L6 7.66337L2.0198 11.6436C1.78218 11.8812 1.48515 12 1.18812 12C0.891089 12 0.594059 11.8812 0.356436 11.6436C-0.118812 11.1683 -0.118812 10.4554 0.356436 9.9802L4.33663 6L0.356436 2.0198C-0.118812 1.54455 -0.118812 0.831683 0.356436 0.356436C0.831683 -0.118812 1.54455 -0.118812 2.0198 0.356436L6 4.33663L9.9802 0.356436C10.4554 -0.118812 11.1683 -0.118812 11.6436 0.356436C12.1188 0.831683 12.1188 1.54455 11.6436 2.0198L7.66337 6L11.6436 9.9802Z' fill='#0E0E10'/> </svg> </div></div>",_scope.labels={},_scope.labels.awarenessCta_message="Need advice or product info? Live Video call our Team.",_scope.labels.barCta_message="Need help? Video call a human",_scope.labels.awarenessCta_startCallMessage="CALL NOW >",_scope.labels.ctaAutoPlay_minimizedPauseLabel="Tap to keep watching...",_scope.labels.ctaAutoPlay_maximizedPauseLabel="Keep watching",_scope.labels.broadcastViewer_LiveMessage="LIVE",_scope.labels.broadcastViewer_specificShopPageText="BLANK",_scope.labels.broadcastViewer_goToShopPageText="BLANK",_scope.labels.broadcastViewer_broadcastEndedMessage="Broadcast Has Ended",_scope.labels.broadcastViewer_broadcastNotFoundText1="There is currently no content available on this channel.",_scope.labels.broadcastViewer_broadcastNotFoundText2="Please try again later.",_scope.labels.broadcastViewer_invalidBroadcastUrlText1="Sorry, the live Broadcast link you have entered is invalid.",_scope.labels.broadcastViewer_invalidBroadcastUrlText2="Please check you have entered the correct URL and try again.",_scope.labels.broadcastViewer_extraButton1="BLANK",_scope.labels.broadcastViewer_extraButton2="BLANK",_scope.labels.liveQa_pinnedPostHeading="Ask me a Question",_scope.labels.liveQa_pinnedPostMessage="Our presenter will answer your product questions in the live broadcast",_scope.labels.liveQa_chatPlaceholderText="Ask a Question...",_scope.labels.liveQa_namePlaceholderText="Enter your name...",_scope.labels.clerkUnavailableConnectScreen_title="We are currently unavailable or in a call",_scope.labels.clerkUnavailableConnectScreen_primaryText="Try again when the light is green",_scope.labels.clerkUnavailableConnectScreen_weekdayOpeningTime="Mon, Tues, Wed, Fri & Sat: 09:00 - 18:00",_scope.labels.clerkUnavailableConnectScreen_weekendOpeningTime="Thurs: 09:00 - 20:00",_scope.labels.clerkUnavailableConnectScreen_closedTime="Sun: 11:00 - 17:00",_scope.labels.connect_v2_Disclaimer="",_scope.labels.clerkAvailable_message="Product expert available",_scope.labels.directCallScreen_Title="Welcome to your live Ribble showroom visit",_scope.labels.connect_v4_mainText="Get advice and see our products live",_scope.labels.connect_v4_subMainText="You can see us, we can’t see you",_scope.labels.support_info_text="What is this?",_scope.labels.connect_v2_Disclaimer="",_scope.labels.connect_v4_button="Speak with an Expert",_scope.labels.directCallScreen_v3_waiting="Please Wait...",_scope.labels.connect_v3_clerkAvailableText="Available Experts",_scope.labels.callScreenOverlay_reconnecting_label="Reconnecting",_scope.labels.callScreenOverlay_disconnected_label="Could not reconnect Please try again later",_scope.labels.callScreenOverlay_end_call_button_label="End call",_scope.labels.meetingScreen_Title="Welcome to your video appointment",_scope.labels.meetingScreen_subMainText="We won't see you",_scope.labels.meetingScreen_infoText="Waiting for assistant to start call.",_scope.labels.meetingScreen_somethingWentWrongText="Sorry, something went wrong.",_scope.labels.meetingScreen_canceledText="Sorry, the appointment has been cancelled.",_scope.labels.meetingScreen_missedText="You missed your appointment.",_scope.labels.meetingScreen_connectBtnLabel="Join Call",_scope.labels.meetingScreen_waiting="Please Wait...",_scope.labels.meetingScreen_ended="The call has ended",_scope.labels.callStatus_header_connectingToLobby="Connecting to the lobby",_scope.labels.callStatus_header_connectedToLobby="Connected!",_scope.labels.callStatus_footer_connectedToLobby="Please wait for the assistant to join",_scope.labels.callStatus_header_assistantJoining="The assistant is joining",_scope.labels.chat_joinChat_button="Join chat",_scope.labels.chat_userName_firstInput="Username",_scope.labels.chat_userName_infoTooLong="Please enter a username that contains 20 characters or less!",_scope.labels.chat_userName_infoTooShort="Please enter a username that contains at least 3 characters!",_scope.labels.chat_userName_instructions="Help us protect your privacy by using only your first name or nickname.",_scope.labels.chat_userName_title="Want to chat?",_scope.labels.chat_userName_secondary_title="Enter a username",_scope.labels.chat_emoticon_error_msg="Emojis are not allowed",_scope.labels.chat_special_error_msg="Special characters are not allowed",_scope.labels.chat_userName_titleTooLong="Your user name is too long!",_scope.labels.chat_userName_titleTooShort="Your user name is too short!",_scope.labels.chat_userName_tryAgainInput="Try again",_scope.labels.chat_room_full_message="Chat is full. Please try again later.",_scope.labels.micAndCameraSetup_title="",_scope.labels.micAndCameraSetup_allowed="",_scope.labels.micAndCameraSetup_cameraBlocked="",_scope.labels.micAndCameraSetup_micBlocked="",_scope.labels.micAndCameraSetup_micBlockedPreview="",_scope.labels.micAndCameraSetup_allow="",_scope.labels.micAndCameraSetup_awaitingPermission="",_scope.labels.micAndCameraSetup_cancel="",_scope.labels.micAndCameraSetup_continue="",_scope.labels.addToBasket_acceptBtn="",_scope.labels.addToBasket_rejectBtn="",_scope.labels.awarenessCta_startBroadcastMessage="",_scope.labels.shopStream_live_indicator="",_scope.labels.shopstream_status="",_scope.labels.dialPadHeading="",_scope.labels.dialPadSubmitButton="",_scope.labels.dialPadInfoMessage="",_scope.labels.dialPadSubmittedMessage="",_scope.labels.shopStream_cta_message="",_scope.labels.shopStream_secondary_cta_message="",_scope.labels.mobile_chat_toggle_label="",_scope.labels.mobile_product_toggle_label="",_scope.labels.broadcastViewer_broadcastEventEnded1="",_scope.labels.broadcastViewer_broadcastEventEnded2="",_scope.labels.broadcastViewer_broadcastEventToBegin="",_scope.labels.broadcastViewer_clickToUnmute="",_scope.labels.broadcastViewer_tapToUnmute="",_scope.labels.bookingWidget_back_button_message="",_scope.labels.product_popup_addAPerson_title="",_scope.labels.product_popup_addAPerson_subtitle="",_scope.labels.product_popup_addAPerson_warning_text="",_scope.labels.product_popup_addAPerson_alert_text="",_scope.labels.product_popup_addAPerson_share_button_text="",_scope.labels.product_popup_addAPerson_cancel_button_text="",_scope.labels.add_a_person_call_has_ended_main_text="",_scope.labels.add_a_person_call_has_ended_sub_main_text="",_scope.labels.add_a_person_start_new_call_button_text="",_scope.labels.sessionFull_main_text="",_scope.labels.product_carousel_prompt_message="",_scope.labels.product_popup_details_label="",_scope.labels.product_popup_more_info_label="",_scope.labels.awarenessCta_unavailableBookCall="",_scope.labels.awarenessCta_unavailableMessage="",_scope.labels.social_browser_popup_main_text="",_scope.labels.social_browser_popup_sub_main_text="",_scope.labels.directCallScreen_connectBtnLabel="",_scope.labels.mic_needed_popup_title="",_scope.labels.mic_needed_popup_subtitle="",_scope.labels.mic_needed_popup_primary_button_label="",_scope.labels.external_chat_button_label="",_scope.labels.start_chatonly_call_button_label="",_scope.labels.chat_inactivity_popup_title="",_scope.labels.chat_inactivity_popup_subtitle="",_scope.labels.chat_inactivity_popup_primary_button_label="",_scope.labels.chat_inactivity_popup_secondary_button_label="",_scope.labels.chat_to_call_transition_cta_label="",_scope.labels.chat_to_call_transition_popup_title="",_scope.labels.chat_to_call_transition_popup_subtitle="",_scope.labels.chat_to_call_transition_popup_primary_btn_label="",_scope.labels.chat_to_call_transition_popup_secondary_btn_label="",_scope.labels.incoming_call_popup_title="",_scope.labels.incoming_call_popup_primary_btn_label="",_scope.labels.incoming_call_popup_secondary_btn_label="",_scope.labels.end_call_popup_title="",_scope.labels.end_call_popup_subtitle="",_scope.labels.end_call_popup_primary_btn_label="",_scope.labels.end_call_popup_secondary_btn_label="",_scope.labels.call_declined_popup_title='',_scope.labels.call_declined_popup_text='',_scope.labels.call_declined_popup_primary_btn_label='',_scope.labels.call_declined_toast_message='',_scope.labels.connecting_v2_chatText='',_scope)_scope.hasOwnProperty(property)&&_scope[property].indexOf&&-1<_scope[property].indexOf("$")&&(_scope[property]="");var avoidEvalSquash="";function parseSystemConfig(e){return JSON.parse(e)}function updateLabels(e){_scope.labels=e}return eval("var $"+avoidEvalSquash+"retailerConfigAsJson= '{}'"),_scope.retailerConfig={"uiConfig":"{ \"cta\": { \"animation\": { \"mobile\": true, \"desktop\": true, \"enabled\": false, \"iconType\": \"phone\" }, \"imageFormatOverride\": { \"format\": \"webp\", \"enabled\": false, \"postfix\": \"-animated\" } }, \"theme\": { \"mainColor\": \"#00B3E3\", \"brandColor\": { \"color\": \"#78b7c6\", \"enabled\": false }, \"backgroundColor\": \"#F3F4F6\", \"foregroundColor\": \"#000000\" }, \"ctaSize\": \"Medium\", \"ctaType\": \"humanized\", \"ctaCustom\": false, \"ctaPosition\": \"right\", \"gisBranding\": true, \"ctaBarMessage\": { \"mobile\": true, \"desktop\": false, \"enabled\": false, \"slideOutDelay\": \"6\", \"slideShowTimeOut\": \"5\" }, \"ctaCallPreview\": { \"mobile\": false, \"desktop\": false }, \"micSetupVersion\": 3, \"supportInfoLink\": \"https://www.ribblecycles.co.uk/liveinstoreexperts\", \"brandLegalNotice\": false, \"disclaimerSurvey\": false, \"liveScheduleLink\": \"\", \"showClerkProfile\": true, \"availableClerkList\": [], \"autoStartDirectCall\": false, \"ctaAwarenessMessage\": { \"delay\": { \"mobile\": 2, \"desktop\": 2, \"enabled\": false }, \"enabled\": [\"clerk\",\"broadcast\"], \"broadcast\": false, \"isEnabledOn\": { \"mobile\": true, \"desktop\": true }, \"reshowDuration\": 1 }, \"ctaBroadcastPreview\": { \"mobile\": false, \"desktop\": false }, \"showAvailableClerks\": false, \"connectScreenHumanized\": true }","systemConfig":"{\"ios\": {\"chrome\": true, \"safari\": true, \"firefox\": true, \"facebook\": true, \"instagram\": true}, \"linux\": {\"opera\": false, \"chrome\": true, \"firefox\": true}, \"cookie\": {\"optIn\": false, \"enabled\": false}, \"android\": {\"opera\": true, \"chrome\": true, \"firefox\": true, \"facebook\": true, \"instagram\": true, \"samsungbrowser\": true}, \"booking\": {\"url\": {\"default\": \"\"}, \"enabled\": false, \"addAPerson\": false, \"twoWayVideo\": {\"enabled\": false}, \"multiParticipant\": false, \"openBookingWidgetInNewTab\": true, \"isEnabledForUnavailableCta\": false}, \"referer\": {\"queryParam\": {\"enabled\": true}}, \"windows\": {\"ie\": false, \"edge\": true, \"opera\": true, \"chrome\": true, \"firefox\": true}, \"oneToOne\": {\"addAPerson\": {\"enabled\": false}, \"inCallChat\": {\"enabled\": false}, \"twoWayVideo\": {\"enabled\": false}, \"isShopStreamCall\": {\"enabled\": false, \"isChatFirstCall\": {\"enabled\": false}, \"productCarousel\": {\"enabled\": false}}}, \"analytics\": {\"enabled\": false, \"eventStreamLog\": {\"URL\": \"https://analytics-event.goinstore.com\"}}, \"broadcast\": {\"enabled\": true, \"polling\": {\"enabled\": true}}, \"macintosh\": {\"opera\": true, \"chrome\": true, \"safari\": true, \"firefox\": true}, \"shopStream\": {\"chat\": {\"type\": \"group\", \"enabled\": true}, \"enabled\": true, \"productCarousel\": {\"enabled\": true}, \"isChatReplayEnabled\": false}, \"captureInfo\": {\"views\": {\"replay\": false, \"broadcast\": false, \"clerkUnavailable\": true}}, \"goToShopBtn\": {\"url\": \"\", \"redirect\": \"tab\"}, \"oneToOneCta\": {\"broadcast\": true}, \"noVideoImage\": false, \"skipMicShare\": false, \"blockedEvents\": {\"events\": [], \"enabled\": false}, \"persistentCta\": true, \"questionDelay\": 30, \"embedBroadcast\": {\"enabled\": false}, \"referrerPolicy\": {\"enable\": false, \"policy\": \"no-referrer-when-downgrade\"}, \"isNewCallScreen\": true, \"privacySettings\": {\"optInAnalytics\": false}, \"specificPageBtn\": {\"url\": \"\", \"redirect\": \"tab\"}, \"broadcastEnabled\": true, \"oneToOneEngagement\": {\"src\": {\"replay\": false, \"serviceIntro\": true}, \"enabled\": true, \"reshowDuration\": 1}, \"imageFormatOverride\": {\"format\": \"webp\", \"enabled\": false}, \"isRoundelCloseButton\": false, \"replayConnectEnabled\": false, \"apiConnectScreenEnabled\": false, \"externalChatIntegration\": {\"isEnabled\": false, \"onConnectScreen\": false, \"onUnavailableScreen\": false}, \"singleCtaDefaultService\": \"clerk\", \"ctaAwarenessMessageDelay\": {\"mobile\": 2, \"desktop\": 2, \"enabled\": false}, \"oneToOneServiceIntroVideoEnabled\": true}"},_scope.dependencyCheckingMaxRetries=parseInt(_scope.dependencyCheckingMaxRetries),_scope.dependencyCheckingSleepTime=1e3*parseInt(_scope.dependencyCheckingSleepTime),_scope.browserVersion=_scope.browserVersion?parseFloat(_scope.browserVersion):-1,_scope.systemConfig=_scope.retailerConfig.systemConfig?parseSystemConfig(_scope.retailerConfig.systemConfig):{},_scope.uiConfig=_scope.retailerConfig.uiConfig?JSON.parse(_scope.retailerConfig.uiConfig):{},_scope.apiEnabled=!0===_scope.apiEnabled||'true'===_scope.apiEnabled,_scope.iosEnabled=!0===_scope.iosEnabled||'true'===_scope.iosEnabled,window.authToken=_scope.authToken,eval("var $"+avoidEvalSquash+"customRetailerFunctionality = ''"),eval("var $"+avoidEvalSquash+"gisGaCustomImpl = ''"),GISAPP.ctaRoundelDOMProcExtension = (function(){

    function _initExtension(){
        this._borderColor = '#00B3E3';
        this._boxShadow = '0 1px 0px 0 #00B3E3';
        this._liveBorderColor = '#00B3E3';
        this._liveBoxShadow = '0 1px 0px 0 #00B3E3';
        this._liveBackground = "#fff";
        this._liveTextBackground = "#fff";
        this._liveTextColor = "#000";
        this._liveTimerTextColor = "red";
    }
    return{
        _initExtension: _initExtension
    };
})(),

GISAPP.initCtrlExtension = (function(){
    var scope;

    //TODO: Fix this properly in core i.e. wait for video-JS to load before showing replay-UI
    //extending init of core initCtrl
    function initExtension(){
        scope = this;
        scope.isVideoJsLoaded = false;

        var VIDEOJS_URL = "https://vjs.zencdn.net/7.4.1/video.js";
        var VIDEOJS_CSSURL = "https://vjs.zencdn.net/7.4.1/video-js.css";
        GISAPP.gisService.loadVideoJs(VIDEOJS_URL, function(){
            GISAPP.gisService.loadExternalCss(VIDEOJS_CSSURL,
                function(){
                    scope.isVideoJsLoaded = true;
                    scope.initGIS();
                },
                function(e){GISAPP.logService.error(scope.LOGTAG, "Failed to load VideoJs css for Ribble-Cycles" + e);});
        }, function (e){
            GISAPP.logService.error(scope.LOGTAG, "Failed to load VideoJs js for Ribble-Cycles " + e);
        });
    }

    //overriding initGIS of core initCtrl
    function initGIS(){
        try {
            if(!scope.cssReceived || !scope.otReceived || !scope.initInfoReceived || !scope.isVideoJsLoaded) return;
            GISAPP.uiUtilitiesService.setupGISPanels();
            GISAPP.logService.log(scope.LOGTAG, "GIS loaded.");
            scope.executeOnGisLoadFunctions();
            scope.gisReady();
        } catch (e) {
            GISAPP.logService.error(scope.LOGTAG, "Failed to initialize due to exception.", e);
        }
    }

    /********** INTERFACE **********/

    return{
        initExtension: initExtension,
        initGIS: initGIS
    };

})()


,null,{getChromeExtensionToken:function(){return _scope.authToken},getMaxRetriesForDependencyChecking:function(){return _scope.dependencyCheckingMaxRetries},getTimeoutForDependencyChecking:function(){return _scope.dependencyCheckingSleepTime},getBrowserSecurityToken:function(){return _scope.browserSecurityToken},getLocale:function(){return _scope.locale},getEnv:function(){return _scope.env},getReferer:function(){return _scope.referer},getDomain:function(){return _scope.domain},getGisDomain:function(){return _scope.gisDomain},getStaticImagesDomain:function(){return _scope.gisStaticImagesDomain},getStaticRetailerResources:function(){return _scope.gisStaticRetailerResources},getImagesResources:function(){return _scope.gisImagesResources},getGisStaticChatDomain:function(){return _scope.gisStaticChatDomain},getGisStaticDomain:function(){return _scope.gisStaticDomain},getGisStaticDomainS3:function(){return _scope.gisS3Domain},getGisEventDomain:function(){return _scope.gisEventDomain},iosEnabled:function(){return _scope.iosEnabled},getRetailerKey:function(){return _scope.retailerKey},getRetailerName:function(){return _scope.retailerName},getGAType:function(){return _scope.googleAnalyticsType},getGATrackerName:function(){return _scope.googleAnalyticsTrackerName},getGAReferenceName:function(){return _scope.googleAnalyticsReferenceName},getApiEnabled:function(){return _scope.apiEnabled},getSurveyEnabled:function(){return _scope.surveyEnabled},getSystemConfig:function(){return _scope.systemConfig},getTokboxApiKey:function(){return _scope.tokboxApiKey},getRetailerToken:function(){return _scope.retailerToken},getCometChatAuthKey:function(){return _scope.cometChatAuthKey},getCometChatAppId:function(){return _scope.cometChatAppId},getCometChatRegion:function(){return _scope.cometChatRegion},getUiConfig:function(){return _scope.uiConfig},isAutoStartDirectCallEnabled:function(){return _scope.uiConfig&&_scope.uiConfig.autoStartDirectCall},getBroadcastView:function(){return _scope.broadcastView},getCallView:function(){return _scope.callView},getConnectCall2View:function(){return _scope.connectCall2View},getCtaRoundelView:function(){return _scope.ctaRoundelView},getCtaTabView:function(){return _scope.ctaTabView},getReplayView:function(){return _scope.replayView},getReplayConnectView:function(){return _scope.replayConnectView},getViews:function(){return _scope.views},getLabels:function(){return _scope.labels},updateLabels:updateLabels}};GISAPP.shopStreamService=function(serverInjectionService){'use strict';var n=serverInjectionService.getSystemConfig().shopStream;function e(){return n&&n.enabled}function r(e){if(!e)return!1;if('replay'==e.type)return!!n.isChatReplayEnabled&&e.isChatProcessed;var t=n.chat&&n.chat.type&&n.chat.enabled,r=a(e.config);return void 0!==r?r:t}function a(e){return e&&e.chat&&e.chat.type&&e.chat.enabled}return{isShopStreamEnabled:e,isChatTypeQuestion:function(e){if(!e)return!1;var t=r(e);return a(e.config)?t&&'question'===e.config.chat.type:t&&'question'===n.chat.type},isChatEnabledForShopStream:r,isProductCarouselEnabledForShopStream:function(){return e()&&n.productCarousel&&n.productCarousel.enabled}}};GISAPP.stateService=function(utilitiesService,GIS_CONSTANTS){'use strict';var e,n,o,r,i,u,a,c,s,f,A,g,I,d,C,t={SCRIPT_INIT:"SCRIPT_INIT",READY:"READY",CALL_INITIATING:"CALL_INITIATING",CALL_INITIATED:"CALL_INITIATED",IN_CALL:"IN_CALL",CALL_END:"CALL_END",BROADCAST_START:"BROADCAST_START",BROADCAST_PLAYING:"BROADCAST_PLAYING",BROADCAST_END:"BROADCAST_END",REPLAY_START:"REPLAY_START",REPLAY_PLAYING:"REPLAY_PLAYING",REPLAY_END:"REPLAY_END",EMBED_CALL_INITIATED:"EMBED_CALL_INITIATED",NO_BROADCAST_AVAILABLE:"NO_BROADCAST_AVAILABLE"},T="",l="",L=!1,N=!1,m={},D=t.SCRIPT_INIT,S=!1,R=!1,B=!1,E=!1,h={},p=!1,O=!1,_=!1,P=!1,y=!1,v={},U=null,b=!1,k="CHECKING",V="CHECKED",G="",w={UNLOADING:"UNLOADING",INACTIVE:"INACTIVE",ACTIVE:"ACTIVE"},x=w.ACTIVE,M={oneToOne:k,broadcast:k},Y=GIS_CONSTANTS.INPUT_ALIGNMENT.LTR,K={},F=1,j={},J=["opera","chrome","firefox","samsungbrowser","safari","edge","facebook","instagram"],q=!1;function z(t){var e=h.deviceName;if(t&&e&&e.match(/linux/i))return'linux';var n=h.osName;return n&&(n=n.toLowerCase()),'mac os x'==n&&(n='macintosh'),n}function H(){var t=h.text,e=h.browserName;return e?('internet explorer'===(e=e.toLowerCase())&&(e='ie'),e.match(/firefox/i)&&(e='firefox'),z().match(/ios/)?(t.match(/FBIOS/)&&(e="facebook"),t.match(/instagram/)&&(e="instagram")):z().match(/android/)&&(t.match(/FBAV/i)&&(e="facebook"),t.match(/Instagram/i)&&(e="instagram")),-1===J.indexOf(e)&&(e="other"),e):""}return{getOs:z,getBrowser:H,getBrowserVersion:function(){return h.browserVersion},getOsVersion:function(){return h.osVersion},getDeviceName:function(){var t=h.deviceName;return t&&(t=t.toLowerCase()),t},getDeviceType:function(){var t=h.deviceType;return t&&(t=t.toLowerCase()),t},getUserAgent:function(){return h.text},getCallUUID:function(){return e},getLogLevel:function(){return n},getRoutingKey:function(){var t;return"object"==typeof(t=l||T)?JSON.stringify(t):t},getCallStartTime:function(){return o},getBroadcasts:function(){return m.gisBroadcasts||[]},getBroadcastById:function(t){for(var e=0;e<m.gisBroadcasts.length;e++){var n=m.gisBroadcasts[e];if(n.id===t)return n}},getClerkAvailability:function(){return L},getChatInitiated:function(){return R},getChatInitialized:function(){return B},getSessionReconnected:function(){return E},getChatUserName:function(){return G},getCallUserUUID:function(){return r},getBroadcastResponse:function(){return m},getCurrentPhase:function(){return D},getViewerRecId:function(){return c},getPageUUID:function(){return i},getABTestId:function(){return s},getABTestGroup:function(){return f},getAPIStandardJourney:function(){return S},getLocale:function(){return g},getTokBoxApiKey:function(){return I},getPageMetadata:function(){return v},getAutoLaunchId:function(){return a},isDataCollectionDisabled:function(){return _},isUIActive:function(){return N},isOneToOneChecked:function(){return M.oneToOne===V},isBroadcastChecked:function(){return M.broadcast===V},getCanceledOnConnectingScreen:function(){return p},getCallInitiatedWhileCanceling:function(){return O},getOneToOneAutoPlay:function(){return U},getPageStatus:function(){return x},isStrictLogging:function(){return P},isEmbed:function(){return b},getUpdateMessageId:function(){return C},setIsCtaCustomMessage:function(t){y=t},setCallUUID:function(t){e=t},setAutoLaunchId:function(t){a=t},setLogLevel:function(t){n=t},setRoutingKey:function(t){T=t},setActiveCallRoutingKey:function(t){l=t},setCallStartTime:function(t){return o=t},setClerkAvailability:function(t){L=t},setChatInitiated:function(t){R=t},setChatInitialized:function(t){B=t},setSessionReconnected:function(t){E=t},setChatUserName:function(t){G=t},setCallUserUUID:function(t){r=t},setUIActive:function(t){"boolean"==typeof t&&(N=t)},setBroadcastResponse:function(t){m=t},setProcessedUserAgent:function(t){h=t},setCurrentPhase:function(t){D=t},setViewerRecId:function(t){c=t},setPageUUID:function(t){return i=t},setABTestId:function(t){s=t},setABTestGroup:function(t){f=t},setActiveABTests:function(t){A=t},getActiveABTests:function(){return A},setAPIStandardJourney:function(t){S=t},setCanceledOnConnectingScreen:function(t){p=t},setCallInitiatedWhileCanceling:function(t){O=t},setLocale:function(t){g=t},addRoutingKey:function(t,e){var n;if("object"!=typeof T&&(T={required:[],optional:[]}),Array.isArray(t))n=t;else{if("string"!=typeof t)return;n=[t]}e?T.optional.push(n):T.required.push(n)},setTokBoxApiKey:function(t){I=t},setPageMetadata:function(t){v=t},setOneToOneChecked:function(){M.oneToOne=V},setBroadcastChecked:function(){M.broadcast=V},setIsDataCollectionDisabled:function(t){_=t},setOneToOneAutoPlay:function(t){U=t},setPageStatus:function(t){x=t},setStrictLogging:function(t){P=t},setIsEmbed:function(t){b=t},setUpdateMessageId:function(t){C=t},addPriorityRoutingKey:function(t,e){utilitiesService.isPriorityRoutingKeyObject(T)||(T={p1:[],p2:[],p3:[],p4:[]}),'string'==typeof t?0===T[e].length?T[e].push([t]):T[e][0].includes(t)||T[e][0].push(t):T[e]=[t]},setSessionId:function(t){u=t},getSessionId:function(){return u},phase:t,pageStatus:w,getInputAlignment:function(){return Y},setInputAlignment:function(t){Y=t},setToken:function(t){d=t},getToken:function(){return d},addStreamToConsumerMap:function(t){F++,K[t]=F},removeStreamFromConsumerMap:function(t){F--,delete K[t]},getIdFromConsumerMap:function(t){return K[t]?K[t]:1},setOTData:function(t){j=t},getOTData:function(){return j},isCtaCustomMessage:function(){return y},isAndroidSocialBrowser:function(){return('facebook'===H()||'instagram'===H())&&'android'===z()||!1},setSocialRedirectionInfo:function(t){q=t},getSocialRedirectionInfo:function(){return q}}};GISAPP.streamService=function(){'use strict';var n=new Map,e={};function r(t){return n.get(t)}return{addStreamToMap:function(t,e,r){n.set(t,{stream:e,element:r})},setPrimaryStream:function(t){e=r(t)},getStreamFromMap:r,getPrimaryStream:function(){return e},isStreamIdExistsInStreamMap:function(t){return!!r(t)}}};GISAPP.systemInfoService=function(serverInjectionService,clientStorageService,stateService,otService,logService,utilitiesService){'use strict';var r=clientStorageService.storageKeys,i={MEDIA_SHARE:"MEDIA_SHARE",DEVICE_SUPPORT:"DEVICE_SUPPORT"},t=!1;function e(e){var t=clientStorageService.getItem(e);if(null==t)return 0;var r=utilitiesService.getTimeWithOutMilliSeconds(),i=Date.parse(t.timeStamp);return Math.abs(Date.parse(r)-i)}function s(e,t){clientStorageService.isLocalStorageAccessible()&&clientStorageService.setItem(e,t)}return{CONTROLLER_KEYS:i,checkSystemSupported:function(){try{return 1===otService.getOT().checkSystemRequirements()&&t}catch(e){return logService.error("systemInfoService","Error occurred on checking system support",e),!1}},checkGisServiceEnabled:function(){var e=serverInjectionService.getSystemConfig();if(null==e||0===Object.keys(e).length)return!0;var t=stateService.getOs(!0),r=stateService.getBrowser();return null!=e[t]&&e[t][r]},getSystemInfo:function(){return{os:stateService.getOs(),browser:stateService.getBrowser()}},userVisitsFirstTime:function(){return!!clientStorageService.isLocalStorageAccessible()&&!clientStorageService.hasProperty(r.SERVICE_AWARENESS_KEY)},isTimeExpired:function(){return 30<e(r.SERVICE_AWARENESS_KEY)/2592e6},saveUserVisitTime:function(){var e,t={timeStamp:(e=new Date,new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime())};s(r.SERVICE_AWARENESS_KEY,t)},isCtaNotificationBarShown:function(){return clientStorageService.hasProperty(r.BROADCAST_PREVIEW_KEY)},isCtaNotificationBarDismissTimeExpired:function(){return 14<=e(r.BROADCAST_PREVIEW_KEY)/864e5},saveUserDismissCtaNotificationBar:function(){var e={timeStamp:utilitiesService.getTimeWithOutMilliSeconds()};s(r.BROADCAST_PREVIEW_KEY,e)},shouldBypass:function(e){var t=!1;switch(e){case i.MEDIA_SHARE:case i.DEVICE_SUPPORT:t="ie"===stateService.getBrowser()}return t},shouldShowAvailableClerkList:function(){var e=!1;return!!clientStorageService.isLocalStorageAccessible()&&(clientStorageService.hasProperty(r.SHOW_AVAILABLE_CLERK)?clientStorageService.getItem(r.SHOW_AVAILABLE_CLERK):(Math.random()<.5&&(e=!0),clientStorageService.setItem(r.SHOW_AVAILABLE_CLERK,e),e))},requiresSSLCall:function(){var e=stateService.getBrowser(),t=stateService.getBrowserVersion();return("chrome"===e&&47<=t||"safari"===e&&11<=t||"opera"===e||"edge"===e&&17<=t)&&"https:"!==window.location.protocol},setUserMediaSupport:function(e){t=e}}};GISAPP.uiUtilitiesService=function(systemInfoService,utilitiesService,logService,serverInjectionService,stateService,globalObjectService,browserInfoService,GIS_CONSTANTS){'use strict';var n,i,o,r,a,l,c,s,e=utilitiesService,t={extraLarge:"ExtraLarge",large:"Large",medium:"Medium",small:"Small",extraSmall:"ExtraSmall"},d=[{type:t.extraLarge,minWidth:1920,maxWidth:1/0,minHeight:840},{type:t.large,minWidth:1280,maxWidth:1920,minHeight:646},{type:t.medium,minWidth:960,maxWidth:1280,minHeight:380},{type:t.small,minWidth:600,maxWidth:960,minHeight:0},{type:t.extraSmall,minWidth:0,maxWidth:600,minHeight:0}],u=["png","jpeg","jpg"],m=[];function g(t,n,i,e){var o=serverInjectionService.getGisStaticDomainS3(),r="";e.forEach(function(e){r+="@font-face {font-family: '"+t+"';font-style: normal;font-weight: "+("regular"==e?400:e)+";src: url('"+o+"/fonts/"+n+"-"+i+"-"+e+".eot');src: local(''),url('"+o+"/fonts/"+t+"/"+n+"-"+i+"-"+e+".eot?#iefix') format('embedded-opentype'),url('"+o+"/fonts/"+t+"/"+n+"-"+i+"-"+e+".woff2') format('woff2'),url('"+o+"/fonts/"+t+"/"+n+"-"+i+"-"+e+".woff') format('woff'),url('"+o+"/fonts/"+t+"/"+n+"-"+i+"-"+e+".ttf') format('truetype'),url('"+o+"/fonts/"+t+"/"+n+"-"+i+"-"+e+".svg#Roboto') format('svg');}"}),f(r)}function f(e,t){var n=document.createElement('style');n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t?t.appendChild(n):document.body.appendChild(n)}function h(e,t){if(e&&t&&t.children)for(;0<t.children.length;)e.appendChild(t.children[0])}function p(e,t,n,i){var o=document.createElement(e);return t&&(o.id=t),n&&(o.className=n),i&&o.setAttribute("style",i),o}function v(e,t){t&&e&&!y(e,t)&&(e.className=e.className.replace(/\s+$/gi,'')+' '+t)}function b(e,t){e&&y(e,t)&&(e.className=e.className.replace(t,''))}function y(e,t){return e.className.match(new RegExp('(\\s|^)'+t+'(\\s|$)'))}function C(){S(document.body),gisAppLib.bodyScrollLock.clearAllBodyScrollLocks()}function w(e){C(),gisAppLib.bodyScrollLock.disableBodyScroll(e,{allowTouchMove:function(e){for(;e&&e!==document.body;){if(null!==e.getAttribute('body-scroll-lock-ignore'))return!0;e=e.parentElement}}})}function S(e){b(e,"gis-disable-scroll")}function L(e,t){var n=t||serverInjectionService.getSystemConfig(),i=e.substring(e.lastIndexOf('.')+1,e.length)||e,o=e.substring(0,e.lastIndexOf('.'))||e,r=!(!n.imageFormatOverride||!n.imageFormatOverride.enabled)&&n.imageFormatOverride.format,a=n.imageFormatOverride&&n.imageFormatOverride.postfix?n.imageFormatOverride.postfix:"";return r&&u.includes(i)&&("webp"!==r.toLowerCase()||browserInfoService.isWebpSupported())?o+a+"."+r:e}return g('Roboto','roboto-v29','vietnamese_latin-ext_latin_greek-ext_greek_cyrillic-ext_cyrillic',["regular","500"]),{setupGISPanels:function(){var e,t,n,i,o,r;l=p("div","gis-outer-panel",'gis-outer-panel',""),c=p("div","gis-inner-panel",'gis-inner-panel',""),s=p("div","gis-bg-cover","gis-bg-cover",""),l.appendChild(c),s.appendChild(l),document.body.appendChild(s),e=l,t=f,n=serverInjectionService.getUiConfig().theme||{},i=n&&n.brandColor&&n.brandColor.enabled&&n.brandColor.color,o=i?n.brandColor.color:"",r=".gis-v3-button {\nbackground: "+o+";\n}\n\nsvg.gis-svg-stars:hover,\n.gis-star-container label:hover ~ label .gis-svg-stars,\n.gis-star-container input[name*=\"Q-\"]:focus ~ label .gis-svg-stars,\n.gis-star-container input[name*=\"Q-\"]:checked ~ label .gis-svg-stars {\ncolor: "+o+";\n}\n\n@keyframes change-color {\nfrom { color: "+o+"; }\nto { color: "+o+"; }\n}",i&&t(r,e)},showModal:function(e){var t=document.getElementsByTagName("body")[0],popup=document.getElementById('gis-bg-cover');y(t,"gis-popanimationactive")||(b(popup,'no-transition'),v(popup,"stack"),v(t,"gis-popanimationactive")),w(c),c.firstChild&&c.removeChild(c.firstChild),c.appendChild(e),window.dispatchEvent(new GisCustomEvent("gisUIOpen"))},hideModal:function(e,t){b(document.getElementsByTagName("body")[0],'gis-popanimationactive'),b(document.getElementById("gis-bg-cover"),"stack");var n=null;C(),void 0!==e&&!1!==e||(t&&(n={action:t}),window.dispatchEvent(new GisCustomEvent("gisUIClosed",{detail:n})))},processView:function(e,t,n){if((e||'string'==typeof e)&&(!t||'object'==typeof t)){var i=document.createElement('div');if(i.innerHTML=e,t&&0!==Object.keys(t).length){for(var o in t)t.hasOwnProperty(o)&&("true"===t[o]&&(t[o]=!0),"false"===t[o]&&(t[o]=!1));var r=i.innerHTML.match(/\{\{.+\}\}/);if(r){var a=r[0].substring(2,r[0].length-2),l=t[a];l&&(i.innerHTML=i.innerHTML.replace("{{"+a+"}}",l))}for(var c=[],s=i.getElementsByTagName("*"),d=0;d<s.length;d++){var u=s[d];u.hasAttribute("cndt")&&(t[u.getAttribute("cndt")]||c.push(s[d]),u.removeAttribute("cndt")),a=null;var m=u.getAttribute("gis-class");m&&(a=t[m])&&v(u,a)}c.forEach(function(e){e.parentNode.removeChild(e)})}return n?i:i.firstChild}},appendView:h,clearView:function(e){for(;0<e.children.length;)e.removeChild(e.children[0])},removeView:function(e,t){for(;0<t.children.length;)e.removeChild(t.children[0])},bodyRender:function(e){h(document.body,e)},appendBefore:function(e,t,n){for(;0<t.children.length;)e.insertBefore(t.children[0],n)},createElementWithAttributes:p,show:function(e,t){document.getElementById(e).style.display=t||'block'},hide:function(e){document.getElementById(e).style.display='none'},addClass:v,removeClass:b,hasClass:y,isLandscape:function(){return 90===window.orientation||-90===window.orientation},adjustAspectRatioBasedOnWidth:function(e,t,n){var i=n||"gis-connect-panel",o=document.getElementById(i),r=parseInt(window.getComputedStyle(o,null).getPropertyValue("width").substr(0,3))+30,a=t/e;return{width:r,height:Math.round(a*r)}},adjustAspectRatioBasedOnHeight:function(e,t,n){var i=n||"gis-connect-panel",o=document.getElementById(i),r=parseInt(window.getComputedStyle(o,null).getPropertyValue("height").substr(0,3))+30,a=e/t;return{width:Math.round(a*r),height:r}},showAlert:function(e,t){(n=p("div","msc-confirm","msc-confirm","display: block;")).innerHTML="<div class='msc-content msc-confirm--animate'>    <h3 class='msc-title'>"+e+"</h3><div class='msc-body'></div>   <div class='msc-action'><button class='msc-ok' onclick='GISAPP.uiUtilitiesService.suspendAlert()'>OK</button></div>    </div>",document.body.appendChild(n),i=t},suspendAlert:function(){document.body.contains(n)&&(document.body.removeChild(n),i instanceof Function&&i())},showConfirm:function(e,t,n){(o=p("div","msc-confirm","msc-confirm","display: block;")).innerHTML="<div class='msc-content msc-confirm--animate'>    <h3 class='msc-title'>"+e+"</h3><div class='msc-body'></div>   <div class='msc-action'><button class='msc-ok' onclick='GISAPP.uiUtilitiesService.onDialogOk()'>OK</button><button class='msc-cancel' onclick='GISAPP.uiUtilitiesService.onDialogCancel()'>Cancel</button></div>    </div>",document.body.appendChild(o),r=t,a=n},onDialogOk:function(){document.body.contains(o)&&(document.body.removeChild(o),r instanceof Function&&r())},onDialogCancel:function(){document.body.contains(o)&&(document.body.removeChild(o),a instanceof Function&&a())},disable:function(e){null!=e&&null!=document.getElementById(e)&&(document.getElementById(e).disabled=!0)},enable:function(e){null!=e&&null!=document.getElementById(e)&&(document.getElementById(e).disabled=!1)},removeNode:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},enableBodyScroll:C,disableBodyScrollExcludingContainer:w,getImageUrl:function(e,t){var n=stateService.getLocale(),i=serverInjectionService.getRetailerToken(),o=serverInjectionService.getChromeExtensionToken(),r=serverInjectionService.getBrowserSecurityToken(),a=serverInjectionService.getImagesResources()+"/"+L(e);return n&&(a=utilitiesService.addParamToUrl(a,"locale="+n)),r?(a=utilitiesService.addParamToUrl(a,"secToken="+r),a=utilitiesService.addParamToUrl(a,"referer="+serverInjectionService.getReferer())):(i&&(a=utilitiesService.addParamToUrl(a,"retailerToken="+i)),o&&(a=utilitiesService.addParamToUrl(a,"q="+o)),utilitiesService.isReferrerPolicyEnable()&&(a=utilitiesService.addParamToUrl(a,"referer="+encodeURIComponent(utilitiesService.getPageUrl(!1))))),t?a:"url(\""+a+"\")"},getClerkImageUrl:function(e){return serverInjectionService.getGisDomain()+"/images/clerk/"+btoa(e)},clearTimeouts:function(e){return e.forEach(function(e){clearTimeout(e)}),[]},redirectToHttp:function(){e.isDirectCall()||e.isAutoStartConnectScreen()||e.isDepartmentCall()?window.location.href=e.removeURLParameter(window.location.href,["giscall","gisAutoCall","giscallcategory",GIS_CONSTANTS.QUERY_PARAM.GIS_SOCIAL]):e.isHttpsPageRedirected()&&window.history.back()},hasChildNodes:function(e){return e.hasChildNodes()},createCallControlButton:function(e,t,n){var i=p('div',e,n);return v(i,'gis-call-control-button'),i.innerHTML=t,i},addClasses:function(e,t){for(var n=0;n<t.length;n++)e.classList.add(t[n])},addClassOnList:function(e,t){e.forEach(function(e){e&&e.classList.add(t)})},removeClassOnList:function(e,t){e.forEach(function(e){e&&e.classList&&e.classList.contains(t)&&e.classList.remove(t)})},classToggle:function(e,t){e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)},isHiddenElement:function(e){return'none'===globalObjectService.getWindow().getComputedStyle(e).display},changeSvg:function(e,t){e.innerHTML=t},hasChildren:function(e){return e&&e.children&&0!==e.children.length},getInnerHeight:function(e){var t=getComputedStyle(e),n=parseInt(t.paddingTop)+parseInt(t.paddingBottom);return e.clientHeight-n},getInnerPanel:function(){if(c)return c},getScreenBreakpoints:function(){return d},getBreakpointLabels:function(){return t},overrideImageFormat:L,applyDrag:function(n,e,i,o,r,a){m[n]={movedUp:!1,movedDown:!1,isActive:!1},e.addEventListener('pointerdown',function(){var t=i.getBoundingClientRect().top;m[n].isActive=!i.classList.contains(a),e.addEventListener('touchmove',function(e){if(e.targetTouches[0].clientY>t){if(m[n].movedDown||!m[n].isActive)return;r.call(),m[n].movedUp=!1,m[n].movedDown=!0,m[n].isActive=!1}else{if(m[n].movedUp||m[n].isActive)return;o.call(),m[n].movedUp=!0,m[n].movedDown=!1,m[n].isActive=!0}})}),e.addEventListener('pointerup',function(){m[n].movedUp=!1,m[n].movedDown=!1})},loadHostedFont:g,styleSheetInjector:f,enableScrollLock:function(e){v(e,"gis-disable-scroll")},disableScrollLock:S}};GISAPP.urlUtilitiesService=function(globalObjectService,overrideService){'use strict';var t={LOGTAG:"urlUtilitiesService"},a=[[".com"],[".co"],[".edu"],[".gov"],[".org"],[".net"]];function e(){return globalObjectService.getWindow().location.href.split('?')[0]}t.getMainDomainForCookie=function(t){for(var r=t||document.location.hostname,e="",n="",i=0;i<a.length;i++)if(r.includes(a[i]))return n=r.substring(r.indexOf(a[i])),(e=r.substring(0,r.indexOf(a[i]))).substring(e.lastIndexOf('.')+1)+n;var o=r.split('.');return o[o.length-2]+'.'+o[o.length-1]};return overrideService.override(t.LOGTAG,t),{appendParamsToUrl:function(t,r){var e='?';for(var n in r)r.hasOwnProperty(n)&&(e=e+n+'='+r[n]+'&');return t+e.slice(0,-1)},mergeParamsObject:function(t,r){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);for(var i in r)r.hasOwnProperty(i)&&(t.hasOwnProperty(i)||(e[i]=r[i]));return e},getLocationObject:function(t){var r=document.createElement("a");return r.href=t,r},getParamsObjectFromUrl:function(t){var e={};return t&&t.search&&t.search.split('?')[1].split('&').reduce(function(t,r){e[r.split('=')[0]]=r.split('=')[1]},''),e},getSupportInfoUrl:function(t,r){if(t&&r)return'string'==typeof t?t:t[r]?t[r]:t.default},getUrlWithoutParams:e,getUrlWithoutParamsWithLimit:function(t){var r=e();return"string"==typeof r?r.substring(0,t):""},getMainDomainForCookie:t.getMainDomainForCookie,getExternalDeepLinkForAndroidWebviews:function(t){return"intent://"+t.replace("https://","").replace("http://","")+"#Intent;scheme=https;S.browser_fallback_url="+t+";end;"}}};GISAPP.userService=function(stateService,cookieService,clientStorageService,utilitiesService,overrideService,GIS_CONSTANTS){'use strict';var e={},t=function(){return GIS_CONSTANTS.COOKIES_PERMISSIONS.REJECTED};return e.getUserConsent=t,e.LOGTAG="userService",overrideService.override(e.LOGTAG,e),{getUserUUID:function(){var e=stateService.getCallUserUUID();return e||(e=cookieService.isCookieEnabled()?cookieService.getCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID):clientStorageService.getItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID)),e},setUserUUID:function(e,t){var s=t||utilitiesService.getRandomAlphaNumKey();if(cookieService.isCookieEnabled()){if(cookieService.isCookieEnabledInBrowser()&&(e===GIS_CONSTANTS.COOKIES_PERMISSIONS.ACCEPTED||cookieService.isOptInEnabledForCookies()&&e===GIS_CONSTANTS.COOKIES_PERMISSIONS.UNKNOWN)){s=cookieService.getCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID);var o=clientStorageService.getItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID);s||(s=o||t||utilitiesService.getRandomAlphaNumKey(),cookieService.setCookie(clientStorageService.storageKeys.CHAT_CALL_USER_UUID,s,365,cookieService.getMainDomainForCookie())),o&&clientStorageService.removeItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID)}}else(s=clientStorageService.getItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID))||(s=t||utilitiesService.getRandomAlphaNumKey(),clientStorageService.setItem(clientStorageService.storageKeys.CHAT_CALL_USER_UUID,s));stateService.setCallUserUUID(s)},getUserConsent:e.getUserConsent,isConsentProcessed:function(){return e.getUserConsent!==t}}};GISAPP.utilitiesService=function(globalObjectService,serverInjectionService,GIS_CONSTANTS){'use strict';var i=[{relativeTo:"year",value:3154e4},{relativeTo:"month",value:2592e3},{relativeTo:"week",value:604800},{relativeTo:"day",value:86400},{relativeTo:"hour",value:3600},{relativeTo:"minute",value:60},{relativeTo:"second",value:1}],o=["gis","giscall","gischannel","gisoffered","gisAutoCall","gismeeting","giscallconnect","gisevent","giskey","giscallcategory",GIS_CONSTANTS.QUERY_PARAM.GIS_SOCIAL];function a(){return l(globalObjectService.getWindow().location.href)}function n(e,t){if(!Array.isArray(t)||!e||0==t.length)return e;var n=l(e),r="",i=e.split('?');if(1===i.length)return i[0];r=i[0];for(var o=0;o<t.length;o++)delete n[t[o]];for(var a in n){var u=a,c=n[a];c&&(u+="="+c),r=s(r,u)}return r}function f(e){return encodeURIComponent(btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))})))}function l(e){e&&-1!==e.indexOf('#')&&(e=e.substring(0,e.indexOf('#')));var t=e.slice(e.indexOf('?')+1).split('&').map(function(e){return e.split('=')});return t.unshift({}),t.reduce(function(e,t,n){return e[t[0]]=t[1],e})}function s(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+t:e}function r(e){if(e)return globalObjectService.getWindow().location.href;for(var t=globalObjectService.getDocument().location,n=t.origin+t.pathname,r=a(),i=0;i<o.length;i++)r[o[i]]&&(n=s(n,o[i]+"="+r[o[i]]));return n}function t(){return serverInjectionService.getSystemConfig()&&serverInjectionService.getSystemConfig().referrerPolicy&&serverInjectionService.getSystemConfig().referrerPolicy.enable&&serverInjectionService.getSystemConfig().referrerPolicy.policy}function g(e){return null!=e&&'object'==typeof e&&!v(e)}function d(e,t){return JSON.stringify(e)==JSON.stringify(t)}function v(e){return Array.isArray(e)}function u(){return l(r(!0))[GIS_CONSTANTS.QUERY_PARAM.GIS_SOCIAL].split("__")}function c(e){var t=Object.keys(l(e)),n=!1;return t.forEach(function(e){o.includes(e)&&(n=!0)}),n}return{isDirectCall:function(){var e=l(window.location.href);return"DIRECT"===e.callType||null!=e.giscall},isMeeting:function(){return null!=l(window.location.href).gismeeting},isHttpsPageRedirected:function(){return-1<window.location.pathname.indexOf('connectCall')},isDirectLinkBroadcast:function(){var e=l(globalObjectService.getWindow().location.href);return null!=e[GIS_CONSTANTS.QUERY_PARAM.GIS_CHANNEL_PARAM]||null!=e[GIS_CONSTANTS.QUERY_PARAM.GIS_EVENT_PARAM]},isAutoStartConnectScreen:function(){return l(globalObjectService.getWindow().location.href).hasOwnProperty("gisAutoCall")},removeURLParameter:n,getUrlParams:a,getUrlParamsLowerCase:function(){return function e(t){var n={};for(var r in t){var i=t[r];'object'==typeof i||Array.isArray(i)?n[r.toLowerCase()]=e(i):n[r.toLowerCase()]=i}return n}(l(globalObjectService.getWindow().location.href))},getErrorObject:function(e,t){return{errorCode:e,errorMsg:t}},encodeJSONtoBase64:function(e){return btoa(JSON.stringify(e))},utf8ToBase64:f,compareFunctionNames:function(e,t){var n="/function (.+?)(/)||[,'']";return e.toString().match(n)[1]==t.toString().match(n)[1]},isEncodedUri:function(e){var t=e||"";return t!==decodeURIComponent(t)},setupPolyfills:function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var e=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent('CustomEvent');return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};e.prototype=window.Event.prototype,window.GisCustomEvent=e},getRandomAlphaNumKey:function(){for(var e='',t='0123456789abcdefghijklmnopqrstuvwxyz',n=0;n<32;n++)e+=t[Math.floor(Math.random()*t.length)];return e=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,32)},getTimeFromSeconds:function(e){for(var t={},n=0;n<i.length;n++){var r=i[n];1<=e/r.value?(t[r.relativeTo]=Math.floor(e/r.value),e%=r.value):t[r.relativeTo]=0}return t},getFormattedTime:function(e){if(null==e)return"";var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds(),i="";return 0<t&&(i+=("0"+t).slice(-2)+":"),i+=0<n?("0"+n).slice(-2)+":":"00:",i+=0<r?("0"+r).slice(-2):"00"},getFormattedDate:function(e){return null==e?"":e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()},getTimeDifference:function(e,t){return e&&t?Math.abs(e.getTime()-t.getTime())/1e3:-1},dateDifferenceInDays:function(e,t){return Math.round((t-e)/864e5)},getSecondsFromStringTime:function(e){var n=0;return e.split(':').reverse().forEach(function(e,t){n+=e*i[i.length-1-t].value}),n},addParamToUrl:s,addToArray:function(e,t){-1===e.indexOf(t)&&e.push(t)},removeFromArray:function(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)},addObjectAsParamToUrl:function(e,t,n,r,i){var o="&"+t+"=",a={},u=JSON.parse(JSON.stringify(e));try{i&&u[i]&&(a[i]=u[i],delete u[i]);for(var c=Object.keys(u).sort(function(e,t){return"string"==typeof u[e]&&"string"==typeof u[t]?u[e].length-u[t].length:0}),l=0;l<c.length;l++){var s=c[l];if(a[s]=u[s],n.length+f(o+JSON.stringify(a)).length>r){delete a[s];break}}}catch(e){}return o+f(JSON.stringify(a))},getPageUrl:r,isJsonString:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},getFileNameFromUrl:function(e){return e.split("/").pop().split(".")[0]},getWithOffset:function(e){var t=6e4*e.getTimezoneOffset();return e.setTime(e.getTime()-t),e},isImageExists:function(e,t){var n=new Image;n.src=e,n.complete?t(!0):(n.onload=function(){t(!0)},n.onerror=function(){t(!1)})},getReferrerPolicy:function(){var e=null;return t()&&(e=serverInjectionService.getSystemConfig().referrerPolicy.policy),e},isReferrerPolicyEnable:t,isPriorityRoutingKeyObject:function(e){return t=e,['p1','p2','p3','p4'].every(function(e){return t.hasOwnProperty(e)});var t},convertInTwoDigits:function(e){return 9<e?e:"0"+e},isLandscape:function(){return globalObjectService.getWindow().innerHeight>globalObjectService.getWindow().innerWidth},callOncePerSession:function(e,t){var n=!0,r='';return function(){(n||t()!==r)&&(r=t(),e()),n=!1}},supportsHLS:function(){var e=document.createElement('video');return!(!e.canPlayType('application/vnd.apple.mpegURL')&&!e.canPlayType('audio/mpegurl'))},debounce:function(e,t){var n;return function(){clearTimeout(n),n=setTimeout(function(){e.apply(this)},t)}},once:function(e){var t=0;return function(){0===t&&e(),t++}},getLocaleFromHtmlTag:function(){return globalObjectService.getWindow().document.documentElement.lang},removeQueryParamsExceptSome:function(t){var e=o.filter(function(e){return!t.includes(e)});return n(r(!0),e)},extractUrlParamsValues:l,getReferer:function(e){var t=r(serverInjectionService.getSystemConfig().referer.queryParam.enabled);return e&&(t=encodeURIComponent(t)),1e3<t.length&&(t=t.slice(0,1e3)),t},getTimeWithOutMilliSeconds:function(){return(new Date).toISOString().split('.')[0]+'Z'},supportsMediaSource:function(){return'MediaSource'in window&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')},isDepartmentCall:function(){return null!=l(globalObjectService.getWindow().location.href).giscallcategory},areObjectsEqual:function e(t,n){var r=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(n);if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++){var a=t[r[o]],u=n[r[o]],c=g(a)&&g(u),l=v(a)&&v(u);if(c&&!e(a,u)||l&&!d(a,u)||!c&&!l&&a!==u)return!1}return!0},isAnObject:g,areArraysEqual:d,isAnArray:v,isGisQueryParamAvailable:c,getSocialTrackableURL:function(e,t){var n=!c(e),r=s(e,GIS_CONSTANTS.QUERY_PARAM.GIS_SOCIAL+"="+t);return n&&(r=s(r,"gisAutoCall")),r},isRedirectedFromSocialWebview:function(){if(Object.keys(l(r(!0))).includes(GIS_CONSTANTS.QUERY_PARAM.GIS_SOCIAL)){var e=u();if(2===e.length&&GIS_CONSTANTS.REGEX.ALPHA_NUM.test(e[0])&&GIS_CONSTANTS.REGEX.ALPHA_NUM.test(e[1])&&Object.values(GIS_CONSTANTS.BROWSER_SHORTCODE_MAP).includes(e[1]))return!0}return!1},getSocialWebviewInfo:u,getBrowserShortcode:function(e){return GIS_CONSTANTS.BROWSER_SHORTCODE_MAP[e]}}};GISAPP.validationUtilitiesService=function(){'use strict';var i={};function u(t){return void 0===t||0===(t=t.trim()).length}function l(t,n,e){return i.isValid=t||!1,i.errorFields=n||[],i.errorMsg=e||"",i}return{validateContactData:function(t){var n=[];if(null==t||void 0===t)return n.push("data"),l(!1,n,"Data array not found");var e=t.name,i=t.phone,a=t.email,r=t.message,o=200,s=l(!0,[],"");return(u(e)||e.length>o)&&(n.push("name"),s=l(!1,n,"Invalid name")),(u(i)||i.length>o)&&(n.push("phone"),s=l(!1,n,"Invalid phone number")),(u(a)||a.length>o||!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(a))&&(n.push("email"),s=l(!1,n,"Invalid email")),(void 0===r||r.length>o)&&(n.push("message"),s=l(!1,n,"Invalid message")),s},isUndefinedOrEmpty:u,isDigit:function(t){return"0"<=t&&t<="9"},isInt:function(t){return null!=t&&!isNaN(t)&&(0|(n=parseFloat(t)))===n;var n},isString:function(t){return'string'==typeof t||!!t&&'object'==typeof t&&'[object String]'===Object.prototype.toString.call(t)},validateEmail:function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)}}};GISAPP.chatGroupService=function(activityLoggerService,callCtrl,logService,GIS_CONSTANTS,stateService,chatLoadService,gisService,utilitiesService){var e={},u='chatGroupService',n=null;function a(){n(!0)}return e.createGroup=function(e,t,r,n,a){var o=new e.Group(t,r,n,a);e.createGroup(o).then(function(e){logService.info(u,'Group created successfully:',e),activityLoggerService.logActivity(activityLoggerService.GIS_ACTIVITY_TYPES.CALL_CHAT_STARTED_IN_CALL),chatLoadService.chatWidgetInit(),stateService.getCurrentPhase(stateService.phase.IN_CALL)&&callCtrl.sendSignal(GIS_CONSTANTS.SIGNAL_TYPE.CHAT_INITIATED)},function(e){(e&&e.details&&e.details.guid&&0<e.details.guid.length&&'The guid has already been taken.'===e.details.guid[0]||'ERR_GUID_ALREADY_EXISTS'===e.code)&&chatLoadService.chatWidgetInit(),logService.error(u,'Group creation failed with exception:',e)})},gisCallbacks.chatMemberCountCallback=function(t){var r=null;try{if(!utilitiesService.isJsonString(t))throw new Error("Json parsing failed for the data");if((r=JSON.parse(t)).status!==GIS_CONSTANTS.CHAT.MEMBER_COUNT_STATUS.SUCCESSFUL)throw new Error("Chat member count unsuccessful response: "+r.status);n(!1,r.isRoomFull)}catch(e){a(),logService.error(u,'Error on fetching group count:',e,{chatCountObject:r||t})}},{createGroup:e.createGroup,getGroupCount:function(e,t){n=t,gisService.getChatMemberCount("gisCallbacks.chatMemberCountCallback",a,e)}}};GISAPP.chatInitService=function(overrideService,stateService,logService,serverInjectionService,chatUserService,chatUtilService){var t={},o="chatInitService";return t.triggerEvent=function(t){document.getElementById("cometChatIframe").contentWindow.dispatchEvent(new GisCustomEvent(t))},t.initializeCometChat=function(t,i){if(!n&&!0===t){var e=document.getElementById("cometChatIframe");if(e&&e.contentWindow)var n=e.contentWindow.CometChat}if(n){logService.info(o,'Comet chat API load successful');var a=(new n.AppSettingsBuilder).subscribePresenceForAllUsers().setRegion(serverInjectionService.getCometChatRegion()).build();n.init(serverInjectionService.getCometChatAppId(),a).then(function(t){logService.info(o,'Comet chat init successful');var e=chatUtilService.getChatUserUUID();stateService.getChatUserName()!=chatUtilService.getChatUserName()&&chatUserService.updateUsername(n,stateService.getChatUserName()),chatUserService.login(n,e,serverInjectionService.getCometChatAuthKey(),i,stateService.getCallUUID(),stateService.getChatInitiated())},function(t){logService.error(o,'Comet chat init failed with exception:',t)})}},overrideService.override(o,t),{initializeCometChat:t.initializeCometChat,triggerEvent:t.triggerEvent}};GISAPP.chatLoadService=function(overrideService,iframeService,uiUtilitiesService,serverInjectionService,stateService,chatUtilService,callService,deviceInfoService,logService,GIS_CONSTANTS){var c={};c.inactivityNotificationTimeout=GIS_CONSTANTS.CHAT.INACTIVITY.CONVERSATION.NOTIFICATION_TIMEOUT,c.loadReactUIKitBundle=function(){document.getElementById("cometChatIframe").contentWindow.loadBundle()},c.loadChatInIframe=function(t,e,i,o){var a=serverInjectionService.getGisStaticDomain()+"/js/chat/comet-chat-loader.js",n=chatUtilService.getGroupId();stateService.getCurrentPhase(stateService.phase.IN_CALL)&&uiUtilitiesService.disableBodyScrollExcludingContainer(t);iframeService.initializeSourceLessIframeWithScriptInjection('cometChat',t,a,{GISAPP:{GIS_CONSTANTS:{CHAT:{AUTH_KEY:serverInjectionService.getCometChatAuthKey(),APP_ID:serverInjectionService.getCometChatAppId(),REGION:serverInjectionService.getCometChatRegion(),RETAILER_NAME:serverInjectionService.getRetailerName()}},getGisStaticChatDomain:serverInjectionService.getGisStaticChatDomain(),chatNotificationService:window.GISAPP.chatNotificationService,stateService:{getSessionReconnected:stateService.getCurrentPhase(stateService.phase.IN_CALL)?GISAPP.stateService.getSessionReconnected:function(){return!0},setSessionReconnected:stateService.getCurrentPhase(stateService.phase.IN_CALL)?GISAPP.stateService.setSessionReconnected:function(){},getCurrentPhase:stateService.getCurrentPhase(),groupID:n},locale:stateService.getLocale(),groupID:n,userUUID:chatUtilService.getChatUserUUID()},isCloseButtonEnabled:!!e,isHeaderDisabled:!o,hideChat:function(){"function"==typeof e&&e()},onCometChatLoaded:GISAPP.chatInitService.initializeCometChat.bind(null,!0,!!i),isCrossCommunication:!0,console:{error:r},inactivityNotification:{isEnabled:function(){return GISAPP.callCtrl.isChatFirstCall()},inactivityTimeoutReachedCallback:chatUtilService.inactivityTimeoutReached,inactivityTimeoutClearedCallback:chatUtilService.inactivityTimeoutCleared,timeout:c.inactivityNotificationTimeout}})},overrideService.override("chatLoadService",c);var i,o,r=(i="cometChat",o=0,function(t,e){o<20?'string'==typeof e[0]&&'object'==typeof e[1]?logService.error(i,e[0],e[1]):'object'==typeof e[0]&&'string'==typeof e[1]?logService.error(i,e[1],e[0]):'object'==typeof e[0]?logService.error(i,'comet chat error',e[0]):'string'==typeof e[0]&&logService.error(i,e[0]):t('GIS- comet chat error',e),o+=1});return{chatWidgetInit:c.loadReactUIKitBundle,loadChatInIframe:c.loadChatInIframe,FOR_INTERNAL_TESTING:{ERROR:r}}};GISAPP.chatLogoutService=function(logService){var o={},e='chatLoginService',n=!1;return o.logout=function(){if(!t){var o=document.getElementById("cometChatIframe");if(o&&o.contentWindow)var t=o.contentWindow.CometChat}n&&t&&t.logout().then(function(o){n=!1,logService.info(e,'Logout completed successfully')},function(o){logService.error(e,'Logout failed with exception:',o)})},{logout:o.logout}};GISAPP.chatNotificationService=function(stateService,logService){var a,e={},d='chatNotificationService';function t(e,s,i){var t,n;stateService.getUpdateMessageId()&&(a=i.id,stateService.setUpdateMessageId(!1)),t=s,n=a-1,(new e.MessagesRequestBuilder).setLimit(100).setMessageId(n).setGUID(t).build().fetchNext().then(function(e){logService.info(d,'Message list fetched:',e),window.dispatchEvent(new GisCustomEvent('messageReceived',{detail:e}))},function(e){logService.info(d,'Message fetching failed with error:',e)})}return e.addMessageListener=function(s,i){stateService.setUpdateMessageId(!0),s.addMessageListener('UNIQUE_LISTENER_ID',new s.MessageListener({onTextMessageReceived:function(e){t(s,i,e)},onMediaMessageReceived:function(e){logService.info(d,'Media message received successfully',e),t(i,e)},onCustomMessageReceived:function(e){logService.info(d,'Custom message received successfully',e),t(i,e)}}))},{addMessageListener:e.addMessageListener,sendNotifcation:t}};GISAPP.chatUserNameService=function(stateService,clientStorageService,uiUtilitiesService,chatLoadService,serverInjectionService,chatUtilService,GIS_CONSTANTS,chatGroupService,eventLoggerService,overrideService){var s,E,S,e,p=!1,N=!1,A=serverInjectionService.getLabels(),D='',M=!1,y=!1,r=!1,t=GIS_CONSTANTS.CHAT.INACTIVITY.USERNAME.AUTO_SUBMIT_LIMIT,n={},U={panelID:null,formContainerID:null,submitButtonID:null,inputID:null,chatIconID:null,type:null,errorElemID:null,onValid:null,isShopStream:null};var a=function(e){return function(){y&&e()}},b=a(function(){r||(r=setTimeout(i,1e3*n.getInactivityTimeoutInSeconds()))}),i=a(function(){var e=document.querySelector('#'+U.formContainerID).getAttribute('id');uiUtilitiesService.hide(e),o(!N&&p?s:GIS_CONSTANTS.CHAT.INACTIVITY.USERNAME.DEFAULT_NAME),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_USERNAME_AUTO_SUBMIT_TRIGGERED)});n.getInactivityTimeoutInSeconds=function(){return t};function H(e,t,r,a,i,o){e.preventDefault();var n,s=document.querySelector('#'+t).getAttribute('id');if(!M)return uiUtilitiesService.hide(s),void l(r,a,i,o);n=function(e,t){var n=document.querySelector('#'+a);e||t||!p?(N=!0,D=A.chat_room_full_message,u(i,n,o),o.classList.remove('valid'),setTimeout(d.bind(null,i,n,o),3e5),eventLoggerService.logEvent(eventLoggerService.GIS_EVENTS.CHAT_ROOM_FULL_MESSAGE_SHOWN)):(uiUtilitiesService.hide(s),l(r,a,i,o))},chatGroupService.getGroupCount(stateService.getCallUUID(),function(e,t){n(e,t)})}function O(e,t,n){var r=e.currentTarget,a=r.innerText.trim();c(r,t,n);var i=!GIS_CONSTANTS.REGEX.SPECIAL_SYMBOL.test(a),o=GIS_CONSTANTS.REGEX.EMOTICON.test(a);i&&0<a.length?(D=A.chat_special_error_msg,p=!1,u(r,t,n)):o&&0<a.length?(D=A.chat_emoticon_error_msg,p=!1,u(r,t,n)):a.length<1?(p=!1,d(r,t,n)):a.length<3?(D=A.chat_userName_infoTooShort,p=!1,u(r,t,n)):20<a.length?(D=A.chat_userName_infoTooLong,p=!1,u(r,t,n)):(s=r.innerText,N=!(p=!0),c(r,t,n))}function l(e,t,n,r){var a=document.querySelector('#'+t);p?o(s):u(n,a,r)}function o(e){clearTimeout(r),r=!0;var t=document.querySelector('#gis-player-chat-container'),n=stateService.getChatInitiated();stateService.setChatUserName(e),setTimeout(function(){M?chatLoadService.loadChatInIframe(t,E,!0):"signal:CHAT_INITIATED"!==U.type||n?n||U.type||m().enableChat(!1):(stateService.setChatInitiated(!0),m().enableChat(!0))},250)}function q(e,t,n,r,a,i,o){if(13===e.keyCode){if(N||!p)return void e.preventDefault();H(e,t,n,r,a,i)}else O(e,o,i);a.innerHTML!==serverInjectionService.getLabels().chat_userName_firstInput&&uiUtilitiesService.removeClass(a,"gis-placeholder")}function u(e,t,n){e.classList.remove('valid'),e.classList.add('not-valid'),n.classList.remove('valid'),t.innerText=D,''!==t.innerText&&uiUtilitiesService.show(t.id)}function c(e,t,n){e.classList.remove('not-valid'),e.classList.add('valid'),n.classList.add('valid'),t.innerText='',uiUtilitiesService.hide(t.id)}function d(e,t,n){c(e,t,n),p?n.classList.add('valid'):n.classList.remove('valid'),N=!1}function G(){return!!clientStorageService.isLocalStorageAccessible()&&!!chatUtilService.getChatUserName()}function m(){return e}return overrideService.override("chatUserNameService",n),{openEnterUserForm:function(e,t,n,r,a,i,o,s,l,u){U={panelID:e,formContainerID:t,submitButtonID:n,inputID:r,chatIconID:a,type:i,errorElemID:o,onValid:s,isShopStream:l};var c,d,m,v,I,h,f=stateService.getChatInitiated(),g=stateService.getChatInitialized(),T=document.querySelector('#'+e),L=document.querySelector('#'+n),_=document.querySelector('#'+r),C=stateService.getCurrentPhase();S=document.querySelector('#'+o),E=s,M=l,y=u,_.innerText||A.chat_userName_firstInput,G()&&(L.classList.add('valid'),p=!0),g||f||uiUtilitiesService.show(t),T&&C===stateService.phase.IN_CALL&&uiUtilitiesService.show(e),null!==a&&uiUtilitiesService.hide(a),c=t,d=i,m=o,v=_,I=S,(h=L).addEventListener('click',function(e){!N&&p&&H(e,c,d,m,v,h)},!1),v.addEventListener('keydown',function(e){q(e,c,d,m,v,h,I)},!1),v.addEventListener('keyup',function(e){q(e,c,d,m,v,h,I)},!1),v.addEventListener('paste',function(e){e.preventDefault()}),v.addEventListener('input',function(e){var t;0<(t=e).currentTarget.innerText.length&&t.currentTarget.classList.contains('not-valid')&&(t.currentTarget.classList.remove('not-valid'),D='',uiUtilitiesService.hide(S.id))}),v.addEventListener('focus',function(e){var t=e.target.innerHTML;t===serverInjectionService.getLabels().chat_userName_firstInput&&(e.target.innerHTML='')},!1),v.addEventListener('blur',function(e){var t=e.target.innerHTML;""===t||"<br>"===t?(e.target.innerHTML=serverInjectionService.getLabels().chat_userName_firstInput,uiUtilitiesService.addClass(v,"gis-placeholder"),uiUtilitiesService.removeClass(v,"valid")):e.target.innerHTML!==serverInjectionService.getLabels().chat_userName_firstInput&&O(e,I,h)},!1),_.innerHTML=_.dataset.placeholder,_.dataset.placeholder!==serverInjectionService.getLabels().chat_userName_firstInput?(_.blur(),uiUtilitiesService.addClass(_,"valid")):(uiUtilitiesService.addClass(_,"gis-placeholder"),uiUtilitiesService.removeClass(_,"valid")),b()},isNameConfigured:G,getUserName:function(){return chatUtilService.getChatUserName()},setCallDOMProc:function(callDOMProc){e=callDOMProc},submitUsername:o,getCallDOMProc:m}};GISAPP.chatUserService=function(logService,serverInjectionService,stateService,utilitiesService,chatUtilService,chatLoadService,chatNotificationService,chatGroupService,GIS_CONSTANTS,eventService){var U={},c='chatUserService';return U.createUser=function(t,e,r,n,a,s,i){var o=new t.User(r);o.setName(e),t.createUser(o,a).then(function(e){logService.info(c,'user created',e),U.login(t,o.uid,a,n,s,i)},function(e){logService.error(c,'error',e)})},U.updateUsername=function(e,t){var r=new e.User(chatUtilService.getChatUserUUID());r.setName(t),e.updateCurrentUserDetails(r).then(function(){stateService.setChatUserName(t)},function(e){logService.error(c,"update username failed: ",e)})},U.login=function(n,t,e,a,s,i){n&&n.login(t,e).then(function(e){_isCometChatLoggedIn=!0,logService.info(c,'Login Successful: ',e);var t=n.GROUP_TYPE.PUBLIC;if(stateService.getCurrentPhase()===stateService.phase.IN_CALL&&chatNotificationService.addMessageListener(n,s),eventService.publish(GIS_CONSTANTS.EVENT_NAMES.COMETCHAT_LOGGED_IN),a||i)chatLoadService.chatWidgetInit();else{var r="in call - "+serverInjectionService.getRetailerKey()+" - "+utilitiesService.getFormattedTime(new Date);chatGroupService.createGroup(n,s,r,t,''),stateService.setChatInitiated(!0)}},function(e){'ERR_UID_NOT_FOUND'!=e.code&&logService.error(c,'Login failed with exception:',e),U.createUser(n,chatUtilService.getChatUserName(),t,a,serverInjectionService.getCometChatAuthKey(),s,i)})},{login:U.login,createUser:U.createUser,getUser:U.getUser,getUserList:U.getUserList,getLoggedUser:U.getLoggedUser,updateUsername:U.updateUsername}};GISAPP.chatUtilService=function(stateService,serverInjectionService,userService,overrideService,eventService,GIS_CONSTANTS){var e={};return e.getGroupId=function(){return stateService.getCallUUID()},e.getCometChatUser=function(){return JSON.parse(JSON.parse(localStorage.getItem(serverInjectionService.getCometChatAppId()+':common_store/user')))},e.getChatUserName=function(){var t=e.getCometChatUser();return t&&t.name?t.name:stateService.getChatUserName()},e.getChatUserUUID=function(){var t=e.getCometChatUser();return t&&t.uid?t.uid:userService.getUserUUID()},e.inactivityTimeoutReached=function(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_REACHED)},e.inactivityTimeoutCleared=function(){eventService.publish(GIS_CONSTANTS.EVENT_NAMES.CHAT_INACTIVITY_TIMEOUT_CLEARED)},overrideService.override("chatUtilService",e),{getChatUserUUID:e.getChatUserUUID,getChatUserName:e.getChatUserName,getGroupId:e.getGroupId,isInactivityNotificationEnabled:e.isInactivityNotificationEnabled,inactivityTimeoutReached:e.inactivityTimeoutReached,inactivityTimeoutCleared:e.inactivityTimeoutCleared}};GISAPP.otPublisher=function(){return function(n){var e,t,o,i,c,u=n;return{getPublisher:function(){return u},setUpOTPublisherHandler:function(){u.on('videoElementCreated',function(n){'function'==typeof e&&e(n)}),u.on('streamCreated',function(n){'function'==typeof t&&t(n)}),u.on('accessAllowed',function(n){'function'==typeof o&&o(n)}),u.on('accessDenied',function(n){'function'==typeof i&&i(n)}),u.on('accessDialogOpened',function(n){'function'==typeof c&&c(n)})},setVideoElementCreatedHandler:function(n){e=n},setStreamCreatedHandler:function(n){t=n},setAccessAllowedHandler:function(n){o=n},setAccessDeniedHandler:function(n){i=n},setAccessDialogOpenedHandler:function(n){c=n},publishAudio:function(n){u.publishAudio(n)},publishVideo:function(n){u.publishVideo(n)},destroy:function(){u.destroy()},cycleVideo:function(){u.cycleVideo()}}}};GISAPP.otSession=function(logService,otSubscriber){return function(n){var e,t,o,i,c,s,f,u,r,a,d,p,l=n,y=[];return{getSession:function(){return l},setUpOTSessionHandlers:function(){l.on('sessionConnected',function(n){'function'==typeof e&&e(n)}),l.on('sessionDisconnected',function(n){'function'==typeof t&&t(n)}),l.on('sessionReconnecting',function(n){'function'==typeof o&&o(n)}),l.on('sessionReconnected',function(n){'function'==typeof i&&i(n)}),l.on('connectionCreated',function(n){'function'==typeof c&&c(n)}),l.on('connectionDestroyed',function(n){'function'==typeof s&&s(n)}),l.on('streamCreated',function(n){'function'==typeof f&&f(n)}),l.on('streamDestroyed',function(n){'function'==typeof u&&u(n)}),l.on('signal',function(n){'function'==typeof r&&r(n)}),l.on('streamPropertyChanged',function(n){'function'==typeof a&&a(n)}),l.on('archiveStarted',function(n){'function'==typeof d&&d(n)}),l.on('archiveStopped',function(n){'function'==typeof p&&p(n)})},setSessionConnectedHandler:function(n){e=n},setSessionDisconnectedHandler:function(n){t=n},setSessionReconnectingHandler:function(n){o=n},setSessionReconnectedHandler:function(n){i=n},setConnectionCreatedHandler:function(n){c=n},setConnectionDestroyedHandler:function(n){s=n},setStreamCreatedHandler:function(n){f=n},setStreamDestroyedHandler:function(n){u=n},setSignalHandler:function(n){r=n},setStreamPropertyChangedHandler:function(n){a=n},setArchivingStartedHandler:function(n){d=n},setArchivingStoppedHandler:function(n){p=n},sendSignal:function(n,e,t){var o={};n&&(o.to=n),e&&(o.type=e),t&&(o.data=t),l&&l.signal(o,function(n){n&&logService.error("otSession","Exception on sending signal.("+n.name+")"+n.message)})},getConnection:function(){return l.connection},subscribe:function(n,e,t){var o=l.subscribe(n,e,t),i=new otSubscriber(o);return y.push(i),i},publish:function(n,e){l.publish(n,e)},disconnect:function(){l.disconnect()},getSubscribers:function(){return y},connect:function(n,e){l.connect(n,e)},off:function(){l.off()}}}};GISAPP.otSubscriber=function(){return function(n){var e,i,o,t,u=n;return{getSubscriber:function(){return u},setVideoDisableWarningHandler:function(n){e=n},setVideoDisableWarningLiftedHandler:function(n){i=n},setVideoDisabledHandler:function(n){o=n},setVideoEnabledHandler:function(n){t=n},setUpSubscriberHandlers:function(){u.on('videoDisableWarning',function(){'function'==typeof e&&e()}),u.on('videoDisableWarningLifted',function(){'function'==typeof i&&i()}),u.on('videoDisabled',function(n){'function'==typeof o&&o(n)}),u.on('videoEnabled',function(){'function'==typeof t&&t()})},setAudioVolume:function(n){u.setAudioVolume(n)}}}};GISAPP.GIS_CONSTANTS=function(){return{CALL_TYPES:{DIRECT:'DIRECT',STANDARD:'STANDARD',MEETING:'MEETING'},CALL_STATUS:{NOT_CONNECTED:0,CONNECTING:1,CONNECTED:2},CALL_END_REASONS:{FAILED:'Failed',CLERK:'Clerk Ended',CONSUMER:'Consumer Ended',OTHER:'Other'},SIGNAL_TYPE:{ADD_TO_BASKET:'ADD-TO-BASKET',CHAT_INITIATED:'CHAT_INITIATED',IS_CHAT_INITIATED:'IS_CHAT_INITIATED',TRANSITION_CHAT_TO_CALL_REQUEST:'TRANSITION_CHAT_TO_CALL_REQUEST',TRANSITION_CHAT_TO_CALL_RESPONSE:'TRANSITION_CHAT_TO_CALL_RESPONSE'},VIEWS:{CONNECT:'CONNECT',HUMANIZED_CONNECT:'HUMANIZED_CONNECT',INVALID_URL:'INVALID_URL',MEETING_CANCELED:'MEETING_CANCELED',MEETING_MISSED:'MEETING_MISSED',MEETING_CONNECT:'MEETING_CONNECT',MEETING_ENDED:'MEETING_ENDED',MEETING_ERROR:'MEETING_ERROR',DIRECT:'DIRECT',CLERK_UNAVAILABLE_CONNECT:'CLERK_UNAVAILABLE_CONNECT',CALL_START:'CALL_START',BOOKING:'BOOKING',ADD_A_PERSON_SCREEN:'ADD_A_PERSON_SCREEN'},MEDIA:{TYPE:{CAMERA:'CAMERA',MIC:'MIC'},STATUS:{DETECTED:'DETECTED',NOT_DETECTED:'NOT_DETECTED',MUTE:'MUTE',UN_MUTE:'UN_MUTE'},PERMISSION:{ALLOWED:'ALLOWED',NOT_ALLOWED:'NOT_ALLOWED'}},CHAT:{MAX_NUM_OF_USERS:20,CURRENT_NUM_OF_USERS:18,MEMBER_COUNT_STATUS:{SUCCESSFUL:1,ERROR_INVALID_GUID:2,ERROR_GENERAL:3},INACTIVITY:{CONVERSATION:{NOTIFICATION_TIMEOUT:300,ENDCALL_TIMEOUT:120},USERNAME:{AUTO_SUBMIT_LIMIT:15,DEFAULT_NAME:"Customer"}}},VIDEO_CONTROLS:{PLAY:'PLAY',PRODUCT:'PRODUCT',CHAT:'CHAT',VOLUME:'VIDEO_VOLUME',FULL_SCREEN:'FULL_SCREEN'},TIME_TYPES:{BOTH:"BOTH",START:"START",END:"END"},CALLSCREEN_MODE:{GIS_CHAT_NORMAL_SCREEN:'GIS_CHAT_NORMAL_SCREEN',GIS_CHAT_FULL_SCREEN:'GIS_CHAT_FULL_SCREEN'},COOKIES_PERMISSIONS:{ACCEPTED:"ACCEPTED",REJECTED:"REJECTED",UNKNOWN:"UNKNOWN"},QUERY_PARAM:{GIS_EVENT_PARAM:'gisevent',GIS_CHANNEL_PARAM:'gischannel',GIS_SOCIAL:'gissocial'},BROADCAST_STATUS:{BROADCAST_CREATED:0,BROADCAST_LIVE:1,BROADCAST_ENDED:10},INPUT_ALIGNMENT:{LTR:"LR",RTL:"RL"},REGEX:{EMOTICON:/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/g,SPECIAL_SYMBOL:/^[A-Za-z0-9.]+$/,ALPHA_NUM:/^[A-Za-z0-9-]+$/},PRODUCT_POPUP_TYPES:{INFO:"info",CTA:"cta",CTA_TYPES:{DETAILS:"details",SHARED:"shared",BEFORE_YOU_GO:"beforeYouGo",ADD_A_PERSON:"addAPerson"},INFO_TYPES:{ADDED_TO_CART:"addedToCart",ADDED_TO_LIST:"addedToList",CAROUSEL_PROMPT:"carouselPrompt"}},EVENT_NAMES:{SCREEN_RESIZE:'gisWindowResize',SHOW_PRODUCT_DETAILS_POPUP:'showProductDetailsPopup',WINDOW_SCROLL:"gisWindowScroll",ORIENTATION_CHANGE:"gisWindowOrientationChange",CHECK_FOR_CAROUSEL_UPDATE:"checkForCarouselUpdate",CHAT_INACTIVITY_TIMEOUT_REACHED:"chatInactivityTimeoutReached",CHAT_INACTIVITY_TIMEOUT_CLEARED:"chatInactivityTimeoutCleared",COMETCHAT_LOGGED_IN:"cometChatLoggedIn"},CURRENCY_MAP:{AED:'د.إ',AFN:'؋',ALL:'L',AMD:'֏',ANG:'ƒ',AOA:'Kz',ARS:'$',AUD:'$',AWG:'ƒ',AZN:'₼',BAM:'KM',BBD:'$',BDT:'৳',BGN:'лв',BHD:'.د.ب',BIF:'FBu',BMD:'$',BND:'$',BOB:'$b',BOV:'BOV',BRL:'R$',BSD:'$',BTC:'₿',BTN:'Nu.',BWP:'P',BYN:'Br',BYR:'Br',BZD:'BZ$',CAD:'$',CDF:'FC',CHE:'CHE',CHF:'CHF',CHW:'CHW',CLF:'CLF',CLP:'$',CNY:'¥',COP:'$',COU:'COU',CRC:'₡',CUC:'$',CUP:'₱',CVE:'$',CZK:'Kč',DJF:'Fdj',DKK:'kr',DOP:'RD$',DZD:'دج',EEK:'kr',EGP:'£',ERN:'Nfk',ETB:'Br',ETH:'Ξ',EUR:'€',FJD:'$',FKP:'£',GBP:'£',GEL:'₾',GGP:'£',GHC:'₵',GHS:'GH₵',GIP:'£',GMD:'D',GNF:'FG',GTQ:'Q',GYD:'$',HKD:'$',HNL:'L',HRK:'kn',HTG:'G',HUF:'Ft',IDR:'Rp',ILS:'₪',IMP:'£',INR:'₹',IQD:'ع.د',IRR:'﷼',ISK:'kr',JEP:'£',JMD:'J$',JOD:'JD',JPY:'¥',KES:'KSh',KGS:'лв',KHR:'៛',KMF:'CF',KPW:'₩',KRW:'₩',KWD:'KD',KYD:'$',KZT:'₸',LAK:'₭',LBP:'£',LKR:'₨',LRD:'$',LSL:'M',LTC:'Ł',LTL:'Lt',LVL:'Ls',LYD:'LD',MAD:'MAD',MDL:'lei',MGA:'Ar',MKD:'ден',MMK:'K',MNT:'₮',MOP:'MOP$',MRO:'UM',MRU:'UM',MUR:'₨',MVR:'Rf',MWK:'MK',MXN:'$',MXV:'MXV',MYR:'RM',MZN:'MT',NAD:'$',NGN:'₦',NIO:'C$',NOK:'kr',NPR:'₨',NZD:'$',OMR:'﷼',PAB:'B/.',PEN:'S/.',PGK:'K',PHP:'₱',PKR:'₨',PLN:'zł',PYG:'Gs',QAR:'﷼',RMB:'￥',RON:'lei',RSD:'Дин.',RUB:'₽',RWF:'R₣',SAR:'﷼',SBD:'$',SCR:'₨',SDG:'ج.س.',SEK:'kr',SGD:'S$',SHP:'£',SLL:'Le',SOS:'S',SRD:'$',SSP:'£',STD:'Db',STN:'Db',SVC:'$',SYP:'£',SZL:'E',THB:'฿',TJS:'SM',TMT:'T',TND:'د.ت',TOP:'T$',TRL:'₤',TRY:'₺',TTD:'TT$',TVD:'$',TWD:'NT$',TZS:'TSh',UAH:'₴',UGX:'USh',USD:'$',UYI:'UYI',UYU:'$U',UYW:'UYW',UZS:'лв',VEF:'Bs',VES:'Bs.S',VND:'₫',VUV:'VT',WST:'WS$',XAF:'FCFA',XBT:'Ƀ',XCD:'$',XOF:'CFA',XPF:'₣',XSU:'Sucre',XUA:'XUA',YER:'﷼',ZAR:'R',ZMW:'ZK',ZWD:'Z$',ZWL:'$'},ACTIONS:{BROADCAST_SCREEN_CLOSED:"BROADCAST_SCREEN_CLOSED"},POPUP_TYPE:{PRECALLSCREEN_MIC_NEEDED:'preCallScreen_MicNeeded',CHAT_INACTIVITY_PROMPT:'chatInactivityPrompt',START_CALL_PROMPT:'startCallPrompt',INCOMING_CALL_PROMPT:'incomingCallPrompt',END_CALL_PROMPT:"endCallPrompt",OUTGOING_CALL_DECLINED:'outgoingCallDeclined'},DIRECT_CALL_TYPE:{DEPARTMENT_CALL:"departmentCall",CLERK_CALL:"clerkCall"},BROWSER_SHORTCODE_MAP:{facebook:"fb",instagram:"ig"}}};GISAPP.moduleLoaderCtrl=function(){'use strict';var o=[],t="moduleLoaderCtrl";for(var r in GISAPP)if(GISAPP.hasOwnProperty(r)){if(l(r,o))continue;a(r)}function a(e){try{GISAPP[e]||console.log("ERROR: Couldn't find module "+e);var r=GISAPP[e].toString().match(/\(.*?\)/)[0];(r=r.substring(1,r.length-1).replace(/\s/g,'').split(","))&&r[0]&&r.forEach(function(r){l(r,o)||a(r)}),GISAPP[e]=GISAPP[e].apply(null,r.map(function(r){return GISAPP[r]})),o.push(e)}catch(r){var n={level:"ERROR",msg:"Error while loading module "+e,tag:t,error:{stack:r.stack,message:r.message},sysInfo:{env:'prod'}};throw window._LTracker&&(_LTracker=window._LTracker||[],_LTracker.push({logglyKey:'c8f8cb7e-94fd-4e89-ab09-19e7712967f0',sendConsoleErrors:!1,tag:"browser-prod"}),_LTracker.push(n)),new Error("GIS: Error loading module: "+r.stack)}}function l(r,e){for(var n=0;n<e.length;n++)if(e[n]===r)return!0;return!1}GISAPP.initCtrl.init()}();